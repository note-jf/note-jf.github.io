import{_ as c}from"./plugin-vue_export-helper.21dcd24c.js";import{o as l,c as u,e as s,w as i,b as a,a as t,d as n,r as e}from"./app.c37b87a5.js";var r="/assets/true-image-20210604131952296.11fdaa89.png",d="/assets/true-image-20210604132012980.e5e1feb9.png",k="/assets/true-image-20210908125845385.033bf4e3.png",v="/assets/true-image-20210908134637817.c0914e91.png",m="/assets/true-image-20210908140454119.cedcc55c.png",q="/assets/true-image-20210908140642855.b873a36f.png",b="/assets/true-image-20210908140522448.6e782efb.png",g="/assets/true-image-20210908141401665.62fc79c2.png",y="/assets/true-image-20210908144225635.924815c0.png",h="/assets/true-image-20210908144344775.7fab5aaf.png",_="/assets/true-image-20210908144359490.f1e7dcd2.png",f="/assets/true-image-20210908145026804.51551790.png",x="/assets/true-image-20210908145037058.84d99cea.png",j="/assets/true-image-20210908145215817.91563c1f.png",w="/assets/true-image-20210908152409088.fc9cb420.png",T="/assets/true-image-20210908153043492.fd9c498e.png",S="/assets/true-image-20210908155510529.46065d03.png",E="/assets/true-image-20210908215920528.3f961357.png",A="/assets/true-image-20210908231400256.348a70f6.png",B="/assets/true-image-20210908173825031.104b9835.png",I="/assets/true-image-20210908173957845.fd26978e.png",R="/assets/true-image-20210909151150060.1b96817a.png";const P={},G=t('<p><img src="'+r+'" alt="image-20210604131952296"></p><p><img src="'+d+`" alt="image-20210604132012980"></p><h1 id="_1-elasticsearch-\u57FA\u672C\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_1-elasticsearch-\u57FA\u672C\u64CD\u4F5C" aria-hidden="true">#</a> 1. ElasticSearch \u57FA\u672C\u64CD\u4F5C</h1><h2 id="_1-es\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_1-es\u4ECB\u7ECD" aria-hidden="true">#</a> 1,ES\u4ECB\u7ECD</h2><p>* \u5E94\u7528\u7A0B\u5E8F\u641C\u7D22 * \u7F51\u7AD9\u641C\u7D22 * \u4F01\u4E1A\u641C\u7D22 * \u65E5\u5FD7\u5904\u7406\u548C\u5206\u6790</p><p>* \u57FA\u7840\u8BBE\u65BD\u6307\u6807\u548C\u5BB9\u5668\u76D1\u6D4B * \u5E94\u7528\u7A0B\u5E8F\u6027\u80FD\u76D1\u6D4B</p><p>* \u5730\u7406\u7A7A\u95F4\u6570\u636E\u5206\u6790\u548C\u53EF\u89C6\u5316 * \u5B89\u5168\u5206\u6790 * \u4E1A\u52A1\u5206\u6790</p><p>\u5B98\u65B9\u6587\u6863 : https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html</p><p>\u5B98\u65B9\u4E2D\u6587 : https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html</p><p>\u793E\u533A\u4E2D\u6587: https://es.xiaoleilu.com/index.html\u3001http://doc.codingdict.com/elasticsearch/0/</p><h2 id="_1-1-\u57FA\u672C\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#_1-1-\u57FA\u672C\u6982\u5FF5" aria-hidden="true">#</a> 1.1. \u57FA\u672C\u6982\u5FF5</h2><p>Elasticsearch\u4E5F\u662F\u57FA\u4E8ELucene\u7684\u5168\u6587\u68C0\u7D22\u5E93\uFF0C\u672C\u8D28\u4E5F\u662F\u5B58\u50A8\u6570\u636E\uFF0C\u5F88\u591A\u6982\u5FF5\u4E0EMySQL\u7C7B\u4F3C\u7684\u3002</p><p>\u5BF9\u6BD4\u5173\u7CFB\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u7D22\u5F15\uFF08indices\uFF09----------------------Databases \u6570\u636E\u5E93

  \u7C7B\u578B\uFF08type\uFF09--------------------------Table \u6570\u636E\u8868

     \u6587\u6863\uFF08Document\uFF09----------------------Row \u884C

	    \u5B57\u6BB5\uFF08Field\uFF09-------------------------Columns \u5217 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index:\u7D22\u5F15</p><p>type: \u6570\u636E\u7C7B\u578B</p><p>document</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u4FDD\u5B58 \u5728 \u67D0 \u4E2A \u7D22\u5F15 <span class="token punctuation">(</span>Index<span class="token punctuation">)</span> \u4E0B \uFF0C \u67D0 \u79CD \u7C7B \u578B Type<span class="token punctuation">)</span> \u7684 \u4E00 \u4E2A \u6570\u636E <span class="token punctuation">(</span>Document<span class="token punctuation">)</span> \uFF0C \u6587 \u6863 \u662F JSON \u683C
\u5F0F \u7684 \uFF0CDocument \u5C31 \u50CF \u662F MySQL \u4E2D \u7684 \u67D0 \u4E2A Table \u91CC \u9762 \u7684 \u5185 \u5BB9 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8981\u6CE8\u610F\u7684\u662F\uFF1AElasticsearch\u672C\u8EAB\u5C31\u662F\u5206\u5E03\u5F0F\u7684\uFF0C\u56E0\u6B64\u5373\u4FBF\u4F60\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\uFF0CElasticsearch\u9ED8\u8BA4\u4E5F\u4F1A\u5BF9\u4F60\u7684\u6570\u636E\u8FDB\u884C\u5206\u7247\u548C\u526F\u672C\u64CD\u4F5C\uFF0C\u5F53\u4F60\u5411\u96C6\u7FA4\u6DFB\u52A0\u65B0\u6570\u636E\u65F6\uFF0C\u6570\u636E\u4E5F\u4F1A\u5728\u65B0\u52A0\u5165\u7684\u8282\u70B9\u4E2D\u8FDB\u884C\u5E73\u8861\u3002</p><h2 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><p>https://www.elastic.co/cn/downloads/elasticsearch#ga-release</p><p>docker pull elasticsearch:7.14.0 \u5B58\u50A8\u548C\u68C0\u7D22\u6570\u636E</p><p>docker pull kibana:7.14.0 \u53EF\u89C6\u5316\u6570\u636E</p><p>\u6559\u7A0B\uFF1Ahttps://blog.csdn.net/qq_42476834/article/details/112675953</p><p><a href="/tools/docker/docker-install-mysql-redis-nginx-nacos-mq-es.html#elasticsearch-kibana">\u5177\u4F53DOcker\u5B89\u88C5\u914D\u7F6E</a></p><h3 id="\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E" aria-hidden="true">#</a> -- \u914D\u7F6E</h3><h4 id="_1-elasticsearch" tabindex="-1"><a class="header-anchor" href="#_1-elasticsearch" aria-hidden="true">#</a> 1,elasticsearch</h4><p><img src="`+k+'" alt="image-20210908125845385"></p><h4 id="_2-kibana" tabindex="-1"><a class="header-anchor" href="#_2-kibana" aria-hidden="true">#</a> 2,kibana</h4><p><img src="'+v+`" alt="image-20210908134637817"></p><h2 id="_1-2-\u7D22\u5F15\u64CD\u4F5C-indices" tabindex="-1"><a class="header-anchor" href="#_1-2-\u7D22\u5F15\u64CD\u4F5C-indices" aria-hidden="true">#</a> 1.2. \u7D22\u5F15\u64CD\u4F5C\uFF08indices\uFF09</h2><h3 id="_1-2-1-\u67E5\u8BE2\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_1-2-1-\u67E5\u8BE2\u7D22\u5F15" aria-hidden="true">#</a> 1.2.1. \u67E5\u8BE2\u7D22\u5F15</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/_cat/indices?v \u6709\u54EA\u4E9B\u7D22\u5F15\u5E93
/_cat/nodes \u67E5\u770B\u8282\u70B9\u4FE1\u606F
/_cat/health \u67E5\u770Bes\u5065\u5EB7\u72B6\u6001
/_cat/master \u67E5\u770B\u4E3B\u8282\u70B9
/_cat/indices \u67E5\u770B\u6240\u6709\u7D22\u5F15
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>es \u4E2D\u4F1A\u9ED8\u8BA4\u5B58\u5728\u4E00\u4E2A\u540D\u4E3A.kibana\u548C.kibana_task_manager\u7684\u7D22\u5F15</p><p>\u8868\u5934\u7684\u542B\u4E49</p><table><thead><tr><th style="text-align:center;">\u5B57\u6BB5\u540D</th><th style="text-align:left;">\u542B\u4E49\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">health</td><td style="text-align:left;">green(\u96C6\u7FA4\u5B8C\u6574) yellow(\u5355\u70B9\u6B63\u5E38\u3001\u96C6\u7FA4\u4E0D\u5B8C\u6574) red(\u5355\u70B9\u4E0D\u6B63\u5E38)</td></tr><tr><td style="text-align:center;">status</td><td style="text-align:left;">\u662F\u5426\u80FD\u4F7F\u7528</td></tr><tr><td style="text-align:center;">index</td><td style="text-align:left;">\u7D22\u5F15\u540D</td></tr><tr><td style="text-align:center;">uuid</td><td style="text-align:left;">\u7D22\u5F15\u7EDF\u4E00\u7F16\u53F7</td></tr><tr><td style="text-align:center;">pri</td><td style="text-align:left;">\u4E3B\u8282\u70B9\u51E0\u4E2A</td></tr><tr><td style="text-align:center;">rep</td><td style="text-align:left;">\u4ECE\u8282\u70B9\u51E0\u4E2A</td></tr><tr><td style="text-align:center;">docs.count</td><td style="text-align:left;">\u6587\u6863\u6570</td></tr><tr><td style="text-align:center;">docs.deleted</td><td style="text-align:left;">\u6587\u6863\u88AB\u5220\u4E86\u591A\u5C11</td></tr><tr><td style="text-align:center;">store.size</td><td style="text-align:left;">\u6574\u4F53\u5360\u7A7A\u95F4\u5927\u5C0F</td></tr><tr><td style="text-align:center;">pri.store.size</td><td style="text-align:left;">\u4E3B\u8282\u70B9\u5360</td></tr></tbody></table><h3 id="_1-2-2-\u521B\u5EFA\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_1-2-2-\u521B\u5EFA\u7D22\u5F15" aria-hidden="true">#</a> 1.2.2. \u521B\u5EFA\u7D22\u5F15</h3><p>\u4FDD\u5B58: PUT /index/type/\u6807\u8BC6id -- \u5982: PUT /customer/demo/1 json\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># PUT \u548C POST\u90FD\u53EF\u4EE5.</span>
*POST* \u65B0\u589E\u3002\u5982\u679C\u4E0D\u6307\u5B9Aid\uFF0C\u4F1A\u81EA\u52A8\u751F\u6210id\u3002\u6307\u5B9Aid\u5C31\u4F1A\u4FEE\u6539\u8FD9\u4E2A\u6570\u636E\uFF0C\u5E76\u65B0\u589E\u7248\u672C\u53F7
*PUT* \u53EF\u4EE5\u65B0\u589E<span class="token operator">&amp;</span>\u4FEE\u6539\u3002PUT\u5FC5\u987B\u6307\u5B9Aid,\u7531\u4E8EPUT\u9700\u8981\u6307\u5B9Aid\uFF0C\u6211\u4EEC\u4E00\u822C\u90FD\u7528\u6765\u505A\u4FEE\u6539\u64CD\u4F5C\uFF0C\u4E0D\u6307\u5B9Aid\u4F1A\u62A5\u9519 \u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u54CD\u5E94\u7ED3\u679C-json" tabindex="-1"><a class="header-anchor" href="#\u54CD\u5E94\u7ED3\u679C-json" aria-hidden="true">#</a> --- \u54CD\u5E94\u7ED3\u679C [json] <a name="\u54CD\u5E94\u7ED3\u679C"></a></h4><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span> #\u7D22\u5F15
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span> #\u7C7B\u578B
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>	#id
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> #\u7248\u672C
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span> #\u72B6\u6001
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> #\u5E76\u53D1\u63A7\u5236\u5B57\u6BB5\uFF0C\u6BCF\u6B21\u66F4\u65B0\u5C31\u4F1A+<span class="token number">1</span>\uFF0C\u7528\u6765\u505A\u4E50\u89C2\u9501
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span> #\u540C\u4E0A<span class="token punctuation">,</span>\u4E3B\u5206\u7247\u91CD\u65B0\u5206\u914D\uFF0C\u5982\u91CD\u542F\uFF0C\u5C31\u4F1A\u53D8\u5316
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="put" tabindex="-1"><a class="header-anchor" href="#put" aria-hidden="true">#</a> --- PUT</h4><p><img src="`+m+'" alt="image-20210908140454119"></p><p><img src="'+q+'" alt="image-20210908140642855"></p><p>\u4E0D\u6307\u5B9AID\u62A5\u9519</p><p><img src="'+b+'" alt="image-20210908140522448"></p><h4 id="post" tabindex="-1"><a class="header-anchor" href="#post" aria-hidden="true">#</a> --- POST</h4><p><img src="'+g+`" alt="image-20210908141401665"></p><h3 id="_1-2-3-get-\u67E5\u8BE2\u6587\u6863-\u4E50\u89C2\u9501" tabindex="-1"><a class="header-anchor" href="#_1-2-3-get-\u67E5\u8BE2\u6587\u6863-\u4E50\u89C2\u9501" aria-hidden="true">#</a> 1.2.3. get \u67E5\u8BE2\u6587\u6863&amp;\u4E50\u89C2\u9501</h3><p><a href="#%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C">\u54CD\u5E94\u7ED3\u679C</a></p><p>get http://192.168.101.5:9200/customer/demo/1</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u9C7C666&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# \u66F4\u65B0\u643A\u5E26 ?if_seq_no=<span class="token number">14</span>&amp;if_primary_term=<span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5E76\u53D1\u4FEE\u6539\u6D4B\u8BD5-\u591A\u4E2A\u4EBA\u540C\u65F6\u4FEE\u6539\u4E00\u4E2A\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u4FEE\u6539\u6D4B\u8BD5-\u591A\u4E2A\u4EBA\u540C\u65F6\u4FEE\u6539\u4E00\u4E2A\u6570\u636E" aria-hidden="true">#</a> \u5E76\u53D1\u4FEE\u6539\u6D4B\u8BD5:\u591A\u4E2A\u4EBA\u540C\u65F6\u4FEE\u6539\u4E00\u4E2A\u6570\u636E</h4><p><img src="`+y+'" alt="image-20210908144225635"></p><p><img src="'+h+'" alt="image-20210908144344775"></p><p>\u8BFB\u53D6</p><p><img src="'+_+'" alt="image-20210908144359490"></p><p>\u5982\u679C\u60F3\u8981\u4FEE\u6539\u6210\u529F,\u5C31\u9700\u8981\u83B7\u53D6\u6700\u65B0\u7684_seq_no</p><h3 id="_1-2-4-post-\u66F4\u65B0\u6587\u6863" tabindex="-1"><a class="header-anchor" href="#_1-2-4-post-\u66F4\u65B0\u6587\u6863" aria-hidden="true">#</a> 1.2.4. post \u66F4\u65B0\u6587\u6863</h3><p>\u66F4\u65B01</p><p><img src="'+f+'" alt="image-20210908145026804"></p><p>\u8BFB\u53D6</p><p><img src="'+x+'" alt="image-20210908145037058"></p><p>\u66F4\u65B02</p><p><img src="'+j+`" alt="image-20210908145215817"></p><h3 id="_1-2-5-\u5220\u9664\u6587\u6863-\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_1-2-5-\u5220\u9664\u6587\u6863-\u7D22\u5F15" aria-hidden="true">#</a> 1.2.5. \u5220\u9664\u6587\u6863&amp;\u7D22\u5F15</h3><p>\u5220\u9664ID: http://192.168.101.5:9200/customer/demo/id/</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8v8NxHsBlSgdobgg7YRN&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deleted&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5220\u9664\u7D22\u5F15: http://192.168.101.5:9200/customer/</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
\u67E5\u770B\u7D22\u5F15<span class="token operator">:</span> http<span class="token operator">:</span><span class="token comment">//192.168.101.5:9200/_cat/indices</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-6-post-bulk\u6279\u91CF\u5BFC\u5165-api" tabindex="-1"><a class="header-anchor" href="#_1-2-6-post-bulk\u6279\u91CF\u5BFC\u5165-api" aria-hidden="true">#</a> 1.2.6 post bulk\u6279\u91CF\u5BFC\u5165 API</h3><h4 id="postman" tabindex="-1"><a class="header-anchor" href="#postman" aria-hidden="true">#</a> --- postman</h4><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u971E&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u82B1&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>post http://192.168.101.5:9200/customer/demo/_bulk</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">200</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">201</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>http://192.168.101.5:9200/customer/demo/1</p><h4 id="\u53EF\u89C6\u5316\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u53EF\u89C6\u5316\u64CD\u4F5C" aria-hidden="true">#</a> --- \u53EF\u89C6\u5316\u64CD\u4F5C</h4><p><img src="`+w+`" alt="image-20210908152409088"></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST /_bulk
<span class="token punctuation">{</span> <span class="token property">&quot;delete&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;create&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My first blog post&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My second blog post&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;update&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;doc&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;My updated blog post&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+T+'" alt="image-20210908153043492"></p><h4 id="\u6837\u672C\u6D4B\u8BD5\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u6837\u672C\u6D4B\u8BD5\u6570\u636E" aria-hidden="true">#</a> -- \u6837\u672C\u6D4B\u8BD5\u6570\u636E</h4><p>https://download.elastic.co/demos/kibana/gettingstarted/accounts.zip</p><p><img src="'+S+`" alt="image-20210908155510529"></p><h2 id="_1-3-\u6620\u5C04\u914D\u7F6E-mapping" tabindex="-1"><a class="header-anchor" href="#_1-3-\u6620\u5C04\u914D\u7F6E-mapping" aria-hidden="true">#</a> 1.3. \u6620\u5C04\u914D\u7F6E\uFF08_mapping\uFF09</h2><p>\u7D22\u5F15\u6709\u4E86\uFF0C\u63A5\u4E0B\u6765\u80AF\u5B9A\u662F\u6DFB\u52A0\u6570\u636E\u3002\u4F46\u662F\uFF0C\u5728\u6DFB\u52A0\u6570\u636E\u4E4B\u524D\u5FC5\u987B\u5B9A\u4E49\u6620\u5C04\u3002</p><p>\u4EC0\u4E48\u662F\u6620\u5C04\uFF1F</p><blockquote><p>\u6620\u5C04\u662F\u5B9A\u4E49\u6587\u6863\u7684\u8FC7\u7A0B\uFF0C\u6587\u6863\u5305\u542B\u54EA\u4E9B\u5B57\u6BB5\uFF0C\u8FD9\u4E9B\u5B57\u6BB5\u662F\u5426\u4FDD\u5B58\uFF0C\u662F\u5426\u7D22\u5F15\uFF0C\u662F\u5426\u5206\u8BCD\u7B49</p></blockquote><p>\u53EA\u6709\u914D\u7F6E\u6E05\u695A\uFF0CElasticsearch\u624D\u4F1A\u5E2E\u6211\u4EEC\u8FDB\u884C\u7D22\u5F15\u5E93\u7684\u521B\u5EFA\uFF08\u4E0D\u4E00\u5B9A\uFF09</p><h3 id="_1-3-1-put-\u521B\u5EFA\u6620\u5C04\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#_1-3-1-put-\u521B\u5EFA\u6620\u5C04\u5B57\u6BB5" aria-hidden="true">#</a> 1.3.1. PUT \u521B\u5EFA\u6620\u5C04\u5B57\u6BB5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>PUT /\u7D22\u5F15\u5E93\u540D/_mapping/\u7C7B\u578B\u540D\u79F0
<span class="token punctuation">{</span>
  <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;\u5B57\u6BB5\u540D&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;\u7C7B\u578B&quot;</span>,
      <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> true\uFF0C
      <span class="token string">&quot;store&quot;</span><span class="token builtin class-name">:</span> true\uFF0C
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;\u5206\u8BCD\u5668&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7C7B\u578B\u540D\u79F0\uFF1A\u5C31\u662F\u524D\u9762\u5C06\u7684type\u7684\u6982\u5FF5\uFF0C\u7C7B\u4F3C\u4E8E\u6570\u636E\u5E93\u4E2D\u7684\u4E0D\u540C\u8868</p><p>\u5B57\u6BB5\u540D\uFF1A\u7C7B\u4F3C\u4E8E\u5217\u540D\uFF0Cproperties\u4E0B\u53EF\u4EE5\u6307\u5B9A\u8BB8\u591A\u5B57\u6BB5\u3002</p><p>\u6BCF\u4E2A\u5B57\u6BB5\u53EF\u4EE5\u6709\u5F88\u591A\u5C5E\u6027\u3002\u4F8B\u5982\uFF1A</p><ul><li>type\uFF1A\u7C7B\u578B\uFF0C\u53EF\u4EE5\u662Ftext\u3001long\u3001short\u3001date\u3001integer\u3001object\u7B49</li><li>index\uFF1A\u662F\u5426\u7D22\u5F15\uFF0C\u9ED8\u8BA4\u4E3Atrue</li><li>store\uFF1A\u662F\u5426\u5B58\u50A8\uFF0C\u9ED8\u8BA4\u4E3Afalse</li><li>analyzer\uFF1A\u5206\u8BCD\u5668\uFF0C\u8FD9\u91CC\u4F7F\u7528ik\u5206\u8BCD\u5668\uFF1A<code>ik_max_word</code>\u6216\u8005<code>ik_smart</code></li></ul><blockquote><p>\u793A\u4F8B</p></blockquote><p>\u53D1\u8D77\u8BF7\u6C42\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>\u793A\u4F8B<span class="token number">1</span>
PUT atguigu/_mapping/goods
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;false&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
\u793A\u4F8B<span class="token number">2</span>
PUT /my_index
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;integer&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u54CD\u5E94\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+E+`" alt="image-20210908215920528"></p><h3 id="_1-3-2-get-\u67E5\u770B\u6620\u5C04\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#_1-3-2-get-\u67E5\u770B\u6620\u5C04\u5173\u7CFB" aria-hidden="true">#</a> 1.3.2. GET \u67E5\u770B\u6620\u5C04\u5173\u7CFB</h3><blockquote><p>\u8BED\u6CD5\uFF1A</p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /\u7D22\u5F15\u5E93\u540D/_mapping
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u793A\u4F8B\uFF1A</p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_mapping
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u54CD\u5E94\uFF1A</p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;atguigu&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;mappings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;goods&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>type\uFF1A\u5B57\u6BB5\u7C7B\u578B\u3002String\uFF08text keyword\uFF09 Numeric\uFF08long integer float double\uFF09 date boolean</p><p>index\uFF1A\u662F\u5426\u521B\u5EFA\u7D22\u5F15</p><p>analyzer\uFF1A\u5206\u8BCD\u5668\uFF08ik_max_word\uFF09</p><h3 id="_1-3-3-put-\u6DFB\u52A0\u7D22\u5F15\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#_1-3-3-put-\u6DFB\u52A0\u7D22\u5F15\u5B57\u6BB5" aria-hidden="true">#</a> 1.3.3 PUT \u6DFB\u52A0\u7D22\u5F15\u5B57\u6BB5</h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /my_index/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;employee-id&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>	#\u5B57\u6BB5
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>#\u7C7B\u578B
      <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token boolean">false</span> #\u53EF\u68C0\u7D22
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
#\u5BF9\u4E8E\u5DF2\u7ECF\u5B58\u5728\u7684\u6620\u5C04\u5B57\u6BB5\uFF0C\u6211\u4EEC\u4E0D\u80FD\u66F4\u65B0\u3002\u66F4\u65B0\u5FC5\u987B\u521B\u5EFA\u65B0\u7684\u7D22\u5F15\u8FDB\u884C\u6570\u636E\u8FC1\u79FB
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-4-\u6620\u5C04-put-\u6570\u636E\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#_1-3-4-\u6620\u5C04-put-\u6570\u636E\u8FC1\u79FB" aria-hidden="true">#</a> 1.3.4 \u6620\u5C04\uFF1APUT \u6570\u636E\u8FC1\u79FB</h3><p>_type=&quot;account&quot; \u53D8\u4E3A&gt; _type: &quot;_doc&quot;,\uFF0C\u53D6\u6D88\u4E86type\uFF0C6.0\u4E4B\u540E\u53D6\u6D88\u4E86type</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /bank/_mapping

PUT /newbank
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;integer&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;balance&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;integer&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;city&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;employer&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;firstname&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lastname&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;state&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET /newbank

POST _reindex
<span class="token punctuation">{</span>
  <span class="token property">&quot;source&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token string">&quot;bank&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;account&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dest&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token string">&quot;newbank&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET /newbank/_search	#_type=<span class="token string">&quot;account&quot;</span> \u53D8\u4E3A&gt; _type<span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>\uFF0C\u53D6\u6D88\u4E86type\uFF0C<span class="token number">6.0</span>\u4E4B\u540E\u53D6\u6D88\u4E86type
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-4-\u65B0\u589E\u6587\u6863-document" tabindex="-1"><a class="header-anchor" href="#_1-4-\u65B0\u589E\u6587\u6863-document" aria-hidden="true">#</a> 1.4. \u65B0\u589E\u6587\u6863\uFF08document\uFF09</h2><p>\u6709\u4E86\u7D22\u5F15\u3001\u7C7B\u578B\u548C\u6620\u5C04\uFF0C\u5C31\u53EF\u4EE5\u5BF9\u6587\u6863\u505A\u589E\u5220\u6539\u67E5\u64CD\u4F5C\u4E86\u3002</p><h3 id="_1-4-1-\u57FA\u672C\u73A9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_1-4-1-\u57FA\u672C\u73A9\u6CD5" aria-hidden="true">#</a> 1.4.1. \u57FA\u672C\u73A9\u6CD5</h3><p>\u5982\u679C\u6211\u4EEC\u60F3\u8981\u81EA\u5DF1\u65B0\u589E\u7684\u65F6\u5019\u6307\u5B9Aid\uFF0C\u53EF\u4EE5\u8FD9\u4E48\u505A\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST /\u7D22\u5F15\u5E93\u540D/\u7C7B\u578B/id\u503C
{
    ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6F14\u793A\uFF1A</p><p>\u67E5\u8BE2\u5F97\u5230\u4E24\u6761\u6570\u636E\uFF1A\u5C0F\u7C73\u624B\u673A\u7684id\u662F\u6211\u4EEC\u6307\u5B9A\u7684id</p><ul><li><code>_source</code>\uFF1A\u6E90\u6587\u6863\u4FE1\u606F\uFF0C\u6240\u6709\u7684\u6570\u636E\u90FD\u5728\u91CC\u9762\u3002</li><li><code>_id</code>\uFF1A\u8FD9\u6761\u6587\u6863\u7684\u552F\u4E00\u6807\u793A\uFF0C\u4E0E\u6587\u6863\u81EA\u5DF1\u7684id\u5B57\u6BB5\u6CA1\u6709\u5173\u8054</li></ul><h3 id="_1-4-2-\u667A\u80FD\u5224\u65AD" tabindex="-1"><a class="header-anchor" href="#_1-4-2-\u667A\u80FD\u5224\u65AD" aria-hidden="true">#</a> 1.4.2. \u667A\u80FD\u5224\u65AD</h3><p>\u4E8B\u5B9E\u4E0AElasticsearch\u975E\u5E38\u667A\u80FD\uFF0C\u4F60\u4E0D\u9700\u8981\u7ED9\u7D22\u5F15\u5E93\u8BBE\u7F6E\u4EFB\u4F55mapping\u6620\u5C04\uFF0C\u5B83\u4E5F\u53EF\u4EE5\u6839\u636E\u4F60\u8F93\u5165\u7684\u6570\u636E\u6765\u5224\u65AD\u7C7B\u578B\uFF0C\u52A8\u6001\u6DFB\u52A0\u6570\u636E\u6620\u5C04\u3002</p><p>\u6D4B\u8BD5\u4E00\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST /atguigu/goods/<span class="token number">2</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2899</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token property">&quot;saleable&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u989D\u5916\u6DFB\u52A0\u4E86stock\u5E93\u5B58\uFF0Csaleable\u662F\u5426\u4E0A\u67B6\uFF0Cattr\u5176\u4ED6\u5C5E\u6027\u51E0\u4E2A\u5B57\u6BB5\u3002</p><p>\u6765\u770B\u7ED3\u679C\uFF1A<code>GET /atguigu/_search</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">4288</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">2899</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          <span class="token property">&quot;saleable&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u518D\u770B\u4E0B\u7D22\u5F15\u5E93\u7684\u6620\u5C04\u5173\u7CFB: <code>GET /atguigu/_mapping</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;atguigu&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;mappings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;goods&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;fields&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;ignore_above&quot;</span> <span class="token operator">:</span> <span class="token number">256</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;fields&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;ignore_above&quot;</span> <span class="token operator">:</span> <span class="token number">256</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;saleable&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;boolean&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>stock\uFF0Csaleable\uFF0Cattr\u90FD\u88AB\u6210\u529F\u6620\u5C04\u4E86\u3002</p><p>\u5982\u679C\u662F\u5B57\u7B26\u4E32\u7C7B\u578B\u7684\u6570\u636E\uFF0C\u4F1A\u6DFB\u52A0\u4E24\u79CD\u7C7B\u578B\uFF1Atext + keyword\u3002\u5982\u4E0A\u4F8B\u4E2D\u7684category \u548C brand</p><h2 id="_1-5-\u5220\u9664\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_1-5-\u5220\u9664\u6570\u636E" aria-hidden="true">#</a> 1.5. \u5220\u9664\u6570\u636E</h2><p>\u5220\u9664\u4F7F\u7528DELETE\u8BF7\u6C42\uFF0C\u540C\u6837\uFF0C\u9700\u8981\u6839\u636Eid\u8FDB\u884C\u5220\u9664\uFF1A</p><blockquote><p>\u8BED\u6CD5</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DELETE /\u7D22\u5F15\u5E93\u540D/\u7C7B\u578B\u540D/id\u503C
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u793A\u4F8B\uFF1A</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DELETE /atguigu/goods/3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u7ED3\u679C\uFF1A</p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_version&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;deleted&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_seq_no&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_primary_term&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-6-\u5206\u8BCD" tabindex="-1"><a class="header-anchor" href="#_1-6-\u5206\u8BCD" aria-hidden="true">#</a> 1.6. \u5206\u8BCD</h2><h3 id="_1-6-1-\u9ED8\u8BA4\u5206\u8BCD\u5668-\u5BF9\u4E2D\u6587\u4E0D\u53CB\u597D" tabindex="-1"><a class="header-anchor" href="#_1-6-1-\u9ED8\u8BA4\u5206\u8BCD\u5668-\u5BF9\u4E2D\u6587\u4E0D\u53CB\u597D" aria-hidden="true">#</a> 1.6.1 \u9ED8\u8BA4\u5206\u8BCD\u5668\uFF0C\u5BF9\u4E2D\u6587\u4E0D\u53CB\u597D</h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bucket aggregations don\u2019t calculate metrics over fields like&quot;</span>
<span class="token punctuation">}</span>
\u7ED3\u679C<span class="token operator">:</span>
	<span class="token punctuation">{</span>
      <span class="token property">&quot;tokens&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bucket&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;aggregations&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
--------------------
POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6211\u7231\u4F60java&quot;</span>
<span class="token punctuation">}</span>
\u7ED3\u679C\uFF1A
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tokens&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5B66&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u6821&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u6211&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-6-2-ik-\u5206\u8BCD\u5668" tabindex="-1"><a class="header-anchor" href="#_1-6-2-ik-\u5206\u8BCD\u5668" aria-hidden="true">#</a> 1.6.2 ik \u5206\u8BCD\u5668</h3><p>\u4E0B\u8F7D\uFF1Ahttps://github.com/medcl/elasticsearch-analysis-ik/releases</p><p>\u89E3\u538B\u5230es\uFF1Aplugins</p><p>\u91CD\u542Fes</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># \u5206\u8BCD\u5931\u8D25
POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6211\u7231\u4F60\u4E2D\u56FD&quot;</span>
<span class="token punctuation">}</span>
# \u5206\u8BCDok
POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_smart&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6211\u7231\u4F60\u4E2D\u56FD&quot;</span>
<span class="token punctuation">}</span>
# \u591A\u8BCD\u7EC4\u5408\u3010\u5982\u4E0B\u56FE\u3011
POST _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6211\u7231\u4F60\u4E2D\u56FD&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+A+'" alt=""></p><h3 id="_1-6-3-\u81EA\u5B9A\u4E49\u5206\u8BCD" tabindex="-1"><a class="header-anchor" href="#_1-6-3-\u81EA\u5B9A\u4E49\u5206\u8BCD" aria-hidden="true">#</a> 1.6.3 \u81EA\u5B9A\u4E49\u5206\u8BCD</h3><p>nginx:</p><p>http://localhost:50005/es/fenci.txt</p><p>ik/config/IKAnalyzer.cfg.xml:</p>',155),z=n("http://localhost:50005/es/fenci.txt"),N=t(`<p>\u91CD\u542Fes</p><h1 id="_2-\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_2-\u67E5\u8BE2" aria-hidden="true">#</a> 2. \u67E5\u8BE2</h1><h2 id="_2\u79CD\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_2\u79CD\u67E5\u8BE2" aria-hidden="true">#</a> 2\u79CD\u67E5\u8BE2 <a name="2\u79CD\u67E5\u8BE2"></a></h2><table><thead><tr><th>took</th><th>Elasticsearch\u6267\u884C\u641C\u7D22\u7684\u65F6\u95F4(\u6BEB\u79D2)</th></tr></thead><tbody><tr><td>time_out</td><td>\u544A\u8BC9\u6211\u4EEC\u641C\u7D22\u662F\u5426\u8D85\u65F6</td></tr><tr><td>_shards</td><td>\u544A\u8BC9\u6211\u4EEC\u591A\u5C11\u4E2A\u5206\u7247\u88AB\u641C\u7D22\u4E86\uFF0C\u4EE5\u53CA\u7EDF\u8BA1\u4E86\u6210\u529F/\u5931\u8D25\u7684\u641C\u7D22\u5206\u7247</td></tr><tr><td>hits</td><td>\u641C\u7D22\u7ED3\u679C</td></tr><tr><td>hits.total</td><td>\u641C\u7D22\u7ED3\u679C</td></tr><tr><td>hits.hits</td><td>\u5B9E\u9645\u7684\u641C\u7D22\u7ED3\u679C\u6570\u7EC4(\u9ED8\u8BA4\u4E3A\u524D10\u7684\u6587\u6863)</td></tr><tr><td>sort</td><td>\u7ED3\u679C\u7684\u6392\u5E8Fkey (\u952E) (\u6CA1\u6709\u5219\u6309score\u6392\u5E8F)</td></tr><tr><td>score\u548Cmax_score</td><td>\u76F8\u5173\u6027\u5F97\u5206\u548C\u6700\u9AD8\u5206</td></tr></tbody></table><p>GET bank/_search?q=*&amp;sort=account_number:asc</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u6240\u6709\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /{index}/_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6839\u636Eid\u67E5\u8BE2\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /{index}/{type}/{id}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u9664\u4E86\u4E0A\u8FF0\u7B80\u5355\u67E5\u8BE2\u4E4B\u5916\u3002elasticsearch\u4F5C\u4E3A\u641C\u7D22\u5F15\u64CE\uFF0C\u6700\u590D\u6742\u6700\u5F3A\u5927\u7684\u529F\u80FD\u5C31\u662F\u641C\u7D22\u67E5\u8BE2\u529F\u80FD\u3002\u5305\u62EC\uFF1A\u5339\u914D\u67E5\u8BE2\u3001\u8BCD\u6761\u67E5\u8BE2\u3001\u6A21\u7CCA\u67E5\u8BE2\u3001\u7EC4\u5408\u67E5\u8BE2\u3001\u8303\u56F4\u67E5\u8BE2\u3001\u9AD8\u4EAE\u3001\u6392\u5E8F\u3001\u5206\u9875\u7B49\u7B49\u67E5\u8BE2\u529F\u80FD\u3002</p><p>\u57FA\u672C\u67E5\u8BE2\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /\u7D22\u5F15\u5E93\u540D/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;\u67E5\u8BE2\u7C7B\u578B&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;\u67E5\u8BE2\u6761\u4EF6&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u67E5\u8BE2\u6761\u4EF6\u503C&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u7684query\u4EE3\u8868\u4E00\u4E2A\u67E5\u8BE2\u5BF9\u8C61\uFF0C\u91CC\u9762\u53EF\u4EE5\u6709\u4E0D\u540C\u7684\u67E5\u8BE2\u5C5E\u6027</p><ul><li>\u67E5\u8BE2\u7C7B\u578B\uFF1A <ul><li>\u4F8B\u5982\uFF1A<code>match_all</code>\uFF0C\xA0<code>match</code>\uFF0C<code>term</code>\xA0\uFF0C\xA0<code>range</code> \u7B49\u7B49</li></ul></li><li>\u67E5\u8BE2\u6761\u4EF6\uFF1A\u67E5\u8BE2\u6761\u4EF6\u4F1A\u6839\u636E\u7C7B\u578B\u7684\u4E0D\u540C\uFF0C\u5199\u6CD5\u4E5F\u6709\u5DEE\u5F02\uFF0C\u540E\u9762\u8BE6\u7EC6\u8BB2\u89E3</li></ul><p>\u67E5\u8BE2\u7ED3\u679C\uFF1A</p><ul><li>took\uFF1A\u67E5\u8BE2\u82B1\u8D39\u65F6\u95F4\uFF0C\u5355\u4F4D\u662F\u6BEB\u79D2</li><li>time_out\uFF1A\u662F\u5426\u8D85\u65F6</li><li>_shards\uFF1A\u5206\u7247\u4FE1\u606F</li><li>hits\uFF1A\u641C\u7D22\u7ED3\u679C\u603B\u89C8\u5BF9\u8C61 <ul><li>total\uFF1A\u641C\u7D22\u5230\u7684\u603B\u6761\u6570</li><li>max_score\uFF1A\u6240\u6709\u7ED3\u679C\u4E2D\u6587\u6863\u5F97\u5206\u7684\u6700\u9AD8\u5206</li><li>hits\uFF1A\u641C\u7D22\u7ED3\u679C\u7684\u6587\u6863\u5BF9\u8C61\u6570\u7EC4\uFF0C\u6BCF\u4E2A\u5143\u7D20\u662F\u4E00\u6761\u641C\u7D22\u5230\u7684\u6587\u6863\u4FE1\u606F <ul><li>_index\uFF1A\u7D22\u5F15\u5E93</li><li>_type\uFF1A\u6587\u6863\u7C7B\u578B</li><li>_id\uFF1A\u6587\u6863id</li><li>_score\uFF1A\u6587\u6863\u5F97\u5206</li><li>_source\uFF1A\u6587\u6863\u7684\u6E90\u6570\u636E</li></ul></li></ul></li></ul><h2 id="_2-1-\u6570\u636E\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_2-1-\u6570\u636E\u51C6\u5907" aria-hidden="true">#</a> 2.1. \u6570\u636E\u51C6\u5907</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST /atguigu/goods/_bulk
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">1999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u8D85\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u7535\u89C6&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">3999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u7535\u89C6&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">4999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">3999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">5999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u8363\u8000\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;oppo\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2799</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;vivo\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2699</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3Anova\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2999</span><span class="token punctuation">,</span> <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5BF9\u975E\u6587\u672C\u6570\u636E\u68C0\u7D22\u7528-trem-\u5BF9\u6587\u672C-\u5168\u6587\u68C0\u7D22\u5C31\u7528-match" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u975E\u6587\u672C\u6570\u636E\u68C0\u7D22\u7528-trem-\u5BF9\u6587\u672C-\u5168\u6587\u68C0\u7D22\u5C31\u7528-match" aria-hidden="true">#</a> \u5BF9\u975E\u6587\u672C\u6570\u636E\u68C0\u7D22\u7528 trem\uFF0C\u5BF9\u6587\u672C|\u5168\u6587\u68C0\u7D22\u5C31\u7528 match</h2><h2 id="_2-2-\u5339\u914D\u67E5\u8BE2-match-match-all" tabindex="-1"><a class="header-anchor" href="#_2-2-\u5339\u914D\u67E5\u8BE2-match-match-all" aria-hidden="true">#</a> 2.2. \u5339\u914D\u67E5\u8BE2\uFF08match &amp;&amp; match_all\uFF09</h2><h3 id="_2-2-1-\u67E5\u8BE2\u6240\u6709-match-all" tabindex="-1"><a class="header-anchor" href="#_2-2-1-\u67E5\u8BE2\u6240\u6709-match-all" aria-hidden="true">#</a> 2.2.1 \u67E5\u8BE2\u6240\u6709\uFF08match_all \uFF09</h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> #\u67E5\u8BE2\u89C4\u5219
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>	#\u67E5\u8BE2\u6240\u6709
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> #\u5F00\u59CB\u4F4D\u7F6E
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> #\u9009\u53D6\u6761\u6570
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> #\u6392\u5E8F
    <span class="token punctuation">{</span>
      <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> #\u5904\u7406\u7684\u5B57\u6BB5
        <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span> # \u6392\u5E8F\u89C4\u5219
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lastname&quot;</span><span class="token punctuation">]</span> #\u663E\u793A\u5B57\u6BB5
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>query</code>\uFF1A\u4EE3\u8868\u67E5\u8BE2\u5BF9\u8C61</li><li><code>match_all</code>\uFF1A\u4EE3\u8868\u67E5\u8BE2\u6240\u6709</li></ul><h3 id="_2-2-2-\u6761\u4EF6\u5339\u914D-match" tabindex="-1"><a class="header-anchor" href="#_2-2-2-\u6761\u4EF6\u5339\u914D-match" aria-hidden="true">#</a> 2.2.2 \u6761\u4EF6\u5339\u914D\uFF08match \uFF09</h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u51FA\u5F88\u591A\u6570\u636E\uFF0C\u4E0D\u4EC5\u5305\u62EC<code>\u5C0F\u7C73\u624B\u673A</code>\uFF0C\u800C\u4E14\u4E0E<code>\u5C0F\u7C73</code>\u6216\u8005<code>\u624B\u673A</code>\u76F8\u5173\u7684\u90FD\u4F1A\u67E5\u8BE2\u5230\uFF0C\u8BF4\u660E\u591A\u4E2A\u8BCD\u4E4B\u95F4\u662F<code>or</code>\u7684\u5173\u7CFB\u3002</p><p>\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u9700\u8981\u66F4\u7CBE\u786E\u67E5\u627E\uFF0C\u6211\u4EEC\u5E0C\u671B\u8FD9\u4E2A\u5173\u7CFB\u53D8\u6210<code>and</code>\uFF0C\u53EF\u4EE5\u8FD9\u6837\u505A\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;and&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.7037868</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.7037868</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">1999</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-3-\u77ED\u8BED\u5339\u914D-match-phrase" tabindex="-1"><a class="header-anchor" href="#_2-2-3-\u77ED\u8BED\u5339\u914D-match-phrase" aria-hidden="true">#</a> 2.2.3 \u77ED\u8BED\u5339\u914D \uFF08match phrase\uFF09 <a name="\u77ED\u8BED\u5339\u914D"></a></h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
## \u53EA\u4F1A\u5305\u542B address=mill lane \u8BB0\u5F55
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-4-\u5B50\u5C5E\u6027\u5339\u914D-\u5B57\u6BB5-xx" tabindex="-1"><a class="header-anchor" href="#_2-2-4-\u5B50\u5C5E\u6027\u5339\u914D-\u5B57\u6BB5-xx" aria-hidden="true">#</a> 2.2.4 \u5B50\u5C5E\u6027\u5339\u914D\uFF08\u5B57\u6BB5.xx\uFF09 <a name="\u5B50\u5C5E\u6027\u5339\u914D"></a></h3><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;attr.brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-5-\u591A\u5B57\u6BB5\u5339\u914D-multi-match" tabindex="-1"><a class="header-anchor" href="#_2-2-5-\u591A\u5B57\u6BB5\u5339\u914D-multi-match" aria-hidden="true">#</a> 2.2.5 \u591A\u5B57\u6BB5\u5339\u914D\uFF08multi_match\uFF09 <a name="\u591A\u5B57\u6BB5\u5339\u914D"></a></h3><p><code>match</code>\u53EA\u80FD\u6839\u636E\u4E00\u4E2A\u5B57\u6BB5\u5339\u914D\u67E5\u8BE2\uFF0C\u5982\u679C\u8981\u6839\u636E\u591A\u4E2A\u5B57\u6BB5\u5339\u914D\u67E5\u8BE2\u53EF\u4EE5\u4F7F\u7528<code>multi_match</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attr.brand.keyword&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# fields\u503C\u5339\u914D\u5230query
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-3-\u8BCD\u6761\u67E5\u8BE2-\u7CBE\u786E\u503C\u5339\u914D-term" tabindex="-1"><a class="header-anchor" href="#_2-3-\u8BCD\u6761\u67E5\u8BE2-\u7CBE\u786E\u503C\u5339\u914D-term" aria-hidden="true">#</a> 2.3. \u8BCD\u6761\u67E5\u8BE2\uFF0C\u7CBE\u786E\u503C\u5339\u914D\uFF08term\uFF09</h2><p><code>term</code> \u67E5\u8BE2\u88AB\u7528\u4E8E\u7CBE\u786E\u503C \u5339\u914D\uFF0C\u8FD9\u4E9B\u7CBE\u786E\u503C\u53EF\u80FD\u662F\u6570\u5B57\u3001\u65F6\u95F4\u3001\u5E03\u5C14\u6216\u8005\u90A3\u4E9B<strong>\u672A\u5206\u8BCD</strong>\u7684\u5B57\u7B26\u4E32\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">4999</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# \u5BF9\u975E\u6587\u672C\u6570\u636E\u68C0\u7D22\u7528trem\uFF0C\u5BF9\u6587\u672C|\u5168\u6587\u68C0\u7D22\u5C31\u7528match
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token string">&quot;28&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span> ########\u4F1A\u53D6\u4E0D\u5230\u6570\u636E
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;990 mill&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address.keyword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;990 mill&quot;</span> # \u7CBE\u786E\u5339\u914D
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;990 mill&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-4-\u8303\u56F4\u67E5\u8BE2-range" tabindex="-1"><a class="header-anchor" href="#_2-4-\u8303\u56F4\u67E5\u8BE2-range" aria-hidden="true">#</a> 2.4. \u8303\u56F4\u67E5\u8BE2\uFF08range\uFF09</h2><p><code>range</code> \u67E5\u8BE2\u627E\u51FA\u90A3\u4E9B\u843D\u5728\u6307\u5B9A\u533A\u95F4\u5185\u7684\u6570\u5B57\u6216\u8005\u65F6\u95F4</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span>  <span class="token number">1000</span><span class="token punctuation">,</span>
                <span class="token property">&quot;lt&quot;</span><span class="token operator">:</span>   <span class="token number">3000</span>
            <span class="token punctuation">}</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="range\u67E5\u8BE2\u5141\u8BB8\u4EE5\u4E0B\u5B57\u7B26-gt\u3001gte\u3001lt\u3001lte" tabindex="-1"><a class="header-anchor" href="#range\u67E5\u8BE2\u5141\u8BB8\u4EE5\u4E0B\u5B57\u7B26-gt\u3001gte\u3001lt\u3001lte" aria-hidden="true">#</a> range\u67E5\u8BE2\u5141\u8BB8\u4EE5\u4E0B\u5B57\u7B26\uFF1Agt\u3001gte\u3001lt\u3001lte</h3><table><thead><tr><th style="text-align:center;">\u64CD\u4F5C\u7B26</th><th style="text-align:center;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">gt</td><td style="text-align:center;">\u5927\u4E8E</td></tr><tr><td style="text-align:center;">gte</td><td style="text-align:center;">\u5927\u4E8E\u7B49\u4E8E</td></tr><tr><td style="text-align:center;">lt</td><td style="text-align:center;">\u5C0F\u4E8E</td></tr><tr><td style="text-align:center;">lte</td><td style="text-align:center;">\u5C0F\u4E8E\u7B49\u4E8E</td></tr></tbody></table><h2 id="_2-5-\u5E03\u5C14\u7EC4\u5408-bool" tabindex="-1"><a class="header-anchor" href="#_2-5-\u5E03\u5C14\u7EC4\u5408-bool" aria-hidden="true">#</a> 2.5. \u5E03\u5C14\u7EC4\u5408\uFF08bool)</h2><p>\u5E03\u5C14\u67E5\u8BE2\u53C8\u53EB**\u7EC4\u5408\u67E5\u8BE2\u3001\u590D\u5408\u67E5\u8BE2 **</p><p><code>bool</code>\u628A\u5404\u79CD\u5176\u5B83\u67E5\u8BE2\u901A\u8FC7<code>must</code>\uFF08\u4E0E\uFF09\u3001<code>must_not</code>\uFF08\u975E\uFF09\u3001<code>should</code>\uFF08\u6216\uFF09\u7684\u65B9\u5F0F\u8FDB\u884C\u7EC4\u5408</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        	  <span class="token punctuation">{</span>
        	    <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	        <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        	        <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">3000</span>
        	      <span class="token punctuation">}</span>
        	    <span class="token punctuation">}</span>
        	  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        	  <span class="token punctuation">{</span>
        	    <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	        <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
        	        <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">4000</span>
        	      <span class="token punctuation">}</span>
        	    <span class="token punctuation">}</span>
        	  <span class="token punctuation">}</span>
        	<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> #\u5FC5\u987B\u662F\u4EC0\u4E48
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;F&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# \u67E5\u8BE2gender=F\u5E76\u4E14address=Mill
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> #\u5FC5\u987B\u662F\u4EC0\u4E48
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;must_not&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> #\u5FC5\u987B\u4E0D\u662F\u4EC0\u4E48
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">38</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
	  <span class="token property">&quot;should&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> #\u5E94\u8BE5\uFF0C\u80FD\u5339\u914D\u5230\u6700\u597D\uFF0C\u6CA1\u5339\u914D\u5230\u4E5F\u4E0D\u4F24\u5927\u96C5\uFF0C\u6EE1\u8DB3\u7684\u8BDDmax_score\u4F1A\u66F4\u9AD8
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;lastname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Wallace&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# \u67E5\u8BE2gender=F &amp; address=Mill &amp; age!=<span class="token number">38</span> \uFF0Clastname\u80FD\u5339\u914D\u5230\u6700\u597D\uFF0C\u6CA1\u5339\u914D\u5230\u4E5F\u4E0D\u4F24\u5927\u96C5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1A\u4E00\u4E2A\u7EC4\u5408\u67E5\u8BE2\u91CC\u9762\u53EA\u80FD\u51FA\u73B0\u4E00\u79CD\u7EC4\u5408\uFF0C\u4E0D\u80FD\u6DF7\u7528</p><h2 id="_2-6-\u8FC7\u6EE4-filter" tabindex="-1"><a class="header-anchor" href="#_2-6-\u8FC7\u6EE4-filter" aria-hidden="true">#</a> 2.6. \u8FC7\u6EE4\uFF08filter\uFF09</h2><p>\u6240\u6709\u7684\u67E5\u8BE2\u90FD\u4F1A\u5F71\u54CD\u5230\u6587\u6863\u7684\u8BC4\u5206\u53CA\u6392\u540D\u3002\u5982\u679C\u6211\u4EEC\u9700\u8981\u5728\u67E5\u8BE2\u7ED3\u679C\u4E2D\u8FDB\u884C\u8FC7\u6EE4\uFF0C\u5E76\u4E14\u4E0D\u5E0C\u671B\u8FC7\u6EE4\u6761\u4EF6\u5F71\u54CD\u8BC4\u5206\uFF0C\u90A3\u4E48\u5C31\u4E0D\u8981\u628A\u8FC7\u6EE4\u6761\u4EF6\u4F5C\u4E3A\u67E5\u8BE2\u6761\u4EF6\u6765\u7528\u3002\u800C\u662F\u4F7F\u7528<code>filter</code>\u65B9\u5F0F\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;gt&quot;</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token property">&quot;lt&quot;</span><span class="token operator">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# filter\u4E0D\u4F1A\u8BA1\u7B97\u76F8\u5173\u6027\u5F97\u5206_score\uFF0Cmust\u53CD\u4E4B
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
              <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">30</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
--------------
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
              <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">30</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# filter \u6700\u597D\u662F\u653E\u5728\u6700\u540E\u8FC7\u6EE4\uFF0C\u8FD9\u6837\u4E0D\u4F1A\u5F71\u54CD\u67E5\u8BE2\u6761\u4EF6\u548C\u76F8\u5173\u6027\u5F97\u5206
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;must_not&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">18</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;lastname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Holland&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
              <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">30</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1Afilter \u6700\u597D\u662F\u653E\u5728\u6700\u540E\u8FC7\u6EE4\uFF0C\u8FD9\u6837\u4E0D\u4F1A\u5F71\u54CD\u67E5\u8BE2\u6761\u4EF6\u548C\u76F8\u5173\u6027\u5F97\u5206\u3002<code>filter</code>\u4E2D\u8FD8\u53EF\u4EE5\u518D\u6B21\u8FDB\u884C<code>bool</code>\u7EC4\u5408\u6761\u4EF6\u8FC7\u6EE4\u3002</p><p><img src="`+B+'" alt="image-20210908173825031"></p><p><img src="'+I+`" alt="image-20210908173957845"></p><h2 id="_2-7-\u6392\u5E8F-sort" tabindex="-1"><a class="header-anchor" href="#_2-7-\u6392\u5E8F-sort" aria-hidden="true">#</a> 2.7. \u6392\u5E8F\uFF08sort\uFF09</h2><p><code>sort</code> \u53EF\u4EE5\u8BA9\u6211\u4EEC\u6309\u7167\u4E0D\u540C\u7684\u5B57\u6BB5\u8FDB\u884C\u6392\u5E8F\uFF0C\u5E76\u4E14\u901A\u8FC7<code>order</code>\u6307\u5B9A\u6392\u5E8F\u7684\u65B9\u5F0F</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-8-\u5206\u9875-from-size" tabindex="-1"><a class="header-anchor" href="#_2-8-\u5206\u9875-from-size" aria-hidden="true">#</a> 2.8. \u5206\u9875\uFF08from/size\uFF09</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>from\uFF1A\u4ECE\u90A3\u4E00\u6761\u5F00\u59CB</p><p>size\uFF1A\u53D6\u591A\u5C11\u6761</p><h2 id="_2-9-\u9AD8\u4EAE-highlight" tabindex="-1"><a class="header-anchor" href="#_2-9-\u9AD8\u4EAE-highlight" aria-hidden="true">#</a> 2.9. \u9AD8\u4EAE\uFF08highlight\uFF09</h2><p>\u53D1\u73B0\uFF1A\u9AD8\u4EAE\u7684\u672C\u8D28\u662F\u7ED9\u5173\u952E\u5B57\u6DFB\u52A0\u4E86&lt;em&gt;\u6807\u7B7E\uFF0C\u5728\u524D\u7AEF\u518D\u7ED9\u8BE5\u6807\u7B7E\u6DFB\u52A0\u6837\u5F0F\u5373\u53EF\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /atguigu/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;title&quot;: &quot;\u5C0F\u7C73&quot;
    }
  },
  &quot;highlight&quot;: {
    &quot;fields&quot;: {&quot;title&quot;: {}}, 
    &quot;pre_tags&quot;: &quot;&lt;em&gt;&quot;,
    &quot;post_tags&quot;: &quot;&lt;/em&gt;&quot;
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>fields\uFF1A\u9AD8\u4EAE\u5B57\u6BB5</p><p>pre_tags\uFF1A\u524D\u7F6E\u6807\u7B7E</p><p>post_tags\uFF1A\u540E\u7F6E\u6807\u7B7E</p><p>\u67E5\u8BE2\u7ED3\u679C\u5982\u4E0B\uFF1A</p><h2 id="_2-10-\u7ED3\u679C\u8FC7\u6EE4-source" tabindex="-1"><a class="header-anchor" href="#_2-10-\u7ED3\u679C\u8FC7\u6EE4-source" aria-hidden="true">#</a> 2.10. \u7ED3\u679C\u8FC7\u6EE4\uFF08_source\uFF09</h2><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Celasticsearch\u5728\u641C\u7D22\u7684\u7ED3\u679C\u4E2D\uFF0C\u4F1A\u628A\u6587\u6863\u4E2D\u4FDD\u5B58\u5728<code>_source</code>\u7684\u6240\u6709\u5B57\u6BB5\u90FD\u8FD4\u56DE\u3002</p><p>\u5982\u679C\u6211\u4EEC\u53EA\u60F3\u83B7\u53D6\u5176\u4E2D\u7684\u90E8\u5206\u5B57\u6BB5\uFF0C\u53EF\u4EE5\u6DFB\u52A0<code>_source</code>\u7684\u8FC7\u6EE4</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">2699</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF0C\u53EA\u6709\u4E24\u4E2A\u5B57\u6BB5\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 9,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 2,
    &quot;successful&quot; : 2,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : 1,
    &quot;max_score&quot; : 1.0,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;atguigu&quot;,
        &quot;_type&quot; : &quot;goods&quot;,
        &quot;_id&quot; : &quot;9&quot;,
        &quot;_score&quot; : 1.0,
        &quot;_source&quot; : {
          &quot;price&quot; : 2699,
          &quot;title&quot; : &quot;vivo\u624B\u673A&quot;
        }
      }
    ]
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="_3-\u805A\u5408-aggregations" tabindex="-1"><a class="header-anchor" href="#_3-\u805A\u5408-aggregations" aria-hidden="true">#</a> 3. \u805A\u5408\uFF08aggregations\uFF09</h1><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#\u641C\u7D22address\u4E2D\u5305\u542Bmill\u7684\u6240\u6709\u4EBA\u7684\u5E74\u9F84\u5206\u5E03\u4EE5\u53CA\u5E73\u5747\u5E74\u9F84\uFF0C\u4F46\u4E0D\u663E\u793A\u8FD9\u4E9B\u4EBA\u7684\u8BE6\u60C5
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

#\u6309 \u7167 \u5E74 \u9F84 \u805A\u5408 \uFF0C \u5E76 \u4E14 \u8BF7 \u6C42 \u8FD9 \u4E9B \u5E74 \u9F84 \u6BB5 \u7684 \u8FD9 \u4E9B \u4EBA \u7684 \u5E73\u5747\u85AA\u8D44
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
##\u67E5\u51FA\u6240\u6709\u5E74\u9F84\u5206\u5E03\uFF0C\u5E76\u4E14\u8FD9\u4E9B\u5E74\u9686\u6BB5\u4E2DM\u7684\u5E73\u5747\u85AA\u8D44\u548CF\u7684\u5E73\u5747\u85AA\u8D44\u4EE5\u53CA\u8FD9\u4E2A\u5E74\u9F84\u6BB5\u7684\u603B\u4F53\u5E73\u5747\u85AA\u8D44
GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;genderAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u805A\u5408\u53EF\u4EE5\u8BA9\u6211\u4EEC\u6781\u5176\u65B9\u4FBF\u7684\u5B9E\u73B0\u5BF9\u6570\u636E\u7684\u7EDF\u8BA1\u3001\u5206\u6790\u3002\u4F8B\u5982\uFF1A</p><ul><li>\u4EC0\u4E48\u54C1\u724C\u7684\u624B\u673A\u6700\u53D7\u6B22\u8FCE\uFF1F</li><li>\u8FD9\u4E9B\u624B\u673A\u7684\u5E73\u5747\u4EF7\u683C\u3001\u6700\u9AD8\u4EF7\u683C\u3001\u6700\u4F4E\u4EF7\u683C\uFF1F</li><li>\u8FD9\u4E9B\u624B\u673A\u6BCF\u6708\u7684\u9500\u552E\u60C5\u51B5\u5982\u4F55\uFF1F</li></ul><p>\u5B9E\u73B0\u8FD9\u4E9B\u7EDF\u8BA1\u529F\u80FD\u7684\u6BD4\u6570\u636E\u5E93\u7684sql\u8981\u65B9\u4FBF\u7684\u591A\uFF0C\u800C\u4E14\u67E5\u8BE2\u901F\u5EA6\u975E\u5E38\u5FEB\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u5B9E\u65F6\u641C\u7D22\u6548\u679C\u3002</p><h2 id="_3-1-\u57FA\u672C\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#_3-1-\u57FA\u672C\u6982\u5FF5" aria-hidden="true">#</a> 3.1 \u57FA\u672C\u6982\u5FF5</h2><p>Elasticsearch\u4E2D\u7684\u805A\u5408\uFF0C\u5305\u542B\u591A\u79CD\u7C7B\u578B\uFF0C\u6700\u5E38\u7528\u7684\u4E24\u79CD\uFF0C\u4E00\u4E2A\u53EB<code>\u6876</code>\uFF0C\u4E00\u4E2A\u53EB<code>\u5EA6\u91CF</code>\uFF1A</p><blockquote><p><strong>\u6876\uFF08bucket\uFF09</strong></p></blockquote><p>\u6876\u7684\u4F5C\u7528\uFF0C\u662F\u6309\u7167\u67D0\u79CD\u65B9\u5F0F\u5BF9\u6570\u636E\u8FDB\u884C\u5206\u7EC4\uFF0C\u6BCF\u4E00\u7EC4\u6570\u636E\u5728ES\u4E2D\u79F0\u4E3A\u4E00\u4E2A<code>\u6876</code>\uFF0C\u4F8B\u5982\u6211\u4EEC\u6839\u636E\u56FD\u7C4D\u5BF9\u4EBA\u5212\u5206\uFF0C\u53EF\u4EE5\u5F97\u5230<code>\u4E2D\u56FD\u6876</code>\u3001<code>\u82F1\u56FD\u6876</code>\uFF0C<code>\u65E5\u672C\u6876</code>\u2026\u2026\u6216\u8005\u6211\u4EEC\u6309\u7167\u5E74\u9F84\u6BB5\u5BF9\u4EBA\u8FDB\u884C\u5212\u5206\uFF1A0~10,10~20,20~30,30~40\u7B49\u3002</p><p>Elasticsearch\u4E2D\u63D0\u4F9B\u7684\u5212\u5206\u6876\u7684\u65B9\u5F0F\u6709\u5F88\u591A\uFF1A</p><ul><li>Date Histogram Aggregation\uFF1A\u6839\u636E\u65E5\u671F\u9636\u68AF\u5206\u7EC4\uFF0C\u4F8B\u5982\u7ED9\u5B9A\u9636\u68AF\u4E3A\u5468\uFF0C\u4F1A\u81EA\u52A8\u6BCF\u5468\u5206\u4E3A\u4E00\u7EC4</li><li>Histogram Aggregation\uFF1A\u6839\u636E\u6570\u503C\u9636\u68AF\u5206\u7EC4\uFF0C\u4E0E\u65E5\u671F\u7C7B\u4F3C</li><li>Terms Aggregation\uFF1A\u6839\u636E\u8BCD\u6761\u5185\u5BB9\u5206\u7EC4\uFF0C\u8BCD\u6761\u5185\u5BB9\u5B8C\u5168\u5339\u914D\u7684\u4E3A\u4E00\u7EC4</li><li>Range Aggregation\uFF1A\u6570\u503C\u548C\u65E5\u671F\u7684\u8303\u56F4\u5206\u7EC4\uFF0C\u6307\u5B9A\u5F00\u59CB\u548C\u7ED3\u675F\uFF0C\u7136\u540E\u6309\u6BB5\u5206\u7EC4</li><li>\u2026\u2026</li></ul><p>bucket aggregations \u53EA\u8D1F\u8D23\u5BF9\u6570\u636E\u8FDB\u884C\u5206\u7EC4\uFF0C\u5E76\u4E0D\u8FDB\u884C\u8BA1\u7B97\uFF0C\u56E0\u6B64\u5F80\u5F80bucket\u4E2D\u5F80\u5F80\u4F1A\u5D4C\u5957\u53E6\u4E00\u79CD\u805A\u5408\uFF1Ametrics aggregations\u5373\u5EA6\u91CF</p><blockquote><p><strong>\u5EA6\u91CF\uFF08metrics\uFF09</strong></p></blockquote><p>\u5206\u7EC4\u5B8C\u6210\u4EE5\u540E\uFF0C\u6211\u4EEC\u4E00\u822C\u4F1A\u5BF9\u7EC4\u4E2D\u7684\u6570\u636E\u8FDB\u884C\u805A\u5408\u8FD0\u7B97\uFF0C\u4F8B\u5982\u6C42\u5E73\u5747\u503C\u3001\u6700\u5927\u3001\u6700\u5C0F\u3001\u6C42\u548C\u7B49\uFF0C\u8FD9\u4E9B\u5728ES\u4E2D\u79F0\u4E3A<code>\u5EA6\u91CF</code></p><p>\u6BD4\u8F83\u5E38\u7528\u7684\u4E00\u4E9B\u5EA6\u91CF\u805A\u5408\u65B9\u5F0F\uFF1A</p><ul><li>Avg Aggregation\uFF1A\u6C42\u5E73\u5747\u503C</li><li>Max Aggregation\uFF1A\u6C42\u6700\u5927\u503C</li><li>Min Aggregation\uFF1A\u6C42\u6700\u5C0F\u503C</li><li>Percentiles Aggregation\uFF1A\u6C42\u767E\u5206\u6BD4</li><li>Stats Aggregation\uFF1A\u540C\u65F6\u8FD4\u56DEavg\u3001max\u3001min\u3001sum\u3001count\u7B49</li><li>Sum Aggregation\uFF1A\u6C42\u548C</li><li>Top hits Aggregation\uFF1A\u6C42\u524D\u51E0</li><li>Value Count Aggregation\uFF1A\u6C42\u603B\u6570</li><li>\u2026\u2026</li></ul><h2 id="_3-2-\u805A\u5408\u4E3A\u6876" tabindex="-1"><a class="header-anchor" href="#_3-2-\u805A\u5408\u4E3A\u6876" aria-hidden="true">#</a> 3.2 \u805A\u5408\u4E3A\u6876</h2><p>\u9996\u5148\uFF0C\u6211\u4EEC\u6309\u7167\u624B\u673A\u7684\u54C1\u724C<code>attr.brand.keyword</code>\u6765\u5212\u5206<code>\u6876</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>size\uFF1A \u67E5\u8BE2\u6761\u6570\uFF0C\u8FD9\u91CC\u8BBE\u7F6E\u4E3A0\uFF0C\u56E0\u4E3A\u6211\u4EEC\u4E0D\u5173\u5FC3\u641C\u7D22\u5230\u7684\u6570\u636E\uFF0C\u53EA\u5173\u5FC3\u805A\u5408\u7ED3\u679C\uFF0C\u63D0\u9AD8\u6548\u7387</li><li>aggs\uFF1A\u58F0\u660E\u8FD9\u662F\u4E00\u4E2A\u805A\u5408\u67E5\u8BE2\uFF0C\u662Faggregations\u7684\u7F29\u5199 <ul><li>brands\uFF1A\u7ED9\u8FD9\u6B21\u805A\u5408\u8D77\u4E00\u4E2A\u540D\u5B57\uFF0C\u4EFB\u610F\u3002 <ul><li>terms\uFF1A\u5212\u5206\u6876\u7684\u65B9\u5F0F\uFF0C\u8FD9\u91CC\u662F\u6839\u636E\u8BCD\u6761\u5212\u5206 <ul><li>field\uFF1A\u5212\u5206\u6876\u7684\u5B57\u6BB5</li></ul></li></ul></li></ul></li></ul><p>\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">124</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>hits\uFF1A\u67E5\u8BE2\u7ED3\u679C\u4E3A\u7A7A\uFF0C\u56E0\u4E3A\u6211\u4EEC\u8BBE\u7F6E\u4E86size\u4E3A0</li><li>aggregations\uFF1A\u805A\u5408\u7684\u7ED3\u679C</li><li>brands\uFF1A\u6211\u4EEC\u5B9A\u4E49\u7684\u805A\u5408\u540D\u79F0</li><li>buckets\uFF1A\u67E5\u627E\u5230\u7684\u6876\uFF0C\u6BCF\u4E2A\u4E0D\u540C\u7684\u54C1\u724C\u5B57\u6BB5\u503C\u90FD\u4F1A\u5F62\u6210\u4E00\u4E2A\u6876 <ul><li>key\uFF1A\u8FD9\u4E2A\u6876\u5BF9\u5E94\u7684\u54C1\u724C\u5B57\u6BB5\u7684\u503C</li><li>doc_count\uFF1A\u8FD9\u4E2A\u6876\u4E2D\u7684\u6587\u6863\u6570\u91CF</li></ul></li></ul><h2 id="_3-3-\u6876\u5185\u5EA6\u91CF" tabindex="-1"><a class="header-anchor" href="#_3-3-\u6876\u5185\u5EA6\u91CF" aria-hidden="true">#</a> 3.3 \u6876\u5185\u5EA6\u91CF</h2><p>\u524D\u9762\u7684\u4F8B\u5B50\u544A\u8BC9\u6211\u4EEC\u6BCF\u4E2A\u6876\u91CC\u9762\u7684\u6587\u6863\u6570\u91CF\uFF0C\u8FD9\u5F88\u6709\u7528\u3002 \u4F46\u901A\u5E38\uFF0C\u6211\u4EEC\u7684\u5E94\u7528\u9700\u8981\u63D0\u4F9B\u66F4\u590D\u6742\u7684\u6587\u6863\u5EA6\u91CF\u3002 \u4F8B\u5982\uFF0C\u6BCF\u79CD\u54C1\u724C\u624B\u673A\u7684\u5E73\u5747\u4EF7\u683C\u662F\u591A\u5C11\uFF1F</p><p>\u56E0\u6B64\uFF0C\u6211\u4EEC\u9700\u8981\u544A\u8BC9Elasticsearch<code>\u4F7F\u7528\u54EA\u4E2A\u5B57\u6BB5</code>\uFF0C<code>\u4F7F\u7528\u4F55\u79CD\u5EA6\u91CF\u65B9\u5F0F</code>\u8FDB\u884C\u8FD0\u7B97\uFF0C\u8FD9\u4E9B\u4FE1\u606F\u8981\u5D4C\u5957\u5728<code>\u6876</code>\u5185\uFF0C<code>\u5EA6\u91CF</code>\u7684\u8FD0\u7B97\u4F1A\u57FA\u4E8E<code>\u6876</code>\u5185\u7684\u6587\u6863\u8FDB\u884C</p><p>\u73B0\u5728\uFF0C\u6211\u4EEC\u4E3A\u521A\u521A\u7684\u805A\u5408\u7ED3\u679C\u6DFB\u52A0 \u6C42\u4EF7\u683C\u5E73\u5747\u503C\u7684\u5EA6\u91CF\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;avg_price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
                   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;price&quot;</span> 
                   <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>aggs\uFF1A\u6211\u4EEC\u5728\u4E0A\u4E00\u4E2Aaggs(brands)\u4E2D\u6DFB\u52A0\u65B0\u7684aggs\u3002\u53EF\u89C1<code>\u5EA6\u91CF</code>\u4E5F\u662F\u4E00\u4E2A\u805A\u5408</li><li>avg_price\uFF1A\u805A\u5408\u7684\u540D\u79F0</li><li>avg\uFF1A\u5EA6\u91CF\u7684\u7C7B\u578B\uFF0C\u8FD9\u91CC\u662F\u6C42\u5E73\u5747\u503C</li><li>field\uFF1A\u5EA6\u91CF\u8FD0\u7B97\u7684\u5B57\u6BB5</li></ul><p>\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">41</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3999.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3499.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2799.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2699.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u6BCF\u4E2A\u6876\u4E2D\u90FD\u6709\u81EA\u5DF1\u7684<code>avg_price</code>\u5B57\u6BB5\uFF0C\u8FD9\u662F\u5EA6\u91CF\u805A\u5408\u7684\u7ED3\u679C</p><h2 id="_3-4-\u6876\u5185\u5D4C\u5957\u6876" tabindex="-1"><a class="header-anchor" href="#_3-4-\u6876\u5185\u5D4C\u5957\u6876" aria-hidden="true">#</a> 3.4 \u6876\u5185\u5D4C\u5957\u6876</h2><p>\u521A\u521A\u7684\u6848\u4F8B\u4E2D\uFF0C\u6211\u4EEC\u5728\u6876\u5185\u5D4C\u5957\u5EA6\u91CF\u8FD0\u7B97\u3002\u4E8B\u5B9E\u4E0A\u6876\u4E0D\u4EC5\u53EF\u4EE5\u5D4C\u5957\u8FD0\u7B97\uFF0C \u8FD8\u53EF\u4EE5\u518D\u5D4C\u5957\u5176\u5B83\u6876\u3002\u4E5F\u5C31\u662F\u8BF4\u5728\u6BCF\u4E2A\u5206\u7EC4\u4E2D\uFF0C\u518D\u5206\u66F4\u591A\u7EC4\u3002</p><p>\u6BD4\u5982\uFF1A\u6211\u4EEC\u60F3\u7EDF\u8BA1\u6BCF\u4E2A\u54C1\u724C\u90FD\u751F\u4EA7\u4E86\u90A3\u4E9B\u4EA7\u54C1\uFF0C\u6309\u7167<code>attr.category.keyword</code>\u5B57\u6BB5\u518D\u8FDB\u884C\u5206\u6876</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /atguigu/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;avg_price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
                   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;price&quot;</span> 
                   <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;categorys&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;attr.category.keyword&quot;</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u90E8\u5206\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">3</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3999.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u7535\u89C6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u7B14\u8BB0\u672C&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3499.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2799.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2699.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\uFF0C\u65B0\u7684\u805A\u5408<code>categorys</code>\u88AB\u5D4C\u5957\u5728\u539F\u6765\u6BCF\u4E00\u4E2A<code>brands</code>\u7684\u6876\u4E2D\u3002</li><li>\u6BCF\u4E2A\u54C1\u724C\u4E0B\u9762\u90FD\u6839\u636E <code>attr.category.keyword</code>\u5B57\u6BB5\u8FDB\u884C\u4E86\u5206\u7EC4</li><li>\u6211\u4EEC\u80FD\u8BFB\u53D6\u5230\u7684\u4FE1\u606F\uFF1A <ul><li>\u534E\u4E3A\u67094\u4E2D\u4EA7\u54C1</li><li>\u534E\u4E3A\u4EA7\u54C1\u7684\u5E73\u5747\u552E\u4EF7\u662F 3999.0\u7F8E\u5143\u3002</li><li>\u5176\u4E2D3\u79CD\u624B\u673A\u4EA7\u54C1\uFF0C1\u79CD\u7B14\u8BB0\u672C\u4EA7\u54C1</li></ul></li></ul><h1 id="_4-springdata-elasticsearch" tabindex="-1"><a class="header-anchor" href="#_4-springdata-elasticsearch" aria-hidden="true">#</a> 4. SpringData-Elasticsearch</h1><p>\u76EE\u524D\u5E02\u9762\u4E0A\u6709\u4E24\u7C7B\u5BA2\u6237\u7AEF</p><p>\u4E00\u7C7B\u662FTransportClient \u4E3A\u4EE3\u8868\u7684ES\u539F\u751F\u5BA2\u6237\u7AEF\uFF0C\u4E0D\u80FD\u6267\u884C\u539F\u751Fdsl\u8BED\u53E5\u5FC5\u987B\u4F7F\u7528\u5B83\u7684Java api\u65B9\u6CD5\u3002</p><p>\u53E6\u5916\u4E00\u79CD\u662F\u4EE5Rest Api\u4E3A\u4E3B\u7684missing client\uFF0C\u6700\u5178\u578B\u7684\u5C31\u662Fjest\u3002 \u8FD9\u79CD\u5BA2\u6237\u7AEF\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528dsl\u8BED\u53E5\u62FC\u6210\u7684\u5B57\u7B26\u4E32\uFF0C\u76F4\u63A5\u4F20\u7ED9\u670D\u52A1\u7AEF\uFF0C\u7136\u540E\u8FD4\u56DEjson\u5B57\u7B26\u4E32\u518D\u89E3\u6790\u3002</p><p>\u4E24\u79CD\u65B9\u5F0F\u5404\u6709\u4F18\u52A3\uFF0C\u4F46\u662F\u6700\u8FD1elasticsearch\u5B98\u7F51\uFF0C\u5BA3\u5E03\u8BA1\u5212\u57287.0\u4EE5\u540E\u7684\u7248\u672C\u4E2D\u5E9F\u9664TransportClient\u3002\u4EE5RestClient\u4E3A\u4E3B\u3002</p><p>\u7531\u4E8E\u539F\u751F\u7684Elasticsearch\u5BA2\u6237\u7AEFAPI\u975E\u5E38\u9EBB\u70E6\u3002\u6240\u4EE5\u8FD9\u91CC\u76F4\u63A5\u5B66\u4E60Spring\u63D0\u4F9B\u7684\u5957\u4EF6\uFF1ASpring Data Elasticsearch\u3002</p><p><strong>spring-data-Elasticsearch \u4F7F\u7528\u4E4B\u524D,\u5FC5\u987B\u5148\u786E\u5B9A\u7248\u672C,elasticsearch \u5BF9\u7248\u672C\u7684\u8981\u6C42\u6BD4\u8F83\u9AD8\u3002</strong></p><p>java-API\u9009\u62E9\uFF1Ahttps://www.elastic.co/guide/en/elasticsearch/client/index.html</p>`,124),O=n("\u9009\u62E9\uFF1AJava REST Client "),U={href:"https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html",target:"_blank",rel:"noopener noreferrer"},C=n("7.14]"),D=n("\u2009=> JavaHighLevelRESTClient "),L={href:"https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html",target:"_blank",rel:"noopener noreferrer"},H=n("\u6587\u6863"),M=t(`<p>\u521B\u5EFA\u5355\u72EC\u9879\u76EEyumall-search</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>7.14.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span> 		
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.14.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>transport<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>6.8.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>transport<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>6.8.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u52A0\u5165nacos\u3001common\u3001@EnableDiscoveryClient</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#\u5F00\u542F\u670D\u52A1\u53D1\u73B0</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ban\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#ban\u6D4B\u8BD5" aria-hidden="true">#</a> -- ban\u6D4B\u8BD5</h2><p>\u521B\u5EFA\u914D\u7F6E\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>builder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.101.5&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getClientBan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//null</span>
<span class="token punctuation">}</span>
<span class="token comment">///\u6D4B\u8BD5\u7C7B\u52A0\u4E0A\u6CE8\u89E3\uFF0C\u5728\u8FD0\u884C\uFF1Aorg.elasticsearch.client.RestHighLevelClient@6f6f65a4</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6D4B\u8BD5\u4FDD\u5B58" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u4FDD\u5B58" aria-hidden="true">#</a> -- \u6D4B\u8BD5\u4FDD\u5B58</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">indexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">IndexRequest</span> indexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        indexRequest<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        indexRequest.source(&quot;name&quot;,&quot;xiaoyu&quot;,&quot;age&quot;,&quot;19&quot;);</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;\u5C0F\u534E&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> jsonString <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        indexRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u8981\u4FDD\u5B58\u7684\u6570\u636Ejson</span>
        <span class="token comment">//\u5F00\u59CB\u4FDD\u5B58</span>
        <span class="token class-name">IndexResponse</span> indexResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexRequest<span class="token punctuation">,</span> <span class="token class-name">ElasticSearchConfig</span><span class="token punctuation">.</span>COMMON_OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;indexResponse = &quot;</span> <span class="token operator">+</span> indexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6D4B\u8BD5\u68C0\u7D22" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u68C0\u7D22" aria-hidden="true">#</a> -- \u6D4B\u8BD5\u68C0\u7D22</h2><h3 id="\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u7ED3\u6784" aria-hidden="true">#</a> --- \u7ED3\u6784\uFF1A</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>//1\u3001\u521B\u5EFA\u68C0\u7D22\u8BF7\u6C42 SearchRequest <span class="token operator">&gt;</span> sourceBuilder<span class="token punctuation">[</span>\u6DFB\u52A0\u805A\u5408\uFF1F<span class="token punctuation">]</span> <span class="token operator">&gt;</span> searchRequest.source<span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
//2\u3001\u6267\u884C\u7ED3\u679C <span class="token assign-left variable">SearchResponse</span><span class="token operator">=</span>client.search<span class="token punctuation">(</span>searchRequest,\u81EA\u5B9A\u4E49OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
//3\u3001\u5206\u6790\u7ED3\u679C searchResponse:getHits\u83B7\u53D6\u6570\u636E,getAggregations\u83B7\u53D6\u805A\u5408
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u4F8B" aria-hidden="true">#</a> --- \u5B9E\u4F8B\uFF1A</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">serachData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1\u3001\u521B\u5EFA\u68C0\u7D22\u8BF7\u6C42</span>
        <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6307\u5B9A\u7D22\u5F15</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;bank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6307\u5B9ADSL\uFF0C\u68C0\u7D22\u6761\u4EF6</span>
        <span class="token comment">//SearchSourceBuilder sourceBuilde \u5C01\u88C5\u7684\u6761\u4EF6</span>
        <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1.1)\u3001\u6784\u9020\u68C0\u7D22\u6761\u4EF6</span>
        <span class="token comment">//sourceBuilder.query();</span>
        <span class="token comment">//sourceBuilder.from();</span>
        <span class="token comment">//sourceBuilder.size();</span>
        <span class="token comment">//sourceBuilder.aggregatipn()</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">//1.2)\u3001\u6309\u7167\u5E74\u9F84\u7684\u503C\u5206\u5E03\u8FDB\u884C\u805A\u5408</span>
        <span class="token class-name">TermsAggregationBuilder</span> ageAgg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">terms</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAgg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">//1.3)\u3001\u5E73\u5747\u85AA\u8D44</span>
        <span class="token class-name">AvgAggregationBuilder</span> balanceAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;balanceAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>balanceAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u68C0\u7D22\u6761\u4EF6\uFF1A&quot;</span> <span class="token operator">+</span> sourceBuilder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token comment">//\u8981\u68C0\u7D22\u5185\u5BB9</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//2\u3001\u6267\u884C\u7ED3\u679C        SearchResponse</span>
        <span class="token class-name">SearchResponse</span> searchResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">ElasticSearchConfig</span><span class="token punctuation">.</span>COMMON_OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3\u3001\u5206\u6790\u7ED3\u679C</span>
<span class="token comment">//        System.out.println(&quot;\u68C0\u7D22\u7ED3\u679C\uFF1A&quot; + searchResponse.toString());</span>
<span class="token comment">//        Map map = JSON.parseObject(searchResponse.toString(), Map.class);</span>
        <span class="token comment">//3.1)\u3001\u83B7\u53D6\u6240\u6709\u6570\u636E;</span>
        <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> searchHits <span class="token operator">=</span> hits<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> searchHits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/*
                &quot;_index&quot;:&quot;bank&quot;,
                &quot;_type&quot;:&quot;account&quot;,
                &quot;_id&quot;:&quot;970&quot;,
                &quot;_score&quot;:5.4032025,
                &quot;_source&quot;:{\u6570\u636E
             */</span>
<span class="token comment">//            hit.getIndex();hit.getType();hit.getId();</span>
            <span class="token class-name">String</span> string <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Account</span> account <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;account = &quot;</span> <span class="token operator">+</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">//3.2)\u3001\u83B7\u53D6\u8FD9\u6B21\u68C0\u7D22\u5230\u7684\u5206\u6790\u4FE1\u606F;</span>
        <span class="token class-name">Aggregations</span> aggregations <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Aggregation</span> aggregation <span class="token operator">:</span> aggregations<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5F53\u524D\u805A\u5408&quot;</span> <span class="token operator">+</span> aggregation<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Terms</span> ageAgg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Terms<span class="token punctuation">.</span>Bucket</span> bucket <span class="token operator">:</span> ageAgg1<span class="token punctuation">.</span><span class="token function">getBuckets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> keyAsString <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">getKeyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5E74\u9F84: &quot;</span> <span class="token operator">+</span> keyAsString <span class="token operator">+</span> <span class="token string">&quot;==&gt;&quot;</span> <span class="token operator">+</span> bucket<span class="token punctuation">.</span><span class="token function">getDocCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+R+`" alt="image-20210909151150060"></p><h2 id="_4-1-\u521B\u5EFAmodule" tabindex="-1"><a class="header-anchor" href="#_4-1-\u521B\u5EFAmodule" aria-hidden="true">#</a> 4.1. \u521B\u5EFAmodule</h2><p>\u5728application.properties\u4E2D\u6DFB\u52A0\u914D\u7F6E</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">spring.elasticsearch.rest.uris</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
<span class="token comment"># \u96C6\u7FA4\u60C5\u51B5\u4E0B</span>
<span class="token key attr-name">spring.elasticsearch.rest.uris[0]</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
<span class="token key attr-name">spring.elasticsearch.rest.uris[1]</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-2-\u5B9E\u4F53\u7C7B" tabindex="-1"><a class="header-anchor" href="#_4-2-\u5B9E\u4F53\u7C7B" aria-hidden="true">#</a> 4.2. \u5B9E\u4F53\u7C7B</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> shards <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> replicas <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> analyzer <span class="token operator">=</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Integer</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spring Data\u901A\u8FC7\u6CE8\u89E3\u6765\u58F0\u660E\u5B57\u6BB5\u7684\u6620\u5C04\u5C5E\u6027\uFF0C\u6709\u4E0B\u9762\u7684\u4E09\u4E2A\u6CE8\u89E3\uFF1A</p><ul><li><code>@Document</code> \u4F5C\u7528\u5728\u7C7B\uFF0C\u6807\u8BB0\u5B9E\u4F53\u7C7B\u4E3A\u6587\u6863\u5BF9\u8C61\uFF0C\u4E00\u822C\u6709\u56DB\u4E2A\u5C5E\u6027 <ul><li>indexName\uFF1A\u5BF9\u5E94\u7D22\u5F15\u5E93\u540D\u79F0</li><li>type\uFF1A\u5BF9\u5E94\u5728\u7D22\u5F15\u5E93\u4E2D\u7684\u7C7B\u578B</li><li>shards\uFF1A\u5206\u7247\u6570\u91CF\uFF0C\u9ED8\u8BA45</li><li>replicas\uFF1A\u526F\u672C\u6570\u91CF\uFF0C\u9ED8\u8BA41</li></ul></li><li><code>@Id</code> \u4F5C\u7528\u5728\u6210\u5458\u53D8\u91CF\uFF0C\u6807\u8BB0\u4E00\u4E2A\u5B57\u6BB5\u4F5C\u4E3Aid\u4E3B\u952E</li><li><code>@Field</code> \u4F5C\u7528\u5728\u6210\u5458\u53D8\u91CF\uFF0C\u6807\u8BB0\u4E3A\u6587\u6863\u7684\u5B57\u6BB5\uFF0C\u5E76\u6307\u5B9A\u5B57\u6BB5\u6620\u5C04\u5C5E\u6027\uFF1A <ul><li>type\uFF1A\u5B57\u6BB5\u7C7B\u578B\uFF0C\u53D6\u503C\u662F\u679A\u4E3E\uFF1AFieldType</li><li>index\uFF1A\u662F\u5426\u7D22\u5F15\uFF0C\u5E03\u5C14\u7C7B\u578B\uFF0C\u9ED8\u8BA4\u662Ftrue</li><li>store\uFF1A\u662F\u5426\u5B58\u50A8\uFF0C\u5E03\u5C14\u7C7B\u578B\uFF0C\u9ED8\u8BA4\u662Ffalse</li><li>analyzer\uFF1A\u5206\u8BCD\u5668\u540D\u79F0\uFF1Aik_max_word</li></ul></li></ul><h2 id="_4-3-\u521B\u5EFA\u7D22\u5F15\u53CA\u6620\u5C04" tabindex="-1"><a class="header-anchor" href="#_4-3-\u521B\u5EFA\u7D22\u5F15\u53CA\u6620\u5C04" aria-hidden="true">#</a> 4.3. \u521B\u5EFA\u7D22\u5F15\u53CA\u6620\u5C04</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">EsDemoApplicationTests</span> <span class="token punctuation">{</span>

    <span class="token comment">// ElasticsearchTemplate \u662F TransportClient \u5BA2\u6237\u7AEF</span>
    <span class="token comment">// ElasticsearchRestTemplate \u662F RestHighLevel \u5BA2\u6237\u7AEF</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ElasticsearchRestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u7D22\u5F15</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFA\u6620\u5C04</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">putMapping</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5220\u9664\u7D22\u5F15</span>
        <span class="token comment">// this.restTemplate.deleteIndex(&quot;user&quot;);</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-4-repository\u6587\u6863\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_4-4-repository\u6587\u6863\u64CD\u4F5C" aria-hidden="true">#</a> 4.4. Repository\u6587\u6863\u64CD\u4F5C</h2><p>Spring Data \u7684\u5F3A\u5927\u4E4B\u5904\uFF0C\u5C31\u5728\u4E8E\u4F60\u4E0D\u7528\u5199\u4EFB\u4F55DAO\u5904\u7406\uFF0C\u81EA\u52A8\u6839\u636E\u65B9\u6CD5\u540D\u6216\u7C7B\u7684\u4FE1\u606F\u8FDB\u884CCRUD\u64CD\u4F5C\u3002\u53EA\u8981\u4F60\u5B9A\u4E49\u4E00\u4E2A\u63A5\u53E3\uFF0C\u7136\u540E\u7EE7\u627FRepository\u63D0\u4F9B\u7684\u4E00\u4E9B\u5B50\u63A5\u53E3\uFF0C\u5C31\u80FD\u5177\u5907\u5404\u79CD\u57FA\u672C\u7684CRUD\u529F\u80FD\u3002</p><p>\u5176\u4E2DElasticsearchRepository\u63A5\u53E3\u529F\u80FD\u6700\u5F3A\u5927\u3002\u8BE5\u63A5\u53E3\u7684\u65B9\u6CD5\u5305\u62EC\uFF1A</p><h3 id="_4-4-1-\u65B0\u589E" tabindex="-1"><a class="header-anchor" href="#_4-4-1-\u65B0\u589E" aria-hidden="true">#</a> 4.4.1. \u65B0\u589E</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token string">&quot;zhang3&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539\u548C\u65B0\u589E\u662F\u540C\u4E00\u4E2A\u63A5\u53E3\uFF0C\u533A\u5206\u7684\u4F9D\u636E\u5C31\u662Fid\uFF0C\u8FD9\u4E00\u70B9\u8DDF\u6211\u4EEC\u5728\u9875\u9762\u53D1\u8D77PUT\u8BF7\u6C42\u662F\u7C7B\u4F3C\u7684\u3002</p><h3 id="_4-4-2-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_4-4-2-\u5220\u9664" aria-hidden="true">#</a> 4.4.2. \u5220\u9664</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-5-\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_4-5-\u67E5\u8BE2" aria-hidden="true">#</a> 4.5. \u67E5\u8BE2</h2><h3 id="_4-5-1-\u57FA\u672C\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_4-5-1-\u57FA\u672C\u67E5\u8BE2" aria-hidden="true">#</a> 4.5.1. \u57FA\u672C\u67E5\u8BE2</h3><p>\u67E5\u8BE2\u4E00\u4E2A\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-5-2-\u6761\u4EF6\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_4-5-2-\u6761\u4EF6\u67E5\u8BE2" aria-hidden="true">#</a> 4.5.2. \u6761\u4EF6\u67E5\u8BE2</h3><p>Spring Data \u7684\u53E6\u4E00\u4E2A\u5F3A\u5927\u529F\u80FD\uFF0C\u662F\u6839\u636E\u65B9\u6CD5\u540D\u79F0\u81EA\u52A8\u5B9E\u73B0\u529F\u80FD\u3002</p><p>\u6BD4\u5982\uFF1A\u4F60\u7684\u65B9\u6CD5\u540D\u53EB\u505A\uFF1AfindByTitle\uFF0C\u90A3\u4E48\u5B83\u5C31\u77E5\u9053\u4F60\u662F\u6839\u636Etitle\u67E5\u8BE2\uFF0C\u7136\u540E\u81EA\u52A8\u5E2E\u4F60\u5B8C\u6210\uFF0C\u65E0\u9700\u5199\u5B9E\u73B0\u7C7B\u3002</p><p>\u5F53\u7136\uFF0C\u65B9\u6CD5\u540D\u79F0\u8981\u7B26\u5408\u4E00\u5B9A\u7684\u7EA6\u5B9A\uFF1A</p><table><thead><tr><th>Keyword</th><th>Sample</th><th>Elasticsearch Query String</th></tr></thead><tbody><tr><td><code>And</code></td><td><code>findByNameAndPrice</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Or</code></td><td><code>findByNameOrPrice</code></td><td><code>{&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Is</code></td><td><code>findByName</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Not</code></td><td><code>findByNameNot</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Between</code></td><td><code>findByPriceBetween</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>LessThanEqual</code></td><td><code>findByPriceLessThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>GreaterThanEqual</code></td><td><code>findByPriceGreaterThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Before</code></td><td><code>findByPriceBefore</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>After</code></td><td><code>findByPriceAfter</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Like</code></td><td><code>findByNameLike</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>StartingWith</code></td><td><code>findByNameStartingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>EndingWith</code></td><td><code>findByNameEndingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;*?&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>Contains/Containing</code></td><td><code>findByNameContaining</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;**?**&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>In</code></td><td><code>findByNameIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}} ]}}}}</code></td></tr><tr><td><code>NotIn</code></td><td><code>findByNameNotIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;bool&quot; : {&quot;should&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}}}</code></td></tr><tr><td><code>Near</code></td><td><code>findByStoreNear</code></td><td><code>Not Supported Yet !</code></td></tr><tr><td><code>True</code></td><td><code>findByAvailableTrue</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr><tr><td><code>False</code></td><td><code>findByAvailableFalse</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : false}}}}</code></td></tr><tr><td><code>OrderBy</code></td><td><code>findByAvailableTrueOrderByNameDesc</code></td><td><code>{&quot;sort&quot; : [{ &quot;name&quot; : {&quot;order&quot; : &quot;desc&quot;} }],&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr></tbody></table><p>\u51C6\u5907\u4E00\u7EC4\u6570\u636E\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testAddAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u67F3\u5CA9&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u8303\u51B0\u51B0&quot;</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u674E\u51B0\u51B0&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">4l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u950B\u54E5&quot;</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">5l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5C0F\u9E7F&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">6l</span><span class="token punctuation">,</span> <span class="token string">&quot;\u97E9\u7EA2&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728UserRepository\u4E2D\u5B9A\u4E49\u4E00\u4E2A\u65B9\u6CD5\uFF1A</p><p>\u7B2C\u4E00\u79CD\u5199\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * \u6839\u636E\u5E74\u9F84\u533A\u95F4\u67E5\u8BE2
     * <span class="token keyword">@param</span> <span class="token parameter">age1</span>
     * <span class="token keyword">@param</span> <span class="token parameter">age2</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByAgeBetween</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age1<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testFindByAgeBetween</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findByAgeBetween</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B2C\u4E8C\u79CD\u5199\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;{\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;    \\&quot;range\\&quot;: {\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;      \\&quot;age\\&quot;: {\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;        \\&quot;gte\\&quot;: \\&quot;?0\\&quot;,\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;        \\&quot;lte\\&quot;: \\&quot;?1\\&quot;\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;      }\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;    }\\n&quot;</span> <span class="token operator">+</span>
       <span class="token string">&quot;  }&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByQuery</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age1<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testFindByQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findByQuery</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-5-3-\u81EA\u5B9A\u4E49\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_4-5-3-\u81EA\u5B9A\u4E49\u67E5\u8BE2" aria-hidden="true">#</a> 4.5.3. \u81EA\u5B9A\u4E49\u67E5\u8BE2</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">testNative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// \u521D\u59CB\u5316\u81EA\u5B9A\u4E49\u67E5\u8BE2\u5BF9\u8C61</span>
    <span class="token class-name">NativeSearchQueryBuilder</span> queryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeSearchQueryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withQuery</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u51B0\u51B0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6392\u5E8F</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withSort</span><span class="token punctuation">(</span><span class="token class-name">SortBuilders</span><span class="token punctuation">.</span><span class="token function">fieldSort</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token class-name">SortOrder</span><span class="token punctuation">.</span>ASC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u5206\u9875</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withPageable</span><span class="token punctuation">(</span><span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u9AD8\u4EAE</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withHighlightBuilder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;em&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/em&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6267\u884C\u67E5\u8BE2\uFF0C\u83B7\u53D6\u5206\u9875\u7ED3\u679C\u96C6</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>queryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u603B\u9875\u6570</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u603B\u8BB0\u5F55\u6570</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getTotalElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u5F53\u524D\u9875\u6570\u636E</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>NativeSearchQueryBuilder\uFF1ASpring\u63D0\u4F9B\u7684\u4E00\u4E2A\u67E5\u8BE2\u6761\u4EF6\u6784\u5EFA\u5668\uFF0C\u5E2E\u52A9\u6784\u5EFAjson\u683C\u5F0F\u7684\u8BF7\u6C42\u4F53</p><p><code>Page&lt;item&gt;</code>\uFF1A\u9ED8\u8BA4\u662F\u5206\u9875\u67E5\u8BE2\uFF0C\u56E0\u6B64\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u5206\u9875\u7684\u7ED3\u679C\u5BF9\u8C61\uFF0C\u5305\u542B\u5C5E\u6027\uFF1A</p><ul><li>totalElements\uFF1A\u603B\u6761\u6570</li><li>totalPages\uFF1A\u603B\u9875\u6570</li><li>Iterator\uFF1A\u8FED\u4EE3\u5668\uFF0C\u672C\u8EAB\u5B9E\u73B0\u4E86Iterator\u63A5\u53E3\uFF0C\u56E0\u6B64\u53EF\u76F4\u63A5\u8FED\u4EE3\u5F97\u5230\u5F53\u524D\u9875\u7684\u6570\u636E</li></ul>`,59);function F(Q,J){const o=e("entry"),p=e("ExternalLinkIcon");return l(),u("div",null,[G,s(o,{key:"remote_ext_dict"},{default:i(()=>[z]),_:1}),N,a("p",null,[O,a("a",U,[C,s(p)]),D,a("a",L,[H,s(p)])]),M])}var K=c(P,[["render",F],["__file","elastic-search.html.vue"]]);export{K as default};
