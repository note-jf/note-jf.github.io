import{_ as c}from"./plugin-vue_export-helper.21dcd24c.js";import{o as l,c as i,e as a,b as n,a as e,d as s,r as p}from"./app.c37b87a5.js";var u="/assets/img.e0ccc579.png",r="/assets/true-image-20210604132105875.cac41ac7.png",d="/assets/true-image-20210604132116450.b967e642.png",k="/assets/img4.982062b4.png";const m={},v=e(`<h1 id="java\u9762\u8BD5\u5B9D\u5178" tabindex="-1"><a class="header-anchor" href="#java\u9762\u8BD5\u5B9D\u5178" aria-hidden="true">#</a> java\u9762\u8BD5\u5B9D\u5178</h1><h2 id="java\u9762\u5411\u5BF9\u8C61\u6709\u54EA\u4E9B\u7279\u5F81-\u5982\u4F55\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#java\u9762\u5411\u5BF9\u8C61\u6709\u54EA\u4E9B\u7279\u5F81-\u5982\u4F55\u5E94\u7528" aria-hidden="true">#</a> Java\u9762\u5411\u5BF9\u8C61\u6709\u54EA\u4E9B\u7279\u5F81\uFF0C\u5982\u4F55\u5E94\u7528</h2><p>\u9762\u5411\u5BF9\u8C61\u7F16\u7A0B\u662F\u5229\u7528\u7C7B\u548C\u5BF9\u8C61\u7F16\u7A0B\u7684\u4E00\u79CD\u601D\u60F3\u3002\u4E07\u7269\u53EF\u5F52\u7C7B\uFF0C\u7C7B\u662F\u5BF9\u4E8E\u4E16\u754C\u4E8B\u7269\u7684\u9AD8\u5EA6\u62BD\u8C61 \uFF0C\u4E0D\u540C\u7684\u4E8B\u7269\u4E4B\u95F4\u6709\u4E0D\u540C\u7684\u5173\u7CFB \uFF0C\u4E00\u4E2A\u7C7B\u81EA\u8EAB\u4E0E\u5916\u754C\u7684\u5C01\u88C5\u5173\u7CFB\uFF0C\u4E00\u4E2A\u7236\u7C7B\u548C\u5B50\u7C7B\u7684\u7EE7\u627F\u5173\u7CFB\uFF0C \u4E00\u4E2A\u7C7B\u548C\u591A\u4E2A\u7C7B\u7684\u591A\u6001\u5173\u7CFB\u3002\u4E07\u7269\u7686\u5BF9\u8C61\uFF0C\u5BF9\u8C61\u662F\u5177\u4F53\u7684\u4E16\u754C\u4E8B\u7269\u3002</p><p>\u9762\u5411\u5BF9\u8C61\u7684\u4E09\u5927\u7279\u5F81<strong>\u5C01\u88C5\uFF0C\u7EE7\u627F\uFF0C\u591A\u6001</strong>\u3002</p><blockquote><ol><li><strong>\u5C01\u88C5</strong>\u8BF4\u660E\u4E00\u4E2A\u7C7B\u884C\u4E3A\u548C\u5C5E\u6027\u4E0E\u5176\u4ED6\u7C7B\u7684\u5173\u7CFB\uFF0C\u4F4E\u8026\u5408\uFF0C\u9AD8\u5185\u805A\uFF1B</li><li><strong>\u7EE7\u627F</strong>\u662F\u7236\u7C7B\u548C\u5B50\u7C7B\u7684\u5173\u7CFB;</li><li><strong>\u591A\u6001</strong>\u8BF4\u7684\u662F\u7C7B\u4E0E\u7C7B\u7684\u5173\u7CFB\u3002</li></ol></blockquote><p><strong>\u5C01\u88C5</strong>\u9690\u85CF\u4E86\u7C7B\u7684\u5185\u90E8\u5B9E\u73B0\u673A\u5236\uFF0C\u53EF\u4EE5\u5728\u4E0D\u5F71\u54CD\u4F7F\u7528\u7684\u60C5\u51B5\u4E0B\u6539\u53D8\u7C7B\u7684\u5185\u90E8\u7ED3\u6784\uFF0C\u540C\u65F6\u4E5F\u4FDD\u62A4\u4E86\u6570\u636E\u3002\u5BF9\u5916\u754C\u800C\u5DF2\u5B83\u7684\u5185\u90E8\u7EC6\u8282\u662F\u9690\u85CF\u7684\uFF0C\u66B4\u9732\u7ED9\u5916\u754C\u7684\u53EA\u662F\u5B83\u7684\u8BBF\u95EE\u65B9\u6CD5\u3002</p><blockquote><ol><li>\u5C5E\u6027\u7684\u5C01\u88C5\uFF1A\u4F7F\u7528\u8005\u53EA\u80FD\u901A\u8FC7\u4E8B\u5148\u5B9A\u5236\u597D\u7684\u65B9\u6CD5\u6765\u8BBF\u95EE\u6570\u636E\uFF0C\u53EF\u4EE5\u65B9\u4FBF\u5730\u52A0\u5165\u903B\u8F91\u63A7\u5236\uFF0C\u9650\u5236\u5BF9\u5C5E\u6027\u7684 \u4E0D\u5408\u7406\u64CD\u4F5C\uFF1B</li><li>\u65B9\u6CD5\u7684\u5C01\u88C5\uFF1A\u4F7F\u7528\u8005\u6309\u7167\u65E2\u5B9A\u7684\u65B9\u5F0F\u8C03\u7528\u65B9\u6CD5\uFF0C\u4E0D\u5FC5\u5173\u5FC3\u65B9\u6CD5\u7684\u5185\u90E8\u5B9E\u73B0\uFF0C\u4FBF\u4E8E\u4F7F\u7528\uFF1B \u4FBF\u4E8E\u4FEE\u6539\uFF0C\u589E\u5F3A \u4EE3\u7801\u7684\u53EF\u7EF4\u62A4\u6027\uFF1B</li></ol></blockquote><p><strong>\u7EE7\u627F</strong>\u662F\u4ECE\u5DF2\u6709\u7684\u7C7B\u4E2D\u6D3E\u751F\u51FA\u65B0\u7684\u7C7B\uFF0C\u65B0\u7684\u7C7B\u80FD\u5438\u6536\u5DF2\u6709\u7C7B\u7684\u6570\u636E\u5C5E\u6027\u548C\u884C\u4E3A\uFF0C\u5E76\u80FD\u6269\u5C55\u65B0\u7684\u80FD\u529B\u3002\u5728\u672C\u8D28\u4E0A\u662F\u7279\u6B8A~\u4E00\u822C\u7684\u5173\u7CFB\uFF0C\u5373\u5E38\u8BF4\u7684is-a\u5173\u7CFB\u3002\u5B50\u7C7B\u7EE7\u627F\u7236\u7C7B\uFF0C\u8868\u660E\u5B50\u7C7B\u662F\u4E00\u79CD\u7279\u6B8A\u7684\u7236\u7C7B\uFF0C\u5E76\u4E14\u5177\u6709\u7236\u7C7B\u6240\u4E0D\u5177\u6709\u7684\u4E00\u4E9B\u5C5E\u6027\u6216\u65B9\u6CD5\u3002 \u4ECE\u591A\u79CD\u5B9E\u73B0\u7C7B\u4E2D\u62BD\u8C61\u51FA\u4E00\u4E2A\u57FA\u7C7B\uFF0C\u4F7F\u5176\u5177\u5907\u591A\u79CD\u5B9E\u73B0\u7C7B\u7684\u5171\u540C\u7279\u6027 \uFF0C\u5F53\u5B9E\u73B0\u7C7B\u7528extends\u5173\u952E\u5B57\u7EE7\u627F\u4E86\u57FA\u7C7B\uFF08\u7236\u7C7B\uFF09\u540E\uFF0C\u5B9E\u73B0\u7C7B\u5C31\u5177\u5907\u4E86\u8FD9\u4E9B\u76F8\u540C\u7684\u5C5E\u6027\u3002\u7EE7\u627F\u7684\u7C7B\u53EB\u505A\u5B50\u7C7B\uFF08\u6D3E\u751F\u7C7B\u6216\u8005\u8D85\u7C7B\uFF09\uFF0C\u88AB\u7EE7\u627F\u7684\u7C7B\u53EB\u505A\u7236\u7C7B\uFF08\u6216\u8005\u57FA\u7C7B\uFF09\u3002 \u6BD4\u5982\u4ECE\u732B\u7C7B\u3001\u72D7\u7C7B\u3001\u864E\u7C7B\u4E2D\u53EF\u4EE5\u62BD\u8C61\u51FA\u4E00\u4E2A\u52A8\u7269\u7C7B\uFF0C\u5177\u6709\u548C\u732B\u3001\u72D7\u3001\u864E\u7C7B\u7684\u5171\u540C\u7279\u6027\uFF08\u5403\u3001\u8DD1\u3001\u53EB\u7B49\uFF09\u3002Java\u901A\u8FC7extends\u5173\u952E\u5B57\u6765\u5B9E\u73B0\u7EE7\u627F\uFF0C\u7236\u7C7B\u4E2D\u901A\u8FC7private\u5B9A\u4E49\u7684\u53D8\u91CF\u548C\u65B9\u6CD5\u4E0D\u4F1A\u88AB\u7EE7\u627F\uFF0C\u4E0D\u80FD\u5728\u5B50\u7C7B\u4E2D\u76F4\u63A5\u64CD\u4F5C\u7236\u7C7B\u901A\u8FC7private\u5B9A\u4E49\u7684\u53D8\u91CF\u4EE5\u53CA\u65B9\u6CD5\u3002 \u7EE7\u627F\u907F\u514D\u4E86\u5BF9\u4E00\u822C\u7C7B\u548C\u7279\u6B8A\u7C7B\u4E4B\u95F4\u5171\u540C\u7279\u5F81\u8FDB\u884C\u7684\u91CD\u590D\u63CF\u8FF0\uFF0C\u901A\u8FC7\u7EE7\u627F\u53EF\u4EE5\u6E05\u6670\u5730\u8868\u8FBE\u6BCF\u4E00\u9879\u5171\u540C\u7279\u5F81\u6240\u9002\u5E94\u7684\u6982\u5FF5\u8303\u56F4\uFF0C\u5728\u4E00\u822C\u7C7B\u4E2D\u5B9A\u4E49\u7684\u5C5E\u6027\u548C\u64CD\u4F5C\u9002\u5E94\u4E8E\u8FD9\u4E2A\u7C7B\u672C\u8EAB\u4EE5\u53CA\u5B83\u4EE5\u4E0B\u7684\u6BCF\u4E00\u5C42\u7279\u6B8A\u7C7B\u7684\u5168\u90E8\u5BF9\u8C61\u3002\u8FD0\u7528\u7EE7\u627F\u539F\u5219\u4F7F\u5F97\u7CFB\u7EDF\u6A21\u578B\u6BD4\u8F83\u7B80\u7EC3\u4E5F\u6BD4\u8F83\u6E05\u6670\u3002</p><p><mark>\u5C01\u88C5\u548C\u7EE7\u627F\u6700\u540E\u5F52\u7ED3\u4E8E\u591A\u6001</mark></p><p><strong>\u591A\u6001\u6307</strong>\u7684\u662F\u7C7B\u548C\u7C7B\u7684\u5173\u7CFB\uFF0C\u4E24\u4E2A\u7C7B\u7531\u7EE7\u627F\u5173\u7CFB\uFF0C\u5B58\u5728\u6709\u65B9\u6CD5\u7684\u91CD\u5199\uFF0C\u6545\u800C\u53EF\u4EE5\u5728\u8C03\u7528\u65F6\u6709\u7236\u7C7B\u5F15\u7528\u6307\u5411\u5B50\u7C7B\u5BF9\u8C61\u3002 \u591A\u6001\u5FC5\u5907\u4E09\u4E2A\u8981\u7D20\uFF1A\u7EE7\u627F\uFF0C\u91CD\u5199\uFF0C\u7236\u7C7B\u5F15\u7528\u6307\u5411\u5B50\u7C7B\u5BF9\u8C61\u3002</p><h2 id="hashmap\u539F\u7406\u662F\u4EC0\u4E48-\u5728jdk1-7\u548C1-8\u4E2D\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#hashmap\u539F\u7406\u662F\u4EC0\u4E48-\u5728jdk1-7\u548C1-8\u4E2D\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> HashMap\u539F\u7406\u662F\u4EC0\u4E48\uFF0C\u5728jdk1.7\u548C1.8\u4E2D\u6709\u4EC0\u4E48\u533A\u522B</h2><p>HashMap \u6839\u636E\u952E\u7684 hashCode \u503C\u5B58\u50A8\u6570\u636E\uFF0C\u5927\u591A\u6570\u60C5\u51B5\u4E0B\u53EF\u4EE5\u76F4\u63A5\u5B9A\u4F4D\u5230\u5B83\u7684\u503C\uFF0C\u56E0\u800C\u5177\u6709\u5F88\u5FEB\u7684\u8BBF\u95EE\u901F\u5EA6\uFF0C\u4F46\u904D\u5386\u987A\u5E8F\u5374\u662F\u4E0D\u786E\u5B9A\u7684\u3002 HashMap\u6700\u591A\u53EA\u5141\u8BB8\u4E00\u6761\u8BB0\u5F55\u7684\u952E\u4E3Anull\uFF0C\u5141\u8BB8\u591A\u6761\u8BB0\u5F55\u7684\u503C\u4E3A null\u3002HashMap \u975E\u7EBF\u7A0B\u5B89\u5168\uFF0C\u5373\u4EFB\u4E00\u65F6\u523B\u53EF\u4EE5\u6709\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u5199 HashMap\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4\u6570\u636E\u7684\u4E0D\u4E00\u81F4\u3002 \u5982\u679C\u9700\u8981\u6EE1\u8DB3\u7EBF\u7A0B\u5B89\u5168\uFF0C\u53EF\u4EE5\u7528 Collections \u7684 synchronizedMap \u65B9\u6CD5\u4F7F HashMap \u5177\u6709\u7EBF\u7A0B\u5B89\u5168\u7684\u80FD\u529B\uFF0C\u6216\u8005\u4F7F\u7528 ConcurrentHashMap\u3002</p><p><strong>JAVA7</strong> \u5B9E\u73B0</p><p>\u5927\u65B9\u5411\u4E0A\uFF0CHashMap \u91CC\u9762\u662F\u4E00\u4E2A\u6570\u7EC4\uFF0C\u7136\u540E\u6570\u7EC4\u4E2D\u6BCF\u4E2A\u5143\u7D20\u662F\u4E00\u4E2A\u5355\u5411\u94FE\u8868\u3002\u4E0A\u56FE\u4E2D\uFF0C\u6BCF\u4E2A\u7EFF\u8272 \u7684\u5B9E\u4F53\u662F\u5D4C\u5957\u7C7B Entry \u7684\u5B9E\u4F8B\uFF0CEntry \u5305\u542B\u56DB\u4E2A\u5C5E\u6027\uFF1Akey, value, hash \u503C\u548C\u7528\u4E8E\u5355\u5411\u94FE\u8868\u7684 next\u3002</p><ol><li>capacity\uFF1A\u5F53\u524D\u6570\u7EC4\u5BB9\u91CF\uFF0C\u59CB\u7EC8\u4FDD\u6301 2^n\uFF0C\u53EF\u4EE5\u6269\u5BB9\uFF0C\u6269\u5BB9\u540E\u6570\u7EC4\u5927\u5C0F\u4E3A\u5F53\u524D\u7684 2 \u500D\u3002</li><li>loadFactor\uFF1A\u8D1F\u8F7D\u56E0\u5B50\uFF0C\u9ED8\u8BA4\u4E3A 0.75\u3002</li><li>threshold\uFF1A\u6269\u5BB9\u7684\u9608\u503C\uFF0C\u7B49\u4E8E capacity * loadFactor</li></ol><p><strong>JAVA8</strong> \u5B9E\u73B0</p><p>Java8 \u5BF9 HashMap \u8FDB\u884C\u4E86\u4E00\u4E9B\u4FEE\u6539\uFF0C\u6700\u5927\u7684\u4E0D\u540C\u5C31\u662F\u5229\u7528\u4E86\u7EA2\u9ED1\u6811\uFF0C\u6240\u4EE5\u5176\u7531 \u6570\u7EC4+\u94FE\u8868+\u7EA2\u9ED1\u6811 \u7EC4\u6210\u3002</p><p>\u6839\u636E Java7 HashMap \u7684\u4ECB\u7ECD\uFF0C\u6211\u4EEC\u77E5\u9053\uFF0C\u67E5\u627E\u7684\u65F6\u5019\uFF0C\u6839\u636E hash \u503C\u6211\u4EEC\u80FD\u591F\u5FEB\u901F\u5B9A\u4F4D\u5230\u6570\u7EC4\u7684\u5177\u4F53\u4E0B\u6807\uFF0C\u4F46\u662F\u4E4B\u540E\u7684\u8BDD\uFF0C\u9700\u8981\u987A\u7740\u94FE\u8868\u4E00\u4E2A\u4E2A\u6BD4\u8F83\u4E0B\u53BB\u624D\u80FD\u627E\u5230\u6211\u4EEC\u9700\u8981\u7684\uFF0C\u65F6\u95F4\u590D\u6742\u5EA6\u53D6\u51B3 \u4E8E\u94FE\u8868\u7684\u957F\u5EA6\uFF0C\u4E3A O(n)\u3002\u4E3A\u4E86\u964D\u4F4E\u8FD9\u90E8\u5206\u7684\u5F00\u9500\uFF0C\u5728 Java8 \u4E2D\uFF0C\u5F53\u94FE\u8868\u4E2D\u7684\u5143\u7D20\u8D85\u8FC7\u4E86 8 \u4E2A\u4EE5\u540E\uFF0C\u4F1A\u5C06\u94FE\u8868\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\uFF0C\u5728\u8FD9\u4E9B\u4F4D\u7F6E\u8FDB\u884C\u67E5\u627E\u7684\u65F6\u5019\u53EF\u4EE5\u964D\u4F4E\u65F6\u95F4\u590D\u6742\u5EA6\u4E3A O(logN)\u3002</p><h2 id="arraylist\u548Clinkedlist\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#arraylist\u548Clinkedlist\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> ArrayList\u548CLinkedList\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</h2><p>list\uFF1A<strong>\u6709\u5E8F\u3001\u53EF\u91CD\u590D\u3002</strong></p><ol><li>ArrayList\uFF1A<strong>\u4E0D\u662F</strong>\u7EBF\u7A0B\u5B89\u5168\uFF0C\u5E95\u5C42\u662F<strong>Object[]\u6570\u7EC4</strong>\u7ED3\u6784\uFF0C\u63D2\u5165\u5220\u9664<strong>\u53D7\u4F4D\u7F6E</strong>\u5F71\u54CD\uFF0C<strong>\u5FEB\u901F\u8BBF\u95EE</strong>\uFF1B\u5185\u5B58\u7A7A\u95F4\u5360\u2F64\uFF1A\u4F53\u73B0\u5728list\u7ED3\u5C3E\u4F1A\u9884\u7559\u2F00\u5B9A\u7684\u5BB9\u91CF\u7A7A\u95F4\u3002\u662F List \u7684\u4E3B\u8981\u5B9E\u73B0\u7C7B\uFF0C\u9002\u2F64\u4E8E<strong>\u9891\u7E41\u7684\u67E5\u627E</strong> \u2F2F\u4F5C\u3002</li><li>LinkedList\uFF1A<strong>\u4E0D\u662F</strong>\u7EBF\u7A0B\u5B89\u5168\uFF0C\u5E95\u5C42\u662F<strong>\u53CC\u5411\u94FE\u8868</strong>\u7ED3\u6784\uFF0C\u63D2\u5165\u5220\u9664<strong>\u4E0D\u53D7\u4F4D\u7F6E</strong>\u5F71\u54CD\uFF0C<strong>\u4E0D\u652F\u6301</strong>\u5FEB\u901F\u8BBF\u95EE\uFF1B\u5185\u5B58\u7A7A\u95F4\u5360\u2F64\uFF1A\u4F53\u73B0\u5728\u5B83\u7684\u6BCF\u2F00\u4E2A\u5143\u7D20\u90FD\u9700\u8981\u6D88\u8017\u2F50 ArrayList \u66F4\u591A\u7684\u7A7A\u95F4\uFF08\u56E0\u4E3A\u8981\u5B58\u653E\u76F4\u63A5\u540E\u7EE7\u548C\u76F4\u63A5\u524D\u9A71\u4EE5\u53CA\u6570\u636E\uFF09\u3002</li><li>Vector\uFF1A\u7EBF\u7A0B\u5B89\u5168\uFF0C\u662F List \u7684\u53E4\u2F7C\u5B9E\u73B0\u7C7B\u3002</li></ol><p>set\uFF1A<strong>\u65E0\u5E8F\u3001\u4E0D\u53EF\u91CD\u590D\u3002</strong></p><ol><li>HashSet(<strong>\u65E0\u5E8F</strong>\uFF0C\u552F\u4E00): \u57FA\u4E8E HashMap \u5B9E\u73B0\u7684\uFF0C\u5E95\u5C42\u91C7\u7528 HashMap \u6765\u4FDD\u5B58\u5143\u7D20</li><li>TreeSet(<strong>\u6709\u5E8F</strong>\uFF0C\u552F\u4E00): \u7EA2\u9ED1\u6811(\u81EA\u5E73\u8861\u7684\u6392\u5E8F\u4E8C\u53C9\u6811)</li><li>LinkedHashSet: \u662F HashSet \u7684\u5B50\u7C7B\uFF0C\u5E76\u4E14\u5176\u5185\u90E8\u662F\u901A\u8FC7 LinkedHashMap \u6765\u5B9E\u73B0\u7684\u3002</li></ol><p>map\uFF08K_V\uFF09\uFF1A<strong>Key \u662F\u2F46\u5E8F\u3001\u4E0D\u53EF\u91CD\u590D\uFF1Bvalue \u662F\u2F46\u5E8F\uFF0C\u53EF\u91CD\u590D\u3002</strong></p><ol><li>HashMap\uFF1A\u2FAE\u7EBF\u7A0B\u5B89\u5168\uFF0C\u6548\u7387\u2FBC\uFF0C\u53EF\u4EE5\u5B58\u50A8 null \u7684 key \u548C value\uFF0C\u4F46 null \u4F5C\u4E3A\u952E\u53EA\u80FD\u6709\u2F00\u4E2A\uFF0Cnull \u4F5C\u4E3A\u503C\u53EF\u4EE5\u6709\u591A\u4E2A\uFF1Bjdk1.8\u524D\uFF1A\u5E95\u5C42\u662F<strong>\u6570\u7EC4\u548C\u94FE\u8868(\u94FE\u8868\u6563\u5217)</strong>\uFF1B jdk1.8\u540E\uFF1A\u5F53\u94FE\u8868\u2ED3\u5EA6\u2F24\u4E8E\u9608\u503C\uFF08\u9ED8 \u8BA4\u4E3A 8\uFF09\u65F6\uFF0C\u5C06\u94FE\u8868\u8F6C\u5316\u4E3A<strong>\u7EA2\u2FCA\u6811</strong>\uFF08\u5C06\u94FE\u8868\u8F6C\u6362\u6210\u7EA2\u2FCA\u6811\u524D\u4F1A\u5224\u65AD\uFF0C\u5982\u679C\u5F53\u524D\u6570\u7EC4\u7684\u2ED3\u5EA6\u2F29\u4E8E 64\uFF0C\u90A3\u4E48\u4F1A\u9009\u62E9\u5148\u8FDB\u2F8F\u6570\u7EC4\u6269\u5BB9\uFF0C\u2F7D\u4E0D\u662F\u8F6C\u6362\u4E3A\u7EA2\u2FCA\u6811\uFF09\uFF0C\u4EE5\u51CF\u5C11\u641C\u7D22\u65F6\u95F4\u3002</li><li>Hashtable\uFF1A \u7EBF\u7A0B\u5B89\u5168\uFF0C\u57FA\u672C\u88AB\u6DD8\u6C70\uFF0C\u4E0D\u5141\u8BB8\u6709 null \u952E\u548C null</li><li>TreeMap\uFF1A\u7EA2\u2FCA\u6811\uFF08\u2F83\u5E73\u8861\u7684\u6392\u5E8F\u2F06\u53C9\u6811\uFF09</li><li>LinkedHashMap\uFF1A\u7EE7\u627F\u2F83 HashMap\uFF1B\u5E95\u5C42\u662F<strong>\u6570\u7EC4\u548C\u94FE\u8868\u6216\u7EA2\u2FCA\u6811</strong>\u7EC4\u6210\uFF1B\u53E6\u5916\uFF0C LinkedHashMap \u5728\u4E0A\u2FAF\u7ED3\u6784\u7684\u57FA\u7840\u4E0A\uFF0C\u589E\u52A0\u4E86\u2F00\u6761\u53CC\u5411\u94FE\u8868\uFF0C\u4F7F\u5F97\u4E0A\u2FAF\u7684\u7ED3\u6784\u53EF\u4EE5\u4FDD\u6301\u952E\u503C\u5BF9\u7684\u63D2\u2F0A\u987A\u5E8F\u3002 \u540C\u65F6\u901A\u8FC7\u5BF9\u94FE\u8868\u8FDB\u2F8F\u76F8\u5E94\u7684 \u64CD\u4F5C\uFF0C\u5B9E\u73B0\u4E86\u8BBF\u95EE\u987A\u5E8F\u76F8\u5173\u903B\u8F91\u3002</li><li>\u5E76\u53D1\u73AF\u5883\u4E0B\u63A8\u8350\u4F7F\u2F64 <strong>ConcurrentHashMap</strong>\uFF1B\u800C\u4E0D\u662FHashMap\u3002</li></ol><p>TreeMap\u3001TreeSet \u4EE5\u53CA JDK1.8 \u4E4B\u540E\u7684 HashMap \u5E95\u5C42\u90FD\u2F64\u5230\u4E86\u7EA2\u2FCA\u6811\u3002\u7EA2\u2FCA\u6811\u5C31\u662F\u4E3A\u4E86\u89E3\u51B3\u2F06\u53C9\u67E5\u627E\u6811\u7684\u7F3A\u9677\uFF0C\u56E0\u4E3A\u2F06\u53C9\u67E5\u627E\u6811\u5728\u67D0\u4E9B\u60C5\u51B5\u4E0B\u4F1A\u9000\u5316\u6210\u2F00\u4E2A\u7EBF\u6027\u7ED3\u6784\u3002</p><h2 id="\u9AD8\u5E76\u53D1\u4E2D\u7684\u96C6\u5408\u6709\u54EA\u4E9B\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u5E76\u53D1\u4E2D\u7684\u96C6\u5408\u6709\u54EA\u4E9B\u95EE\u9898" aria-hidden="true">#</a> \u9AD8\u5E76\u53D1\u4E2D\u7684\u96C6\u5408\u6709\u54EA\u4E9B\u95EE\u9898</h2><p><strong>\u7B2C\u4E00\u4EE3\u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u7C7B</strong></p><p>Vector\u3001Hashtable</p><p>\u662F\u600E\u4E48\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u6392\u7684\uFF1A \u4F7F\u7528synchronized\u4FEE\u9970\u65B9\u6CD5*</p><p>\u7F3A\u70B9\uFF1A\u6548\u7387\u4F4E\u4E0B</p><p><strong>\u7B2C\u4E8C\u4EE3\u7EBF\u7A0B\u975E\u5B89\u5168\u96C6\u5408\u7C7B</strong></p><p>ArrayList\u3001HashMap</p><p>\u7EBF\u7A0B\u4E0D\u5B89\u5168\uFF0C\u4F46\u662F\u6027\u80FD\u597D\uFF0C\u7528\u6765\u66FF\u4EE3Vector\u3001Hashtable</p><p>\u4F7F\u7528ArrayList\u3001HashMap\uFF0C\u9700\u8981\u7EBF\u7A0B\u5B89\u5168\u600E\u4E48\u529E\u5462\uFF1F</p><p>\u4F7F\u7528 Collections.synchronizedList(list); Collections.synchronizedMap(m);</p><p>\u5E95\u5C42\u4F7F\u7528synchronized\u4EE3\u7801\u5757\u9501 \u867D\u7136\u4E5F\u662F\u9501\u4F4F\u4E86\u6240\u6709\u7684\u4EE3\u7801\uFF0C\u4F46\u662F\u9501\u5728\u65B9\u6CD5\u91CC\u8FB9\uFF0C\u5E76\u6240\u5728\u65B9\u6CD5\u5916\u8FB9\u6027\u80FD\u53EF\u4EE5\u7406\u89E3\u4E3A\u7A0D\u6709\u63D0\u9AD8\u5427\u3002\u6BD5\u7ADF\u8FDB\u65B9\u6CD5\u672C\u8EAB\u5C31\u8981\u5206\u914D\u8D44\u6E90\u7684</p><p><strong>\u7B2C\u4E09\u4EE3\u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u7C7B</strong></p><p>\u5728\u5927\u91CF\u5E76\u53D1\u60C5\u51B5\u4E0B\u5982\u4F55\u63D0\u9AD8\u96C6\u5408\u7684\u6548\u7387\u548C\u5B89\u5168\u5462\uFF1F</p><p>java.util.concurrent.*</p><p>ConcurrentHashMap\uFF1A</p><p>CopyOnWriteArrayList \uFF1A</p><p>CopyOnWriteArraySet\uFF1A \u6CE8\u610F \u4E0D\u662F CopyOnWriteHashSet*</p><p>\u5E95\u5C42\u5927\u90FD\u91C7\u7528Lock\u9501\uFF081.8\u7684ConcurrentHashMap\u4E0D\u4F7F\u7528Lock\u9501\uFF09\uFF0C\u4FDD\u8BC1\u5B89\u5168\u7684\u540C\u65F6\uFF0C\u6027\u80FD\u4E5F\u5F88\u9AD8\u3002</p><h2 id="jdk1-8\u7684\u65B0\u7279\u6027\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#jdk1-8\u7684\u65B0\u7279\u6027\u6709\u54EA\u4E9B" aria-hidden="true">#</a> jdk1.8\u7684\u65B0\u7279\u6027\u6709\u54EA\u4E9B</h2><h3 id="\u4E00\u3001\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5" aria-hidden="true">#</a> \u4E00\u3001\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5</h3><p>Java 8\u5141\u8BB8\u6211\u4EEC\u7ED9\u63A5\u53E3\u6DFB\u52A0\u4E00\u4E2A\u975E\u62BD\u8C61\u7684\u65B9\u6CD5\u5B9E\u73B0\uFF0C\u53EA\u9700\u8981\u4F7F\u7528 default\u5173\u952E\u5B57\u5373\u53EF\uFF0C\u8FD9\u4E2A\u7279\u5F81\u53C8\u53EB\u505A\u6269\u5C55\u65B9\u6CD5\uFF0C\u793A\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Formula</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span> <span class="token keyword">double</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Formula\u63A5\u53E3\u5728\u62E5\u6709calculate\u65B9\u6CD5\u4E4B\u5916\u540C\u65F6\u8FD8\u5B9A\u4E49\u4E86sqrt\u65B9\u6CD5\uFF0C\u5B9E\u73B0\u4E86Formula\u63A5\u53E3\u7684\u5B50\u7C7B\u53EA\u9700\u8981\u5B9E\u73B0\u4E00\u4E2Acalculate\u65B9\u6CD5\uFF0C\u9ED8\u8BA4\u65B9\u6CD5sqrt\u5C06\u5728\u5B50\u7C7B\u4E0A\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Formula</span> formula<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Formula</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>a<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        formula<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100.0 formula.sqrt(16); // 4.0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6587\u4E2D\u7684formula\u88AB\u5B9E\u73B0\u4E3A\u4E00\u4E2A\u533F\u540D\u7C7B\u7684\u5B9E\u4F8B\uFF0C\u8BE5\u4EE3\u7801\u975E\u5E38\u5BB9\u6613\u7406\u89E3\uFF0C6\u884C\u4EE3\u7801\u5B9E\u73B0\u4E86\u8BA1\u7B97 sqrt(a * 100)\u3002</p><p>\u8BD1\u8005\u6CE8\uFF1A \u5728Java\u4E2D\u53EA\u6709\u5355\u7EE7\u627F\uFF0C\u5982\u679C\u8981\u8BA9\u4E00\u4E2A\u7C7B\u8D4B\u4E88\u65B0\u7684\u7279\u6027\uFF0C\u901A\u5E38\u662F\u4F7F\u7528\u63A5\u53E3\u6765\u5B9E\u73B0\uFF0C\u5728C++\u4E2D\u652F\u6301\u591A\u7EE7\u627F\uFF0C\u5141\u8BB8\u4E00\u4E2A\u5B50\u7C7B\u540C\u65F6\u5177\u6709\u591A\u4E2A\u7236\u7C7B\u7684\u63A5\u53E3\u4E0E\u529F\u80FD\uFF0C\u5728\u5176\u4ED6\u8BED\u8A00\u4E2D\uFF0C \u8BA9\u4E00\u4E2A\u7C7B\u540C\u65F6\u5177\u6709\u5176\u4ED6\u7684\u53EF\u590D\u7528\u4EE3\u7801\u7684\u65B9\u6CD5\u53EB\u505Amixin\u3002\u65B0\u7684Java 8 \u7684\u8FD9\u4E2A\u7279\u65B0\u5728\u7F16\u8BD1\u5668\u5B9E\u73B0\u7684\u89D2\u5EA6\u4E0A\u6765\u8BF4\u66F4\u52A0\u63A5\u8FD1Scala\u7684trait\u3002 \u5728C#\u4E2D\u4E5F\u6709\u540D\u4E3A\u6269\u5C55\u65B9\u6CD5\u7684\u6982\u5FF5\uFF0C \u5141\u8BB8\u7ED9\u5DF2\u5B58\u5728\u7684\u7C7B\u578B\u6269\u5C55\u65B9\u6CD5\uFF0C\u548CJava 8\u7684\u8FD9\u4E2A\u5728\u8BED\u4E49\u4E0A\u6709\u5DEE\u522B\u3002</p><h3 id="\u4E8C\u3001lambda-\u8868\u8FBE\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001lambda-\u8868\u8FBE\u5F0F" aria-hidden="true">#</a> \u4E8C\u3001Lambda \u8868\u8FBE\u5F0F</h3><p>\u9996\u5148\u770B\u770B\u5728\u8001\u7248\u672C\u7684Java\u4E2D\u662F\u5982\u4F55\u6392\u5217\u5B57\u7B26\u4E32\u7684\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names<span class="token operator">=</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;peterF&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;anna&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;xenia&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span><span class="token class-name">String</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EA\u9700\u8981\u7ED9\u9759\u6001\u65B9\u6CD5 Collections.sort \u4F20\u5165\u4E00\u4E2AList\u5BF9\u8C61\u4EE5\u53CA\u4E00\u4E2A\u6BD4\u8F83\u5668\u6765\u6309\u6307\u5B9A\u987A\u5E8F\u6392\u5217\u3002\u901A\u5E38\u505A\u6CD5\u90FD\u662F\u521B\u5EFA\u4E00\u4E2A\u533F\u540D\u7684\u6BD4\u8F83\u5668\u5BF9\u8C61\u7136\u540E\u5C06\u5176\u4F20\u9012\u7ED9sort\u65B9\u6CD5\u3002</p><p>\u5728Java 8 \u4E2D\u4F60\u5C31\u6CA1\u5FC5\u8981\u4F7F\u7528\u8FD9\u79CD\u4F20\u7EDF\u7684\u533F\u540D\u5BF9\u8C61\u7684\u65B9\u5F0F\u4E86\uFF0CJava 8\u63D0\u4F9B\u4E86\u66F4\u7B80\u6D01\u7684\u8BED\u6CD5\uFF0Clambda\u8868\u8FBE\u5F0F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span><span class="token class-name">String</span> b<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u770B\u5230\u4E86\u5427\uFF0C\u4EE3\u7801\u53D8\u5F97\u66F4\u6BB5\u4E14\u66F4\u5177\u6709\u53EF\u8BFB\u6027\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u8FD8\u53EF\u4EE5\u5199\u5F97\u66F4\u77ED\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span><span class="token class-name">String</span> b<span class="token punctuation">)</span><span class="token operator">-&gt;</span>b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5BF9\u4E8E\u51FD\u6570\u4F53\u53EA\u6709\u4E00\u884C\u4EE3\u7801\u7684\uFF0C\u4F60\u53EF\u4EE5\u53BB\u6389\u5927\u62EC\u53F7{}\u4EE5\u53CAreturn\u5173\u952E\u5B57\uFF0C\u4F46\u662F\u4F60\u8FD8\u53EF\u4EE5\u5199\u5F97\u66F4\u77ED\u70B9\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">-&gt;</span>b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Java\u7F16\u8BD1\u5668\u53EF\u4EE5\u81EA\u52A8\u63A8\u5BFC\u51FA\u53C2\u6570\u7C7B\u578B\uFF0C\u6240\u4EE5\u4F60\u53EF\u4EE5\u4E0D\u7528\u518D\u5199\u4E00\u6B21\u7C7B\u578B\u3002</p><h3 id="\u4E09\u3001\u51FD\u6570\u5F0F\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u51FD\u6570\u5F0F\u63A5\u53E3" aria-hidden="true">#</a> \u4E09\u3001\u51FD\u6570\u5F0F\u63A5\u53E3</h3><p>Lambda\u8868\u8FBE\u5F0F\u662F\u5982\u4F55\u5728java\u7684\u7C7B\u578B\u7CFB\u7EDF\u4E2D\u8868\u793A\u7684\u5462\uFF1F\u6BCF\u4E00\u4E2Alambda\u8868\u8FBE\u5F0F\u90FD\u5BF9\u5E94\u4E00\u4E2A\u7C7B\u578B\uFF0C\u901A\u5E38\u662F\u63A5\u53E3\u7C7B\u578B\u3002\u800C\u201C\u51FD\u6570\u5F0F\u63A5\u53E3\u201D\u662F\u6307\u4EC5\u4EC5\u53EA\u5305\u542B\u4E00\u4E2A\u62BD\u8C61\u65B9\u6CD5\u7684\u63A5\u53E3\uFF0C \u6BCF\u4E00\u4E2A\u8BE5\u7C7B\u578B\u7684lambda\u8868\u8FBE\u5F0F\u90FD\u4F1A\u88AB\u5339\u914D\u5230\u8FD9\u4E2A\u62BD\u8C61\u65B9\u6CD5\u3002\u56E0\u4E3A \u9ED8\u8BA4\u65B9\u6CD5 \u4E0D\u7B97\u62BD\u8C61\u65B9\u6CD5\uFF0C\u6240\u4EE5\u4F60\u4E5F\u53EF\u4EE5\u7ED9\u4F60\u7684\u51FD\u6570\u5F0F\u63A5\u53E3\u6DFB\u52A0\u9ED8\u8BA4\u65B9\u6CD5\u3002</p><p>\u6211\u4EEC\u53EF\u4EE5\u5C06lambda\u8868\u8FBE\u5F0F\u5F53\u4F5C\u4EFB\u610F\u53EA\u5305\u542B\u4E00\u4E2A\u62BD\u8C61\u65B9\u6CD5\u7684\u63A5\u53E3\u7C7B\u578B\uFF0C\u786E\u4FDD\u4F60\u7684\u63A5\u53E3\u4E00\u5B9A\u8FBE\u5230\u8FD9\u4E2A\u8981\u6C42\uFF0C\u4F60\u53EA\u9700\u8981\u7ED9\u4F60\u7684\u63A5\u53E3\u6DFB\u52A0 @FunctionalInterface \u6CE8\u89E3\uFF0C \u7F16\u8BD1\u5668\u5982\u679C\u53D1\u73B0\u4F60\u6807\u6CE8\u4E86\u8FD9\u4E2A\u6CE8\u89E3\u7684\u63A5\u53E3\u6709\u591A\u4E8E\u4E00\u4E2A\u62BD\u8C61\u65B9\u6CD5\u7684\u65F6\u5019\u4F1A\u62A5\u9519\u7684\u3002</p><p>\u793A\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">interface</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">T</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">F</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> converter<span class="token operator">=</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> converted<span class="token operator">=</span>converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F\u5982\u679C@FunctionalInterface\u5982\u679C\u6CA1\u6709\u6307\u5B9A\uFF0C\u4E0A\u9762\u7684\u4EE3\u7801\u4E5F\u662F\u5BF9\u7684\u3002</p><p>\u8BD1\u8005\u6CE8 \u5C06lambda\u8868\u8FBE\u5F0F\u6620\u5C04\u5230\u4E00\u4E2A\u5355\u65B9\u6CD5\u7684\u63A5\u53E3\u4E0A\uFF0C\u8FD9\u79CD\u505A\u6CD5\u5728Java 8\u4E4B\u524D\u5C31\u6709\u522B\u7684\u8BED\u8A00\u5B9E\u73B0\uFF0C\u6BD4\u5982Rhino JavaScript\u89E3\u91CA\u5668\uFF0C\u5982\u679C\u4E00\u4E2A\u51FD\u6570\u53C2\u6570\u63A5\u6536\u4E00\u4E2A\u5355\u65B9\u6CD5\u7684\u63A5\u53E3\u800C\u4F60\u4F20\u9012\u7684 \u662F\u4E00\u4E2Afunction\uFF0CRhino \u89E3\u91CA\u5668\u4F1A\u81EA\u52A8\u505A\u4E00\u4E2A\u5355\u63A5\u53E3\u7684\u5B9E\u4F8B\u5230function\u7684\u9002\u914D\u5668\uFF0C\u5178\u578B\u7684\u5E94\u7528\u573A\u666F\u6709 org.w3c.dom.events.EventTarget \u7684addEventListener \u7B2C\u4E8C\u4E2A\u53C2\u6570 EventListener\u3002</p><h3 id="\u56DB\u3001\u65B9\u6CD5\u4E0E\u6784\u9020\u51FD\u6570\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u65B9\u6CD5\u4E0E\u6784\u9020\u51FD\u6570\u5F15\u7528" aria-hidden="true">#</a> \u56DB\u3001\u65B9\u6CD5\u4E0E\u6784\u9020\u51FD\u6570\u5F15\u7528</h3><p>\u524D\u4E00\u8282\u4E2D\u7684\u4EE3\u7801\u8FD8\u53EF\u4EE5\u901A\u8FC7\u9759\u6001\u65B9\u6CD5\u5F15\u7528\u6765\u8868\u793A\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> converter<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> converted<span class="token operator">=</span>converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java 8 \u5141\u8BB8\u4F60\u4F7F\u7528 :: \u5173\u952E\u5B57\u6765\u4F20\u9012\u65B9\u6CD5\u6216\u8005\u6784\u9020\u51FD\u6570\u5F15\u7528\uFF0C\u4E0A\u9762\u7684\u4EE3\u7801\u5C55\u793A\u4E86\u5982\u4F55\u5F15\u7528\u4E00\u4E2A\u9759\u6001\u65B9\u6CD5\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u5F15\u7528\u4E00\u4E2A\u5BF9\u8C61\u7684\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>converter<span class="token operator">=</span>something<span class="token operator">::</span><span class="token function">startsWith</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> converted<span class="token operator">=</span>converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;J&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\u770B\u770B\u6784\u9020\u51FD\u6570\u662F\u5982\u4F55\u4F7F\u7528::\u5173\u952E\u5B57\u6765\u5F15\u7528\u7684\uFF0C\u9996\u5148\u6211\u4EEC\u5B9A\u4E49\u4E00\u4E2A\u5305\u542B\u591A\u4E2A\u6784\u9020\u51FD\u6570\u7684\u7B80\u5355\u7C7B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>
    <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> firstName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\u6211\u4EEC\u6307\u5B9A\u4E00\u4E2A\u7528\u6765\u521B\u5EFAPerson\u5BF9\u8C61\u7684\u5BF9\u8C61\u5DE5\u5382\u63A5\u53E3\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">PersonFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">P</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">P</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u6211\u4EEC\u4F7F\u7528\u6784\u9020\u51FD\u6570\u5F15\u7528\u6765\u5C06\u4ED6\u4EEC\u5173\u8054\u8D77\u6765\uFF0C\u800C\u4E0D\u662F\u5B9E\u73B0\u4E00\u4E2A\u5B8C\u6574\u7684\u5DE5\u5382\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">PersonFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personFactory<span class="token operator">=</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>
        <span class="token class-name">Person</span> person<span class="token operator">=</span>personFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;Peter&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Parker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u53EA\u9700\u8981\u4F7F\u7528 Person::new \u6765\u83B7\u53D6Person\u7C7B\u6784\u9020\u51FD\u6570\u7684\u5F15\u7528\uFF0CJava\u7F16\u8BD1\u5668\u4F1A\u81EA\u52A8\u6839\u636EPersonFactory.create\u65B9\u6CD5\u7684\u7B7E\u540D\u6765\u9009\u62E9\u5408\u9002\u7684\u6784\u9020\u51FD\u6570\u3002</p><h3 id="\u4E94\u3001lambda-\u4F5C\u7528\u57DF" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001lambda-\u4F5C\u7528\u57DF" aria-hidden="true">#</a> \u4E94\u3001Lambda \u4F5C\u7528\u57DF</h3><p>\u5728lambda\u8868\u8FBE\u5F0F\u4E2D\u8BBF\u95EE\u5916\u5C42\u4F5C\u7528\u57DF\u548C\u8001\u7248\u672C\u7684\u533F\u540D\u5BF9\u8C61\u4E2D\u7684\u65B9\u5F0F\u5F88\u76F8\u4F3C\u3002\u4F60\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\u6807\u8BB0\u4E86final\u7684\u5916\u5C42\u5C40\u90E8\u53D8\u91CF\uFF0C\u6216\u8005\u5B9E\u4F8B\u7684\u5B57\u6BB5\u4EE5\u53CA\u9759\u6001\u53D8\u91CF\u3002</p><h3 id="\u516D\u3001\u8BBF\u95EE\u5C40\u90E8\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u8BBF\u95EE\u5C40\u90E8\u53D8\u91CF" aria-hidden="true">#</a> \u516D\u3001\u8BBF\u95EE\u5C40\u90E8\u53D8\u91CF</h3><p>\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u5728lambda\u8868\u8FBE\u5F0F\u4E2D\u8BBF\u95EE\u5916\u5C42\u7684\u5C40\u90E8\u53D8\u91CF\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">int</span> num<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringConverter<span class="token operator">=</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F46\u662F\u548C\u533F\u540D\u5BF9\u8C61\u4E0D\u540C\u7684\u662F\uFF0C\u8FD9\u91CC\u7684\u53D8\u91CFnum\u53EF\u4EE5\u4E0D\u7528\u58F0\u660E\u4E3Afinal\uFF0C\u8BE5\u4EE3\u7801\u540C\u6837\u6B63\u786E\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> num<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringConverter<span class="token operator">=</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0D\u8FC7\u8FD9\u91CC\u7684num\u5FC5\u987B\u4E0D\u53EF\u88AB\u540E\u9762\u7684\u4EE3\u7801\u4FEE\u6539\uFF08\u5373\u9690\u6027\u7684\u5177\u6709final\u7684\u8BED\u4E49\uFF09\uFF0C\u4F8B\u5982\u4E0B\u9762\u7684\u5C31\u65E0\u6CD5\u7F16\u8BD1\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> num<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringConverter<span class="token operator">=</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        num<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728lambda\u8868\u8FBE\u5F0F\u4E2D\u8BD5\u56FE\u4FEE\u6539num\u540C\u6837\u662F\u4E0D\u5141\u8BB8\u7684\u3002</p><h3 id="\u4E03\u3001\u8BBF\u95EE\u5BF9\u8C61\u5B57\u6BB5\u4E0E\u9759\u6001\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u8BBF\u95EE\u5BF9\u8C61\u5B57\u6BB5\u4E0E\u9759\u6001\u53D8\u91CF" aria-hidden="true">#</a> \u4E03\u3001\u8BBF\u95EE\u5BF9\u8C61\u5B57\u6BB5\u4E0E\u9759\u6001\u53D8\u91CF</h3><p>\u548C\u672C\u5730\u53D8\u91CF\u4E0D\u540C\u7684\u662F\uFF0Clambda\u5185\u90E8\u5BF9\u4E8E\u5B9E\u4F8B\u7684\u5B57\u6BB5\u4EE5\u53CA\u9759\u6001\u53D8\u91CF\u662F\u5373\u53EF\u8BFB\u53C8\u53EF\u5199\u3002\u8BE5\u884C\u4E3A\u548C\u533F\u540D\u5BF9\u8C61\u662F\u4E00\u81F4\u7684\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Lambda4</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> outerStaticNum<span class="token punctuation">;</span>
    <span class="token keyword">int</span> outerNum<span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">testScopes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringConverter1 <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            outerNum <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringConverter2 <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            outerStaticNum <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u516B\u3001\u8BBF\u95EE\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001\u8BBF\u95EE\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5" aria-hidden="true">#</a> \u516B\u3001\u8BBF\u95EE\u63A5\u53E3\u7684\u9ED8\u8BA4\u65B9\u6CD5</h3><p>\u8FD8\u8BB0\u5F97\u7B2C\u4E00\u8282\u4E2D\u7684formula\u4F8B\u5B50\u4E48\uFF0C\u63A5\u53E3Formula\u5B9A\u4E49\u4E86\u4E00\u4E2A\u9ED8\u8BA4\u65B9\u6CD5sqrt\u53EF\u4EE5\u76F4\u63A5\u88ABformula\u7684\u5B9E\u4F8B\u5305\u62EC\u533F\u540D\u5BF9\u8C61\u8BBF\u95EE\u5230\uFF0C\u4F46\u662F\u5728lambda\u8868\u8FBE\u5F0F\u4E2D\u8FD9\u4E2A\u662F\u4E0D\u884C\u7684\u3002 Lambda\u8868\u8FBE\u5F0F\u4E2D\u662F\u65E0\u6CD5\u8BBF\u95EE\u5230\u9ED8\u8BA4\u65B9\u6CD5\u7684\uFF0C\u4EE5\u4E0B\u4EE3\u7801\u5C06\u65E0\u6CD5\u7F16\u8BD1\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Formula</span> formula<span class="token operator">=</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sqrt</span><span class="token punctuation">(</span>a<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Built</span><span class="token operator">-</span>in <span class="token class-name">Functional</span> <span class="token class-name">Interfaces</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>JDK 1.8 API\u5305\u542B\u4E86\u5F88\u591A\u5185\u5EFA\u7684\u51FD\u6570\u5F0F\u63A5\u53E3\uFF0C\u5728\u8001Java\u4E2D\u5E38\u7528\u5230\u7684\u6BD4\u5982Comparator\u6216\u8005Runnable\u63A5\u53E3\uFF0C\u8FD9\u4E9B\u63A5\u53E3\u90FD\u589E\u52A0\u4E86@FunctionalInterface\u6CE8\u89E3\u4EE5\u4FBF\u80FD\u7528\u5728lambda\u4E0A\u3002 Java 8 API\u540C\u6837\u8FD8\u63D0\u4F9B\u4E86\u5F88\u591A\u5168\u65B0\u7684\u51FD\u6570\u5F0F\u63A5\u53E3\u6765\u8BA9\u5DE5\u4F5C\u66F4\u52A0\u65B9\u4FBF\uFF0C\u6709\u4E00\u4E9B\u63A5\u53E3\u662F\u6765\u81EAGoogle Guava\u5E93\u91CC\u7684\uFF0C\u5373\u4FBF\u4F60\u5BF9\u8FD9\u4E9B\u5F88\u719F\u6089\u4E86\uFF0C\u8FD8\u662F\u6709\u5FC5\u8981\u770B\u770B\u8FD9\u4E9B\u662F\u5982\u4F55\u6269\u5C55\u5230lambda\u4E0A\u4F7F\u7528\u7684\u3002</p><p><strong>Predicate \u63A5\u53E3</strong></p><p>Predicate \u63A5\u53E3\u53EA\u6709\u4E00\u4E2A\u53C2\u6570\uFF0C\u8FD4\u56DEboolean\u7C7B\u578B\u3002\u8BE5\u63A5\u53E3\u5305\u542B\u591A\u79CD\u9ED8\u8BA4\u65B9\u6CD5\u6765\u5C06Predicate\u7EC4\u5408\u6210\u5176\u4ED6\u590D\u6742\u7684\u903B\u8F91\uFF08\u6BD4\u5982\uFF1A\u4E0E\uFF0C\u6216\uFF0C\u975E\uFF09\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> predicate<span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">;</span>
        predicate<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true predicate.negate().test(&quot;foo&quot;); // false</span>
        <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> nonNull<span class="token operator">=</span><span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">nonNull</span><span class="token punctuation">;</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> isNull<span class="token operator">=</span><span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">isNull</span><span class="token punctuation">;</span>
        <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> isEmpty<span class="token operator">=</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">isEmpty</span><span class="token punctuation">;</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> isNotEmpty<span class="token operator">=</span>isEmpty<span class="token punctuation">.</span><span class="token function">negate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Function \u63A5\u53E3</strong></p><p>Function \u63A5\u53E3\u6709\u4E00\u4E2A\u53C2\u6570\u5E76\u4E14\u8FD4\u56DE\u4E00\u4E2A\u7ED3\u679C\uFF0C\u5E76\u9644\u5E26\u4E86\u4E00\u4E9B\u53EF\u4EE5\u548C\u5176\u4ED6\u51FD\u6570\u7EC4\u5408\u7684\u9ED8\u8BA4\u65B9\u6CD5\uFF08compose, andThen\uFF09\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> toInteger<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span>
        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> backToString<span class="token operator">=</span>toInteger<span class="token punctuation">.</span><span class="token function">andThen</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        backToString<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;123&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Supplier \u63A5\u53E3</strong> Supplier \u63A5\u53E3\u8FD4\u56DE\u4E00\u4E2A\u4EFB\u610F\u8303\u578B\u7684\u503C\uFF0C\u548CFunction\u63A5\u53E3\u4E0D\u540C\u7684\u662F\u8BE5\u63A5\u53E3\u6CA1\u6709\u4EFB\u4F55\u53C2\u6570</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personSupplier<span class="token operator">=</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>
        personSupplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// new Person</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Consumer \u63A5\u53E3</strong> Consumer \u63A5\u53E3\u8868\u793A\u6267\u884C\u5728\u5355\u4E2A\u53C2\u6570\u4E0A\u7684\u64CD\u4F5C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> greeter<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, &quot;</span><span class="token operator">+</span>p<span class="token punctuation">.</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        greeter<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Luke&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Skywalker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Comparator \u63A5\u53E3</strong> Comparator \u662F\u8001Java\u4E2D\u7684\u7ECF\u5178\u63A5\u53E3\uFF0C Java 8\u5728\u6B64\u4E4B\u4E0A\u6DFB\u52A0\u4E86\u591A\u79CD\u9ED8\u8BA4\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> comparator<span class="token operator">=</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token operator">-&gt;</span>p1<span class="token punctuation">.</span>firstName<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Person</span> p1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Person</span> p2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Wonderland&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        comparator<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &gt; 0 comparator.reversed().compare(p1, p2); // &lt; 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Optional \u63A5\u53E3</strong></p><p>Optional \u4E0D\u662F\u51FD\u6570\u662F\u63A5\u53E3\uFF0C\u8FD9\u662F\u4E2A\u7528\u6765\u9632\u6B62NullPointerException\u5F02\u5E38\u7684\u8F85\u52A9\u7C7B\u578B\uFF0C\u8FD9\u662F\u4E0B\u4E00\u5C4A\u4E2D\u5C06\u8981\u7528\u5230\u7684\u91CD\u8981\u6982\u5FF5\uFF0C\u73B0\u5728\u5148\u7B80\u5355\u7684\u770B\u770B\u8FD9\u4E2A\u63A5\u53E3\u80FD\u5E72\u4EC0\u4E48\uFF1A</p><p>Optional \u88AB\u5B9A\u4E49\u4E3A\u4E00\u4E2A\u7B80\u5355\u7684\u5BB9\u5668\uFF0C\u5176\u503C\u53EF\u80FD\u662Fnull\u6216\u8005\u4E0D\u662Fnull\u3002\u5728Java 8\u4E4B\u524D\u4E00\u822C\u67D0\u4E2A\u51FD\u6570\u5E94\u8BE5\u8FD4\u56DE\u975E\u7A7A\u5BF9\u8C61\u4F46\u662F\u5076\u5C14\u5374\u53EF\u80FD\u8FD4\u56DE\u4E86null\uFF0C\u800C\u5728Java 8\u4E2D\uFF0C\u4E0D\u63A8\u8350\u4F60\u8FD4\u56DEnull\u800C\u662F\u8FD4\u56DEOptional\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> optional<span class="token operator">=</span><span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;bam&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true </span>
        optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;bam&quot; </span>
        optional<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">&quot;fallback&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;bam&quot;</span>
        optional<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;b&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Stream \u63A5\u53E3</strong></p><p>java.util.Stream \u8868\u793A\u80FD\u5E94\u7528\u5728\u4E00\u7EC4\u5143\u7D20\u4E0A\u4E00\u6B21\u6267\u884C\u7684\u64CD\u4F5C\u5E8F\u5217\u3002Stream \u64CD\u4F5C\u5206\u4E3A\u4E2D\u95F4\u64CD\u4F5C\u6216\u8005\u6700\u7EC8\u64CD\u4F5C\u4E24\u79CD\uFF0C\u6700\u7EC8\u64CD\u4F5C\u8FD4\u56DE\u4E00\u7279\u5B9A\u7C7B\u578B\u7684\u8BA1\u7B97\u7ED3\u679C\uFF0C\u800C\u4E2D\u95F4\u64CD\u4F5C\u8FD4\u56DEStream\u672C\u8EAB\uFF0C \u8FD9\u6837\u4F60\u5C31\u53EF\u4EE5\u5C06\u591A\u4E2A\u64CD\u4F5C\u4F9D\u6B21\u4E32\u8D77\u6765\u3002Stream \u7684\u521B\u5EFA\u9700\u8981\u6307\u5B9A\u4E00\u4E2A\u6570\u636E\u6E90\uFF0C\u6BD4\u5982 java.util.Collection\u7684\u5B50\u7C7B\uFF0CList\u6216\u8005Set\uFF0C Map\u4E0D\u652F\u6301\u3002Stream\u7684\u64CD\u4F5C\u53EF\u4EE5\u4E32\u884C\u6267\u884C\u6216\u8005\u5E76\u884C\u6267\u884C\u3002</p><p>\u9996\u5148\u770B\u770BStream\u662F\u600E\u4E48\u7528\uFF0C\u9996\u5148\u521B\u5EFA\u5B9E\u4F8B\u4EE3\u7801\u7684\u7528\u5230\u7684\u6570\u636EList\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stringCollection<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ddd2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;aaa2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;bbb1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;aaa1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;bbb3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ccc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;bbb2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ddd1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java 8\u6269\u5C55\u4E86\u96C6\u5408\u7C7B\uFF0C\u53EF\u4EE5\u901A\u8FC7 Collection.stream() \u6216\u8005 Collection.parallelStream() \u6765\u521B\u5EFA\u4E00\u4E2AStream\u3002</p><p><strong>Filter \u8FC7\u6EE4</strong></p><p>\u8FC7\u6EE4\u901A\u8FC7\u4E00\u4E2Apredicate\u63A5\u53E3\u6765\u8FC7\u6EE4\u5E76\u53EA\u4FDD\u7559\u7B26\u5408\u6761\u4EF6\u7684\u5143\u7D20\uFF0C\u8BE5\u64CD\u4F5C\u5C5E\u4E8E\u4E2D\u95F4\u64CD\u4F5C\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u5728\u8FC7\u6EE4\u540E\u7684\u7ED3\u679C\u6765\u5E94\u7528\u5176\u4ED6Stream\u64CD\u4F5C\uFF08\u6BD4\u5982forEach\uFF09\u3002 forEach\u9700\u8981\u4E00\u4E2A\u51FD\u6570\u6765\u5BF9\u8FC7\u6EE4\u540E\u7684\u5143\u7D20\u4F9D\u6B21\u6267\u884C\u3002forEach\u662F\u4E00\u4E2A\u6700\u7EC8\u64CD\u4F5C\uFF0C\u6240\u4EE5\u6211\u4EEC\u4E0D\u80FD\u5728forEach\u4E4B\u540E\u6765\u6267\u884C\u5176\u4ED6Stream\u64CD\u4F5C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &quot;aaa2&quot;, &quot;aaa1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Sort \u6392\u5E8F</strong></p><p>\u6392\u5E8F\u662F\u4E00\u4E2A\u4E2D\u95F4\u64CD\u4F5C\uFF0C\u8FD4\u56DE\u7684\u662F\u6392\u5E8F\u597D\u540E\u7684Stream\u3002\u5982\u679C\u4F60\u4E0D\u6307\u5B9A\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7684Comparator\u5219\u4F1A\u4F7F\u7528\u9ED8\u8BA4\u6392\u5E8F\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &quot;aaa1&quot;, &quot;aaa2&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u6392\u5E8F\u53EA\u521B\u5EFA\u4E86\u4E00\u4E2A\u6392\u5217\u597D\u540E\u7684Stream\uFF0C\u800C\u4E0D\u4F1A\u5F71\u54CD\u539F\u6709\u7684\u6570\u636E\u6E90\uFF0C\u6392\u5E8F\u4E4B\u540E\u539F\u6570\u636EstringCollection\u662F\u4E0D\u4F1A\u88AB\u4FEE\u6539\u7684\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringCollection<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ddd2, aaa2, bbb1, aaa1, bbb3, ccc, bbb2, ddd1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>Map \u6620\u5C04</strong> \u4E2D\u95F4\u64CD\u4F5Cmap\u4F1A\u5C06\u5143\u7D20\u6839\u636E\u6307\u5B9A\u7684Function\u63A5\u53E3\u6765\u4F9D\u6B21\u5C06\u5143\u7D20\u8F6C\u6210\u53E6\u5916\u7684\u5BF9\u8C61\uFF0C\u4E0B\u9762\u7684\u793A\u4F8B\u5C55\u793A\u4E86\u5C06\u5B57\u7B26\u4E32\u8F6C\u6362\u4E3A\u5927\u5199\u5B57\u7B26\u4E32\u3002\u4F60\u4E5F\u53EF\u4EE5\u901A\u8FC7map\u6765\u8BB2\u5BF9\u8C61\u8F6C\u6362\u6210\u5176\u4ED6\u7C7B\u578B\uFF0C map\u8FD4\u56DE\u7684Stream\u7C7B\u578B\u662F\u6839\u636E\u4F60map\u4F20\u9012\u8FDB\u53BB\u7684\u51FD\u6570\u7684\u8FD4\u56DE\u503C\u51B3\u5B9A\u7684\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">toUpperCase</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">-&gt;</span>b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &quot;DDD2&quot;, &quot;DDD1&quot;, &quot;CCC&quot;, &quot;BBB3&quot;, &quot;BBB2&quot;, &quot;AAA2&quot;, &quot;AAA1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Match \u5339\u914D</strong></p><p>Stream\u63D0\u4F9B\u4E86\u591A\u79CD\u5339\u914D\u64CD\u4F5C\uFF0C\u5141\u8BB8\u68C0\u6D4B\u6307\u5B9A\u7684Predicate\u662F\u5426\u5339\u914D\u6574\u4E2AStream\u3002\u6240\u6709\u7684\u5339\u914D\u64CD\u4F5C\u90FD\u662F\u6700\u7EC8\u64CD\u4F5C\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2Aboolean\u7C7B\u578B\u7684\u503C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">boolean</span> anyStartsWithA<span class="token operator">=</span>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>anyStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
        <span class="token keyword">boolean</span> allStartsWithA<span class="token operator">=</span>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>allStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
        <span class="token keyword">boolean</span> noneStartsWithZ<span class="token operator">=</span>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>noneStartsWithZ<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Count \u8BA1\u6570</strong> \u8BA1\u6570\u662F\u4E00\u4E2A\u6700\u7EC8\u64CD\u4F5C\uFF0C\u8FD4\u56DEStream\u4E2D\u5143\u7D20\u7684\u4E2A\u6570\uFF0C\u8FD4\u56DE\u503C\u7C7B\u578B\u662Flong\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">long</span> startsWithB<span class="token operator">=</span>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>startsWithB<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Reduce \u89C4\u7EA6</strong></p><p>\u8FD9\u662F\u4E00\u4E2A\u6700\u7EC8\u64CD\u4F5C\uFF0C\u5141\u8BB8\u901A\u8FC7\u6307\u5B9A\u7684\u51FD\u6570\u6765\u8BB2stream\u4E2D\u7684\u591A\u4E2A\u5143\u7D20\u89C4\u7EA6\u4E3A\u4E00\u4E2A\u5143\u7D20\uFF0C\u89C4\u8D8A\u540E\u7684\u7ED3\u679C\u662F\u901A\u8FC7Optional\u63A5\u53E3\u8868\u793A\u7684\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> reduced<span class="token operator">=</span>stringCollection<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s1<span class="token operator">+</span><span class="token string">&quot;#&quot;</span><span class="token operator">+</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        reduced<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;aaa1#aaa2#bbb1#bbb2#bbb3#ccc#ddd1#ddd2&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5E76\u884C****Streams</strong></p><p>\u524D\u9762\u63D0\u5230\u8FC7Stream\u6709\u4E32\u884C\u548C\u5E76\u884C\u4E24\u79CD\uFF0C\u4E32\u884CStream\u4E0A\u7684\u64CD\u4F5C\u662F\u5728\u4E00\u4E2A\u7EBF\u7A0B\u4E2D\u4F9D\u6B21\u5B8C\u6210\uFF0C\u800C\u5E76\u884CStream\u5219\u662F\u5728\u591A\u4E2A\u7EBF\u7A0B\u4E0A\u540C\u65F6\u6267\u884C\u3002</p><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u5C55\u793A\u4E86\u662F\u5982\u4F55\u901A\u8FC7\u5E76\u884CStream\u6765\u63D0\u5347\u6027\u80FD\uFF1A</p><p>\u9996\u5148\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A\u6CA1\u6709\u91CD\u590D\u5143\u7D20\u7684\u5927\u8868\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> max<span class="token operator">=</span><span class="token number">1000000</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> values<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">UUID</span> uuid<span class="token operator">=</span>UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u6211\u4EEC\u8BA1\u7B97\u4E00\u4E0B\u6392\u5E8F\u8FD9\u4E2AStream\u8981\u8017\u65F6\u591A\u4E45\uFF0C \u4E32\u884C\u6392\u5E8F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">long</span> t0<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> count<span class="token operator">=</span>values<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> t1<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> millis<span class="token operator">=</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span>t1<span class="token operator">-</span>t0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;sequential sort took: %d ms&quot;</span><span class="token punctuation">,</span>millis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u4E32\u884C\u8017\u65F6: 899 ms \u5E76\u884C\u6392\u5E8F\uFF1A</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">long</span> t0<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> count<span class="token operator">=</span>values<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> t1<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> millis<span class="token operator">=</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span>t1<span class="token operator">-</span>t0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;parallel sort took: %d ms&quot;</span><span class="token punctuation">,</span>millis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u5E76\u884C\u6392\u5E8F\u8017\u65F6: 472 ms</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u4E24\u4E2A\u4EE3\u7801\u51E0\u4E4E\u662F\u4E00\u6837\u7684\uFF0C\u4F46\u662F\u5E76\u884C\u7248\u7684\u5FEB\u4E8650%\u4E4B\u591A\uFF0C\u552F\u4E00\u9700\u8981\u505A\u7684\u6539\u52A8\u5C31\u662F\u5C06stream()\u6539\u4E3AparallelStream()\u3002</p><p><strong>Map</strong></p><p>\u524D\u9762\u63D0\u5230\u8FC7\uFF0CMap\u7C7B\u578B\u4E0D\u652F\u6301stream\uFF0C\u4E0D\u8FC7Map\u63D0\u4F9B\u4E86\u4E00\u4E9B\u65B0\u7684\u6709\u7528\u7684\u65B9\u6CD5\u6765\u5904\u7406\u4E00\u4E9B\u65E5\u5E38\u4EFB\u52A1\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        map<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token string">&quot;val&quot;</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        map<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u4EE3\u7801\u5F88\u5BB9\u6613\u7406\u89E3\uFF0C putIfAbsent \u4E0D\u9700\u8981\u6211\u4EEC\u505A\u989D\u5916\u7684\u5B58\u5728\u6027\u68C0\u67E5\uFF0C\u800CforEach\u5219\u63A5\u6536\u4E00\u4E2AConsumer\u63A5\u53E3\u6765\u5BF9map\u91CC\u7684\u6BCF\u4E00\u4E2A\u952E\u503C\u5BF9\u8FDB\u884C\u64CD\u4F5C\u3002</p><p>\u4E0B\u9762\u7684\u4F8B\u5B50\u5C55\u793A\u4E86map\u4E0A\u7684\u5176\u4ED6\u6709\u7528\u7684\u51FD\u6570\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>map<span class="token punctuation">.</span><span class="token function">computeIfPresent</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token operator">-&gt;</span>val<span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// val33</span>
        map<span class="token punctuation">.</span><span class="token function">computeIfPresent</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
        map<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span>num<span class="token operator">-&gt;</span><span class="token string">&quot;val&quot;</span><span class="token operator">+</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
        map<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>num<span class="token operator">-&gt;</span><span class="token string">&quot;bam&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// val33</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\u5C55\u793A\u5982\u4F55\u5728Map\u91CC\u5220\u9664\u4E00\u4E2A\u952E\u503C\u5168\u90FD\u5339\u914D\u7684\u9879\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;val3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// val33</span>
        map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;val33&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// null</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53E6\u5916\u4E00\u4E2A\u6709\u7528\u7684\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token string">&quot;not found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// not found</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5BF9Map\u7684\u5143\u7D20\u505A\u5408\u5E76\u4E5F\u53D8\u5F97\u5F88\u5BB9\u6613\u4E86\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>map<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">&quot;val9&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>newValue<span class="token punctuation">)</span><span class="token operator">-&gt;</span>value<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// val9</span>
        map<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">&quot;concat&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>newValue<span class="token punctuation">)</span><span class="token operator">-&gt;</span>value<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// val9concat</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Merge\u505A\u7684\u4E8B\u60C5\u662F\u5982\u679C\u952E\u540D\u4E0D\u5B58\u5728\u5219\u63D2\u5165\uFF0C\u5426\u5219\u5219\u5BF9\u539F\u952E\u5BF9\u5E94\u7684\u503C\u505A\u5408\u5E76\u64CD\u4F5C\u5E76\u91CD\u65B0\u63D2\u5165\u5230map\u4E2D\u3002</p><h3 id="\u4E5D\u3001date-api" tabindex="-1"><a class="header-anchor" href="#\u4E5D\u3001date-api" aria-hidden="true">#</a> \u4E5D\u3001Date API</h3><p>Java 8 \u5728\u5305java.time\u4E0B\u5305\u542B\u4E86\u4E00\u7EC4\u5168\u65B0\u7684\u65F6\u95F4\u65E5\u671FAPI\u3002\u65B0\u7684\u65E5\u671FAPI\u548C\u5F00\u6E90\u7684Joda-Time\u5E93\u5DEE\u4E0D\u591A\uFF0C\u4F46\u53C8\u4E0D\u5B8C\u5168\u4E00\u6837\uFF0C\u4E0B\u9762\u7684\u4F8B\u5B50\u5C55\u793A\u4E86\u8FD9\u7EC4\u65B0API\u91CC\u6700\u91CD\u8981\u7684\u4E00\u4E9B\u90E8\u5206\uFF1A</p><p><strong>Clock \u65F6\u949F</strong></p><p>Clock\u7C7B\u63D0\u4F9B\u4E86\u8BBF\u95EE\u5F53\u524D\u65E5\u671F\u548C\u65F6\u95F4\u7684\u65B9\u6CD5\uFF0CClock\u662F\u65F6\u533A\u654F\u611F\u7684\uFF0C\u53EF\u4EE5\u7528\u6765\u53D6\u4EE3 System.currentTimeMillis() \u6765\u83B7\u53D6\u5F53\u524D\u7684\u5FAE\u79D2\u6570\u3002\u67D0\u4E00\u4E2A\u7279\u5B9A\u7684\u65F6\u95F4\u70B9\u4E5F\u53EF\u4EE5\u4F7F\u7528Instant\u7C7B\u6765\u8868\u793A\uFF0CInstant\u7C7B\u4E5F\u53EF\u4EE5\u7528\u6765\u521B\u5EFA\u8001\u7684java.util.Date\u5BF9\u8C61\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Clock</span> clock<span class="token operator">=</span><span class="token class-name">Clock</span><span class="token punctuation">.</span><span class="token function">systemDefaultZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> millis<span class="token operator">=</span>clock<span class="token punctuation">.</span><span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Instant</span> instant<span class="token operator">=</span>clock<span class="token punctuation">.</span><span class="token function">instant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> legacyDate<span class="token operator">=</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>instant<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// legacy java.util.Date</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Timezones \u65F6\u533A</strong></p><p>\u5728\u65B0API\u4E2D\u65F6\u533A\u4F7F\u7528ZoneId\u6765\u8868\u793A\u3002\u65F6\u533A\u53EF\u4EE5\u5F88\u65B9\u4FBF\u7684\u4F7F\u7528\u9759\u6001\u65B9\u6CD5of\u6765\u83B7\u53D6\u5230\u3002 \u65F6\u533A\u5B9A\u4E49\u4E86\u5230UTS\u65F6\u95F4\u7684\u65F6\u95F4\u5DEE\uFF0C\u5728Instant\u65F6\u95F4\u70B9\u5BF9\u8C61\u5230\u672C\u5730\u65E5\u671F\u5BF9\u8C61\u4E4B\u95F4\u8F6C\u6362\u7684\u65F6\u5019\u662F\u6781\u5176\u91CD\u8981\u7684\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">getAvailableZoneIds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints all available timezone ids</span>

        <span class="token class-name">ZoneId</span> zone1<span class="token operator">=</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;Europe/Berlin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ZoneId</span> zone2<span class="token operator">=</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;Brazil/East&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zone1<span class="token punctuation">.</span><span class="token function">getRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zone2<span class="token punctuation">.</span><span class="token function">getRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ZoneRules[currentStandardOffset=+01:00] </span>
<span class="token comment">// ZoneRules[currentStandardOffset=-03:00]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>LocalTime \u672C\u5730\u65F6\u95F4</strong></p><p>LocalTime \u5B9A\u4E49\u4E86\u4E00\u4E2A\u6CA1\u6709\u65F6\u533A\u4FE1\u606F\u7684\u65F6\u95F4\uFF0C\u4F8B\u5982 \u665A\u4E0A10\u70B9\uFF0C\u6216\u8005 17:30:15\u3002\u4E0B\u9762\u7684\u4F8B\u5B50\u4F7F\u7528\u524D\u9762\u4EE3\u7801\u521B\u5EFA\u7684\u65F6\u533A\u521B\u5EFA\u4E86\u4E24\u4E2A\u672C\u5730\u65F6\u95F4\u3002\u4E4B\u540E\u6BD4\u8F83\u65F6\u95F4\u5E76\u4EE5\u5C0F\u65F6\u548C\u5206\u949F\u4E3A\u5355\u4F4D\u8BA1\u7B97\u4E24\u4E2A\u65F6\u95F4\u7684\u65F6\u95F4\u5DEE\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">LocalTime</span> now1<span class="token operator">=</span><span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span>zone1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalTime</span> now2<span class="token operator">=</span><span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span>zone2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>now1<span class="token punctuation">.</span><span class="token function">isBefore</span><span class="token punctuation">(</span>now2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

        <span class="token keyword">long</span> hoursBetween<span class="token operator">=</span><span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>HOURS<span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>now1<span class="token punctuation">,</span>now2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> minutesBetween<span class="token operator">=</span><span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MINUTES<span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>now1<span class="token punctuation">,</span>now2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hoursBetween<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -3 </span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>minutesBetween<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -239</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>LocalTime \u63D0\u4F9B\u4E86\u591A\u79CD\u5DE5\u5382\u65B9\u6CD5\u6765\u7B80\u5316\u5BF9\u8C61\u7684\u521B\u5EFA\uFF0C\u5305\u62EC\u89E3\u6790\u65F6\u95F4\u5B57\u7B26\u4E32\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">LocalTime</span> late<span class="token operator">=</span><span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>late<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 23:59:59</span>

        <span class="token class-name">DateTimeFormatter</span> germanFormatter<span class="token operator">=</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofLocalizedTime</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span>SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withLocale</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>GERMAN<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">LocalTime</span> leetTime<span class="token operator">=</span><span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;13:37&quot;</span><span class="token punctuation">,</span>germanFormatter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>leetTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 13:37 </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>LocalDate \u672C\u5730\u65E5\u671F</strong></p><p>LocalDate \u8868\u793A\u4E86\u4E00\u4E2A\u786E\u5207\u7684\u65E5\u671F\uFF0C\u6BD4\u5982 2014-03-11\u3002\u8BE5\u5BF9\u8C61\u503C\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u7528\u8D77\u6765\u548CLocalTime\u57FA\u672C\u4E00\u81F4\u3002\u4E0B\u9762\u7684\u4F8B\u5B50\u5C55\u793A\u4E86\u5982\u4F55\u7ED9Date\u5BF9\u8C61\u52A0\u51CF\u5929/\u6708/\u5E74\u3002\u53E6\u5916\u8981\u6CE8\u610F\u7684\u662F\u8FD9\u4E9B\u5BF9\u8C61\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u64CD\u4F5C\u8FD4\u56DE\u7684\u603B\u662F\u4E00\u4E2A\u65B0\u5B9E\u4F8B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token class-name">LocalDate</span> today<span class="token operator">=</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalDate</span> tomorrow<span class="token operator">=</span>today<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">LocalDate</span> yesterday<span class="token operator">=</span>tomorrow<span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">LocalDate</span> independenceDay<span class="token operator">=</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span><span class="token class-name">Month</span><span class="token punctuation">.</span>JULY<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DayOfWeek</span> dayOfWeek<span class="token operator">=</span>independenceDay<span class="token punctuation">.</span><span class="token function">getDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dayOfWeek<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// FRIDAY</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ECE\u5B57\u7B26\u4E32\u89E3\u6790\u4E00\u4E2ALocalDate\u7C7B\u578B\u548C\u89E3\u6790LocalTime\u4E00\u6837\u7B80\u5355\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token class-name">DateTimeFormatter</span> germanFormatter<span class="token operator">=</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofLocalizedDate</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span>MEDIUM<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withLocale</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>GERMAN<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">LocalDate</span> xmas<span class="token operator">=</span><span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;24.12.2014&quot;</span><span class="token punctuation">,</span>germanFormatter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>xmas<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2014-12-24</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>LocalDateTime \u672C\u5730\u65E5\u671F\u65F6\u95F4</strong></p><p>LocalDateTime \u540C\u65F6\u8868\u793A\u4E86\u65F6\u95F4\u548C\u65E5\u671F\uFF0C\u76F8\u5F53\u4E8E\u524D\u4E24\u8282\u5185\u5BB9\u5408\u5E76\u5230\u4E00\u4E2A\u5BF9\u8C61\u4E0A\u4E86\u3002LocalDateTime\u548CLocalTime\u8FD8\u6709LocalDate\u4E00\u6837\uFF0C\u90FD\u662F\u4E0D\u53EF\u53D8\u7684\u3002LocalDateTime\u63D0\u4F9B\u4E86\u4E00\u4E9B\u80FD\u8BBF\u95EE\u5177\u4F53\u5B57\u6BB5\u7684\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">LocalDateTime</span> sylvester<span class="token operator">=</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span><span class="token class-name">Month</span><span class="token punctuation">.</span>DECEMBER<span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">DayOfWeek</span> dayOfWeek<span class="token operator">=</span>sylvester<span class="token punctuation">.</span><span class="token function">getDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dayOfWeek<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// WEDNESDAY</span>

        <span class="token class-name">Month</span> month<span class="token operator">=</span>sylvester<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// DECEMBER</span>

        <span class="token keyword">long</span> minuteOfDay<span class="token operator">=</span>sylvester<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token class-name">ChronoField</span><span class="token punctuation">.</span>MINUTE_OF_DAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>minuteOfDay<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1439</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EA\u8981\u9644\u52A0\u4E0A\u65F6\u533A\u4FE1\u606F\uFF0C\u5C31\u53EF\u4EE5\u5C06\u5176\u8F6C\u6362\u4E3A\u4E00\u4E2A\u65F6\u95F4\u70B9Instant\u5BF9\u8C61\uFF0CInstant\u65F6\u95F4\u70B9\u5BF9\u8C61\u53EF\u4EE5\u5F88\u5BB9\u6613\u7684\u8F6C\u6362\u4E3A\u8001\u5F0F\u7684java.util.Date\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Instant</span> instant<span class="token operator">=</span>sylvester<span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Date</span> legacyDate<span class="token operator">=</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>instant<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>legacyDate<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Wed Dec 31 23:59:59 CET 2014</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u683C\u5F0F\u5316LocalDateTime\u548C\u683C\u5F0F\u5316\u65F6\u95F4\u548C\u65E5\u671F\u4E00\u6837\u7684\uFF0C\u9664\u4E86\u4F7F\u7528\u9884\u5B9A\u4E49\u597D\u7684\u683C\u5F0F\u5916\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u81EA\u5DF1\u5B9A\u4E49\u683C\u5F0F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">DateTimeFormatter</span> formatter<span class="token operator">=</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;MMM dd, yyyy - HH:mm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">LocalDateTime</span> parsed<span class="token operator">=</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;Nov 03, 2014 - 07:13&quot;</span><span class="token punctuation">,</span>formatter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> string<span class="token operator">=</span>formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>parsed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Nov 03, 2014 - 07:13</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u548Cjava.text.NumberFormat\u4E0D\u4E00\u6837\u7684\u662F\u65B0\u7248\u7684DateTimeFormatter\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u6240\u4EE5\u5B83\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002</p><h3 id="\u5341\u3001annotation-\u6CE8\u89E3" tabindex="-1"><a class="header-anchor" href="#\u5341\u3001annotation-\u6CE8\u89E3" aria-hidden="true">#</a> \u5341\u3001Annotation \u6CE8\u89E3</h3><p>\u5728Java 8\u4E2D\u652F\u6301\u591A\u91CD\u6CE8\u89E3\u4E86\uFF0C\u5148\u770B\u4E2A\u4F8B\u5B50\u6765\u7406\u89E3\u4E00\u4E0B\u662F\u4EC0\u4E48\u610F\u601D\u3002 \u9996\u5148\u5B9A\u4E49\u4E00\u4E2A\u5305\u88C5\u7C7BHints\u6CE8\u89E3\u7528\u6765\u653E\u7F6E\u4E00\u7EC4\u5177\u4F53\u7684Hint\u6CE8\u89E3\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@interface</span> <span class="token class-name">Hints</span> <span class="token punctuation">{</span>
    <span class="token class-name">Hint</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Repeatable</span><span class="token punctuation">(</span><span class="token class-name">Hints</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">Hint</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java 8\u5141\u8BB8\u6211\u4EEC\u628A\u540C\u4E00\u4E2A\u7C7B\u578B\u7684\u6CE8\u89E3\u4F7F\u7528\u591A\u6B21\uFF0C\u53EA\u9700\u8981\u7ED9\u8BE5\u6CE8\u89E3\u6807\u6CE8\u4E00\u4E0B@Repeatable\u5373\u53EF\u3002</p><p>\u4F8B 1: \u4F7F\u7528\u5305\u88C5\u7C7B\u5F53\u5BB9\u5668\u6765\u5B58\u591A\u4E2A\u6CE8\u89E3\uFF08\u8001\u65B9\u6CD5\uFF09</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token annotation punctuation">@Hints</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">&quot;hint1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">&quot;hint2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F8B 2\uFF1A\u4F7F\u7528\u591A\u91CD\u6CE8\u89E3\uFF08\u65B0\u65B9\u6CD5\uFF09</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">&quot;hint1&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">&quot;hint2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B2C\u4E8C\u4E2A\u4F8B\u5B50\u91CCjava\u7F16\u8BD1\u5668\u4F1A\u9690\u6027\u7684\u5E2E\u4F60\u5B9A\u4E49\u597D@Hints\u6CE8\u89E3\uFF0C\u4E86\u89E3\u8FD9\u4E00\u70B9\u6709\u52A9\u4E8E\u4F60\u7528\u53CD\u5C04\u6765\u83B7\u53D6\u8FD9\u4E9B\u4FE1\u606F\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Hint</span> hint<span class="token operator">=</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Hint</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// null</span>

        <span class="token class-name">Hints</span> hints1<span class="token operator">=</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Hints</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hints1<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>

        <span class="token class-name">Hint</span><span class="token punctuation">[</span><span class="token punctuation">]</span>hints2<span class="token operator">=</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotationsByType</span><span class="token punctuation">(</span><span class="token class-name">Hint</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hints2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5373\u4FBF\u6211\u4EEC\u6CA1\u6709\u5728Person\u7C7B\u4E0A\u5B9A\u4E49@Hints\u6CE8\u89E3\uFF0C\u6211\u4EEC\u8FD8\u662F\u53EF\u4EE5\u901A\u8FC7 getAnnotation(Hints.class) \u6765\u83B7\u53D6 @Hints\u6CE8\u89E3\uFF0C\u66F4\u52A0\u65B9\u4FBF\u7684\u65B9\u6CD5\u662F\u4F7F\u7528 getAnnotationsByType \u53EF\u4EE5\u76F4\u63A5\u83B7\u53D6\u5230\u6240\u6709\u7684@Hint\u6CE8\u89E3\u3002 \u53E6\u5916Java 8\u7684\u6CE8\u89E3\u8FD8\u589E\u52A0\u5230\u4E24\u79CD\u65B0\u7684target\u4E0A\u4E86\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE_PARAMETER<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE_USE<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@interface</span> <span class="token class-name">MyAnnotation</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5173\u4E8EJava 8\u7684\u65B0\u7279\u6027\u5C31\u5199\u5230\u8FD9\u4E86\uFF0C\u80AF\u5B9A\u8FD8\u6709\u66F4\u591A\u7684\u7279\u6027\u7B49\u5F85\u53D1\u6398\u3002JDK 1.8\u91CC\u8FD8\u6709\u5F88\u591A\u5F88\u6709\u7528\u7684\u4E1C\u897F\uFF0C\u6BD4\u5982Arrays.parallelSort, StampedLock\u548CCompletableFuture\u7B49\u7B49\u3002</p><h2 id="java\u4E2D\u91CD\u5199\u548C\u91CD\u8F7D\u6709\u54EA\u4E9B\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#java\u4E2D\u91CD\u5199\u548C\u91CD\u8F7D\u6709\u54EA\u4E9B\u533A\u522B" aria-hidden="true">#</a> Java\u4E2D\u91CD\u5199\u548C\u91CD\u8F7D\u6709\u54EA\u4E9B\u533A\u522B</h2><p>\u91CD\u8F7D\u548C\u91CD\u5199\u90FD\u662F\u5B9E\u73B0\u591A\u6001\u7684\u65B9\u5F0F\uFF0C\u533A\u522B\u5728\u4E8E\u524D\u8005\u5B9E\u73B0\u7684\u662F\u7F16\u8BD1\u65F6\u7684\u591A\u6001\u6027\uFF0C\u800C\u540E\u8005\u5B9E\u73B0\u7684\u662F\u8FD0\u884C\u65F6\u7684\u591A\u6001\u6027\u3002\u91CD\u8F7D\u53D1\u751F\u5728\u4E00\u4E2A\u7C7B\u4E2D\uFF0C\u540C\u540D\u7684\u65B9\u6CD5\u5982\u679C\u6709\u4E0D\u540C\u7684\u53C2\u6570\u5217\u8868\uFF08\u53C2\u6570\u7C7B\u578B\u4E0D\u540C\u3001\u53C2\u6570\u4E2A\u6570\u4E0D\u540C\u6216\u8005\u4E8C\u8005\u90FD\u4E0D\u540C\uFF09\u5219\u89C6\u4E3A\u91CD\u8F7D\uFF1B\u91CD\u5199\u53D1\u751F\u5728\u5B50\u7C7B\u4E0E\u7236\u7C7B\u4E4B\u95F4\uFF0C\u91CD\u5199\u8981\u6C42\u5B50\u7C7B\u88AB\u91CD\u5199\u65B9\u6CD5\u4E0E\u7236\u7C7B\u88AB\u91CD\u5199\u65B9\u6CD5\u6709\u76F8\u540C\u7684\u8FD4\u56DE\u7C7B\u578B\uFF0C\u6BD4\u7236\u7C7B\u88AB\u91CD\u5199\u65B9\u6CD5\u66F4\u597D\u8BBF\u95EE\uFF0C\u4E0D\u80FD\u6BD4\u7236\u7C7B\u88AB\u91CD\u5199\u65B9\u6CD5\u58F0\u660E\u66F4\u591A\u7684\u5F02\u5E38\uFF08\u91CC\u6C0F\u4EE3\u6362\u539F\u5219\uFF09\u3002\u91CD\u8F7D\u5BF9\u8FD4\u56DE\u7C7B\u578B\u6CA1\u6709\u7279\u6B8A\u7684\u8981\u6C42\u3002</p><p><strong>\u91CD\u8F7D</strong>\u7684\u89C4\u5219\uFF1A</p><ol><li><p>\u65B9\u6CD5\u540D\u4E00\u81F4\uFF0C\u53C2\u6570\u5217\u8868\u4E2D\u53C2\u6570\u7684\u987A\u5E8F\uFF0C\u7C7B\u578B\uFF0C\u4E2A\u6570\u4E0D\u540C\u3002</p></li><li><p>\u91CD\u8F7D\u4E0E\u65B9\u6CD5\u7684\u8FD4\u56DE\u503C\u65E0\u5173\uFF0C\u5B58\u5728\u4E8E\u7236\u7C7B\u548C\u5B50\u7C7B\uFF0C\u540C\u7C7B\u4E2D\u3002</p></li><li><p>\u53EF\u4EE5\u629B\u51FA\u4E0D\u540C\u7684\u5F02\u5E38\uFF0C\u53EF\u4EE5\u6709\u4E0D\u540C\u4FEE\u9970\u7B26</p></li></ol><p><strong>\u91CD\u5199</strong>\u7684\u89C4\u5219\uFF1A</p><ol><li><p>\u53C2\u6570\u5217\u8868\u5FC5\u987B\u5B8C\u5168\u4E0E\u88AB\u91CD\u5199\u65B9\u6CD5\u7684\u4E00\u81F4\uFF0C\u8FD4\u56DE\u7C7B\u578B\u5FC5\u987B\u5B8C\u5168\u4E0E\u88AB\u91CD\u5199\u65B9\u6CD5\u7684\u8FD4\u56DE\u7C7B\u578B\u4E00\u81F4\u3002</p></li><li><p>\u6784\u9020\u65B9\u6CD5\u4E0D\u80FD\u88AB\u91CD\u5199\uFF0C\u58F0\u660E\u4E3A final \u7684\u65B9\u6CD5\u4E0D\u80FD\u88AB\u91CD\u5199\uFF0C\u58F0\u660E\u4E3A static \u7684\u65B9\u6CD5\u4E0D\u80FD\u88AB\u91CD\u5199\uFF0C\u4F46\u662F\u80FD\u591F\u88AB\u518D\u6B21\u58F0\u660E\u3002</p></li><li><p>\u8BBF\u95EE\u6743\u9650\u4E0D\u80FD\u6BD4\u7236\u7C7B\u4E2D\u88AB\u91CD\u5199\u7684\u65B9\u6CD5\u7684\u8BBF\u95EE\u6743\u9650\u66F4\u4F4E\u3002</p></li><li><p>\u91CD\u5199\u7684\u65B9\u6CD5\u80FD\u591F\u629B\u51FA\u4EFB\u4F55\u975E\u5F3A\u5236\u5F02\u5E38\uFF08UncheckedException\uFF0C\u4E5F\u53EB\u975E\u8FD0\u884C\u65F6\u5F02\u5E38\uFF09\uFF0C\u65E0\u8BBA\u88AB\u91CD\u5199\u7684\u65B9\u6CD5\u662F\u5426\u629B\u51FA\u5F02\u5E38\u3002\u4F46\u662F\uFF0C\u91CD\u5199\u7684\u65B9\u6CD5\u4E0D\u80FD\u629B\u51FA\u65B0\u7684\u5F3A\u5236\u6027\u5F02\u5E38\uFF0C\u6216\u8005\u6BD4\u88AB\u91CD\u5199\u65B9\u6CD5\u58F0\u660E\u7684\u66F4\u5E7F\u6CDB\u7684\u5F3A\u5236\u6027\u5F02\u5E38\uFF0C\u53CD\u4E4B\u5219\u53EF\u4EE5\u3002</p></li></ol><h2 id="\u63A5\u53E3\u548C\u62BD\u8C61\u7C7B\u6709\u54EA\u4E9B\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#\u63A5\u53E3\u548C\u62BD\u8C61\u7C7B\u6709\u54EA\u4E9B\u533A\u522B" aria-hidden="true">#</a> \u63A5\u53E3\u548C\u62BD\u8C61\u7C7B\u6709\u54EA\u4E9B\u533A\u522B</h2><p>\u4E0D\u540C\uFF1A</p><ul><li>\u62BD\u8C61\u7C7B\uFF1A</li></ul><ol><li>\u62BD\u8C61\u7C7B\u4E2D\u53EF\u4EE5\u5B9A\u4E49\u6784\u9020\u5668</li><li>\u53EF\u4EE5\u6709\u62BD\u8C61\u65B9\u6CD5\u548C\u5177\u4F53\u65B9\u6CD5</li><li>\u63A5\u53E3\u4E2D\u7684\u6210\u5458\u5168\u90FD\u662F public \u7684</li><li>\u62BD\u8C61\u7C7B\u4E2D\u53EF\u4EE5\u5B9A\u4E49\u6210\u5458\u53D8\u91CF</li><li>\u6709\u62BD\u8C61\u65B9\u6CD5\u7684\u7C7B\u5FC5\u987B\u88AB\u58F0\u660E\u4E3A\u62BD\u8C61\u7C7B\uFF0C\u800C\u62BD\u8C61\u7C7B\u672A\u5FC5\u8981\u6709\u62BD\u8C61\u65B9\u6CD5</li><li>\u62BD\u8C61\u7C7B\u4E2D\u53EF\u4EE5\u5305\u542B\u9759\u6001\u65B9\u6CD5</li><li>\u4E00\u4E2A\u7C7B\u53EA\u80FD\u7EE7\u627F\u4E00\u4E2A\u62BD\u8C61\u7C7B</li></ol><ul><li>\u63A5\u53E3\uFF1A</li></ul><ol><li>\u63A5\u53E3\u4E2D\u4E0D\u80FD\u5B9A\u4E49\u6784\u9020\u5668</li><li>\u65B9\u6CD5\u5168\u90E8\u90FD\u662F\u62BD\u8C61\u65B9\u6CD5</li><li>\u62BD\u8C61\u7C7B\u4E2D\u7684\u6210\u5458\u53EF\u4EE5\u662F private\u3001\u9ED8\u8BA4\u3001protected\u3001public</li><li>\u63A5\u53E3\u4E2D\u5B9A\u4E49\u7684\u6210\u5458\u53D8\u91CF\u5B9E\u9645\u4E0A\u90FD\u662F\u5E38\u91CF</li><li>\u63A5\u53E3\u4E2D\u4E0D\u80FD\u6709\u9759\u6001\u65B9\u6CD5</li><li>\u4E00\u4E2A\u7C7B\u53EF\u4EE5\u5B9E\u73B0\u591A\u4E2A\u63A5\u53E3</li></ol><p>\u76F8\u540C\uFF1A</p><ol><li>\u4E0D\u80FD\u591F\u5B9E\u4F8B\u5316</li><li>\u53EF\u4EE5\u5C06\u62BD\u8C61\u7C7B\u548C\u63A5\u53E3\u7C7B\u578B\u4F5C\u4E3A\u5F15\u7528\u7C7B\u578B</li><li>\u4E00\u4E2A\u7C7B\u5982\u679C\u7EE7\u627F\u4E86\u67D0\u4E2A\u62BD\u8C61\u7C7B\u6216\u8005\u5B9E\u73B0\u4E86\u67D0\u4E2A\u63A5\u53E3\u90FD\u9700\u8981\u5BF9\u5176\u4E2D\u7684\u62BD\u8C61\u65B9\u6CD5\u5168\u90E8\u8FDB\u884C\u5B9E\u73B0\uFF0C\u5426\u5219\u8BE5\u7C7B\u4ECD\u7136\u9700\u8981\u88AB\u58F0\u660E\u4E3A\u62BD\u8C61\u7C7B</li></ol><h2 id="\u600E\u6837\u58F0\u660E\u4E00\u4E2A\u7C7B\u4E0D\u4F1A\u88AB\u7EE7\u627F-\u4EC0\u4E48\u573A\u666F\u4E0B\u4F1A\u7528" tabindex="-1"><a class="header-anchor" href="#\u600E\u6837\u58F0\u660E\u4E00\u4E2A\u7C7B\u4E0D\u4F1A\u88AB\u7EE7\u627F-\u4EC0\u4E48\u573A\u666F\u4E0B\u4F1A\u7528" aria-hidden="true">#</a> \u600E\u6837\u58F0\u660E\u4E00\u4E2A\u7C7B\u4E0D\u4F1A\u88AB\u7EE7\u627F\uFF0C\u4EC0\u4E48\u573A\u666F\u4E0B\u4F1A\u7528</h2><p>\u5982\u679C\u4E00\u4E2A\u7C7B\u88ABfinal\u4FEE\u9970\uFF0C\u6B64\u7C7B\u4E0D\u53EF\u4EE5\u6709\u5B50\u7C7B\uFF0C\u4E0D\u80FD\u88AB\u5176\u5B83\u7C7B\u7EE7\u627F\uFF0C\u5982\u679C\u4E00\u4E2A\u4E2D\u7684\u6240\u6709\u65B9\u6CD5\u90FD\u6CA1\u6709\u91CD\u5199\u7684\u9700\u8981\uFF0C\u5F53\u524D\u7C7B\u6CA1\u6709\u5B50\u7C7B\u4E5F\u7F62\uFF0C\u5C31\u53EF\u4EE5\u4F7F\u7528final\u4FEE\u9970\u7C7B\u3002</p><h2 id="java\u4E2D-\u548Cequals\u6709\u54EA\u4E9B\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#java\u4E2D-\u548Cequals\u6709\u54EA\u4E9B\u533A\u522B" aria-hidden="true">#</a> Java\u4E2D==\u548Cequals\u6709\u54EA\u4E9B\u533A\u522B</h2><p>equals \u548C== \u6700\u5927\u7684\u533A\u522B\u662F\u4E00\u4E2A\u662F\u65B9\u6CD5\u4E00\u4E2A\u662F\u8FD0\u7B97\u7B26\u3002</p><p>==\uFF1A\u5982\u679C\u6BD4\u8F83\u7684\u5BF9\u8C61\u662F\u57FA\u672C\u6570\u636E\u7C7B\u578B\uFF0C\u5219\u6BD4\u8F83\u7684\u662F\u6570\u503C\u662F\u5426\u76F8\u7B49\uFF1B\u5982\u679C\u6BD4\u8F83\u7684\u662F\u5F15\u7528\u6570\u636E\u7C7B\u578B\uFF0C\u5219\u6BD4\u8F83\u7684\u662F\u5BF9\u8C61\u7684\u5730\u5740\u503C\u662F\u5426\u76F8\u7B49\u3002</p><p>equals()\uFF1A\u7528\u6765\u6BD4\u8F83\u65B9\u6CD5\u4E24\u4E2A\u5BF9\u8C61\u7684\u5185\u5BB9\u662F\u5426\u76F8\u7B49\u3002</p><p>\u6CE8\u610F\uFF1Aequals \u65B9\u6CD5\u4E0D\u80FD\u7528\u4E8E\u57FA\u672C\u6570\u636E\u7C7B\u578B\u7684\u53D8\u91CF\uFF0C\u5982\u679C\u6CA1\u6709\u5BF9 equals \u65B9\u6CD5\u8FDB\u884C\u91CD\u5199\uFF0C\u5219\u6BD4\u8F83\u7684\u662F\u5F15\u7528\u7C7B\u578B\u7684\u53D8\u91CF\u6240\u6307\u5411\u7684\u5BF9\u8C61\u7684\u5730\u5740\u3002</p><h2 id="string\u3001stringbuffer\u3001stringbuilder\u533A\u522B\u53CA\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#string\u3001stringbuffer\u3001stringbuilder\u533A\u522B\u53CA\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> String\u3001StringBuffer\u3001StringBuilder\u533A\u522B\u53CA\u4F7F\u7528\u573A\u666F</h2><p>String \u7C7B\u4E2D\u4F7F\u2F64 final \u5173\u952E\u5B57\u4FEE\u9970\u5B57\u7B26\u6570\u7EC4\u6765\u4FDD\u5B58\u5B57\u7B26\u4E32\uFF0C private final char value[] \uFF0C\u6240\u4EE5 String \u5BF9\u8C61\u662F\u4E0D\u53EF\u53D8\u7684.</p><p>\u2F7D StringBuilder \u4E0E StringBuffer \u90FD\u7EE7\u627F\u2F83 AbstractStringBuilder \u7C7B\uFF1B\u4F46\u662F\u6CA1\u6709\u2F64 final \u5173\u952E\u5B57\u4FEE\u9970\uFF0C\u6240\u4EE5\u8FD9\u4E24\u79CD\u5BF9\u8C61\u90FD\u662F\u53EF\u53D8\u7684\u3002</p><p>StringBuffer \u662F\u7EBF\u7A0B\u5B89\u5168\u7684\uFF1B</p><p>StringBuilder \u662F\u2FAE\u7EBF\u7A0B\u5B89\u5168\u7684\uFF1B</p><ol><li>\u64CD\u4F5C\u5C11\u91CF\u7684\u6570\u636E: \u9002\u2F64 String</li><li>\u5355\u7EBF\u7A0B\u64CD\u4F5C\u5B57\u7B26\u4E32\u7F13\u51B2\u533A\u4E0B\u64CD\u4F5C\u2F24\u91CF\u6570\u636E: \u9002\u2F64 StringBuilder</li><li>\u591A\u7EBF\u7A0B\u64CD\u4F5C\u5B57\u7B26\u4E32\u7F13\u51B2\u533A\u4E0B\u64CD\u4F5C\u2F24\u91CF\u6570\u636E: \u9002\u2F64 StringBuffer</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> str<span class="token operator">=</span> \u201Cabc\u201D\uFF1B
        str<span class="token operator">=</span> \u201Cbcd\u201D<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u4E0A\uFF0C\u5B57\u7B26\u4E32 str \u660E\u660E\u662F\u53EF\u4EE5\u6539\u53D8\u7684\u5440\uFF01\u5176\u5B9E\u4E0D\u7136\uFF0Cstr \u4EC5\u4EC5\u662F\u4E00\u4E2A\u5F15\u7528\u5BF9\u8C61\uFF0C\u5B83\u6307\u5411\u4E00\u4E2A\u5B57\u7B26\u4E32\u5BF9\u8C61\u201Cabc\u201D\u3002\u7B2C\u4E8C\u884C\u4EE3\u7801\u7684\u542B\u4E49\u662F\u8BA9 str \u91CD\u65B0\u6307\u5411\u4E86\u4E00\u4E2A\u65B0\u7684\u5B57\u7B26\u4E32\u201Cbcd\u201D\u5BF9\u8C61\uFF0C \u800C\u201Cabc\u201D\u5BF9\u8C61\u5E76\u6CA1\u6709\u4EFB\u4F55\u6539\u53D8\uFF0C\u53EA\u4E0D\u8FC7\u8BE5\u5BF9\u8C61\u5DF2\u7ECF\u6210\u4E3A\u4E00\u4E2A\u4E0D\u53EF\u53CA\u5BF9\u8C61\u7F62\u4E86\u3002</p><h2 id="java\u4EE3\u7406\u7684\u51E0\u79CD\u5B9E\u73B0\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#java\u4EE3\u7406\u7684\u51E0\u79CD\u5B9E\u73B0\u65B9\u5F0F" aria-hidden="true">#</a> Java\u4EE3\u7406\u7684\u51E0\u79CD\u5B9E\u73B0\u65B9\u5F0F</h2><p>\u7B2C\u4E00\u79CD:\u9759\u6001\u4EE3\u7406,\u53EA\u80FD\u9759\u6001\u7684\u4EE3\u7406\u67D0\u4E9B\u7C7B\u6216\u8005\u67D0\u4E9B\u65B9\u6CD5,\u4E0D\u63A8\u8350\u4F7F\u7528,\u529F\u80FD\u6BD4\u8F83\u5F31,\u4F46\u662F\u7F16\u7801\u7B80\u5355</p><p>\u7B2C\u4E8C\u79CD:\u52A8\u6001\u4EE3\u7406,\u5305\u542BProxy\u4EE3\u7406\u548CCGLIB\u52A8\u6001\u4EE3\u7406</p><h3 id="proxy\u4EE3\u7406\u662Fjdk\u5185\u7F6E\u7684\u52A8\u6001\u4EE3\u7406" tabindex="-1"><a class="header-anchor" href="#proxy\u4EE3\u7406\u662Fjdk\u5185\u7F6E\u7684\u52A8\u6001\u4EE3\u7406" aria-hidden="true">#</a> Proxy\u4EE3\u7406\u662FJDK\u5185\u7F6E\u7684\u52A8\u6001\u4EE3\u7406</h3><p>\u7279\u70B9:\u9762\u5411\u63A5\u53E3\u7684,\u4E0D\u9700\u8981\u5BFC\u5165\u4E09\u65B9\u4F9D\u8D56\u7684\u52A8\u6001\u4EE3\u7406,\u53EF\u4EE5\u5BF9\u591A\u4E2A\u4E0D\u540C\u7684\u63A5\u53E3\u8FDB\u884C\u589E\u5F3A,\u901A\u8FC7\u53CD\u5C04\u8BFB\u53D6\u6CE8\u89E3\u65F6,\u53EA\u80FD\u8BFB\u53D6\u5230\u63A5\u53E3\u4E0A\u7684\u6CE8\u89E3\u3002</p><p>\u539F\u7406:\u9762\u5411\u63A5\u53E3,\u53EA\u80FD\u5BF9\u5B9E\u73B0\u7C7B\u5728\u5B9E\u73B0\u63A5\u53E3\u4E2D\u5B9A\u4E49\u7684\u65B9\u6CD5\u8FDB\u884C\u589E\u5F3A\u3002</p><p>\u5B9A\u4E49\u63A5\u53E3\u548C\u5B9E\u73B0</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------getName------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;riemann&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------getAge------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">26</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationHandler</span></span><span class="token punctuation">;</span>
        <span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInvocationHandler</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>

    <span class="token class-name">MyInvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">MyInvocationHandler</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;getName&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;++++++before &quot;</span> <span class="token operator">+</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;++++++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;++++++after &quot;</span> <span class="token operator">+</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;++++++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationHandler</span></span><span class="token punctuation">;</span>
        <span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Proxy</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InvocationHandler</span> invocationHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyInvocationHandler</span><span class="token punctuation">(</span>userService<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserService</span> userServiceProxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userService<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> invocationHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userServiceProxy<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userServiceProxy<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cglib\u52A8\u6001\u4EE3\u7406" tabindex="-1"><a class="header-anchor" href="#cglib\u52A8\u6001\u4EE3\u7406" aria-hidden="true">#</a> CGLIB\u52A8\u6001\u4EE3\u7406</h3><p>\u7279\u70B9:\u9762\u5411\u7236\u7C7B\u7684\u52A8\u6001\u4EE3\u7406,\u9700\u8981\u5BFC\u5165\u7B2C\u4E09\u65B9\u4F9D\u8D56</p><p>\u539F\u7406:\u9762\u5411\u7236\u7C7B,\u5E95\u5C42\u901A\u8FC7\u5B50\u7C7B\u7EE7\u627F\u7236\u7C7B\u5E76\u91CD\u5199\u65B9\u6CD5\u7684\u5F62\u5F0F\u5B9E\u73B0\u589E\u5F3A</p><p>Proxy\u548CCGLIB\u662F\u975E\u5E38\u91CD\u8981\u7684\u4EE3\u7406\u6A21\u5F0F,\u662FspringAOP\u5E95\u5C42\u5B9E\u73B0\u7684\u4E3B\u8981\u4E24\u79CD\u65B9\u5F0F</p><p>CGLIB\u7684\u6838\u5FC3\u7C7B\uFF1A</p><ol><li>net.sf.cglib.proxy.Enhancer \u2013 \u4E3B\u8981\u7684\u589E\u5F3A\u7C7B</li><li>net.sf.cglib.proxy.MethodInterceptor \u2013 \u4E3B\u8981\u7684\u65B9\u6CD5\u62E6\u622A\u7C7B\uFF0C\u5B83\u662FCallback\u63A5\u53E3\u7684\u5B50\u63A5\u53E3\uFF0C\u9700\u8981\u7528\u6237\u5B9E\u73B0</li><li>net.sf.cglib.proxy.MethodProxy \u2013 JDK\u7684java.lang.reflect.Method\u7C7B\u7684\u4EE3\u7406\u7C7B\uFF0C\u53EF\u4EE5\u65B9\u4FBF\u7684\u5B9E\u73B0\u5BF9\u6E90\u5BF9\u8C61\u65B9\u6CD5\u7684\u8C03\u7528,\u5982\u4F7F\u7528\uFF1A</li></ol><p>Object o = methodProxy.invokeSuper(proxy, args);//\u867D\u7136\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F\u88AB\u4EE3\u7406\u5BF9\u8C61\uFF0C\u4E5F\u4E0D\u4F1A\u51FA\u73B0\u6B7B\u5FAA\u73AF\u7684\u95EE\u9898\u3002</p><p>net.sf.cglib.proxy.MethodInterceptor \u63A5\u53E3\u662F\u6700\u901A\u7528\u7684\u56DE\u8C03\uFF08callback\uFF09\u7C7B\u578B\uFF0C\u5B83\u7ECF\u5E38\u88AB\u57FA\u4E8E\u4EE3\u7406\u7684AOP\u7528\u6765\u5B9E\u73B0\u62E6\u622A\uFF08intercept\uFF09\u65B9\u6CD5\u7684\u8C03\u7528\u3002</p><p>\u8FD9\u4E2A\u63A5\u53E3\u53EA\u5B9A\u4E49\u4E86\u4E00\u4E2A\u65B9\u6CD5</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span>Method</span> method<span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span>args<span class="token punctuation">,</span><span class="token class-name">MethodProxy</span> proxy<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">Throwable</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F\u4EE3\u7406\u5BF9\u50CF\uFF0C\u7B2C\u4E8C\u548C\u7B2C\u4E09\u4E2A\u53C2\u6570\u5206\u522B\u662F\u62E6\u622A\u7684\u65B9\u6CD5\u548C\u65B9\u6CD5\u7684\u53C2\u6570\u3002\u539F\u6765\u7684\u65B9\u6CD5\u53EF\u80FD\u901A\u8FC7\u4F7F\u7528java.lang.reflect.Method\u5BF9\u8C61\u7684\u4E00\u822C\u53CD\u5C04\u8C03\u7528\uFF0C \u6216\u8005\u4F7F\u7528 net.sf.cglib.proxy.MethodProxy\u5BF9\u8C61\u8C03\u7528\u3002net.sf.cglib.proxy.MethodProxy\u901A\u5E38\u88AB\u9996\u9009\u4F7F\u7528\uFF0C\u56E0\u4E3A\u5B83\u66F4\u5FEB\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>cglib</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span><span class="token class-name">MethodInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span><span class="token class-name">MethodProxy</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CglibProxy</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> <span class="token class-name">MethodProxy</span> methodProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;++++++before &quot;</span> <span class="token operator">+</span> methodProxy<span class="token punctuation">.</span><span class="token function">getSuperName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;++++++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> o1 <span class="token operator">=</span> methodProxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;++++++before &quot;</span> <span class="token operator">+</span> methodProxy<span class="token punctuation">.</span><span class="token function">getSuperName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;++++++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> o1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CglibProxy</span> cglibProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CglibProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Enhancer</span> enhancer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span><span class="token class-name">UserServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span>cglibProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserService</span> o <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> enhancer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        o<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        o<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hashcode\u548Cequals\u5982\u4F55\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#hashcode\u548Cequals\u5982\u4F55\u4F7F\u7528" aria-hidden="true">#</a> hashcode\u548Cequals\u5982\u4F55\u4F7F\u7528</h2><p><strong>equals()</strong> \u6E90\u81EA\u4E8Ejava.lang.Object,\u8BE5\u65B9\u6CD5\u7528\u6765\u7B80\u5355\u9A8C\u8BC1\u4E24\u4E2A\u5BF9\u8C61\u7684\u76F8\u7B49\u6027\u3002Object\u7C7B\u4E2D\u5B9A\u4E49\u7684\u9ED8\u8BA4\u5B9E\u73B0\u53EA\u68C0\u67E5\u4E24\u4E2A\u5BF9\u8C61\u7684\u5BF9\u8C61\u5F15\u7528\uFF0C\u4EE5\u9A8C\u8BC1\u5B83\u4EEC\u7684\u76F8\u7B49\u6027\u3002 \u901A\u8FC7\u91CD\u5199\u8BE5\u65B9\u6CD5,\u53EF\u4EE5\u81EA\u5B9A\u4E49\u9A8C\u8BC1\u5BF9\u8C61\u76F8\u7B49\u65B0\u7684\u89C4\u5219,\u5982\u679C\u4F60\u4F7F\u7528ORM\u5904\u7406\u4E00\u4E9B\u5BF9\u8C61\u7684\u8BDD\uFF0C\u4F60\u8981\u786E\u4FDD\u5728hashCode()\u548Cequals()\u5BF9\u8C61\u4E2D\u4F7F\u7528getter\u548Csetter\u800C\u4E0D\u662F\u76F4\u63A5\u5F15\u7528\u6210\u5458\u53D8\u91CF</p><p><strong>hashCode()</strong> \u6E90\u81EA\u4E8Ejava.lang.Object ,\u8BE5\u65B9\u6CD5\u7528\u4E8E\u83B7\u53D6\u7ED9\u5B9A\u5BF9\u8C61\u7684\u552F\u4E00\u7684\u6574\u6570(\u6563\u5217\u7801)\u3002\u5F53\u8FD9\u4E2A\u5BF9\u8C61\u9700\u8981\u5B58\u50A8\u5728\u54C8\u5E0C\u8868\u8FD9\u6837\u7684\u6570\u636E\u7ED3\u6784\u65F6\uFF0C\u8FD9\u4E2A\u6574\u6570\u7528\u4E8E\u786E\u5B9A\u6876\u7684\u4F4D\u7F6E\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5BF9\u8C61\u7684hashCode() \u65B9\u6CD5\u8FD4\u56DE\u5BF9\u8C61\u6240\u5728\u5185\u5B58\u5730\u5740\u7684\u6574\u6570\u8868\u793A\u3002hashCode()\u662FHashTable\u3001HashMap\u548CHashSet\u4F7F\u7528\u7684\u3002\u9ED8\u8BA4\u7684\uFF0CObject\u7C7B\u7684hashCode()\u65B9\u6CD5\u8FD4\u56DE\u8FD9\u4E2A\u5BF9\u8C61\u5B58\u50A8\u7684\u5185\u5B58\u5730\u5740\u7684\u7F16\u53F7\u3002 hash\u6563\u5217\u7B97\u6CD5,\u4F7F\u5F97\u5728hash\u8868\u4E2D\u67E5\u627E\u4E00\u4E2A\u8BB0\u5F55\u901F\u5EA6\u53D8O(1). \u6BCF\u4E2A\u8BB0\u5F55\u90FD\u6709\u81EA\u5DF1\u7684hashcode,\u6563\u5217\u7B97\u6CD5\u6309\u7167hashcode\u628A\u8BB0\u5F55\u653E\u7F6E\u5728\u5408\u9002\u7684\u4F4D\u7F6E. \u5728\u67E5\u627E\u4E00\u4E2A\u8BB0\u5F55,\u9996\u5148\u5148\u901A\u8FC7hashcode\u5FEB\u901F\u5B9A\u4F4D\u8BB0\u5F55\u7684\u4F4D\u7F6E.\u7136\u540E\u518D\u901A\u8FC7equals\u6765\u6BD4\u8F83\u662F\u5426\u76F8\u7B49\u3002\u5982\u679Chashcode\u6CA1\u627E\u5230\uFF0C\u5219\u4E0Dequal\uFF0C\u5143\u7D20\u4E0D\u5B58\u5728\u4E8E\u54C8\u5E0C\u8868\u4E2D\uFF1B\u5373\u4F7F\u627E\u5230\u4E86\uFF0C\u4E5F\u53EA\u9700\u6267\u884Chashcode\u76F8\u540C\u7684\u51E0\u4E2A\u5143\u7D20\u7684equal\uFF0C\u5982\u679C\u4E0Dequal\uFF0C\u8FD8\u662F\u4E0D\u5B58\u5728\u54C8\u5E0C\u8868\u4E2D\u3002</p><h2 id="hashmap\u548Chashtable\u7684\u533A\u522B\u53CA\u5E95\u5C42\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#hashmap\u548Chashtable\u7684\u533A\u522B\u53CA\u5E95\u5C42\u5B9E\u73B0" aria-hidden="true">#</a> HashMap\u548CHashTable\u7684\u533A\u522B\u53CA\u5E95\u5C42\u5B9E\u73B0\`</h2><h3 id="hashmap\u548Chashtable\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#hashmap\u548Chashtable\u5BF9\u6BD4" aria-hidden="true">#</a> HashMap\u548CHashTable\u5BF9\u6BD4</h3><ol><li>HashTable\u7EBF\u7A0B\u540C\u6B65\uFF0CHashMap\u975E\u7EBF\u7A0B\u540C\u6B65\u3002</li><li>HashTable\u4E0D\u5141\u8BB8&lt;\u952E,\u503C&gt;\u6709\u7A7A\u503C\uFF0CHashMap\u5141\u8BB8&lt;\u952E,\u503C&gt;\u6709\u7A7A\u503C\u3002</li><li>HashTable\u4F7F\u7528Enumeration\uFF0CHashMap\u4F7F\u7528Iterator\u3002</li><li>HashTable\u4E2Dhash\u6570\u7EC4\u7684\u9ED8\u8BA4\u5927\u5C0F\u662F11\uFF0C\u589E\u52A0\u65B9\u5F0F\u7684old*2+1\uFF0CHashMap\u4E2Dhash\u6570\u7EC4\u7684\u9ED8\u8BA4\u5927\u5C0F\u662F16\uFF0C\u589E\u957F\u65B9\u5F0F\u662F2\u7684\u6307\u6570\u500D\u3002</li><li>HashMap jdk1.8\u4E4B\u524Dlist + \u94FE\u8868 jdk1.8\u4E4B\u540Elist + \u94FE\u8868,\u5F53\u94FE\u8868\u957F\u5EA6\u52308\u65F6\uFF0C\u8F6C\u5316\u4E3A\u7EA2\u9ED1\u6811</li><li>HashMap\u94FE\u8868\u63D2\u5165\u8282\u70B9\u7684\u65B9\u5F0F \u5728Java1.7\u4E2D\uFF0C\u63D2\u5165\u94FE\u8868\u8282\u70B9\u4F7F\u7528<strong>\u5934\u63D2\u6CD5</strong>\u3002Java1.8\u4E2D\u53D8\u6210\u4E86<strong>\u5C3E\u63D2\u6CD5</strong></li><li>Java1.8\u7684hash()\u4E2D\uFF0C\u5C06hash\u503C\u9AD8\u4F4D\uFF08\u524D16\u4F4D\uFF09\u53C2\u4E0E\u5230\u53D6\u6A21\u7684\u8FD0\u7B97\u4E2D\uFF0C\u4F7F\u5F97\u8BA1\u7B97\u7ED3\u679C\u7684\u4E0D\u786E\u5B9A\u6027\u589E\u5F3A\uFF0C\u964D\u4F4E\u53D1\u751F\u54C8\u5E0C\u78B0\u649E\u7684\u6982\u7387</li></ol><h3 id="hashmap\u6269\u5BB9\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#hashmap\u6269\u5BB9\u4F18\u5316" aria-hidden="true">#</a> HashMap\u6269\u5BB9\u4F18\u5316:</h3><p>\u6269\u5BB9\u4EE5\u540E,1.7\u5BF9\u5143\u7D20\u8FDB\u884Crehash\u7B97\u6CD5,\u8BA1\u7B97\u539F\u6765\u6BCF\u4E2A\u5143\u7D20\u5728\u6269\u5BB9\u4E4B\u540E\u7684\u54C8\u5E0C\u8868\u4E2D\u7684\u4F4D\u7F6E,1.8\u501F\u52A92\u500D\u6269\u5BB9\u673A\u5236,\u5143\u7D20\u4E0D\u9700\u8981\u8FDB\u884C\u91CD\u65B0\u8BA1\u7B97\u4F4D\u7F6E</p><p>JDK 1.8 \u5728\u6269\u5BB9\u65F6\u5E76\u6CA1\u6709\u50CF JDK 1.7 \u90A3\u6837\uFF0C\u91CD\u65B0\u8BA1\u7B97\u6BCF\u4E2A\u5143\u7D20\u7684\u54C8\u5E0C\u503C\uFF0C\u800C\u662F\u901A\u8FC7\u9AD8\u4F4D\u8FD0\u7B97**\uFF08e.hash &amp; oldCap\uFF09**\u6765\u786E\u5B9A\u5143\u7D20\u662F\u5426\u9700\u8981\u79FB\u52A8\uFF0C\u6BD4\u5982 key1 \u7684\u4FE1\u606F\u5982\u4E0B\uFF1A</p><p>\u4F7F\u7528 e.hash &amp; oldCap \u5F97\u5230\u7684\u7ED3\u679C\uFF0C\u9AD8\u4E00\u4F4D\u4E3A 0\uFF0C\u5F53\u7ED3\u679C\u4E3A 0 \u65F6\u8868\u793A\u5143\u7D20\u5728\u6269\u5BB9\u65F6\u4F4D\u7F6E\u4E0D\u4F1A\u53D1\u751F\u4EFB\u4F55\u53D8\u5316\uFF0C\u800C key 2 \u4FE1\u606F\u5982\u4E0B</p><p>\u9AD8\u4E00\u4F4D\u4E3A 1\uFF0C\u5F53\u7ED3\u679C\u4E3A 1 \u65F6\uFF0C\u8868\u793A\u5143\u7D20\u5728\u6269\u5BB9\u65F6\u4F4D\u7F6E\u53D1\u751F\u4E86\u53D8\u5316\uFF0C\u65B0\u7684\u4E0B\u6807\u4F4D\u7F6E\u7B49\u4E8E\u539F\u4E0B\u6807\u4F4D\u7F6E + \u539F\u6570\u7EC4\u957F\u5EA6<strong>hashmap,</strong> <strong>\u4E0D\u5FC5\u50CF1.7\u4E00\u6837\u5168\u90E8\u91CD\u65B0\u8BA1\u7B97\u4F4D\u7F6E</strong></p><h3 id="\u4E3A\u4EC0\u4E48hashmap\u6269\u5BB9\u7684\u65F6\u5019\u662F\u4E24\u500D" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48hashmap\u6269\u5BB9\u7684\u65F6\u5019\u662F\u4E24\u500D" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48hashmap\u6269\u5BB9\u7684\u65F6\u5019\u662F\u4E24\u500D\uFF1F</h3><p>\u67E5\u770B\u6E90\u4EE3\u7801</p><p>\u5728\u5B58\u5165\u5143\u7D20\u65F6,\u653E\u5165\u5143\u7D20\u4F4D\u7F6E\u6709\u4E00\u4E2A (n-1)&amp;hash \u7684\u4E00\u4E2A\u7B97\u6CD5,\u548Chash&amp;(newCap-1),\u8FD9\u91CC\u7528\u5230\u4E86\u4E00\u4E2A&amp;\u4F4D\u8FD0\u7B97\u7B26</p><p>\u5F53HashMap\u7684\u5BB9\u91CF\u662F16\u65F6\uFF0C\u5B83\u7684\u4E8C\u8FDB\u5236\u662F10000\uFF0C(n-1)\u7684\u4E8C\u8FDB\u5236\u662F01111\uFF0C\u4E0Ehash\u503C\u5F97\u8BA1\u7B97\u7ED3\u679C\u5982\u4E0B</p><p>\u4E0B\u9762\u5C31\u6765\u770B\u4E00\u4E0BHashMap\u7684\u5BB9\u91CF\u4E0D\u662F2\u7684n\u6B21\u5E42\u7684\u60C5\u51B5\uFF0C\u5F53\u5BB9\u91CF\u4E3A10\u65F6\uFF0C\u4E8C\u8FDB\u5236\u4E3A01010\uFF0C(n-1)\u7684\u4E8C\u8FDB\u5236\u662F01001\uFF0C\u5411\u91CC\u9762\u6DFB\u52A0\u540C\u6837\u7684\u5143\u7D20\uFF0C\u7ED3\u679C\u4E3A</p><p>\u53EF\u4EE5\u770B\u51FA\uFF0C\u6709\u4E09\u4E2A\u4E0D\u540C\u7684\u5143\u7D20\u8FDB\u8FC7&amp;\u8FD0\u7B97\u5F97\u51FA\u4E86\u540C\u6837\u7684\u7ED3\u679C\uFF0C\u4E25\u91CD\u7684hash\u78B0\u649E\u4E86</p><p>\u53EA\u6709\u5F53n\u7684\u503C\u662F2\u7684N\u6B21\u5E42\u7684\u65F6\u5019\uFF0C\u8FDB\u884C&amp;\u4F4D\u8FD0\u7B97\u7684\u65F6\u5019\uFF0C\u624D\u53EF\u4EE5\u53EA\u770B\u540E\u51E0\u4F4D\uFF0C\u800C\u4E0D\u9700\u8981\u5168\u90E8\u8FDB\u884C\u8BA1\u7B97</p><h3 id="hashmap\u7EBF\u7A0B\u5B89\u5168\u7684\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#hashmap\u7EBF\u7A0B\u5B89\u5168\u7684\u65B9\u5F0F" aria-hidden="true">#</a> hashmap\u7EBF\u7A0B\u5B89\u5168\u7684\u65B9\u5F0F\uFF1F</h3><p>HashMap\u4E0D\u662F\u7EBF\u7A0B\u5B89\u5168\u7684,\u5F80\u5F80\u5728\u5199\u7A0B\u5E8F\u65F6\u9700\u8981\u901A\u8FC7\u4E00\u4E9B\u65B9\u6CD5\u6765\u56DE\u907F.\u5176\u5B9EJDK\u539F\u751F\u7684\u63D0\u4F9B\u4E862\u79CD\u65B9\u6CD5\u8BA9HashMap\u652F\u6301\u7EBF\u7A0B\u5B89\u5168.</p><p>\u65B9\u6CD5\u4E00: \u901A\u8FC7Collections.synchronizedMap()\u8FD4\u56DE\u4E00\u4E2A\u65B0\u7684Map,\u8FD9\u4E2A\u65B0\u7684map\u5C31\u662F\u7EBF\u7A0B\u5B89\u5168\u7684. \u8FD9\u4E2A\u8981\u6C42\u5927\u5BB6\u4E60\u60EF\u57FA\u4E8E\u63A5\u53E3\u7F16\u7A0B,\u56E0\u4E3A\u8FD4\u56DE\u7684\u5E76\u4E0D\u662FHashMap,\u800C\u662F\u4E00\u4E2AMap\u7684\u5B9E\u73B0.</p><p>\u65B9\u6CD5\u4E8C: \u91CD\u65B0\u6539\u5199\u4E86HashMap,\u5177\u4F53\u7684\u53EF\u4EE5\u67E5\u770Bjava.util.concurrent.ConcurrentHashMap. \u8FD9\u4E2A\u65B9\u6CD5\u6BD4\u65B9\u6CD5\u4E00\u6709\u4E86\u5F88\u5927\u7684\u6539\u8FDB.</p><p>\u65B9\u6CD5\u4E00\u7279\u70B9:</p><p>\u901A\u8FC7Collections.synchronizedMap()\u6765\u5C01\u88C5\u6240\u6709\u4E0D\u5B89\u5168\u7684HashMap\u7684\u65B9\u6CD5,\u5C31\u8FDEtoString, hashCode\u90FD\u8FDB\u884C\u4E86\u5C01\u88C5. \u5C01\u88C5\u7684\u5173\u952E\u70B9\u67092\u5904,1)\u4F7F\u7528\u4E86\u7ECF\u5178\u7684synchronized\u6765\u8FDB\u884C\u4E92\u65A5, 2) \u4F7F\u7528\u4E86\u4EE3\u7406\u6A21\u5F0Fnew\u4E86\u4E00\u4E2A\u65B0\u7684\u7C7B,\u8FD9\u4E2A\u7C7B\u540C\u6837\u5B9E\u73B0\u4E86Map\u63A5\u53E3. \u5728Hashmap\u4E0A\u9762,synchronized\u9501\u4F4F\u7684\u662F\u5BF9\u8C61,\u6240\u4EE5\u7B2C\u4E00\u4E2A\u7533\u8BF7\u7684\u5F97\u5230\u9501,\u5176\u4ED6\u7EBF\u7A0B\u5C06\u8FDB\u5165\u963B\u585E,\u7B49\u5F85\u5524\u9192. \u4F18\u70B9:\u4EE3\u7801\u5B9E\u73B0\u5341\u5206\u7B80\u5355,\u4E00\u770B\u5C31\u61C2.\u7F3A\u70B9: \u4ECE\u9501\u7684\u89D2\u5EA6\u6765\u770B,\u65B9\u6CD5\u4E00\u76F4\u63A5\u4F7F\u7528\u4E86\u9501\u4F4F\u65B9\u6CD5,\u57FA\u672C\u4E0A\u662F\u9501\u4F4F\u4E86\u5C3D\u53EF\u80FD\u5927\u7684\u4EE3\u7801\u5757.\u6027\u80FD\u4F1A\u6BD4\u8F83\u5DEE.</p><p>\u65B9\u6CD5\u4E8C\u7279\u70B9:</p><p>\u91CD\u65B0\u5199\u4E86HashMap,\u6BD4\u8F83\u5927\u7684\u6539\u53D8\u6709\u5982\u4E0B\u51E0\u70B9.\u4F7F\u7528\u4E86\u65B0\u7684\u9501\u673A\u5236,\u628AHashMap\u8FDB\u884C\u4E86\u62C6\u5206,\u62C6\u5206\u6210\u4E86\u591A\u4E2A\u72EC\u7ACB\u7684\u5757,\u8FD9\u6837\u5728\u9AD8\u5E76\u53D1\u7684\u60C5\u51B5\u4E0B\u51CF\u5C11\u4E86\u9501\u51B2\u7A81\u7684\u53EF\u80FD,\u4F7F\u7528\u7684\u662FNonfairSync. \u8FD9\u4E2A\u7279\u6027\u8C03\u7528CAS\u6307\u4EE4\u6765\u786E\u4FDD\u539F\u5B50\u6027\u4E0E\u4E92\u65A5\u6027.\u5F53\u5982\u679C\u591A\u4E2A\u7EBF\u7A0B\u6070\u597D\u64CD\u4F5C\u5230\u540C\u4E00\u4E2Asegment\u4E0A\u9762,\u90A3\u4E48\u53EA\u4F1A\u6709\u4E00\u4E2A\u7EBF\u7A0B\u5F97\u5230\u8FD0\u884C.</p><p>\u4F18\u70B9:</p><p>\u9700\u8981\u4E92\u65A5\u7684\u4EE3\u7801\u6BB5\u6BD4\u8F83\u5C11,\u6027\u80FD\u4F1A\u6BD4\u8F83\u597D. ConcurrentHashMap\u628A\u6574\u4E2AMap\u5207\u5206\u6210\u4E86\u591A\u4E2A\u5757,\u53D1\u751F\u9501\u78B0\u649E\u7684\u51E0\u7387\u5927\u5927\u964D\u4F4E,\u6027\u80FD\u4F1A\u6BD4\u8F83\u597D. \u7F3A\u70B9:\u4EE3\u7801\u7E41\u7410</p><h2 id="java\u5F02\u5E38\u5904\u7406\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#java\u5F02\u5E38\u5904\u7406\u65B9\u5F0F" aria-hidden="true">#</a> Java\u5F02\u5E38\u5904\u7406\u65B9\u5F0F</h2><p>Java \u901A\u8FC7\u9762\u5411\u5BF9\u8C61\u7684\u65B9\u6CD5\u8FDB\u884C\u5F02\u5E38\u5904\u7406\uFF0C\u4E00\u65E6\u65B9\u6CD5\u629B\u51FA\u5F02\u5E38\uFF0C\u7CFB\u7EDF\u81EA\u52A8\u6839\u636E\u8BE5\u5F02\u5E38\u5BF9\u8C61\u5BFB\u627E\u5408\u9002\u5F02\u5E38\u5904\u7406\u5668\uFF08Exception Handler\uFF09\u6765\u5904\u7406\u8BE5\u5F02\u5E38\uFF0C\u628A\u5404\u79CD\u4E0D\u540C\u7684\u5F02\u5E38\u8FDB\u884C\u5206\u7C7B\uFF0C\u5E76\u63D0\u4F9B\u4E86\u826F\u597D\u7684\u63A5\u53E3\u3002\u5728 Java \u4E2D\uFF0C\u6BCF\u4E2A\u5F02\u5E38\u90FD\u662F\u4E00\u4E2A\u5BF9</p><p>\u8C61\uFF0C\u5B83\u662F Throwable \u7C7B\u6216\u5176\u5B50\u7C7B\u7684\u5B9E\u4F8B\u3002\u5F53\u4E00\u4E2A\u65B9\u6CD5\u51FA\u73B0\u5F02\u5E38\u540E\u4FBF\u629B\u51FA\u4E00\u4E2A\u5F02\u5E38\u5BF9\u8C61\uFF0C\u8BE5\u5BF9\u8C61\u4E2D\u5305\u542B\u6709\u5F02\u5E38\u4FE1\u606F\uFF0C\u8C03\u7528\u8FD9\u4E2A\u5BF9\u8C61\u7684\u65B9\u6CD5\u53EF\u4EE5\u6355\u83B7\u5230\u8FD9\u4E2A\u5F02\u5E38\u5E76\u53EF\u4EE5\u5BF9\u5176\u8FDB\u884C\u5904\u7406\u3002Java \u7684\u5F02\u5E38\u5904\u7406\u662F\u901A\u8FC7 5 \u4E2A\u5173\u952E\u8BCD\u6765\u5B9E\u73B0\u7684\uFF1Atry\u3001 catch\u3001throw\u3001throws \u548C finally\u3002</p><p>\u5728Java\u5E94\u7528\u4E2D\uFF0C\u5F02\u5E38\u7684\u5904\u7406\u673A\u5236\u5206\u4E3A\u58F0\u660E\u5F02\u5E38\uFF0C\u629B\u51FA\u5F02\u5E38\u548C\u6355\u83B7\u5F02\u5E38\u3002</p><h3 id="throw\u548Cthrows\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#throw\u548Cthrows\u7684\u533A\u522B" aria-hidden="true">#</a> throw\u548Cthrows\u7684\u533A\u522B</h3><ol><li><p>\u4F4D\u7F6E\u4E0D\u540C\uFF1A throw\uFF1A\u65B9\u6CD5\u5185\u90E8 throws: \u65B9\u6CD5\u7684\u7B7E\u540D\u5904\uFF0C\u65B9\u6CD5\u7684\u58F0\u660E\u5904</p></li><li><p>\u5185\u5BB9\u4E0D\u540C\uFF1A throw+\u5F02\u5E38\u5BF9\u8C61\uFF08\u68C0\u67E5\u5F02\u5E38\uFF0C\u8FD0\u884C\u65F6\u5F02\u5E38\uFF09 throws+\u5F02\u5E38\u7684\u7C7B\u578B\uFF08\u53EF\u4EE5\u591A\u4E2A\u7C7B\u578B\uFF0C\u7528\uFF0C\u62FC\u63A5\uFF09</p></li><li><p>\u4F5C\u7528\u4E0D\u540C\uFF1A throw\uFF1A\u5F02\u5E38\u51FA\u73B0\u7684\u6E90\u5934\uFF0C\u5236\u9020\u5F02\u5E38\u3002 throws:\u5728\u65B9\u6CD5\u7684\u58F0\u660E\u5904\uFF0C\u544A\u8BC9\u65B9\u6CD5\u7684\u8C03\u7528\u8005\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u4E2D\u53EF\u80FD\u4F1A\u51FA\u73B0\u6211\u58F0\u660E\u7684\u8FD9\u4E9B\u5F02\u5E38\u3002\u7136\u540E\u8C03\u7528\u8005\u5BF9\u8FD9\u4E2A\u5F02\u5E38\u8FDB\u884C\u5904\u7406\uFF1A \u8981\u4E48\u81EA\u5DF1\u5904\u7406\u8981\u4E48\u518D\u7EE7\u7EED\u5411\u5916\u629B\u51FA\u5F02\u5E38</p></li></ol><h3 id="_1-throws\u58F0\u660E\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#_1-throws\u58F0\u660E\u5F02\u5E38" aria-hidden="true">#</a> 1.throws\u58F0\u660E\u5F02\u5E38</h3><p>\u901A\u5E38\uFF0C\u5E94\u8BE5\u6355\u83B7\u90A3\u4E9B\u77E5\u9053\u5982\u4F55\u5904\u7406\u7684\u5F02\u5E38\uFF0C\u5C06\u4E0D\u77E5\u9053\u5982\u4F55\u5904\u7406\u7684\u5F02\u5E38\u7EE7\u7EED\u4F20\u9012\u4E0B\u53BB\u3002\u4F20\u9012\u5F02\u5E38\u53EF\u4EE5\u5728\u65B9\u6CD5\u7B7E\u540D\u5904\u4F7F\u7528 throws \u5173\u952E\u5B57\u58F0\u660E\u53EF\u80FD\u4F1A\u629B\u51FA\u7684\u5F02\u5E38\u3002</p><p>\u6CE8\u610F<strong>\u975E\u68C0\u67E5\u5F02\u5E38</strong>\uFF08Error\u3001RuntimeException \u6216\u5B83\u4EEC\u7684\u5B50\u7C7B\uFF09\u4E0D\u53EF\u4F7F\u7528 throws \u5173\u952E\u5B57\u6765\u58F0\u660E\u8981\u629B\u51FA\u7684\u5F02\u5E38\u3002</p><p>\u4E00\u4E2A\u65B9\u6CD5\u51FA\u73B0\u7F16\u8BD1\u65F6\u5F02\u5E38\uFF0C\u5C31\u9700\u8981 try-catch/ throws \u5904\u7406\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u7F16\u8BD1\u9519\u8BEF</p><h3 id="_2-throw\u629B\u51FA\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#_2-throw\u629B\u51FA\u5F02\u5E38" aria-hidden="true">#</a> 2.throw\u629B\u51FA\u5F02\u5E38</h3><p>\u5982\u679C\u4F60\u89C9\u5F97\u89E3\u51B3\u4E0D\u4E86\u67D0\u4E9B\u5F02\u5E38\u95EE\u9898\uFF0C\u4E14\u4E0D\u9700\u8981\u8C03\u7528\u8005\u5904\u7406\uFF0C\u90A3\u4E48\u4F60\u53EF\u4EE5\u629B\u51FA\u5F02\u5E38\u3002 throw\u5173\u952E\u5B57\u4F5C\u7528\u662F\u5728\u65B9\u6CD5\u5185\u90E8\u629B\u51FA\u4E00\u4E2AThrowable\u7C7B\u578B\u7684\u5F02\u5E38\u3002\u4EFB\u4F55Java\u4EE3\u7801\u90FD\u53EF\u4EE5\u901A\u8FC7throw\u8BED\u53E5\u629B\u51FA\u5F02\u5E38\u3002</p><h3 id="_3-trycatch\u6355\u83B7\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#_3-trycatch\u6355\u83B7\u5F02\u5E38" aria-hidden="true">#</a> 3.trycatch\u6355\u83B7\u5F02\u5E38</h3><p>\u7A0B\u5E8F\u901A\u5E38\u5728\u8FD0\u884C\u4E4B\u524D\u4E0D\u62A5\u9519\uFF0C\u4F46\u662F\u8FD0\u884C\u540E\u53EF\u80FD\u4F1A\u51FA\u73B0\u67D0\u4E9B\u672A\u77E5\u7684\u9519\u8BEF\uFF0C\u4F46\u662F\u8FD8\u4E0D\u60F3\u76F4\u63A5\u629B\u51FA\u5230\u4E0A\u4E00\u7EA7\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u901A\u8FC7try\u2026catch\u2026\u7684\u5F62\u5F0F\u8FDB\u884C\u5F02\u5E38\u6355\u83B7\uFF0C\u4E4B\u540E\u6839\u636E\u4E0D\u540C\u7684\u5F02\u5E38\u60C5\u51B5\u6765\u8FDB\u884C\u76F8\u5E94\u7684\u5904\u7406\u3002\u5982\u4F55\u9009\u62E9\u5F02\u5E38\u7C7B\u578B</p><p>\u53EF\u4EE5\u6839\u636E\u4E0B\u56FE\u6765\u9009\u62E9\u662F\u6355\u83B7\u5F02\u5E38\uFF0C\u58F0\u660E\u5F02\u5E38\u8FD8\u662F\u629B\u51FA\u5F02\u5E38</p><h2 id="\u81EA\u5B9A\u4E49\u5F02\u5E38\u5728\u751F\u4EA7\u4E2D\u5982\u4F55\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u5F02\u5E38\u5728\u751F\u4EA7\u4E2D\u5982\u4F55\u5E94\u7528" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u5F02\u5E38\u5728\u751F\u4EA7\u4E2D\u5982\u4F55\u5E94\u7528</h2><p>Java\u867D\u7136\u63D0\u4F9B\u4E86\u4E30\u5BCC\u7684\u5F02\u5E38\u5904\u7406\u7C7B\uFF0C\u4F46\u662F\u5728\u9879\u76EE\u4E2D\u8FD8\u4F1A\u7ECF\u5E38\u4F7F\u7528\u81EA\u5B9A\u4E49\u5F02\u5E38\uFF0C\u5176\u4E3B\u8981\u539F\u56E0\u662FJava\u63D0\u4F9B\u7684\u5F02\u5E38\u7C7B\u5728\u67D0\u4E9B\u60C5\u51B5\u4E0B\u8FD8\u662F\u4E0D\u80FD\u6EE1\u8DB3\u5B9E\u9645\u9700\u7403\u3002\u4F8B\u5982\u4EE5\u4E0B\u60C5\u51B5\uFF1A</p><p>1\u3001\u7CFB\u7EDF\u4E2D\u6709\u4E9B\u9519\u8BEF\u662F\u7B26\u5408Java\u8BED\u6CD5\uFF0C\u4F46\u4E0D\u7B26\u5408\u4E1A\u52A1\u903B\u8F91\u3002</p><p>2\u3001\u5728\u5206\u5C42\u7684\u8F6F\u4EF6\u7ED3\u6784\u4E2D\uFF0C\u901A\u5E38\u662F\u5728\u8868\u73B0\u5C42\u7EDF\u4E00\u5BF9\u7CFB\u7EDF\u5176\u4ED6\u5C42\u6B21\u7684\u5F02\u5E38\u8FDB\u884C\u6355\u83B7\u5904\u7406\u3002</p><h2 id="\u5982\u4F55\u5B9E\u73B0\u4E00\u4E2Aioc\u5BB9\u5668" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u5B9E\u73B0\u4E00\u4E2Aioc\u5BB9\u5668" aria-hidden="true">#</a> \u5982\u4F55\u5B9E\u73B0\u4E00\u4E2AIOC\u5BB9\u5668?</h2><p>IOC(Inversion of Control),\u610F\u601D\u662F\u63A7\u5236\u53CD\u8F6C\uFF0C\u4E0D\u662F\u4EC0\u4E48\u6280\u672F\uFF0C\u800C\u662F\u4E00\u79CD\u8BBE\u8BA1\u601D\u60F3\uFF0CIOC\u610F\u5473\u7740\u5C06\u4F60\u8BBE\u8BA1\u597D\u7684\u5BF9\u8C61\u4EA4\u7ED9\u5BB9\u5668\u63A7\u5236\uFF0C\u800C\u4E0D\u662F\u4F20\u7EDF\u7684\u5728\u4F60\u7684\u5BF9\u8C61\u5185\u90E8\u76F4\u63A5\u63A7\u5236\u3002</p><p>\u5728\u4F20\u7EDF\u7684\u7A0B\u5E8F\u8BBE\u8BA1\u4E2D\uFF0C\u6211\u4EEC\u76F4\u63A5\u5728\u5BF9\u8C61\u5185\u90E8\u901A\u8FC7new\u8FDB\u884C\u5BF9\u8C61\u521B\u5EFA\uFF0C\u662F\u7A0B\u5E8F\u4E3B\u52A8\u53BB\u521B\u5EFA\u4F9D\u8D56\u5BF9\u8C61\uFF0C\u800CIOC\u662F\u6709\u4E13\u95E8\u7684\u5BB9\u5668\u6765\u8FDB\u884C\u5BF9\u8C61\u7684\u521B\u5EFA\uFF0C\u5373IOC\u5BB9\u5668\u6765\u63A7\u5236\u5BF9\u8C61\u7684\u521B\u5EFA\u3002</p><p>\u5728\u4F20\u7EDF\u7684\u5E94\u7528\u7A0B\u5E8F\u4E2D\uFF0C\u6211\u4EEC\u662F\u5728\u5BF9\u8C61\u4E2D\u4E3B\u52A8\u63A7\u5236\u53BB\u76F4\u63A5\u83B7\u53D6\u4F9D\u8D56\u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u662F\u6B63\u8F6C\uFF0C\u53CD\u8F6C\u662F\u7531\u5BB9\u5668\u6765\u5E2E\u5FD9\u521B\u5EFA\u53CA\u6CE8\u5165\u4F9D\u8D56\u5BF9\u8C61\uFF0C\u5728\u8FD9\u4E2A\u8FC7\u7A0B\u8FC7\u7A0B\u4E2D\uFF0C\u7531\u5BB9\u5668\u5E2E\u6211\u4EEC\u67E5\u627E\u7EA7\u6CE8\u5165\u4F9D\u8D56\u5BF9\u8C61\uFF0C\u5BF9\u8C61\u53EA\u662F\u88AB\u52A8\u7684\u63A5\u53D7\u4F9D\u8D56\u5BF9\u8C61\u3002</p><p>1\u3001\u5148\u51C6\u5907\u4E00\u4E2A\u57FA\u672C\u7684\u5BB9\u5668\u5BF9\u8C61\uFF0C\u5305\u542B\u4E00\u4E9Bmap\u7ED3\u6784\u7684\u96C6\u5408\uFF0C\u7528\u6765\u65B9\u4FBF\u540E\u7EED\u8FC7\u7A0B\u4E2D\u5B58\u50A8\u5177\u4F53\u7684\u5BF9\u8C61</p><p>2\u3001\u8FDB\u884C\u914D\u7F6E\u6587\u4EF6\u7684\u8BFB\u53D6\u5DE5\u4F5C\u6216\u8005\u6CE8\u89E3\u7684\u89E3\u6790\u5DE5\u4F5C\uFF0C\u5C06\u9700\u8981\u521B\u5EFA\u7684bean\u5BF9\u8C61\u90FD\u5C01\u88C5\u6210BeanDefinition\u5BF9\u8C61\u5B58\u50A8\u5728\u5BB9\u5668\u4E2D</p><p>3\u3001\u5BB9\u5668\u5C06\u5C01\u88C5\u597D\u7684BeanDefinition\u5BF9\u8C61\u901A\u8FC7\u53CD\u5C04\u7684\u65B9\u5F0F\u8FDB\u884C\u5B9E\u4F8B\u5316\uFF0C\u5B8C\u6210\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316\u5DE5\u4F5C</p><p>4\u3001\u8FDB\u884C\u5BF9\u8C61\u7684\u521D\u59CB\u5316\u64CD\u4F5C\uFF0C\u4E5F\u5C31\u662F\u7ED9\u7C7B\u4E2D\u7684\u5BF9\u5E94\u5C5E\u6027\u503C\u5C31\u884C\u8BBE\u7F6E\uFF0C\u4E5F\u5C31\u662F\u8FDB\u884C\u4F9D\u8D56\u6CE8\u5165\uFF0C\u5B8C\u6210\u6574\u4E2A\u5BF9\u8C61\u7684\u521B\u5EFA\uFF0C\u53D8\u6210\u4E00\u4E2A\u5B8C\u6574\u7684bean\u5BF9\u8C61\uFF0C\u5B58\u50A8\u5728\u5BB9\u5668\u7684\u67D0\u4E2Amap\u7ED3\u6784\u4E2D</p><p>5\u3001\u901A\u8FC7\u5BB9\u5668\u5BF9\u8C61\u6765\u83B7\u53D6\u5BF9\u8C61\uFF0C\u8FDB\u884C\u5BF9\u8C61\u7684\u83B7\u53D6\u548C\u903B\u8F91\u5904\u7406\u5DE5\u4F5C</p><p>6\u3001\u63D0\u4F9B\u9500\u6BC1\u64CD\u4F5C\uFF0C\u5F53\u5BF9\u8C61\u4E0D\u7528\u6216\u8005\u5BB9\u5668\u5173\u95ED\u7684\u65F6\u5019\uFF0C\u5C06\u65E0\u7528\u7684\u5BF9\u8C61\u8FDB\u884C\u9500\u6BC1</p><h2 id="\u8BF4\u8BF4\u4F60\u5BF9spring-\u7684\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u8BF4\u8BF4\u4F60\u5BF9spring-\u7684\u7406\u89E3" aria-hidden="true">#</a> \u8BF4\u8BF4\u4F60\u5BF9Spring \u7684\u7406\u89E3\uFF1F</h2><a href="https://spring.io/projects/spring-framework#overview"> \u5B98\u7F51\u5730\u5740: https://spring.io/projects/spring-framework#overview</a><a href="https://repo.spring.io/release/org/springframework/spring/"> \u538B\u7F29\u5305\u4E0B\u8F7D\u5730\u5740\uFF1Ahttps://repo.spring.io/release/org/springframework/spring/</a><a href="https://github.com/spring-projects/spring-framework"> \u6E90\u7801\u5730\u5740\uFF1Ahttps://github.com/spring-projects/spring-framework</a><blockquote><p>Spring makes it easy to create Java enterprise applications. It provides everything you need to embrace the Java language in an enterprise environment, with support for Groovy and Kotlin as alternative languages on the JVM, and with the flexibility to create many kinds of architectures depending on an application\u2019s needs. As of Spring Framework 5.1, Spring requires JDK 8+ (Java SE 8+) and provides out-of-the-box support for JDK 11 LTS. Java SE 8 update 60 is suggested as the minimum patch release for Java 8, but it is generally recommended to use a recent patch release.</p><p>Spring supports a wide range of application scenarios. In a large enterprise, applications often exist for a long time and have to run on a JDK and application server whose upgrade cycle is beyond developer control. Others may run as a single jar with the server embedded, possibly in a cloud environment. Yet others may be standalone applications (such as batch or integration workloads) that do not need a server.</p><p>Spring is open source. It has a large and active community that provides continuous feedback based on a diverse range of real-world use cases. This has helped Spring to successfully evolve over a very long time.</p><p>Spring \u4F7F\u521B\u5EFA Java \u4F01\u4E1A\u5E94\u7528\u7A0B\u5E8F\u53D8\u5F97\u66F4\u52A0\u5BB9\u6613\u3002\u5B83\u63D0\u4F9B\u4E86\u5728\u4F01\u4E1A\u73AF\u5883\u4E2D\u63A5\u53D7 Java \u8BED\u8A00\u6240\u9700\u7684\u4E00\u5207,\uFF0C\u5E76\u652F\u6301 Groovy \u548C Kotlin \u4F5C\u4E3A JVM \u4E0A\u7684\u66FF\u4EE3\u8BED\u8A00\uFF0C\u5E76\u53EF\u6839\u636E\u5E94\u7528\u7A0B\u5E8F \u7684\u9700\u8981\u7075\u6D3B\u5730\u521B\u5EFA\u591A\u79CD\u4F53\u7CFB\u7ED3\u6784\u3002 \u4ECE Spring Framework 5.0 \u5F00\u59CB\uFF0CSpring \u9700\u8981 JDK 8(Java SE 8+)\uFF0C\u5E76\u4E14\u5DF2\u7ECF\u4E3A JDK 9 \u63D0\u4F9B\u4E86\u73B0\u6210\u7684\u652F\u6301\u3002</p><p>Spring\u652F\u6301\u5404\u79CD\u5E94\u7528\u573A\u666F\uFF0C \u5728\u5927\u578B\u4F01\u4E1A\u4E2D, \u5E94\u7528\u7A0B\u5E8F\u901A\u5E38\u9700\u8981\u8FD0\u884C\u5F88\u957F\u65F6\u95F4\uFF0C\u800C\u4E14\u5FC5\u987B\u8FD0\u884C\u5728 jdk \u548C\u5E94\u7528\u670D\u52A1\u5668\u4E0A\uFF0C\u8FD9\u79CD\u573A\u666F\u5F00\u53D1\u4EBA\u5458\u65E0\u6CD5\u63A7\u5236\u5176\u5347\u7EA7\u5468\u671F\u3002 \u5176\u4ED6\u53EF\u80FD\u4F5C\u4E3A\u4E00\u4E2A\u5355\u72EC\u7684jar\u5D4C\u5165\u5230\u670D\u52A1\u5668\u53BB\u8FD0\u884C\uFF0C \u4E5F\u6709\u53EF\u80FD\u5728\u4E91\u73AF\u5883\u4E2D\u3002\u8FD8\u6709\u4E00\u4E9B\u53EF\u80FD\u662F\u4E0D\u9700\u8981\u670D\u52A1\u5668\u7684\u72EC\u7ACB\u5E94\u7528\u7A0B\u5E8F(\u5982\u6279\u5904\u7406\u6216\u96C6\u6210\u7684\u5DE5\u4F5C\u4EFB\u52A1)\u3002</p><p>Spring \u662F\u5F00\u6E90\u7684\u3002\u5B83\u62E5\u6709\u4E00\u4E2A\u5E9E\u5927\u800C\u4E14\u6D3B\u8DC3\u7684\u793E\u533A\uFF0C\u63D0\u4F9B\u4E0D\u540C\u8303\u56F4\u7684\uFF0C\u771F\u5B9E\u7528\u6237\u7684\u6301\u7EED\u53CD\u9988\u3002\u8FD9\u4E5F\u5E2E\u52A9Spring\u4E0D\u65AD\u5730\u6539\u8FDB,\u4E0D\u65AD\u53D1\u5C55\u3002</p></blockquote><h2 id="\u4F60\u89C9\u5F97spring\u7684\u6838\u5FC3\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u4F60\u89C9\u5F97spring\u7684\u6838\u5FC3\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u4F60\u89C9\u5F97Spring\u7684\u6838\u5FC3\u662F\u4EC0\u4E48\uFF1F</h2><p>spring\u662F\u4E00\u4E2A\u5F00\u6E90\u6846\u67B6\u3002</p><p>spring\u662F\u4E3A\u4E86\u7B80\u5316\u4F01\u4E1A\u5F00\u53D1\u800C\u751F\u7684\uFF0C\u4F7F\u5F97\u5F00\u53D1\u53D8\u5F97\u66F4\u52A0\u4F18\u96C5\u548C\u7B80\u6D01\u3002</p><p>spring\u662F\u4E00\u4E2A<strong>IOC</strong>\u548C<strong>AOP</strong>\u7684\u5BB9\u5668\u6846\u67B6\u3002</p><ol><li>IOC\uFF1A\u63A7\u5236\u53CD\u8F6C</li><li>AOP\uFF1A\u9762\u5411\u5207\u9762\u7F16\u7A0B</li><li>\u5BB9\u5668\uFF1A\u5305\u542B\u5E76\u7BA1\u7406\u5E94\u7528\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\uFF0C\u5C31\u597D\u6BD4\u7528\u6876\u88C5\u6C34\u4E00\u6837\uFF0Cspring\u5C31\u662F\u6876\uFF0C\u800C\u5BF9\u8C61\u5C31\u662F\u6C34</li></ol><h2 id="\u8BF4\u4E00\u4E0B\u4F7F\u7528spring\u7684\u4F18\u52BF" tabindex="-1"><a class="header-anchor" href="#\u8BF4\u4E00\u4E0B\u4F7F\u7528spring\u7684\u4F18\u52BF" aria-hidden="true">#</a> \u8BF4\u4E00\u4E0B\u4F7F\u7528spring\u7684\u4F18\u52BF\uFF1F</h2><ol><li>Spring\u901A\u8FC7DI\u3001AOP\u548C\u6D88\u9664\u6837\u677F\u5F0F\u4EE3\u7801\u6765\u7B80\u5316\u4F01\u4E1A\u7EA7Java\u5F00\u53D1</li><li>Spring\u6846\u67B6\u4E4B\u5916\u8FD8\u5B58\u5728\u4E00\u4E2A\u6784\u5EFA\u5728\u6838\u5FC3\u6846\u67B6\u4E4B\u4E0A\u7684\u5E9E\u5927\u751F\u6001\u5708\uFF0C\u5B83\u5C06Spring\u6269\u5C55\u5230\u4E0D\u540C\u7684\u9886\u57DF\uFF0C\u5982Web\u670D\u52A1\u3001REST\u3001\u79FB\u52A8\u5F00\u53D1\u4EE5\u53CANoSQL</li><li>\u4F4E\u4FB5\u5165\u5F0F\u8BBE\u8BA1\uFF0C\u4EE3\u7801\u7684\u6C61\u67D3\u6781\u4F4E</li><li>\u72EC\u7ACB\u4E8E\u5404\u79CD\u5E94\u7528\u670D\u52A1\u5668\uFF0C\u57FA\u4E8ESpring\u6846\u67B6\u7684\u5E94\u7528\uFF0C\u53EF\u4EE5\u771F\u6B63\u5B9E\u73B0Write Once,Run Anywhere\u7684\u627F\u8BFA</li><li>Spring\u7684IoC\u5BB9\u5668\u964D\u4F4E\u4E86\u4E1A\u52A1\u5BF9\u8C61\u66FF\u6362\u7684\u590D\u6742\u6027\uFF0C\u63D0\u9AD8\u4E86\u7EC4\u4EF6\u4E4B\u95F4\u7684\u89E3\u8026</li><li>Spring\u7684AOP\u652F\u6301\u5141\u8BB8\u5C06\u4E00\u4E9B\u901A\u7528\u4EFB\u52A1\u5982\u5B89\u5168\u3001\u4E8B\u52A1\u3001\u65E5\u5FD7\u7B49\u8FDB\u884C\u96C6\u4E2D\u5F0F\u5904\u7406\uFF0C\u4ECE\u800C\u63D0\u4F9B\u4E86\u66F4\u597D\u7684\u590D\u7528</li><li>Spring\u7684ORM\u548CDAO\u63D0\u4F9B\u4E86\u4E0E\u7B2C\u4E09\u65B9\u6301\u4E45\u5C42\u6846\u67B6\u7684\u7684\u826F\u597D\u6574\u5408\uFF0C\u5E76\u7B80\u5316\u4E86\u5E95\u5C42\u7684\u6570\u636E\u5E93\u8BBF\u95EE</li><li>Spring\u7684\u9AD8\u5EA6\u5F00\u653E\u6027\uFF0C\u5E76\u4E0D\u5F3A\u5236\u5E94\u7528\u5B8C\u5168\u4F9D\u8D56\u4E8ESpring\uFF0C\u5F00\u53D1\u8005\u53EF\u81EA\u7531\u9009\u7528Spring\u6846\u67B6\u7684\u90E8\u5206\u6216\u5168\u90E8</li></ol><h2 id="spring\u662F\u5982\u4F55\u7B80\u5316\u5F00\u53D1\u7684" tabindex="-1"><a class="header-anchor" href="#spring\u662F\u5982\u4F55\u7B80\u5316\u5F00\u53D1\u7684" aria-hidden="true">#</a> Spring\u662F\u5982\u4F55\u7B80\u5316\u5F00\u53D1\u7684\uFF1F</h2><ol><li>\u57FA\u4E8EPOJO\u7684\u8F7B\u91CF\u7EA7\u548C\u6700\u5C0F\u4FB5\u5165\u6027\u7F16\u7A0B</li><li>\u901A\u8FC7\u4F9D\u8D56\u6CE8\u5165\u548C\u9762\u5411\u63A5\u53E3\u5B9E\u73B0\u677E\u8026\u5408</li><li>\u57FA\u4E8E\u5207\u9762\u548C\u60EF\u4F8B\u8FDB\u884C\u58F0\u660E\u5F0F\u7F16\u7A0B</li><li>\u901A\u8FC7\u5207\u9762\u548C\u6A21\u677F\u51CF\u5C11\u6837\u677F\u5F0F\u4EE3\u7801</li></ol><h2 id="\u8BF4\u8BF4\u4F60\u5BF9aop\u7684\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u8BF4\u8BF4\u4F60\u5BF9aop\u7684\u7406\u89E3" aria-hidden="true">#</a> \u8BF4\u8BF4\u4F60\u5BF9Aop\u7684\u7406\u89E3\uFF1F</h2><p>AOP\u5168\u79F0\u53EB\u505A Aspect Oriented Programming \u9762\u5411\u5207\u9762\u7F16\u7A0B\u3002\u5B83\u662F\u4E3A\u89E3\u8026\u800C\u751F\u7684\uFF0C\u89E3\u8026\u662F\u7A0B\u5E8F\u5458\u7F16\u7801\u5F00\u53D1\u8FC7\u7A0B\u4E2D\u4E00\u76F4\u8FFD\u6C42\u7684\u5883\u754C\uFF0CAOP\u5728\u4E1A\u52A1\u7C7B\u7684\u9694\u79BB\u4E0A\uFF0C\u7EDD\u5BF9\u662F\u505A\u5230\u4E86\u89E3\u8026\uFF0C\u5728\u8FD9\u91CC\u9762\u6709\u51E0\u4E2A\u6838\u5FC3\u7684\u6982\u5FF5\uFF1A</p><ul><li><p>\u5207\u9762\uFF08Aspect\uFF09: \u6307\u5173\u6CE8\u70B9\u6A21\u5757\u5316\uFF0C\u8FD9\u4E2A\u5173\u6CE8\u70B9\u53EF\u80FD\u4F1A\u6A2A\u5207\u591A\u4E2A\u5BF9\u8C61\u3002\u4E8B\u52A1\u7BA1\u7406\u662F\u4F01\u4E1A\u7EA7Java\u5E94\u7528\u4E2D\u6709\u5173\u6A2A\u5207\u5173\u6CE8\u70B9\u7684\u4F8B\u5B50\u3002 \u5728Spring AOP\u4E2D\uFF0C\u5207\u9762\u53EF\u4EE5\u4F7F\u7528\u901A\u7528\u7C7B\u57FA\u4E8E\u6A21\u5F0F\u7684\u65B9\u5F0F\uFF08schema-based approach\uFF09 \u6216\u8005\u5728\u666E\u901A\u7C7B\u4E2D\u4EE5<code>@Aspect</code>\u6CE8\u89E3\uFF08@AspectJ \u6CE8\u89E3\u65B9\u5F0F\uFF09\u6765\u5B9E\u73B0\u3002</p></li><li><p>\u8FDE\u63A5\u70B9\uFF08Join point\uFF09: \u5728\u7A0B\u5E8F\u6267\u884C\u8FC7\u7A0B\u4E2D\u67D0\u4E2A\u7279\u5B9A\u7684\u70B9\uFF0C\u4F8B\u5982\u67D0\u4E2A\u65B9\u6CD5\u8C03\u7528\u7684\u65F6\u95F4\u70B9\u6216\u8005\u5904\u7406\u5F02\u5E38\u7684\u65F6\u95F4\u70B9\u3002\u5728Spring AOP\u4E2D\uFF0C\u4E00\u4E2A\u8FDE\u63A5\u70B9\u603B\u662F\u4EE3\u8868\u4E00\u4E2A\u65B9\u6CD5\u7684\u6267\u884C\u3002</p></li><li><p>\u901A\u77E5\uFF08Advice\uFF09: \u5728\u5207\u9762\u7684\u67D0\u4E2A\u7279\u5B9A\u7684\u8FDE\u63A5\u70B9\u4E0A\u6267\u884C\u7684\u52A8\u4F5C\u3002\u901A\u77E5\u6709\u591A\u79CD\u7C7B\u578B\uFF0C\u5305\u62EC\u201Caround\u201D, \u201Cbefore\u201D and \u201Cafter\u201D\u7B49\u7B49\u3002\u901A\u77E5\u7684\u7C7B\u578B\u5C06\u5728\u540E\u9762\u7684\u7AE0\u8282\u8FDB\u884C\u8BA8\u8BBA\u3002 \u8BB8\u591AAOP\u6846\u67B6\uFF0C\u5305\u62ECSpring\u5728\u5185\uFF0C \u90FD\u662F\u4EE5\u62E6\u622A\u5668\u505A\u901A\u77E5\u6A21\u578B\u7684\uFF0C\u5E76\u7EF4\u62A4\u7740\u4E00\u4E2A\u4EE5\u8FDE\u63A5\u70B9\u4E3A\u4E2D\u5FC3\u7684\u62E6\u622A\u5668\u94FE\u3002</p></li><li><p>\u5207\u70B9\uFF08Pointcut\uFF09: \u5339\u914D\u8FDE\u63A5\u70B9\u7684\u65AD\u8A00\u3002\u901A\u77E5\u548C\u5207\u70B9\u8868\u8FBE\u5F0F\u76F8\u5173\u8054\uFF0C\u5E76\u5728\u6EE1\u8DB3\u8FD9\u4E2A\u5207\u70B9\u7684\u8FDE\u63A5\u70B9\u4E0A\u8FD0\u884C\uFF08\u4F8B\u5982\uFF0C\u5F53\u6267\u884C\u67D0\u4E2A\u7279\u5B9A\u540D\u79F0\u7684\u65B9\u6CD5\u65F6\uFF09\u3002\u5207\u70B9\u8868\u8FBE\u5F0F\u5982\u4F55\u548C\u8FDE\u63A5\u70B9\u5339\u914D\u662FAOP\u7684\u6838\u5FC3\uFF1A Spring\u9ED8\u8BA4\u4F7F\u7528AspectJ\u5207\u70B9\u8BED\u4E49\u3002</p></li><li><p>\u5F15\u5165\uFF08Introduction\uFF09: \u58F0\u660E\u989D\u5916\u7684\u65B9\u6CD5\u6216\u8005\u67D0\u4E2A\u7C7B\u578B\u7684\u5B57\u6BB5\u3002Spring\u5141\u8BB8\u5F15\u5165\u65B0\u7684\u63A5\u53E3\uFF08\u4EE5\u53CA\u4E00\u4E2A\u5BF9\u5E94\u7684\u5B9E\u73B0\uFF09\u5230\u4EFB\u4F55\u88AB\u901A\u77E5\u7684\u5BF9\u8C61\u4E0A\u3002\u4F8B\u5982\uFF0C\u53EF\u4EE5\u4F7F\u7528\u5F15\u5165\u6765\u4F7Fbean\u5B9E\u73B0 <code>IsModified</code>\u63A5\u53E3\uFF0C \u4EE5\u4FBF\u7B80\u5316\u7F13\u5B58\u673A\u5236\uFF08\u5728AspectJ\u793E\u533A\uFF0C\u5F15\u5165\u4E5F\u88AB\u79F0\u4E3A\u5185\u90E8\u7C7B\u578B\u58F0\u660E\uFF08inter\uFF09\uFF09\u3002</p></li><li><p>\u76EE\u6807\u5BF9\u8C61\uFF08Target object\uFF09: \u88AB\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u5207\u9762\u6240\u901A\u77E5\u7684\u5BF9\u8C61\u3002\u4E5F\u88AB\u79F0\u4F5C\u88AB\u901A\u77E5\uFF08advised\uFF09\u5BF9\u8C61\u3002\u65E2\u7136Spring AOP\u662F\u901A\u8FC7\u8FD0\u884C\u65F6\u4EE3\u7406\u5B9E\u73B0\u7684\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u5BF9\u8C61\u6C38\u8FDC\u662F\u4E00\u4E2A\u88AB\u4EE3\u7406\uFF08proxied\uFF09\u7684\u5BF9\u8C61\u3002</p></li><li><p>AOP\u4EE3\u7406\uFF08AOP proxy\uFF09:AOP\u6846\u67B6\u521B\u5EFA\u7684\u5BF9\u8C61\uFF0C\u7528\u6765\u5B9E\u73B0\u5207\u9762\u5951\u7EA6\uFF08aspect contract\uFF09\uFF08\u5305\u62EC\u901A\u77E5\u65B9\u6CD5\u6267\u884C\u7B49\u529F\u80FD\uFF09\u3002\u5728Spring\u4E2D\uFF0CAOP\u4EE3\u7406\u53EF\u4EE5\u662FJDK\u52A8\u6001\u4EE3\u7406\u6216CGLIB\u4EE3\u7406\u3002</p></li><li><p>\u7EC7\u5165\uFF08Weaving\uFF09: \u628A\u5207\u9762\u8FDE\u63A5\u5230\u5176\u5B83\u7684\u5E94\u7528\u7A0B\u5E8F\u7C7B\u578B\u6216\u8005\u5BF9\u8C61\u4E0A\uFF0C\u5E76\u521B\u5EFA\u4E00\u4E2A\u88AB\u88AB\u901A\u77E5\u7684\u5BF9\u8C61\u7684\u8FC7\u7A0B\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u53EF\u4EE5\u5728\u7F16\u8BD1\u65F6\uFF08\u4F8B\u5982\u4F7F\u7528AspectJ\u7F16\u8BD1\u5668\uFF09\u3001\u7C7B\u52A0\u8F7D\u65F6\u6216\u8FD0\u884C\u65F6\u4E2D\u5B8C\u6210\u3002 Spring\u548C\u5176\u4ED6\u7EAFJava AOP\u6846\u67B6\u4E00\u6837\uFF0C\u662F\u5728\u8FD0\u884C\u65F6\u5B8C\u6210\u7EC7\u5165\u7684\u3002</p><p>\u8FD9\u4E9B\u6982\u5FF5\u90FD\u592A\u5B66\u672F\u4E86\uFF0C\u5982\u679C\u66F4\u7B80\u5355\u7684\u89E3\u91CA\u5462\uFF0C\u5176\u5B9E\u975E\u5E38\u7B80\u5355\uFF1A</p><p>\u4EFB\u4F55\u4E00\u4E2A\u7CFB\u7EDF\u90FD\u662F\u7531\u4E0D\u540C\u7684\u7EC4\u4EF6\u7EC4\u6210\u7684\uFF0C\u6BCF\u4E2A\u7EC4\u4EF6\u8D1F\u8D23\u4E00\u5757\u7279\u5B9A\u7684\u529F\u80FD\uFF0C\u5F53\u7136\u4F1A\u5B58\u5728\u5F88\u591A\u7EC4\u4EF6\u662F\u8DDF\u4E1A\u52A1\u65E0\u5173\u7684\uFF0C\u4F8B\u5982\u65E5\u5FD7\u3001\u4E8B\u52A1\u3001\u6743\u9650\u7B49\u6838\u5FC3\u670D\u52A1\u7EC4\u4EF6\uFF0C\u8FD9\u4E9B\u6838\u5FC3\u670D\u52A1\u7EC4\u4EF6\u7ECF\u5E38\u878D\u5165\u5230\u5177\u4F53\u7684\u4E1A\u52A1\u903B\u8F91\u4E2D\uFF0C \u5982\u679C\u6211\u4EEC\u4E3A\u6BCF\u4E00\u4E2A\u5177\u4F53\u4E1A\u52A1\u903B\u8F91\u64CD\u4F5C\u90FD\u6DFB\u52A0\u8FD9\u6837\u7684\u4EE3\u7801\uFF0C\u5F88\u660E\u663E\u4EE3\u7801\u5197\u4F59\u592A\u591A\uFF0C\u56E0\u6B64\u6211\u4EEC\u9700\u8981\u5C06\u8FD9\u4E9B\u516C\u5171\u7684\u4EE3\u7801\u903B\u8F91\u62BD\u8C61\u51FA\u6765\u53D8\u6210\u4E00\u4E2A\u5207\u9762\uFF0C\u7136\u540E\u6CE8\u5165\u5230\u76EE\u6807\u5BF9\u8C61\uFF08\u5177\u4F53\u4E1A\u52A1\uFF09\u4E2D\u53BB\uFF0C AOP\u6B63\u662F\u57FA\u4E8E\u8FD9\u6837\u7684\u4E00\u4E2A\u601D\u8DEF\u5B9E\u73B0\u7684\uFF0C\u901A\u8FC7\u52A8\u6001\u4EE3\u7406\u7684\u65B9\u5F0F\uFF0C\u5C06\u9700\u8981\u6CE8\u5165\u5207\u9762\u7684\u5BF9\u8C61\u8FDB\u884C\u4EE3\u7406\uFF0C\u5728\u8FDB\u884C\u8C03\u7528\u7684\u65F6\u5019\uFF0C\u5C06\u516C\u5171\u7684\u903B\u8F91\u76F4\u63A5\u6DFB\u52A0\u8FDB\u53BB\uFF0C\u800C\u4E0D\u9700\u8981\u4FEE\u6539\u539F\u6709\u4E1A\u52A1\u7684\u903B\u8F91\u4EE3\u7801\uFF0C \u53EA\u9700\u8981\u5728\u539F\u6765\u7684\u4E1A\u52A1\u903B\u8F91\u57FA\u7840\u4E4B\u4E0A\u505A\u4E00\u4E9B\u589E\u5F3A\u529F\u80FD\u5373\u53EF\u3002</p></li></ul><h2 id="\u8BF4\u8BF4\u4F60\u5BF9ioc\u7684\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u8BF4\u8BF4\u4F60\u5BF9ioc\u7684\u7406\u89E3" aria-hidden="true">#</a> \u8BF4\u8BF4\u4F60\u5BF9IOC\u7684\u7406\u89E3\uFF1F</h2><blockquote><p>IOC\u4E0E\u5927\u5BB6\u719F\u77E5\u7684\u4F9D\u8D56\u6CE8\u5165\u540C\u7406\uFF0C\u8FD9\u662F\u4E00\u4E2A\u901A\u8FC7\u4F9D\u8D56\u6CE8\u5165\u5BF9\u8C61\u7684\u8FC7\u7A0B \u4E5F\u5C31\u662F\u8BF4\uFF0C\u5B83\u4EEC\u6240\u4F7F\u7528\u7684\u5BF9\u8C61\uFF0C\u662F\u901A\u8FC7\u6784\u9020\u51FD\u6570\u53C2\u6570\uFF0C\u5DE5\u5382\u65B9\u6CD5\u7684\u53C2\u6570\u6216\u8FD9\u662F\u4ECE\u5DE5\u5382\u65B9\u6CD5\u7684\u6784\u9020\u51FD\u6570\u6216\u8FD4\u56DE\u503C\u7684\u5BF9\u8C61\u5B9E\u4F8B\u8BBE\u7F6E\u7684\u5C5E\u6027\uFF0C\u7136\u540E\u5BB9\u5668\u5728\u521B\u5EFAbean\u65F6\u6CE8\u5165\u8FD9\u4E9B\u9700\u8981\u7684\u4F9D\u8D56\u3002 \u8FD9\u4E2A\u8FC7\u7A0B\u76F8\u5BF9\u666E\u901A\u521B\u5EFA\u5BF9\u8C61\u7684\u8FC7\u7A0B\u662F\u53CD\u5411\u7684\uFF08\u56E0\u6B64\u79F0\u4E4B\u4E3AIoC\uFF09\uFF0Cbean\u672C\u8EAB\u901A\u8FC7\u76F4\u63A5\u6784\u9020\u7C7B\u6765\u63A7\u5236\u4F9D\u8D56\u5173\u7CFB\u7684\u5B9E\u4F8B\u5316\u6216\u4F4D\u7F6E\uFF0C\u6216\u63D0\u4F9B\u8BF8\u5982\u670D\u52A1\u5B9A\u4F4D\u5668\u6A21\u5F0F\u4E4B\u7C7B\u7684\u673A\u5236\u3002</p></blockquote><p>\u5982\u679C\u8FD9\u4E2A\u8FC7\u7A0B\u6BD4\u8F83\u96BE\u7406\u89E3\u7684\u8BDD\uFF0C\u90A3\u4E48\u53EF\u4EE5\u60F3\u8C61\u81EA\u5DF1\u627E\u5973\u670B\u53CB\u548C\u5A5A\u4ECB\u516C\u53F8\u627E\u5973\u670B\u53CB\u7684\u8FC7\u7A0B\u3002\u5982\u679C\u8FD9\u4E2A\u8FC7\u7A0B\u80FD\u591F\u60F3\u660E\u767D\u7684\u8BDD\uFF0C\u90A3\u4E48\u6211\u4EEC\u73B0\u5728\u56DE\u7B54\u4E0A\u9762\u7684\u95EE\u9898\uFF1A</p><blockquote><ol><li>\u8C01\u63A7\u5236\u8C01\uFF1A\u5728\u4E4B\u524D\u7684\u7F16\u7801\u8FC7\u7A0B\u4E2D\uFF0C\u90FD\u662F\u9700\u8981\u4EC0\u4E48\u5BF9\u8C61\u81EA\u5DF1\u53BB\u521B\u5EFA\u4EC0\u4E48\u5BF9\u8C61\uFF0C\u6709\u7A0B\u5E8F\u5458\u81EA\u5DF1\u6765\u63A7\u5236\u5BF9\u8C61\uFF0C\u800C\u6709\u4E86IOC\u5BB9\u5668\u4E4B\u540E\uFF0C\u5C31\u4F1A\u53D8\u6210\u7531IOC\u5BB9\u5668\u6765\u63A7\u5236\u5BF9\u8C61</li><li>\u63A7\u5236\u4EC0\u4E48\uFF1A\u5728\u5B9E\u73B0\u8FC7\u7A0B\u4E2D\u6240\u9700\u8981\u7684\u5BF9\u8C61\u53CA\u9700\u8981\u4F9D\u8D56\u7684\u5BF9\u8C61</li><li>\u4EC0\u4E48\u662F\u53CD\u8F6C\uFF1A\u5728\u6CA1\u6709IOC\u5BB9\u5668\u4E4B\u524D\u6211\u4EEC\u90FD\u662F\u5728\u5BF9\u8C61\u4E2D\u4E3B\u52A8\u53BB\u521B\u5EFA\u4F9D\u8D56\u7684\u5BF9\u8C61\uFF0C\u8FD9\u662F\u6B63\u8F6C\u7684\uFF0C\u800C\u6709\u4E86IOC\u4E4B\u540E\uFF0C\u4F9D\u8D56\u7684\u5BF9\u8C61\u76F4\u63A5\u7531IOC\u5BB9\u5668\u521B\u5EFA\u540E\u6CE8\u5165\u5230\u5BF9\u8C61\u4E2D\uFF0C\u7531\u4E3B\u52A8\u521B\u5EFA\u53D8\u6210\u4E86\u88AB\u52A8\u63A5\u53D7\uFF0C\u8FD9\u662F\u53CD\u8F6C</li><li>\u54EA\u4E9B\u65B9\u9762\u88AB\u53CD\u8F6C\uFF1A\u4F9D\u8D56\u7684\u5BF9\u8C61</li></ol></blockquote><h2 id="beanfactory\u548Capplicationcontext\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#beanfactory\u548Capplicationcontext\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> BeanFactory\u548CApplicationContext\u6709\u4EC0\u4E48\u533A\u522B</h2><p>\u76F8\u540C\uFF1A</p><ul><li>Spring\u63D0\u4F9B\u4E86\u4E24\u79CD\u4E0D\u540C\u7684IOC \u5BB9\u5668\uFF0C\u4E00\u4E2A\u662FBeanFactory\uFF0C\u53E6\u5916\u4E00\u4E2A\u662FApplicationContext\uFF0C\u5B83\u4EEC\u90FD\u662FJava interface\uFF0CApplicationContext\u7EE7\u627F\u4E8EBeanFactory( ApplicationContext\u7EE7\u627FListableBeanFactory\u3002</li><li>\u5B83\u4EEC\u90FD\u53EF\u4EE5\u7528\u6765\u914D\u7F6EXML\u5C5E\u6027\uFF0C\u4E5F\u652F\u6301\u5C5E\u6027\u7684\u81EA\u52A8\u6CE8\u5165\u3002</li><li>\u800CListableBeanFactory\u7EE7\u627FBeanFactory)\uFF0CBeanFactory \u548C ApplicationContext \u90FD\u63D0\u4F9B\u4E86\u4E00\u79CD\u65B9\u5F0F\uFF0C\u4F7F\u7528getBean(&quot;bean name&quot;)\u83B7\u53D6bean\u3002</li></ul><p>\u4E0D\u540C\uFF1A</p><ul><li>\u5F53\u4F60\u8C03\u7528getBean()\u65B9\u6CD5\u65F6\uFF0CBeanFactory\u4EC5\u5B9E\u4F8B\u5316bean\uFF0C\u800CApplicationContext \u5728\u542F\u52A8\u5BB9\u5668\u7684\u65F6\u5019\u5B9E\u4F8B\u5316\u5355\u4F8Bbean\uFF0C\u4E0D\u4F1A\u7B49\u5F85\u8C03\u7528getBean()\u65B9\u6CD5\u65F6\u518D\u5B9E\u4F8B\u5316\u3002</li><li>BeanFactory\u4E0D\u652F\u6301\u56FD\u9645\u5316\uFF0C\u5373i18n\uFF0C\u4F46ApplicationContext\u63D0\u4F9B\u4E86\u5BF9\u5B83\u7684\u652F\u6301\u3002</li><li>BeanFactory\u4E0EApplicationContext\u4E4B\u95F4\u7684\u53E6\u4E00\u4E2A\u533A\u522B\u662F\u80FD\u591F\u5C06\u4E8B\u4EF6\u53D1\u5E03\u5230\u6CE8\u518C\u4E3A\u76D1\u542C\u5668\u7684bean\u3002</li><li>BeanFactory \u7684\u4E00\u4E2A\u6838\u5FC3\u5B9E\u73B0\u662FXMLBeanFactory \u800CApplicationContext \u7684\u4E00\u4E2A\u6838\u5FC3\u5B9E\u73B0\u662FClassPathXmlApplicationContext\uFF0CWeb\u5BB9\u5668\u7684\u73AF\u5883\u6211\u4EEC\u4F7F\u7528WebApplicationContext\u5E76\u4E14\u589E\u52A0\u4E86getServletContext \u65B9\u6CD5\u3002</li><li>\u5982\u679C\u4F7F\u7528\u81EA\u52A8\u6CE8\u5165\u5E76\u4F7F\u7528BeanFactory\uFF0C\u5219\u9700\u8981\u4F7F\u7528API\u6CE8\u518CAutoWiredBeanPostProcessor\uFF0C\u5982\u679C\u4F7F\u7528ApplicationContext\uFF0C\u5219\u53EF\u4EE5\u4F7F\u7528XML\u8FDB\u884C\u914D\u7F6E\u3002</li><li></li></ul><p>\u7B80\u800C\u8A00\u4E4B\uFF0CBeanFactory\u63D0\u4F9B\u57FA\u672C\u7684IOC\u548CDI\u529F\u80FD\uFF0C\u800CApplicationContext\u63D0\u4F9B\u9AD8\u7EA7\u529F\u80FD\uFF0CBeanFactory\u53EF\u7528\u4E8E\u6D4B\u8BD5\u548C\u975E\u751F\u4EA7\u4F7F\u7528\uFF0C\u4F46ApplicationContext\u662F\u529F\u80FD\u66F4\u4E30\u5BCC\u7684\u5BB9\u5668\u5B9E\u73B0\uFF0C\u5E94\u8BE5\u4F18\u4E8EBeanFactory</p><h2 id="\u7B80\u8FF0spring-bean\u7684\u751F\u547D\u5468\u671F" tabindex="-1"><a class="header-anchor" href="#\u7B80\u8FF0spring-bean\u7684\u751F\u547D\u5468\u671F" aria-hidden="true">#</a> \u7B80\u8FF0spring bean\u7684\u751F\u547D\u5468\u671F\uFF1F</h2><ol><li>\u5B9E\u4F8B\u5316bean\u5BF9\u8C61</li></ol><p>\u200B \u901A\u8FC7\u53CD\u5C04\u7684\u65B9\u5F0F\u8FDB\u884C\u5BF9\u8C61\u7684\u521B\u5EFA\uFF0C\u6B64\u65F6\u7684\u521B\u5EFA\u53EA\u662F\u5728\u5806\u7A7A\u95F4\u4E2D\u7533\u8BF7\u7A7A\u95F4\uFF0C\u5C5E\u6027\u90FD\u662F\u9ED8\u8BA4\u503C</p><ol start="2"><li>\u8BBE\u7F6E\u5BF9\u8C61\u5C5E\u6027</li></ol><p>\u200B \u7ED9\u5BF9\u8C61\u4E2D\u7684\u5C5E\u6027\u8FDB\u884C\u503C\u7684\u8BBE\u7F6E\u5DE5\u4F5C</p><ol start="3"><li>\u68C0\u67E5Aware\u76F8\u5173\u63A5\u53E3\u5E76\u8BBE\u7F6E\u76F8\u5173\u4F9D\u8D56</li></ol><p>\u200B \u5982\u679C\u5BF9\u8C61\u4E2D\u9700\u8981\u5F15\u7528\u5BB9\u5668\u5185\u90E8\u7684\u5BF9\u8C61\uFF0C\u90A3\u4E48\u9700\u8981\u8C03\u7528aware\u63A5\u53E3\u7684\u5B50\u7C7B\u65B9\u6CD5\u6765\u8FDB\u884C\u7EDF\u4E00\u7684\u8BBE\u7F6E</p><ol start="4"><li>BeanPostProcessor\u7684\u524D\u7F6E\u5904\u7406</li></ol><p>\u200B \u5BF9\u751F\u6210\u7684bean\u5BF9\u8C61\u8FDB\u884C\u524D\u7F6E\u7684\u5904\u7406\u5DE5\u4F5C</p><ol start="5"><li>\u68C0\u67E5\u662F\u5426\u662FInitializingBean\u7684\u5B50\u7C7B\u6765\u51B3\u5B9A\u662F\u5426\u8C03\u7528afterPropertiesSet\u65B9\u6CD5</li></ol><p>\u200B \u5224\u65AD\u5F53\u524Dbean\u5BF9\u8C61\u662F\u5426\u8BBE\u7F6E\u4E86InitializingBean\u63A5\u53E3\uFF0C\u7136\u540E\u8FDB\u884C\u5C5E\u6027\u7684\u8BBE\u7F6E\u7B49\u57FA\u672C\u5DE5\u4F5C</p><ol start="6"><li>\u68C0\u67E5\u662F\u5426\u914D\u7F6E\u6709\u81EA\u5B9A\u4E49\u7684init-method\u65B9\u6CD5</li></ol><p>\u200B \u5982\u679C\u5F53\u524Dbean\u5BF9\u8C61\u5B9A\u4E49\u4E86\u521D\u59CB\u5316\u65B9\u6CD5\uFF0C\u90A3\u4E48\u5728\u6B64\u5904\u8C03\u7528\u521D\u59CB\u5316\u65B9\u6CD5</p><ol start="7"><li>BeanPostProcessor\u540E\u7F6E\u5904\u7406</li></ol><p>\u200B \u5BF9\u751F\u6210\u7684bean\u5BF9\u8C61\u8FDB\u884C\u540E\u7F6E\u7684\u5904\u7406\u5DE5\u4F5C</p><ol start="8"><li>\u6CE8\u518C\u5FC5\u8981\u7684Destruction\u76F8\u5173\u56DE\u8C03\u63A5\u53E3</li></ol><p>\u200B \u4E3A\u4E86\u65B9\u4FBF\u5BF9\u8C61\u7684\u9500\u6BC1\uFF0C\u5728\u6B64\u5904\u8C03\u7528\u6CE8\u9500\u7684\u56DE\u8C03\u63A5\u53E3\uFF0C\u65B9\u4FBF\u5BF9\u8C61\u8FDB\u884C\u9500\u6BC1\u64CD\u4F5C</p><ol start="9"><li>\u83B7\u53D6\u5E76\u4F7F\u7528bean\u5BF9\u8C61</li></ol><p>\u200B \u901A\u8FC7\u5BB9\u5668\u6765\u83B7\u53D6\u5BF9\u8C61\u5E76\u8FDB\u884C\u4F7F\u7528</p><ol start="10"><li>\u662F\u5426\u5B9E\u73B0DisposableBean\u63A5\u53E3</li></ol><p>\u200B \u5224\u65AD\u662F\u5426\u5B9E\u73B0\u4E86DisposableBean\u63A5\u53E3\uFF0C\u5E76\u8C03\u7528\u5177\u4F53\u7684\u65B9\u6CD5\u6765\u8FDB\u884C\u5BF9\u8C61\u7684\u9500\u6BC1\u5DE5\u4F5C</p><ol start="11"><li>\u662F\u5426\u914D\u7F6E\u6709\u81EA\u5B9A\u4E49\u7684destory\u65B9\u6CD5</li></ol><p>\u200B \u5982\u679C\u5F53\u524Dbean\u5BF9\u8C61\u5B9A\u4E49\u4E86\u9500\u6BC1\u65B9\u6CD5\uFF0C\u90A3\u4E48\u5728\u6B64\u5904\u8C03\u7528\u9500\u6BC1\u65B9\u6CD5</p><h2 id="spring\u652F\u6301\u7684bean\u4F5C\u7528\u57DF\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#spring\u652F\u6301\u7684bean\u4F5C\u7528\u57DF\u6709\u54EA\u4E9B" aria-hidden="true">#</a> spring\u652F\u6301\u7684bean\u4F5C\u7528\u57DF\u6709\u54EA\u4E9B\uFF1F</h2><p>\u2460 singleton</p><p>\u4F7F\u7528\u8BE5\u5C5E\u6027\u5B9A\u4E49Bean\u65F6\uFF0CIOC\u5BB9\u5668\u4EC5\u521B\u5EFA\u4E00\u4E2ABean\u5B9E\u4F8B\uFF0CIOC\u5BB9\u5668\u6BCF\u6B21\u8FD4\u56DE\u7684\u662F\u540C\u4E00\u4E2ABean\u5B9E\u4F8B\u3002</p><p>\u2461 prototype</p><p>\u4F7F\u7528\u8BE5\u5C5E\u6027\u5B9A\u4E49Bean\u65F6\uFF0CIOC\u5BB9\u5668\u53EF\u4EE5\u521B\u5EFA\u591A\u4E2ABean\u5B9E\u4F8B\uFF0C\u6BCF\u6B21\u8FD4\u56DE\u7684\u90FD\u662F\u4E00\u4E2A\u65B0\u7684\u5B9E\u4F8B\u3002</p><p>\u2462 request</p><p>\u8BE5\u5C5E\u6027\u4EC5\u5BF9HTTP\u8BF7\u6C42\u4EA7\u751F\u4F5C\u7528\uFF0C\u4F7F\u7528\u8BE5\u5C5E\u6027\u5B9A\u4E49Bean\u65F6\uFF0C\u6BCF\u6B21HTTP\u8BF7\u6C42\u90FD\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684Bean\uFF0C\u9002\u7528\u4E8EWebApplicationContext\u73AF\u5883\u3002</p><p>\u2463 session</p><p>\u8BE5\u5C5E\u6027\u4EC5\u7528\u4E8EHTTP Session\uFF0C\u540C\u4E00\u4E2ASession\u5171\u4EAB\u4E00\u4E2ABean\u5B9E\u4F8B\u3002\u4E0D\u540CSession\u4F7F\u7528\u4E0D\u540C\u7684\u5B9E\u4F8B\u3002</p><p>\u2464 global-session</p><p>\u8BE5\u5C5E\u6027\u4EC5\u7528\u4E8EHTTP Session\uFF0C\u540Csession\u4F5C\u7528\u57DF\u4E0D\u540C\u7684\u662F\uFF0C\u6240\u6709\u7684Session\u5171\u4EAB\u4E00\u4E2ABean\u5B9E\u4F8B\u3002</p><h2 id="spring\u6846\u67B6\u4E2D\u7684\u5355\u4F8Bbean\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u4E48" tabindex="-1"><a class="header-anchor" href="#spring\u6846\u67B6\u4E2D\u7684\u5355\u4F8Bbean\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u4E48" aria-hidden="true">#</a> Spring\u6846\u67B6\u4E2D\u7684\u5355\u4F8BBean\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u4E48\uFF1F</h2><p>Spring\u4E2D\u7684Bean\u5BF9\u8C61\u9ED8\u8BA4\u662F\u5355\u4F8B\u7684\uFF0C\u6846\u67B6\u5E76\u6CA1\u6709\u5BF9bean\u8FDB\u884C\u591A\u7EBF\u7A0B\u7684\u5C01\u88C5\u5904\u7406</p><p>\u200B \u5982\u679CBean\u662F\u6709\u72B6\u6001\u7684\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u5F00\u53D1\u4EBA\u5458\u81EA\u5DF1\u6765\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u7684\u4FDD\u8BC1\uFF0C\u6700\u7B80\u5355\u7684\u529E\u6CD5\u5C31\u662F\u6539\u53D8bean\u7684\u4F5C\u7528\u57DF\u628Asingleton\u6539\u6210prototype\uFF0C\u8FD9\u6837\u6BCF\u6B21\u8BF7\u6C42bean\u5BF9\u8C61\u5C31\u76F8\u5F53\u4E8E\u662F\u521B\u5EFA\u65B0\u7684\u5BF9\u8C61\u6765\u4FDD\u8BC1\u7EBF\u7A0B\u7684\u5B89\u5168</p><p>\u200B \u6709\u72B6\u6001\u5C31\u662F\u7531\u6570\u636E\u5B58\u50A8\u7684\u529F\u80FD</p><p>\u200B \u65E0\u72B6\u6001\u5C31\u662F\u4E0D\u4F1A\u5B58\u50A8\u6570\u636E\uFF0C\u4F60\u60F3\u4E00\u4E0B\uFF0C\u6211\u4EEC\u7684controller\uFF0Cservice\u548Cdao\u672C\u8EAB\u5E76\u4E0D\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\uFF0C\u53EA\u662F\u8C03\u7528\u91CC\u9762\u7684\u65B9\u6CD5\uFF0C\u800C\u4E14\u591A\u7EBF\u7A0B\u8C03\u7528\u4E00\u4E2A\u5B9E\u4F8B\u7684\u65B9\u6CD5\uFF0C\u4F1A\u5728\u5185\u5B58\u4E2D\u590D\u5236\u904D\u5386\uFF0C\u8FD9\u662F\u81EA\u5DF1\u7EBF\u7A0B\u7684\u5DE5\u4F5C\u5185\u5B58\uFF0C\u662F\u6700\u5B89\u5168\u7684\u3002</p><p>\u200B \u56E0\u6B64\u5728\u8FDB\u884C\u4F7F\u7528\u7684\u65F6\u5019\uFF0C\u4E0D\u8981\u5728bean\u4E2D\u58F0\u660E\u4EFB\u4F55\u6709\u72B6\u6001\u7684\u5B9E\u4F8B\u53D8\u91CF\u6216\u8005\u7C7B\u53D8\u91CF\uFF0C\u5982\u679C\u5FC5\u987B\u5982\u6B64\uFF0C\u4E5F\u63A8\u8350\u5927\u5BB6\u4F7F\u7528ThreadLocal\u628A\u53D8\u91CF\u53D8\u6210\u7EBF\u7A0B\u79C1\u6709\uFF0C\u5982\u679Cbean\u7684\u5B9E\u4F8B\u53D8\u91CF\u6216\u8005\u7C7B\u53D8\u91CF\u9700\u8981\u5728\u591A\u4E2A\u7EBF\u7A0B\u4E4B\u95F4\u5171\u4EAB\uFF0C\u90A3\u4E48\u5C31\u53EA\u80FD\u4F7F\u7528synchronized\uFF0Clock\uFF0Ccas\u7B49\u8FD9\u4E9B\u5B9E\u73B0\u7EBF\u7A0B\u540C\u6B65\u7684\u65B9\u6CD5\u4E86\u3002</p><h2 id="spring\u6846\u67B6\u4E2D\u4F7F\u7528\u4E86\u54EA\u4E9B\u8BBE\u8BA1\u6A21\u5F0F\u53CA\u5E94\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#spring\u6846\u67B6\u4E2D\u4F7F\u7528\u4E86\u54EA\u4E9B\u8BBE\u8BA1\u6A21\u5F0F\u53CA\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a> spring\u6846\u67B6\u4E2D\u4F7F\u7528\u4E86\u54EA\u4E9B\u8BBE\u8BA1\u6A21\u5F0F\u53CA\u5E94\u7528\u573A\u666F</h2><ol><li>\u5DE5\u5382\u6A21\u5F0F\uFF0C\u5728\u5404\u79CDBeanFactory\u4EE5\u53CAApplicationContext\u521B\u5EFA\u4E2D\u90FD\u7528\u5230\u4E86</li><li>\u6A21\u7248\u6A21\u5F0F\uFF0C\u5728\u5404\u79CDBeanFactory\u4EE5\u53CAApplicationContext\u5B9E\u73B0\u4E2D\u4E5F\u90FD\u7528\u5230\u4E86</li><li>\u4EE3\u7406\u6A21\u5F0F\uFF0CSpring AOP \u5229\u7528\u4E86 AspectJ AOP\u5B9E\u73B0\u7684! AspectJ AOP \u7684\u5E95\u5C42\u7528\u4E86\u52A8\u6001\u4EE3\u7406</li><li></li></ol><p>\u7B56\u7565\u6A21\u5F0F\uFF0C\u52A0\u8F7D\u8D44\u6E90\u6587\u4EF6\u7684\u65B9\u5F0F\uFF0C\u4F7F\u7528\u4E86\u4E0D\u540C\u7684\u65B9\u6CD5\uFF0C\u6BD4\u5982\uFF1AClassPathResourece\uFF0CFileSystemResource\uFF0CServletContextResource\uFF0CUrlResource\u4F46\u4ED6\u4EEC\u90FD\u6709\u5171\u540C\u7684\u501F\u53E3Resource\uFF1B\u5728Aop\u7684\u5B9E\u73B0\u4E2D\uFF0C\u91C7\u7528\u4E86\u4E24\u79CD\u4E0D\u540C\u7684\u65B9\u5F0F\uFF0CJDK\u52A8\u6001\u4EE3\u7406\u548CCGLIB\u4EE3\u7406</p><ol start="5"><li>\u5355\u4F8B\u6A21\u5F0F\uFF0C\u6BD4\u5982\u5728\u521B\u5EFAbean\u7684\u65F6\u5019\u3002</li><li>\u89C2\u5BDF\u8005\u6A21\u5F0F\uFF0Cspring\u4E2D\u7684ApplicationEvent\uFF0CApplicationListener,ApplicationEventPublisher</li><li>\u9002\u914D\u5668\u6A21\u5F0F\uFF0CMethodBeforeAdviceAdapter,ThrowsAdviceAdapter,AfterReturningAdapter</li><li>\u88C5\u9970\u8005\u6A21\u5F0F\uFF0C\u6E90\u7801\u4E2D\u7C7B\u578B\u5E26Wrapper\u6216\u8005Decorator\u7684\u90FD\u662F</li></ol><h2 id="spring\u4E8B\u52A1\u7684\u5B9E\u73B0\u65B9\u5F0F\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#spring\u4E8B\u52A1\u7684\u5B9E\u73B0\u65B9\u5F0F\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> spring\u4E8B\u52A1\u7684\u5B9E\u73B0\u65B9\u5F0F\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u5728\u4F7F\u7528Spring\u6846\u67B6\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u6709\u4E24\u79CD\u4E8B\u52A1\u7684\u5B9E\u73B0\u65B9\u5F0F\uFF0C\u4E00\u79CD\u662F\u7F16\u7A0B\u5F0F\u4E8B\u52A1\uFF0C\u6709\u7528\u6237\u81EA\u5DF1\u901A\u8FC7\u4EE3\u7801\u6765\u63A7\u5236\u4E8B\u52A1\u7684\u5904\u7406\u903B\u8F91\uFF0C\u8FD8\u6709\u4E00\u79CD\u662F\u58F0\u660E\u5F0F\u4E8B\u52A1\uFF0C\u901A\u8FC7@Transactional\u6CE8\u89E3\u6765\u5B9E\u73B0\u3002</p><p>\u200B \u5176\u5B9E\u4E8B\u52A1\u7684\u64CD\u4F5C\u672C\u6765\u5E94\u8BE5\u662F\u7531\u6570\u636E\u5E93\u6765\u8FDB\u884C\u63A7\u5236\uFF0C\u4F46\u662F\u4E3A\u4E86\u65B9\u4FBF\u7528\u6237\u8FDB\u884C\u4E1A\u52A1\u903B\u8F91\u7684\u64CD\u4F5C\uFF0Cspring\u5BF9\u4E8B\u52A1\u529F\u80FD\u8FDB\u884C\u4E86\u6269\u5C55\u5B9E\u73B0\uFF0C\u4E00\u822C\u6211\u4EEC\u5F88\u5C11\u4F1A\u7528\u7F16\u7A0B\u5F0F\u4E8B\u52A1\uFF0C\u66F4\u591A\u7684\u662F\u901A\u8FC7\u6DFB\u52A0@Transactional\u6CE8\u89E3\u6765\u8FDB\u884C\u5B9E\u73B0\uFF0C\u5F53\u6DFB\u52A0\u6B64\u6CE8\u89E3\u4E4B\u540E\u4E8B\u52A1\u7684\u81EA\u52A8\u529F\u80FD\u5C31\u4F1A\u5173\u95ED\uFF0C\u6709spring\u6846\u67B6\u6765\u5E2E\u52A9\u8FDB\u884C\u63A7\u5236\u3002</p><p>\u200B \u5176\u5B9E\u4E8B\u52A1\u64CD\u4F5C\u662FAOP\u7684\u4E00\u4E2A\u6838\u5FC3\u4F53\u73B0\uFF0C\u5F53\u4E00\u4E2A\u65B9\u6CD5\u6DFB\u52A0@Transactional\u6CE8\u89E3\u4E4B\u540E\uFF0Cspring\u4F1A\u57FA\u4E8E\u8FD9\u4E2A\u7C7B\u751F\u6210\u4E00\u4E2A\u4EE3\u7406\u5BF9\u8C61\uFF0C\u4F1A\u5C06\u8FD9\u4E2A\u4EE3\u7406\u5BF9\u8C61\u4F5C\u4E3Abean\uFF0C\u5F53\u4F7F\u7528\u8FD9\u4E2A\u4EE3\u7406\u5BF9\u8C61\u7684\u65B9\u6CD5\u7684\u65F6\u5019\uFF0C\u5982\u679C\u6709\u4E8B\u52A1\u5904\u7406\uFF0C\u90A3\u4E48\u4F1A\u5148\u628A\u4E8B\u52A1\u7684\u81EA\u52A8\u63D0\u4EA4\u7ED9\u5173\u7CFB\uFF0C\u7136\u540E\u53BB\u6267\u884C\u5177\u4F53\u7684\u4E1A\u52A1\u903B\u8F91\uFF0C\u5982\u679C\u6267\u884C\u903B\u8F91\u6CA1\u6709\u51FA\u73B0\u5F02\u5E38\uFF0C\u90A3\u4E48\u4EE3\u7406\u903B\u8F91\u5C31\u4F1A\u76F4\u63A5\u63D0\u4EA4\uFF0C\u5982\u679C\u51FA\u73B0\u4EFB\u4F55\u5F02\u5E38\u60C5\u51B5\uFF0C\u90A3\u4E48\u76F4\u63A5\u8FDB\u884C\u56DE\u6EDA\u64CD\u4F5C\uFF0C\u5F53\u7136\u7528\u6237\u53EF\u4EE5\u63A7\u5236\u5BF9\u54EA\u4E9B\u5F02\u5E38\u8FDB\u884C\u56DE\u6EDA\u64CD\u4F5C\u3002</p><p>TransactionInterceptor</p><h2 id="\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u3001\u865A\u8BFB-\u5E7B\u8BFB" tabindex="-1"><a class="header-anchor" href="#\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u3001\u865A\u8BFB-\u5E7B\u8BFB" aria-hidden="true">#</a> \u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u3001\u865A\u8BFB\uFF08\u5E7B\u8BFB\uFF09</h2><table><thead><tr><th>\u7C7B\u578B</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>**</td><td></td></tr><tr><td>\u810F\u8BFB**</td><td>\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\u4E86\u672A\u63D0\u4EA4\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\u7684\u6570\u636E\u3002</td></tr><tr><td>**</td><td></td></tr><tr><td>\u4E0D\u53EF\u91CD\u590D\u8BFB**</td><td>\u4E00\u4E2A\u4E8B\u52A1\u53EF\u4EE5\u8BFB\u53D6\u53E6\u4E00\u4E2A\u4E8B\u52A1\u5DF2\u63D0\u4EA4\u7684\u6570\u636E \u5355\u6761\u8BB0\u5F55\u524D\u540E\u4E0D\u5339\u914D\u3002<br>\u4E0D\u53EF\u91CD\u590D\u8BFB\u662F\u6307\u5BF9\u4E8E\u6570\u636E\u5E93\u4E2D\u7684\u67D0\u4E2A\u6570\u636E\uFF0C\u4E00\u4E2A\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\u591A\u6B21\u67E5\u8BE2\u8FD4\u56DE\u4E0D\u540C\u67E5\u8BE2\u7ED3\u679C\uFF0C\u8FD9\u5C31\u662F\u5728\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u6570\u636E\u88AB\u5176\u4ED6\u4E8B\u52A1\u63D0\u4EA4\u4FEE\u6539\u4E86\u3002<br>\u4E0D\u53EF\u91CD\u590D\u8BFB\u540C\u810F\u8BFB\u7684\u533A\u522B\u5728\u4E8E\uFF0C\u810F\u8BFB\u662F\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\u4E86\u53E6\u4E00\u672A\u5B8C\u6210\u7684\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\u7684\u6570\u636E\uFF0C\u800C\u4E0D\u53EF\u91CD\u590D\u8BFB\u662F\u4E00\u4E2A\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u53E6\u4E00\u4E8B\u52A1\u63D0\u4EA4\u5E76\u4FEE\u6539\u4E86\u5F53\u524D\u4E8B\u52A1\u6B63\u5728\u8BFB\u53D6\u7684\u6570\u636E\u3002</td></tr><tr><td>**</td><td></td></tr><tr><td>\u865A\u8BFB\uFF08\u5E7B\u8BFB\uFF09**</td><td>\u4E00\u4E2A\u4E8B\u52A1\u53EF\u4EE5\u8BFB\u53D6\u53E6\u4E00\u4E2A\u4E8B\u52A1\u5DF2\u63D0\u4EA4\u7684\u6570\u636E\uFF0C\u6267\u884C\u540C\u4E00\u6761sql\u8BED\u53E5\u51E0\u6B21\uFF0C\u8BFB\u53D6\u5230\u7684\u6570\u636E\u524D\u540E\u53EF\u80FD\u591A\u4E86\u70B9\u6216\u8005\u5C11\u4E86\u70B9\u3002<br>\u5E7B\u8BFB\u662F\u4E8B\u52A1\u975E\u72EC\u7ACB\u6267\u884C\u65F6\u53D1\u751F\u7684\u4E00\u79CD\u73B0\u8C61\uFF0C\u4F8B\u5982\u4E8B\u52A1T1\u6279\u91CF\u5BF9\u4E00\u4E2A\u8868\u4E2D\u67D0\u4E00\u5217\u5217\u503C\u4E3A1\u7684\u6570\u636E\u4FEE\u6539\u4E3A2\u7684\u53D8\u66F4\uFF0C\u4F46\u662F\u5728\u8FD9\u65F6\uFF0C\u4E8B\u52A1T2\u5BF9\u8FD9\u5F20\u8868\u63D2\u5165\u4E86\u4E00\u6761\u5217\u503C\u4E3A1\u7684\u6570\u636E\uFF0C\u5E76\u5B8C\u6210\u63D0\u4EA4\u3002\u6B64\u65F6\uFF0C\u5982\u679C\u4E8B\u52A1T1\u67E5\u770B\u521A\u521A\u5B8C\u6210\u64CD\u4F5C\u7684\u6570\u636E\uFF0C\u53D1\u73B0\u8FD8\u6709\u4E00\u6761\u5217\u503C\u4E3A1\u7684\u6570\u636E\u6CA1\u6709\u8FDB\u884C\u4FEE\u6539\uFF0C\u800C\u8FD9\u6761\u6570\u636E\u5176\u5B9E\u662FT2\u521A\u521A\u63D0\u4EA4\u63D2\u5165\u7684\uFF0C\u8FD9\u5C31\u662F\u5E7B\u8BFB\u3002<br>\u5E7B\u8BFB\u548C\u4E0D\u53EF\u91CD\u590D\u8BFB\u90FD\u662F\u8BFB\u53D6\u4E86\u53E6\u4E00\u6761\u5DF2\u7ECF\u63D0\u4EA4\u7684\u4E8B\u52A1\uFF08\u8FD9\u70B9\u540C\u810F\u8BFB\u4E0D\u540C\uFF09\uFF0C\u6240\u4E0D\u540C\u7684\u662F\u4E0D\u53EF\u91CD\u590D\u8BFB\u67E5\u8BE2\u7684\u90FD\u662F\u540C\u4E00\u4E2A\u6570\u636E\u9879\uFF0C\u800C\u5E7B\u8BFB\u9488\u5BF9\u7684\u662F\u4E00\u6279\u6570\u636E\u6574\u4F53\uFF08\u6BD4\u5982\u6570\u636E\u7684\u4E2A\u6570\uFF09\u3002</td></tr></tbody></table><h2 id="spring\u4E8B\u52A1\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#spring\u4E8B\u52A1\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B" aria-hidden="true">#</a> spring\u4E8B\u52A1\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B\uFF1F</h2><p>\u7EA7\u522B\u8D8A\u5927\uFF0C\u5E76\u53D1\u6027\u8D8A\u4F4E\u3002</p><p>\u9694\u79BB\u7EA7\u522B Isolation\uFF1A\u8BFB\u672A\u63D0\u4EA4 &lt; \u8BFB\u5DF2\u63D0\u4EA4 &lt; \u53EF\u91CD\u590D\u8BFB\uFF08MySQL\u9ED8\u8BA4\uFF09 &lt; \u5E8F\u5217\u5316</p><p>spring\u4E2D\u7684\u4E8B\u52A1\u9694\u79BB\u7EA7\u522B\u5C31\u662F\u6570\u636E\u5E93\u7684\u9694\u79BB\u7EA7\u522B\uFF0C\u6709\u4EE5\u4E0B\u51E0\u79CD\uFF1A</p><p>\u200B read uncommitted\uFF08\u8BFB\u672A\u63D0\u4EA4\uFF09<strong>\u810F\u8BFB</strong></p><p>\u200B read committed\uFF08\u8BFB\u5DF2\u63D0\u4EA4\uFF09<strong>\u4E0D\u53EF\u91CD\u590D\u8BFB</strong></p><p>\u200B repeatable read\uFF08\u53EF\u91CD\u590D\u8BFB\uFF09<strong>\u5E7B\u8BFB</strong></p><p>\u200B serializable\uFF08\u4E32\u884C\u5316\uFF09<strong>\u907F\u514D\u4E86\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u8BFB\u590D\u8BFB\u548C\u5E7B\u8BFB\u95EE\u9898\u3002</strong></p><table><thead><tr><th style="text-align:center;">\u9694\u79BB\u7EA7\u522B</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">DEFAULT</td><td style="text-align:left;">\u4F7F\u7528\u5E95\u5C42\u6570\u636E\u5B58\u50A8\u7684\u9ED8\u8BA4\u9694\u79BB\u7EA7\u522B\u3002 \u6240\u6709\u5176\u4ED6\u7EA7\u522B\u5BF9\u5E94\u4E8E JDBC \u9694\u79BB\u7EA7\u522B\u3002</td></tr><tr><td style="text-align:center;">READ_UNCOMMITTED</td><td style="text-align:left;">\u6307\u793A\u53EF\u80FD\u53D1\u751F**</td></tr><tr><td style="text-align:center;">\u810F\u8BFB**\u7684\u5E38\u91CF\u3002 \u6B64\u7EA7\u522B\u5141\u8BB8\u7531\u4E00\u4E2A\u4E8B\u52A1\u66F4\u6539\u7684\u884C\u5728\u63D0\u4EA4\u8BE5\u884C\u4E2D\u7684\u4EFB\u4F55\u66F4\u6539\u4E4B\u524D\u88AB\u53E6\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\uFF08\u201C\u810F\u8BFB\u201D\uFF09\u3002 \u5982\u679C\u4EFB\u4F55\u66F4\u6539\u88AB\u56DE\u6EDA\uFF0C\u5219\u7B2C\u4E8C\u4E2A\u4E8B\u52A1\u5C06\u68C0\u7D22\u5230\u65E0\u6548\u884C\u3002</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;">READ_COMMITTED</td><td style="text-align:left;">\u4E00\u4E2A\u4E8B\u52A1\u53EF\u4EE5\u8BFB\u53D6\u53E6\u4E00\u4E2A\u5DF2\u63D0\u4EA4\u7684\u4E8B\u52A1\uFF0C\u591A\u6B21\u8BFB\u53D6\u4F1A\u9020\u6210\u4E0D\u4E00\u6837\u7684\u7ED3\u679C\uFF0C\u6B64\u73B0\u8C61\u79F0\u4E3A**</td></tr><tr><td style="text-align:center;">\u4E0D\u53EF\u91CD\u590D\u8BFB**\uFF0COracle\u548CSQL Server\u7684\u9ED8\u8BA4\u9694\u79BB\u7EA7\u522B</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;"><strong>REPEATABLE_READ</strong></td><td style="text-align:left;">\u8868\u793A\u9632\u6B62\u810F\u8BFB\u7684\u5E38\u91CF\uFF1B\u53EF\u80FD\u4F1A\u53D1\u751F<strong>\u5E7B\u8BFB</strong>\u3002\u6B64\u7EA7\u522B\u4EC5\u7981\u6B62\u4E8B\u52A1\u8BFB\u53D6\u5176\u4E2D\u5305\u542B\u672A\u63D0\u4EA4\u66F4\u6539\u7684\u884C\u3002*MySQL</td></tr><tr><td style="text-align:center;">\u9ED8\u8BA4\u7684\u9694\u79BB\u7EA7\u522B*</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;">SERIALIZABLE</td><td style="text-align:left;">\u6307\u793A\u9632\u6B62\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u548C\u5E7B\u8BFB\u7684\u5E38\u91CF\u3002\u8BE5\u7EA7\u522B\u5305\u62ECISOLATION_REPEATABLE_READ\u7684\u7981\u6B62\uFF0C\u5E76\u8FDB\u4E00\u6B65\u7981\u6B62\u8FD9\u6837\u4E00\u79CD\u60C5\u51B5\uFF0C\u5373\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\u6EE1\u8DB3WHERE\u6761\u4EF6\u7684\u6240\u6709\u884C\uFF0C\u7B2C\u4E8C\u4E2A\u4E8B\u52A1\u63D2\u5165\u6EE1\u8DB3WHERE\u6761\u4EF6\u7684\u884C\uFF0C\u7B2C\u4E00\u4E2A\u4E8B\u52A1\u4E3A\u76F8\u540C\u6761\u4EF6\u91CD\u65B0\u8BFB\u53D6\uFF0C\u68C0\u7D22\u989D\u5916\u7684\u201C\u7B2C\u4E8C\u6B21\u9605\u8BFB\u4E2D\u7684\u5E7B\u5F71\u201D\u884C\u3002</td></tr></tbody></table><p>\u200B \u5728\u8FDB\u884C\u914D\u7F6E\u7684\u65F6\u5019\uFF0C\u5982\u679C\u6570\u636E\u5E93\u548Cspring\u4EE3\u7801\u4E2D\u7684\u9694\u79BB\u7EA7\u522B\u4E0D\u540C\uFF0C\u90A3\u4E48\u4EE5spring\u7684\u914D\u7F6E\u4E3A\u4E3B\u3002</p><h2 id="spring\u7684\u4E8B\u52A1\u4F20\u64AD\u673A\u5236\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#spring\u7684\u4E8B\u52A1\u4F20\u64AD\u673A\u5236\u662F\u4EC0\u4E48" aria-hidden="true">#</a> spring\u7684\u4E8B\u52A1\u4F20\u64AD\u673A\u5236\u662F\u4EC0\u4E48\uFF1F</h2><table><thead><tr><th style="text-align:center;">\u4F20\u64AD\u884C\u4E3A</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>REQUIRED\uFF08\u5E38\u7528\uFF09</strong></td><td style="text-align:left;">\u652F\u6301\u5F53\u524D\u4E8B\u52A1\uFF0C\u5982\u679C\u4E0D\u5B58\u5728\u5219\u521B\u5EFA\u4E00\u4E2A\u65B0\u4E8B\u52A1\u3002 \u8FD9\u662F\u4E8B\u52A1\u6CE8\u91CA\u7684\u9ED8\u8BA4\u8BBE\u7F6E\u3002</td></tr><tr><td style="text-align:center;">SUPPORTS</td><td style="text-align:left;">\u652F\u6301\u5F53\u524D\u4E8B\u52A1\uFF0C\u5982\u679C\u4E0D\u5B58\u5728\u5219\u4EE5\u975E\u4E8B\u52A1\u65B9\u5F0F\u6267\u884C\u3002</td></tr><tr><td style="text-align:center;">MANDATORY</td><td style="text-align:left;">\u652F\u6301\u5F53\u524D\u4E8B\u52A1\uFF0C\u5982\u679C\u4E0D\u5B58\u5728\u5219\u629B\u51FA\u5F02\u5E38\u3002</td></tr><tr><td style="text-align:center;"><strong>REQUIRES_NEW\uFF08\u5E38\u7528\uFF09</strong></td><td style="text-align:left;">\u521B\u5EFA\u4E00\u4E2A\u65B0\u4E8B\u52A1\uFF0C\u5B58\u4E0D\u5B58\u5728\u90FD\u521B\u5EFA\u65B0\u7684\u4E8B\u7269\u3002</td></tr><tr><td style="text-align:center;">NOT_SUPPORTED</td><td style="text-align:left;">\u4EE5\u975E\u4E8B\u52A1\u65B9\u5F0F\u6267\u884C\uFF0C\u5982\u679C\u5B58\u5728\u5219\u6682\u505C\u5F53\u524D\u4E8B\u52A1\u3002</td></tr><tr><td style="text-align:center;">NEVER</td><td style="text-align:left;">\u4EE5\u975E\u4E8B\u52A1\u65B9\u5F0F\u6267\u884C\uFF0C\u5982\u679C\u5B58\u5728\u4E8B\u52A1\u5219\u629B\u51FA\u5F02\u5E38\u3002</td></tr><tr><td style="text-align:center;">NESTED</td><td style="text-align:left;">\u5982\u679C\u5F53\u524D\u4E8B\u52A1\u5B58\u5728\uFF0C\u5219\u5728\u5D4C\u5957\u4E8B\u52A1\u4E2D\u6267\u884C\uFF0C\u5426\u5219\u884C\u4E3A\u7C7B\u4F3C\u4E8EREQUIRED \u3002</td></tr></tbody></table><p><strong>NESTED\u548CREQUIRED_NEW\u7684\u533A\u522B\uFF1A</strong></p><p>REQUIRED_NEW\u662F\u65B0\u5EFA\u4E00\u4E2A\u4E8B\u52A1\u5E76\u4E14\u65B0\u5F00\u59CB\u7684\u8FD9\u4E2A\u4E8B\u52A1\u4E0E\u539F\u6709\u4E8B\u52A1\u65E0\u5173\uFF0C\u800CNESTED\u5219\u662F\u5F53\u524D\u5B58\u5728\u4E8B\u52A1\u65F6\u4F1A\u5F00\u542F\u4E00\u4E2A\u5D4C\u5957\u4E8B\u52A1;</p><p>\u5728NESTED\u60C5\u51B5\u4E0B\uFF0C\u7236\u4E8B\u52A1\u56DE\u6EDA\u65F6\uFF0C\u5B50\u4E8B\u52A1\u4E5F\u4F1A\u56DE\u6EDA\uFF0C\u800CREQUIRED_NEW\u60C5\u51B5\u4E0B\uFF0C\u539F\u6709\u4E8B\u52A1\u56DE\u6EDA\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u65B0\u5F00\u542F\u7684\u4E8B\u52A1</p><p><strong>NESTED\u548CREQUIRED\u7684\u533A\u522B\uFF1A</strong></p><p>REQUIRED\u60C5\u51B5\u4E0B\uFF0C\u8C03\u7528\u65B9\u5B58\u5728\u4E8B\u52A1\u65F6\uFF0C\u5219\u88AB\u8C03\u7528\u65B9\u548C\u8C03\u7528\u65B9\u4F7F\u7528\u540C\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u90A3\u4E48\u88AB\u8C03\u7528\u65B9\u51FA\u73B0\u5F02\u5E38\u65F6\uFF0C\u7531\u4E8E\u5171\u7528\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u6240\u4EE5\u65E0\u8BBA\u662F\u5426catch\u5F02\u5E38\uFF0C\u4E8B\u52A1\u90FD\u4F1A\u56DE\u6EDA\uFF0C</p><p>\u800C\u5728NESTED\u60C5\u51B5\u4E0B\uFF0C\u88AB\u8C03\u7528\u65B9\u53D1\u751F\u5F02\u5E38\u65F6\uFF0C\u8C03\u7528\u65B9\u53EF\u4EE5catch\u5176\u5F02\u5E38\uFF0C\u8FD9\u6837\u53EA\u6709\u5B50\u4E8B\u52A1\u56DE\u6EDA\uFF0C\u7236\u4E8B\u52A1\u4E0D\u4F1A\u56DE\u6EDA\u3002</p><h2 id="spring\u4E8B\u52A1\u4EC0\u4E48\u65F6\u5019\u4F1A\u5931\u6548" tabindex="-1"><a class="header-anchor" href="#spring\u4E8B\u52A1\u4EC0\u4E48\u65F6\u5019\u4F1A\u5931\u6548" aria-hidden="true">#</a> spring\u4E8B\u52A1\u4EC0\u4E48\u65F6\u5019\u4F1A\u5931\u6548\uFF1F</h2><ol><li>\u6570\u636E\u5E93\u4E0D\u652F\u6301\u4E8B\u52A1</li><li>\u6570\u636E\u6E90\u6CA1\u6709\u914D\u7F6E\u4E8B\u52A1\u7BA1\u7406\u5668</li><li>bean\u5BF9\u8C61\u6CA1\u6709\u88ABspring\u5BB9\u5668\u7BA1\u7406</li><li>\u6CE8\u89E3\u6807\u6CE8\u65B9\u6CD5\u4FEE\u9970\u7B26\u4E3A\u975Epublic\u65F6\uFF0C@Transactional\u6CE8\u89E3\u5C06\u4F1A\u4E0D\u8D77\u4F5C\u7528</li><li>\u5728\u7C7B\u5185\u90E8\u8C03\u7528\u8C03\u7528\u7C7B\u5185\u90E8@Transactional\u6807\u6CE8\u7684\u65B9\u6CD5\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E0B\u4E5F\u4F1A\u5BFC\u81F4\u4E8B\u52A1\u4E0D\u5F00\u542F\u3002</li><li>\u4E8B\u52A1\u65B9\u6CD5\u5185\u90E8\u6355\u6349\u4E86\u5F02\u5E38\uFF0C\u6CA1\u6709\u629B\u51FA\u65B0\u7684\u5F02\u5E38\uFF0C\u5BFC\u81F4\u4E8B\u52A1\u64CD\u4F5C\u4E0D\u4F1A\u8FDB\u884C\u56DE\u6EDA\u3002</li><li>\u628Aspring\u4E8B\u52A1\u4F20\u64AD\u673A\u5236\u4ECEREQUIRED\u6539\u6210\u4E86REQUIRES_NEW</li></ol><h2 id="\u4EC0\u4E48\u7684\u662Fbean\u7684\u81EA\u52A8\u88C5\u914D-\u5B83\u6709\u54EA\u4E9B\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u7684\u662Fbean\u7684\u81EA\u52A8\u88C5\u914D-\u5B83\u6709\u54EA\u4E9B\u65B9\u5F0F" aria-hidden="true">#</a> \u4EC0\u4E48\u7684\u662Fbean\u7684\u81EA\u52A8\u88C5\u914D\uFF0C\u5B83\u6709\u54EA\u4E9B\u65B9\u5F0F\uFF1F</h2><p>bean\u7684\u81EA\u52A8\u88C5\u914D\u6307\u7684\u662Fbean\u7684\u5C5E\u6027\u503C\u5728\u8FDB\u884C\u6CE8\u5165\u7684\u65F6\u5019\u901A\u8FC7\u67D0\u79CD\u7279\u5B9A\u7684\u89C4\u5219\u548C\u65B9\u5F0F\u53BB\u5BB9\u5668\u4E2D\u67E5\u627E\uFF0C\u5E76\u8BBE\u7F6E\u5230\u5177\u4F53\u7684\u5BF9\u8C61\u5C5E\u6027\u4E2D\uFF0C\u4E3B\u8981\u6709\u4E94\u79CD\u65B9\u5F0F\uFF1A</p><p>no \u2013 \u7F3A\u7701\u60C5\u51B5\u4E0B\uFF0C\u81EA\u52A8\u914D\u7F6E\u662F\u901A\u8FC7\u201Cref\u201D\u5C5E\u6027\u624B\u52A8\u8BBE\u5B9A\uFF0C\u5728\u9879\u76EE\u4E2D\u6700\u5E38\u7528</p><p>byName \u2013 \u6839\u636E\u5C5E\u6027\u540D\u79F0\u81EA\u52A8\u88C5\u914D\u3002\u5982\u679C\u4E00\u4E2Abean\u7684\u540D\u79F0\u548C\u5176\u4ED6bean\u5C5E\u6027\u7684\u540D\u79F0\u662F\u4E00\u6837\u7684\uFF0C\u5C06\u4F1A\u81EA\u88C5\u914D\u5B83\u3002</p><p>byType \u2013 \u6309\u6570\u636E\u7C7B\u578B\u81EA\u52A8\u88C5\u914D\uFF0C\u5982\u679Cbean\u7684\u6570\u636E\u7C7B\u578B\u662F\u7528\u5176\u5B83bean\u5C5E\u6027\u7684\u6570\u636E\u7C7B\u578B\uFF0C\u517C\u5BB9\u5E76\u81EA\u52A8\u88C5\u914D\u5B83\u3002</p><p>constructor \u2013 \u5728\u6784\u9020\u51FD\u6570\u53C2\u6570\u7684byType\u65B9\u5F0F\u3002</p><p>autodetect \u2013 \u5982\u679C\u627E\u5230\u9ED8\u8BA4\u7684\u6784\u9020\u51FD\u6570\uFF0C\u4F7F\u7528\u201C\u81EA\u52A8\u88C5\u914D\u7528\u6784\u9020\u201D; \u5426\u5219\uFF0C\u4F7F\u7528\u201C\u6309\u7C7B\u578B\u81EA\u52A8\u88C5\u914D\u201D\u3002</p><h2 id="spring\u3001springmvc\u3001springboot\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#spring\u3001springmvc\u3001springboot\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> spring\u3001springmvc\u3001springboot\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><p>spring\u548CspringMvc\uFF1A</p><ol><li>spring\u662F\u4E00\u4E2A\u4E00\u7AD9\u5F0F\u7684\u8F7B\u91CF\u7EA7\u7684java\u5F00\u53D1\u6846\u67B6\uFF0C\u6838\u5FC3\u662F\u63A7\u5236\u53CD\u8F6C\uFF08IOC\uFF09\u548C\u9762\u5411\u5207\u9762\uFF08AOP\uFF09\uFF0C\u9488\u5BF9\u4E8E\u5F00\u53D1\u7684WEB\u5C42(springMvc)\u3001\u4E1A\u52A1\u5C42(Ioc)\u3001\u6301\u4E45\u5C42(jdbcTemplate)\u7B49\u90FD\u63D0\u4F9B\u4E86\u591A\u79CD\u914D\u7F6E\u89E3\u51B3\u65B9\u6848\uFF1B</li><li>springMvc\u662Fspring\u57FA\u7840\u4E4B\u4E0A\u7684\u4E00\u4E2AMVC\u6846\u67B6\uFF0C\u4E3B\u8981\u5904\u7406web\u5F00\u53D1\u7684\u8DEF\u5F84\u6620\u5C04\u548C\u89C6\u56FE\u6E32\u67D3\uFF0C\u5C5E\u4E8Espring\u6846\u67B6\u4E2DWEB\u5C42\u5F00\u53D1\u7684\u4E00\u90E8\u5206\uFF1B</li></ol><p>springMvc\u548CspringBoot\uFF1A</p><ol><li>springMvc\u5C5E\u4E8E\u4E00\u4E2A\u4F01\u4E1AWEB\u5F00\u53D1\u7684MVC\u6846\u67B6\uFF0C\u6DB5\u76D6\u9762\u5305\u62EC\u524D\u7AEF\u89C6\u56FE\u5F00\u53D1\u3001\u6587\u4EF6\u914D\u7F6E\u3001\u540E\u53F0\u63A5\u53E3\u903B\u8F91\u5F00\u53D1\u7B49\uFF0CXML\u3001config\u7B49\u914D\u7F6E\u76F8\u5BF9\u6BD4\u8F83\u7E41\u7410\u590D\u6742\uFF1B</li><li>springBoot\u6846\u67B6\u76F8\u5BF9\u4E8EspringMvc\u6846\u67B6\u6765\u8BF4\uFF0C\u66F4\u4E13\u6CE8\u4E8E\u5F00\u53D1\u5FAE\u670D\u52A1\u540E\u53F0\u63A5\u53E3\uFF0C\u4E0D\u5F00\u53D1\u524D\u7AEF\u89C6\u56FE\uFF0C\u540C\u65F6\u9075\u5FAA\u9ED8\u8BA4\u4F18\u4E8E\u914D\u7F6E\uFF0C\u7B80\u5316\u4E86\u63D2\u4EF6\u914D\u7F6E\u6D41\u7A0B\uFF0C\u4E0D\u9700\u8981\u914D\u7F6Exml\uFF0C\u76F8\u5BF9springmvc\uFF0C\u5927\u5927\u7B80\u5316\u4E86\u914D\u7F6E\u6D41\u7A0B\uFF1B</li></ol><p>\u603B\u7ED3\uFF1A</p><ol><li>Spring \u6846\u67B6\u5C31\u50CF\u4E00\u4E2A\u5BB6\u65CF\uFF0C\u6709\u4F17\u591A\u884D\u751F\u4EA7\u54C1\u4F8B\u5982 boot\u3001security\u3001jpa\u7B49\u7B49\u3002\u4F46\u4ED6\u4EEC\u7684\u57FA\u7840\u90FD\u662FSpring\u7684ioc\u3001aop\u7B49. ioc \u63D0\u4F9B\u4E86\u4F9D\u8D56\u6CE8\u5165\u7684\u5BB9\u5668\uFF0C aop\u89E3\u51B3\u4E86\u9762\u5411\u6A2A\u5207\u9762\u7F16\u7A0B\uFF0C\u7136\u540E\u5728\u6B64\u4E24\u8005\u7684\u57FA\u7840\u4E0A\u5B9E\u73B0\u4E86\u5176\u4ED6\u5EF6\u4F38\u4EA7\u54C1\u7684\u9AD8\u7EA7\u529F\u80FD\uFF1B</li><li>springMvc\u4E3B\u8981\u89E3\u51B3WEB\u5F00\u53D1\u7684\u95EE\u9898\uFF0C\u662F\u57FA\u4E8EServlet \u7684\u4E00\u4E2AMVC\u6846\u67B6\uFF0C\u901A\u8FC7XML\u914D\u7F6E\uFF0C\u7EDF\u4E00\u5F00\u53D1\u524D\u7AEF\u89C6\u56FE\u548C\u540E\u7AEF\u903B\u8F91\uFF1B</li><li></li></ol><p>\u7531\u4E8ESpring\u7684\u914D\u7F6E\u975E\u5E38\u590D\u6742\uFF0C\u5404\u79CDXML\u3001JavaConfig\u3001servlet\u5904\u7406\u8D77\u6765\u6BD4\u8F83\u7E41\u7410\uFF0C\u4E3A\u4E86\u7B80\u5316\u5F00\u53D1\u8005\u7684\u4F7F\u7528\uFF0C\u4ECE\u800C\u521B\u9020\u6027\u5730\u63A8\u51FA\u4E86springBoot\u6846\u67B6\uFF0C\u9ED8\u8BA4\u4F18\u4E8E\u914D\u7F6E\uFF0C\u7B80\u5316\u4E86springMvc\u7684\u914D\u7F6E\u6D41\u7A0B\uFF1B\u4F46\u533A\u522B\u4E8EspringMvc\u7684\u662F\uFF0CspringBoot\u4E13\u6CE8\u4E8E\u5355\u4F53\u5FAE\u670D\u52A1\u63A5\u53E3\u5F00\u53D1\uFF0C\u548C\u524D\u7AEF\u89E3\u8026\uFF0C\u867D\u7136springBoot\u4E5F\u53EF\u4EE5\u505A\u6210springMvc\u524D\u540E\u53F0\u4E00\u8D77\u5F00\u53D1\uFF0C\u4F46\u662F\u8FD9\u5C31\u6709\u70B9\u4E0D\u7B26\u5408springBoot\u6846\u67B6\u7684\u521D\u8877\u4E86\uFF1B</p><h2 id="springmvc\u5DE5\u4F5C\u6D41\u7A0B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#springmvc\u5DE5\u4F5C\u6D41\u7A0B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> springmvc\u5DE5\u4F5C\u6D41\u7A0B\u662F\u4EC0\u4E48\uFF1F</h2><p>\u5F53\u53D1\u8D77\u8BF7\u6C42\u65F6\u88AB\u524D\u7F6E\u7684\u63A7\u5236\u5668\u62E6\u622A\u5230\u8BF7\u6C42\uFF0C\u6839\u636E\u8BF7\u6C42\u53C2\u6570\u751F\u6210\u4EE3\u7406\u8BF7\u6C42\uFF0C\u627E\u5230\u8BF7\u6C42\u5BF9\u5E94\u7684\u5B9E\u9645\u63A7\u5236\u5668\uFF0C\u63A7\u5236\u5668\u5904\u7406\u8BF7\u6C42\uFF0C\u521B\u5EFA\u6570\u636E\u6A21\u578B\uFF0C\u8BBF\u95EE\u6570\u636E\u5E93\uFF0C \u5C06\u6A21\u578B\u54CD\u5E94\u7ED9\u4E2D\u5FC3\u63A7\u5236\u5668\uFF0C\u63A7\u5236\u5668\u4F7F\u7528\u6A21\u578B\u4E0E\u89C6\u56FE\u6E32\u67D3\u89C6\u56FE\u7ED3\u679C\uFF0C\u5C06\u7ED3\u679C\u8FD4\u56DE\u7ED9\u4E2D\u5FC3\u63A7\u5236\u5668\uFF0C\u518D\u5C06\u7ED3\u679C\u8FD4\u56DE\u7ED9\u8BF7\u6C42\u8005\u3002</p><p><img src="`+u+'" alt="img.png"></p><ol><li>DispatcherServlet\u8868\u793A\u524D\u7F6E\u63A7\u5236\u5668\uFF0C\u662F\u6574\u4E2ASpringMVC\u7684\u63A7\u5236\u4E2D\u5FC3\u3002\u7528\u6237\u53D1\u51FA\u8BF7\u6C42\uFF0CDispatcherServlet\u63A5\u6536\u8BF7\u6C42\u5E76\u62E6\u622A\u8BF7\u6C42\u3002</li><li>HandlerMapping\u4E3A\u5904\u7406\u5668\u6620\u5C04\u3002DispatcherServlet\u8C03\u7528HandlerMapping,HandlerMapping\u6839\u636E\u8BF7\u6C42url\u67E5\u627EHandler\u3002</li><li>\u8FD4\u56DE\u5904\u7406\u5668\u6267\u884C\u94FE\uFF0C\u6839\u636Eurl\u67E5\u627E\u63A7\u5236\u5668\uFF0C\u5E76\u4E14\u5C06\u89E3\u6790\u540E\u7684\u4FE1\u606F\u4F20\u9012\u7ED9DispatcherServlet</li><li>HandlerAdapter\u8868\u793A\u5904\u7406\u5668\u9002\u914D\u5668\uFF0C\u5176\u6309\u7167\u7279\u5B9A\u7684\u89C4\u5219\u53BB\u6267\u884CHandler\u3002</li><li>\u6267\u884Chandler\u627E\u5230\u5177\u4F53\u7684\u5904\u7406\u5668</li><li>Controller\u5C06\u5177\u4F53\u7684\u6267\u884C\u4FE1\u606F\u8FD4\u56DE\u7ED9HandlerAdapter,\u5982ModelAndView\u3002</li><li>HandlerAdapter\u5C06\u89C6\u56FE\u903B\u8F91\u540D\u6216\u6A21\u578B\u4F20\u9012\u7ED9DispatcherServlet\u3002</li><li>DispatcherServlet\u8C03\u7528\u89C6\u56FE\u89E3\u6790\u5668(ViewResolver)\u6765\u89E3\u6790HandlerAdapter\u4F20\u9012\u7684\u903B\u8F91\u89C6\u56FE\u540D\u3002</li><li>\u89C6\u56FE\u89E3\u6790\u5668\u5C06\u89E3\u6790\u7684\u903B\u8F91\u89C6\u56FE\u540D\u4F20\u7ED9DispatcherServlet\u3002</li><li>DispatcherServlet\u6839\u636E\u89C6\u56FE\u89E3\u6790\u5668\u89E3\u6790\u7684\u89C6\u56FE\u7ED3\u679C\uFF0C\u8C03\u7528\u5177\u4F53\u7684\u89C6\u56FE\uFF0C\u8FDB\u884C\u8BD5\u56FE\u6E32\u67D3</li><li>\u5C06\u54CD\u5E94\u6570\u636E\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF</li></ol><h2 id="springmvc\u7684\u4E5D\u5927\u7EC4\u4EF6\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#springmvc\u7684\u4E5D\u5927\u7EC4\u4EF6\u6709\u54EA\u4E9B" aria-hidden="true">#</a> springmvc\u7684\u4E5D\u5927\u7EC4\u4EF6\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>HandlerMapping</li></ol><p>\u6839\u636Erequest\u627E\u5230\u76F8\u5E94\u7684\u5904\u7406\u5668\u3002\u56E0\u4E3AHandler\uFF08Controller\uFF09\u6709\u4E24\u79CD\u5F62\u5F0F\uFF0C\u4E00\u79CD\u662F\u57FA\u4E8E\u7C7B\u7684Handler\uFF0C\u53E6\u4E00\u79CD\u662F\u57FA\u4E8EMethod\u7684Handler\uFF08\u4E5F\u5C31\u662F\u6211\u4EEC\u5E38\u7528\u7684\uFF09</p><ol start="2"><li>HandlerAdapter</li></ol><p>\u8C03\u7528Handler\u7684\u9002\u914D\u5668\u3002\u5982\u679C\u628AHandler\uFF08Controller\uFF09\u5F53\u505A\u5DE5\u5177\u7684\u8BDD\uFF0C\u90A3\u4E48HandlerAdapter\u5C31\u76F8\u5F53\u4E8E\u5E72\u6D3B\u7684\u5DE5\u4EBA</p><ol start="3"><li>HandlerExceptionResolver</li></ol><p>\u5BF9\u5F02\u5E38\u7684\u5904\u7406</p><ol start="4"><li>ViewResolver</li></ol><p>\u7528\u6765\u5C06String\u7C7B\u578B\u7684\u89C6\u56FE\u540D\u548CLocale\u89E3\u6790\u4E3AView\u7C7B\u578B\u7684\u89C6\u56FE</p><ol start="5"><li>RequestToViewNameTranslator</li></ol><p>\u6709\u7684Handler\uFF08Controller\uFF09\u5904\u7406\u5B8C\u540E\u6CA1\u6709\u8BBE\u7F6E\u8FD4\u56DE\u7C7B\u578B\uFF0C\u6BD4\u5982\u662Fvoid\u65B9\u6CD5\uFF0C\u8FD9\u662F\u5C31\u9700\u8981\u4ECErequest\u4E2D\u83B7\u53D6viewName</p><ol start="6"><li>LocaleResolver</li></ol><p>\u4ECErequest\u4E2D\u89E3\u6790\u51FALocale\u3002Locale\u8868\u793A\u4E00\u4E2A\u533A\u57DF\uFF0C\u6BD4\u5982zh-cn\uFF0C\u5BF9\u4E0D\u540C\u7684\u533A\u57DF\u7684\u7528\u6237\uFF0C\u663E\u793A\u4E0D\u540C\u7684\u7ED3\u679C\uFF0C\u8FD9\u5C31\u662Fi18n\uFF08SpringMVC\u4E2D\u6709\u5177\u4F53\u7684\u62E6\u622A\u5668LocaleChangeInterceptor\uFF09</p><ol start="7"><li>ThemeResolver</li></ol><p>\u4E3B\u9898\u89E3\u6790\uFF0C\u8FD9\u79CD\u7C7B\u4F3C\u4E8E\u6211\u4EEC\u624B\u673A\u66F4\u6362\u4E3B\u9898\uFF0C\u4E0D\u540C\u7684UI\uFF0Ccss\u7B49</p><ol start="8"><li>MultipartResolver</li></ol><p>\u5904\u7406\u4E0A\u4F20\u8BF7\u6C42\uFF0C\u5C06\u666E\u901A\u7684request\u5C01\u88C5\u6210MultipartHttpServletRequest</p><ol start="9"><li>FlashMapManager</li></ol><p>\u7528\u4E8E\u7BA1\u7406FlashMap\uFF0CFlashMap\u7528\u4E8E\u5728redirect\u91CD\u5B9A\u5411\u4E2D\u4F20\u9012\u53C2\u6570</p><h2 id="springboot\u81EA\u52A8\u914D\u7F6E\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#springboot\u81EA\u52A8\u914D\u7F6E\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> springboot\u81EA\u52A8\u914D\u7F6E\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u5728\u4E4B\u524D\u7684\u8BFE\u7A0B\u4E2D\u6211\u4EEC\u8BB2\u89E3\u4E86springboot\u7684\u542F\u52A8\u8FC7\u7A0B\uFF0C\u5176\u5B9E\u5728\u9762\u8BD5\u8FC7\u7A0B\u4E2D\u95EE\u7684\u6700\u591A\u7684\u53EF\u80FD\u662F\u81EA\u52A8\u88C5\u914D\u7684\u539F\u7406\uFF0C\u800C\u81EA\u52A8\u88C5\u914D\u662F\u5728\u542F\u52A8\u8FC7\u7A0B\u4E2D\u5B8C\u6210\uFF0C\u53EA\u4E0D\u8FC7\u5728\u521A\u5F00\u59CB\u7684\u65F6\u5019\u6211\u4EEC\u9009\u62E9\u6027\u7684\u8DF3\u8FC7\u4E86\uFF0C\u4E0B\u9762\u8BE6\u7EC6\u8BB2\u89E3\u81EA\u52A8\u88C5\u914D\u7684\u8FC7\u7A0B\u3002</p>',443),b=e(`<ol><li>\u5728springboot\u7684\u542F\u52A8\u8FC7\u7A0B\u4E2D\uFF0C\u6709\u4E00\u4E2A\u6B65\u9AA4\u662F\u521B\u5EFA\u4E0A\u4E0B\u6587\uFF0C\u5982\u679C\u4E0D\u8BB0\u5F97\u53EF\u4EE5\u770B\u4E0B\u9762\u7684\u4EE3\u7801\uFF1A</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ConfigurableApplicationContext</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">StopWatch</span> stopWatch<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ConfigurableApplicationContext</span> context<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpringBootExceptionReporter</span><span class="token punctuation">&gt;</span></span> exceptionReporters<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">configureHeadlessProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SpringApplicationRunListeners</span> listeners<span class="token operator">=</span><span class="token function">getRunListeners</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">starting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token class-name">ApplicationArguments</span> applicationArguments<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DefaultApplicationArguments</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ConfigurableEnvironment</span> environment<span class="token operator">=</span><span class="token function">prepareEnvironment</span><span class="token punctuation">(</span>listeners<span class="token punctuation">,</span>applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">configureIgnoreBeanInfo</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Banner</span> printedBanner<span class="token operator">=</span><span class="token function">printBanner</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token operator">=</span><span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        exceptionReporters<span class="token operator">=</span><span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span><span class="token class-name">SpringBootExceptionReporter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">ConfigurableApplicationContext</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6B64\u5904\u5B8C\u6210\u81EA\u52A8\u88C5\u914D\u7684\u8FC7\u7A0B</span>
        <span class="token function">prepareContext</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>environment<span class="token punctuation">,</span>listeners<span class="token punctuation">,</span>applicationArguments<span class="token punctuation">,</span>printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">refreshContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">afterRefresh</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">StartupInfoLogger</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logStarted</span><span class="token punctuation">(</span><span class="token function">getApplicationLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>stopWatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        listeners<span class="token punctuation">.</span><span class="token function">started</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callRunners</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">handleRunFailure</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>ex<span class="token punctuation">,</span>exceptionReporters<span class="token punctuation">,</span>listeners<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span><span class="token punctuation">{</span>
        listeners<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">handleRunFailure</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>ex<span class="token punctuation">,</span>exceptionReporters<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> context<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u5728 prepareContext \u65B9\u6CD5\u4E2D\u67E5\u627E load \u65B9\u6CD5\uFF0C\u4E00\u5C42\u4E00\u5C42\u5411\u5185\u70B9\u51FB\uFF0C\u627E\u5230\u6700\u7EC8\u7684load\u65B9\u6CD5</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//prepareContext\u65B9\u6CD5</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">prepareContext</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span><span class="token class-name">ConfigurableEnvironment</span> environment<span class="token punctuation">,</span>
        <span class="token class-name">SpringApplicationRunListeners</span> listeners<span class="token punctuation">,</span><span class="token class-name">ApplicationArguments</span> applicationArguments<span class="token punctuation">,</span><span class="token class-name">Banner</span> printedBanner<span class="token punctuation">)</span><span class="token punctuation">{</span>
        context<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">postProcessApplicationContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">applyInitializers</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">contextPrepared</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">logStartupInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">logStartupProfileInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Add boot specific singleton beans</span>
        <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token operator">=</span>context<span class="token punctuation">.</span><span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">&quot;springApplicationArguments&quot;</span><span class="token punctuation">,</span>applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>printedBanner<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">&quot;springBootBanner&quot;</span><span class="token punctuation">,</span>printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">)</span>beanFactory<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setAllowBeanDefinitionOverriding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowBeanDefinitionOverriding<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazyInitialization<span class="token punctuation">)</span><span class="token punctuation">{</span>
        context<span class="token punctuation">.</span><span class="token function">addBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LazyInitializationBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Load the sources</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> sources<span class="token operator">=</span><span class="token function">getAllSources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>sources<span class="token punctuation">,</span><span class="token string">&quot;Sources must not be empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//load\u65B9\u6CD5\u5B8C\u6210\u8BE5\u529F\u80FD</span>
        <span class="token function">load</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>sources<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">contextLoaded</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


<span class="token doc-comment comment">/**
 * Load beans into the application context.
 * <span class="token keyword">@param</span> <span class="token parameter">context</span> the context to load beans into
 * <span class="token keyword">@param</span> <span class="token parameter">sources</span> the sources to load
 * \u52A0\u8F7Dbean\u5BF9\u8C61\u5230context\u4E2D
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span>sources<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Loading source &quot;</span><span class="token operator">+</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">arrayToCommaDelimitedString</span><span class="token punctuation">(</span>sources<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u83B7\u53D6bean\u5BF9\u8C61\u5B9A\u4E49\u7684\u52A0\u8F7D\u5668</span>
        <span class="token class-name">BeanDefinitionLoader</span> loader<span class="token operator">=</span><span class="token function">createBeanDefinitionLoader</span><span class="token punctuation">(</span><span class="token function">getBeanDefinitionRegistry</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">,</span>sources<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanNameGenerator<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">.</span><span class="token function">setBeanNameGenerator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanNameGenerator<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">.</span><span class="token function">setResourceLoader</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>environment<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token doc-comment comment">/**
         * Load the sources into the reader.
         * <span class="token keyword">@return</span> the number of loaded beans
         */</span>
        <span class="token keyword">int</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>sources<span class="token punctuation">)</span><span class="token punctuation">{</span>
        count<span class="token operator">+=</span><span class="token function">load</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5B9E\u9645\u6267\u884Cload\u7684\u662FBeanDefinitionLoader\u4E2D\u7684load\u65B9\u6CD5\uFF0C\u5982\u4E0B\uFF1A</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token comment">//\u5B9E\u9645\u8BB0\u8F7Dbean\u7684\u65B9\u6CD5</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span><span class="token string">&quot;Source must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5982\u679C\u662Fclass\u7C7B\u578B\uFF0C\u542F\u7528\u6CE8\u89E3\u7C7B\u578B</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>source <span class="token keyword">instanceof</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u5982\u679C\u662Fresource\u7C7B\u578B\uFF0C\u542F\u52A8xml\u89E3\u6790</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>source <span class="token keyword">instanceof</span> <span class="token class-name">Resource</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Resource</span><span class="token punctuation">)</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u5982\u679C\u662Fpackage\u7C7B\u578B\uFF0C\u542F\u7528\u626B\u63CF\u5305\uFF0C\u4F8B\u5982@ComponentScan</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>source <span class="token keyword">instanceof</span> <span class="token class-name">Package</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Package</span><span class="token punctuation">)</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u5982\u679C\u662F\u5B57\u7B26\u4E32\u7C7B\u578B\uFF0C\u76F4\u63A5\u52A0\u8F7D</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>source <span class="token keyword">instanceof</span> <span class="token class-name">CharSequence</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span><span class="token punctuation">)</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid source type &quot;</span><span class="token operator">+</span>source<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u4E0B\u9762\u65B9\u6CD5\u5C06\u7528\u6765\u5224\u65AD\u662F\u5426\u8D44\u6E90\u7684\u7C7B\u578B\uFF0C\u662F\u4F7F\u7528groovy\u52A0\u8F7D\u8FD8\u662F\u4F7F\u7528\u6CE8\u89E3\u7684\u65B9\u5F0F</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> source<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u5224\u65AD\u4F7F\u7528groovy\u811A\u672C</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isGroovyPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token class-name">GroovyBeanDefinitionSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// Any GroovyLoaders added in beans{} DSL can contribute beans here</span>
        <span class="token class-name">GroovyBeanDefinitionSource</span> loader<span class="token operator">=</span><span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">instantiateClass</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span><span class="token class-name">GroovyBeanDefinitionSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">load</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u4F7F\u7528\u6CE8\u89E3\u52A0\u8F7D</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isComponent</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>annotatedReader<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li></li></ol><p>\u4E0B\u9762\u65B9\u6CD5\u5224\u65AD\u542F\u52A8\u7C7B\u4E2D\u662F\u5426\u5305\u542B@Component\u6CE8\u89E3\uFF0C\u4F46\u662F\u4F1A\u795E\u5947\u7684\u53D1\u73B0\u6211\u4EEC\u7684\u542F\u52A8\u7C7B\u4E2D\u5E76\u6CA1\u6709\u8BE5\u6CE8\u89E3\uFF0C\u7EE7\u7EED\u66F4\u8FDB\u53D1\u73B0MergedAnnotations\u7C7B\u4F20\u5165\u4E86\u4E00\u4E2A\u53C2\u6570SearchStrategy.TYPE_HIERARCHY\uFF0C\u4F1A\u67E5\u627E\u7EE7\u627F\u5173\u7CFB\u4E2D\u662F\u5426\u5305\u542B\u8FD9\u4E2A\u6CE8\u89E3\uFF0C@SpringBootApplication--&gt; @SpringBootConfiguration--&gt;@Configuration--&gt;@Component,\u5F53\u627E\u5230@Component\u6CE8\u89E3\u4E4B\u540E\uFF0C\u4F1A\u628A\u8BE5\u5BF9\u8C61\u6CE8\u518C\u5230AnnotatedBeanDefinitionReader\u5BF9\u8C61\u4E2D</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isComponent</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// This has to be a bit of a guess. The only way to be sure that this type is</span>
        <span class="token comment">// eligible is to make a bean definition out of it and try to instantiate it.</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">MergedAnnotations</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span><span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span>TYPE_HIERARCHY<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Nested anonymous classes are not eligible for registration, nor are groovy</span>
        <span class="token comment">// closures</span>
        <span class="token keyword">return</span><span class="token operator">!</span>type<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;.*\\\\$_.*closure.*&quot;</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>type<span class="token punctuation">.</span><span class="token function">isAnonymousClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">&amp;&amp;</span>type<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span>type<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Register a bean from the given bean class, deriving its metadata from
 * class-declared annotations.
 * \u4ECE\u7ED9\u5B9A\u7684bean class\u4E2D\u6CE8\u518C\u4E00\u4E2Abean\u5BF9\u8C61\uFF0C\u4ECE\u6CE8\u89E3\u4E2D\u627E\u5230\u76F8\u5173\u7684\u5143\u6570\u636E
 */</span>
<span class="token keyword">private</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">doRegisterBean</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">,</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
<span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token keyword">extends</span> <span class="token class-name">Annotation</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span>qualifiers<span class="token punctuation">,</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">,</span>
<span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanDefinitionCustomizer</span><span class="token punctuation">[</span><span class="token punctuation">]</span>customizers<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">AnnotatedGenericBeanDefinition</span> abd<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">AnnotatedGenericBeanDefinition</span><span class="token punctuation">(</span>beanClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conditionEvaluator<span class="token punctuation">.</span><span class="token function">shouldSkip</span><span class="token punctuation">(</span>abd<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        abd<span class="token punctuation">.</span><span class="token function">setInstanceSupplier</span><span class="token punctuation">(</span>supplier<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ScopeMetadata</span> scopeMetadata<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>scopeMetadataResolver<span class="token punctuation">.</span><span class="token function">resolveScopeMetadata</span><span class="token punctuation">(</span>abd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        abd<span class="token punctuation">.</span><span class="token function">setScope</span><span class="token punctuation">(</span>scopeMetadata<span class="token punctuation">.</span><span class="token function">getScopeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> beanName<span class="token operator">=</span><span class="token punctuation">(</span>name<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">?</span>name<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>beanNameGenerator<span class="token punctuation">.</span><span class="token function">generateBeanName</span><span class="token punctuation">(</span>abd<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">processCommonDefinitionAnnotations</span><span class="token punctuation">(</span>abd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>qualifiers<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token keyword">extends</span> <span class="token class-name">Annotation</span><span class="token punctuation">&gt;</span></span> qualifier<span class="token operator">:</span>qualifiers<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Primary</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">==</span>qualifier<span class="token punctuation">)</span><span class="token punctuation">{</span>
        abd<span class="token punctuation">.</span><span class="token function">setPrimary</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Lazy</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">==</span>qualifier<span class="token punctuation">)</span><span class="token punctuation">{</span>
        abd<span class="token punctuation">.</span><span class="token function">setLazyInit</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        abd<span class="token punctuation">.</span><span class="token function">addQualifier</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AutowireCandidateQualifier</span><span class="token punctuation">(</span>qualifier<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>customizers<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionCustomizer</span> customizer<span class="token operator">:</span>customizers<span class="token punctuation">)</span><span class="token punctuation">{</span>
        customizer<span class="token punctuation">.</span><span class="token function">customize</span><span class="token punctuation">(</span>abd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">BeanDefinitionHolder</span> definitionHolder<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">(</span>abd<span class="token punctuation">,</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        definitionHolder<span class="token operator">=</span><span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">applyScopedProxyMode</span><span class="token punctuation">(</span>scopeMetadata<span class="token punctuation">,</span>definitionHolder<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanDefinitionReaderUtils</span><span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span>definitionHolder<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Register the given bean definition with the given bean factory.
 * \u6CE8\u518C\u4E3B\u7C7B\uFF0C\u5982\u679C\u6709\u522B\u540D\u53EF\u4EE5\u8BBE\u7F6E\u522B\u540D
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span>
        <span class="token class-name">BeanDefinitionHolder</span> definitionHolder<span class="token punctuation">,</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">{</span>

        <span class="token comment">// Register bean definition under primary name.</span>
        <span class="token class-name">String</span> beanName<span class="token operator">=</span>definitionHolder<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span>definitionHolder<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Register aliases for bean name, if any.</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>aliases<span class="token operator">=</span>definitionHolder<span class="token punctuation">.</span><span class="token function">getAliases</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>aliases<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> alias<span class="token operator">:</span>aliases<span class="token punctuation">)</span><span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">registerAlias</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span>alias<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

<span class="token comment">//@SpringBootApplication</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">//@SpringBootConfiguration</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootConfiguration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">//@Configuration</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u770B\u5B8C\u4E0A\u8FF0\u4EE3\u7801\u4E4B\u540E\uFF0C\u53EA\u662F\u5B8C\u6210\u4E86\u542F\u52A8\u5BF9\u8C61\u7684\u6CE8\u5165\uFF0C\u81EA\u52A8\u88C5\u914D\u8FD8\u6CA1\u6709\u5F00\u59CB\uFF0C\u4E0B\u9762\u5F00\u59CB\u8FDB\u5165\u5230\u81EA\u52A8\u88C5\u914D\u3002</p><ol start="6"><li>\u81EA\u52A8\u88C5\u914D\u5165\u53E3\uFF0C\u4ECE\u5237\u65B0\u5BB9\u5668\u5F00\u59CB</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">,</span><span class="token class-name">IllegalStateException</span><span class="token punctuation">{</span>
<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startupShutdownMonitor<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// Prepare this context for refreshing.</span>
        <span class="token function">prepareRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Tell the subclass to refresh the internal bean factory.</span>
        <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token operator">=</span><span class="token function">obtainFreshBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Prepare the bean factory for use in this context.</span>
        <span class="token function">prepareBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token comment">// Allows post-processing of the bean factory in context subclasses.</span>
        <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Invoke factory processors registered as beans in the context.</span>
        <span class="token comment">// \u6B64\u5904\u662F\u81EA\u52A8\u88C5\u914D\u7684\u5165\u53E3</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="7"><li>\u5728invokeBeanFactoryPostProcessors\u65B9\u6CD5\u4E2D\u5B8C\u6210bean\u7684\u5B9E\u4F8B\u5316\u548C\u6267\u884C</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Instantiate and invoke all registered BeanFactoryPostProcessor beans,
 * respecting explicit order if given.
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Must be called before singleton instantiation.
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u5F00\u59CB\u6267\u884CbeanFactoryPostProcessor\u5BF9\u5E94\u5B9E\u73B0\u7C7B,\u9700\u8981\u77E5\u9053\u7684\u662FbeanFactoryPostProcessor\u662Fspring\u7684\u6269\u5C55\u63A5\u53E3\uFF0C\u5728\u5237\u65B0\u5BB9\u5668\u4E4B\u524D\uFF0C\u8BE5\u63A5\u53E3\u53EF\u4EE5\u7528\u6765\u4FEE\u6539bean\u5143\u6570\u636E\u4FE1\u606F</span>
        <span class="token class-name">PostProcessorRegistrationDelegate</span><span class="token punctuation">.</span><span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">,</span><span class="token function">getBeanFactoryPostProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Detect a LoadTimeWeaver and prepare for weaving, if found in the meantime</span>
        <span class="token comment">// (e.g. through an @Bean method registered by ConfigurationClassPostProcessor)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getTempClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span>beanFactory<span class="token punctuation">.</span><span class="token function">containsBean</span><span class="token punctuation">(</span>LOAD_TIME_WEAVER_BEAN_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">addBeanPostProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoadTimeWeaverAwareProcessor</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">setTempClassLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ContextTypeMatchClassLoader</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="8"><li>\u67E5\u770BinvokeBeanFactoryPostProcessors\u7684\u5177\u4F53\u6267\u884C\u65B9\u6CD5</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>
        <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">,</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">&gt;</span></span> beanFactoryPostProcessors<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token comment">// Invoke BeanDefinitionRegistryPostProcessors first, if any.</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> processedBeans<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">BeanDefinitionRegistry</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span><span class="token punctuation">)</span>beanFactory<span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">&gt;</span></span> regularPostProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">&gt;</span></span> registryProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5F00\u59CB\u904D\u5386\u4E09\u4E2A\u5185\u90E8\u7C7B\uFF0C\u5982\u679C\u5C5E\u4E8EBeanDefinitionRegistryPostProcessor\u5B50\u7C7B\uFF0C\u52A0\u5165\u5230bean\u6CE8\u518C\u7684\u96C6\u5408\uFF0C\u5426\u5219\u52A0\u5165\u5230regularPostProcessors</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">BeanFactoryPostProcessor</span> postProcessor<span class="token operator">:</span>beanFactoryPostProcessors<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>postProcessor <span class="token keyword">instanceof</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanDefinitionRegistryPostProcessor</span> registryProcessor<span class="token operator">=</span>
        <span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">)</span>postProcessor<span class="token punctuation">;</span>
        registryProcessor<span class="token punctuation">.</span><span class="token function">postProcessBeanDefinitionRegistry</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registryProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>registryProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        regularPostProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>postProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
        <span class="token comment">// uninitialized to let the bean factory post-processors apply to them!</span>
        <span class="token comment">// Separate between BeanDefinitionRegistryPostProcessors that implement</span>
        <span class="token comment">// PriorityOrdered, Ordered, and the rest.</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">&gt;</span></span> currentRegistryProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// First, invoke the BeanDefinitionRegistryPostProcessors that implement PriorityOrdered.</span>
        <span class="token comment">//\u901A\u8FC7BeanDefinitionRegistryPostProcessor\u83B7\u53D6\u5230\u5BF9\u5E94\u7684\u5904\u7406\u7C7B\u201Corg.springframework.context.annotation.internalConfigurationAnnotationProcessor\u201D\uFF0C\u4F46\u662F\u9700\u8981\u6CE8\u610F\u7684\u662F\u8FD9\u4E2A\u7C7B\u5728springboot\u4E2D\u641C\u7D22\u4E0D\u5230\uFF0C\u8FD9\u4E2A\u7C7B\u7684\u5B8C\u5168\u9650\u5B9A\u540D\u5728AnnotationConfigEmbeddedWebApplicationContext\u4E2D\uFF0C\u5728\u8FDB\u884C\u521D\u59CB\u5316\u7684\u65F6\u5019\u4F1A\u88C5\u914D\u51E0\u4E2A\u7C7B\uFF0C\u5728\u521B\u5EFAAnnotatedBeanDefinitionReader\u5BF9\u8C61\u7684\u65F6\u5019\u4F1A\u5C06\u8BE5\u7C7B\u6CE8\u518C\u5230bean\u5BF9\u8C61\u4E2D\uFF0C\u6B64\u5904\u53EF\u4EE5\u770B\u5230internalConfigurationAnnotationProcessor\u4E3Abean\u540D\u79F0\uFF0C\u5BB9\u5668\u4E2D\u771F\u6B63\u7684\u7C7B\u662FConfigurationClassPostProcessor</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>postProcessorNames<span class="token operator">=</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">getBeanNamesForType</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u9996\u5148\u6267\u884C\u7C7B\u578B\u4E3APriorityOrdered\u7684BeanDefinitionRegistryPostProcessor</span>
        <span class="token comment">//PriorityOrdered\u7C7B\u578B\u8868\u660E\u4E3A\u4F18\u5148\u6267\u884C</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> ppName<span class="token operator">:</span>postProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">isTypeMatch</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">PriorityOrdered</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u83B7\u53D6\u5BF9\u5E94\u7684bean</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u7528\u6765\u5B58\u50A8\u5DF2\u7ECF\u6267\u884C\u8FC7\u7684BeanDefinitionRegistryPostProcessor</span>
        processedBeans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">sortPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registryProcessors<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5F00\u59CB\u6267\u884C\u88C5\u914D\u903B\u8F91</span>
        <span class="token function">invokeBeanDefinitionRegistryPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.</span>
        <span class="token comment">//\u5176\u6B21\u6267\u884C\u7C7B\u578B\u4E3AOrdered\u7684BeanDefinitionRegistryPostProcessor</span>
        <span class="token comment">//Ordered\u8868\u660E\u6309\u987A\u5E8F\u6267\u884C</span>
        postProcessorNames<span class="token operator">=</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBeanNamesForType</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> ppName<span class="token operator">:</span>postProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>processedBeans<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>beanFactory<span class="token punctuation">.</span><span class="token function">isTypeMatch</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        processedBeans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">sortPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registryProcessors<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">invokeBeanDefinitionRegistryPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.</span>
        <span class="token comment">//\u5FAA\u73AF\u4E2D\u6267\u884C\u7C7B\u578B\u4E0D\u4E3APriorityOrdered\uFF0COrdered\u7C7B\u578B\u7684BeanDefinitionRegistryPostProcessor</span>
        <span class="token keyword">boolean</span> reiterate<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>reiterate<span class="token punctuation">)</span><span class="token punctuation">{</span>
        reiterate<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
        postProcessorNames<span class="token operator">=</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBeanNamesForType</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> ppName<span class="token operator">:</span>postProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>processedBeans<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        processedBeans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        reiterate<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">sortPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registryProcessors<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">invokeBeanDefinitionRegistryPostProcessors</span><span class="token punctuation">(</span>currentRegistryProcessors<span class="token punctuation">,</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        currentRegistryProcessors<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Now, invoke the postProcessBeanFactory callback of all processors handled so far.	</span>
        <span class="token comment">//\u6267\u884C\u7236\u7C7B\u65B9\u6CD5\uFF0C\u4F18\u5148\u6267\u884C\u6CE8\u518C\u5904\u7406\u7C7B</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>registryProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6267\u884C\u6709\u89C4\u5219\u5904\u7406\u7C7B</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>regularPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">// Invoke factory processors registered with the context instance.</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactoryPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
        <span class="token comment">// uninitialized to let the bean factory post-processors apply to them!</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>postProcessorNames<span class="token operator">=</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">getBeanNamesForType</span><span class="token punctuation">(</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Separate between BeanFactoryPostProcessors that implement PriorityOrdered,</span>
        <span class="token comment">// Ordered, and the rest.</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">&gt;</span></span> priorityOrderedPostProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> orderedPostProcessorNames<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nonOrderedPostProcessorNames<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> ppName<span class="token operator">:</span>postProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>processedBeans<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// skip - already processed in first phase above</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">isTypeMatch</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">PriorityOrdered</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        priorityOrderedPostProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">isTypeMatch</span><span class="token punctuation">(</span>ppName<span class="token punctuation">,</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        orderedPostProcessorNames<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        nonOrderedPostProcessorNames<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ppName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.</span>
        <span class="token function">sortPostProcessors</span><span class="token punctuation">(</span>priorityOrderedPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>priorityOrderedPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Next, invoke the BeanFactoryPostProcessors that implement Ordered.</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">&gt;</span></span> orderedPostProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>orderedPostProcessorNames<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> postProcessorName<span class="token operator">:</span>orderedPostProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        orderedPostProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>postProcessorName<span class="token punctuation">,</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">sortPostProcessors</span><span class="token punctuation">(</span>orderedPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>orderedPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Finally, invoke all other BeanFactoryPostProcessors.</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">&gt;</span></span> nonOrderedPostProcessors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>nonOrderedPostProcessorNames<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> postProcessorName<span class="token operator">:</span>nonOrderedPostProcessorNames<span class="token punctuation">)</span><span class="token punctuation">{</span>
        nonOrderedPostProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>postProcessorName<span class="token punctuation">,</span><span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>nonOrderedPostProcessors<span class="token punctuation">,</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Clear cached merged bean definitions since the post-processors might have</span>
        <span class="token comment">// modified the original metadata, e.g. replacing placeholders in values...</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">clearMetadataCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="9"><li>\u5F00\u59CB\u6267\u884C\u81EA\u52A8\u914D\u7F6E\u903B\u8F91\uFF08\u542F\u52A8\u7C7B\u6307\u5B9A\u7684\u914D\u7F6E\uFF0C\u975E\u9ED8\u8BA4\u914D\u7F6E\uFF09\uFF0C\u53EF\u4EE5\u901A\u8FC7debug\u7684\u65B9\u5F0F\u4E00\u5C42\u5C42\u5411\u91CC\u8FDB\u884C\u67E5\u627E\uFF0C\u4F1A\u53D1\u73B0\u6700\u7EC8\u4F1A\u5728ConfigurationClassParser\u7C7B\u4E2D\uFF0C\u6B64\u7C7B\u662F\u6240\u6709\u914D\u7F6E\u7C7B\u7684\u89E3\u6790\u7C7B\uFF0C\u6240\u6709\u7684\u89E3\u6790\u903B\u8F91\u5728parser.parse( candidates)\u4E2D</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">&gt;</span></span> configCandidates<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionHolder</span> holder<span class="token operator">:</span>configCandidates<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanDefinition</span> bd<span class="token operator">=</span>holder<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token comment">//\u662F\u5426\u662F\u6CE8\u89E3\u7C7B</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>bd <span class="token keyword">instanceof</span> <span class="token class-name">AnnotatedBeanDefinition</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AnnotatedBeanDefinition</span><span class="token punctuation">)</span>bd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>holder<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>bd <span class="token keyword">instanceof</span> <span class="token class-name">AbstractBeanDefinition</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractBeanDefinition</span><span class="token punctuation">)</span>bd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AbstractBeanDefinition</span><span class="token punctuation">)</span>bd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>holder<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">parse</span><span class="token punctuation">(</span>bd<span class="token punctuation">.</span><span class="token function">getBeanClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>holder<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionStoreException</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Failed to parse configuration class [&quot;</span><span class="token operator">+</span>bd<span class="token punctuation">.</span><span class="token function">getBeanClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//\u6267\u884C\u914D\u7F6E\u7C7B</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deferredImportSelectorHandler<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token function">processConfigurationClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ConfigurationClass</span><span class="token punctuation">(</span>metadata<span class="token punctuation">,</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">processConfigurationClass</span><span class="token punctuation">(</span><span class="token class-name">ConfigurationClass</span> configClass<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conditionEvaluator<span class="token punctuation">.</span><span class="token function">shouldSkip</span><span class="token punctuation">(</span>configClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">ConfigurationPhase</span><span class="token punctuation">.</span>PARSE_CONFIGURATION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">ConfigurationClass</span> existingClass<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>configurationClasses<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>existingClass<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>configClass<span class="token punctuation">.</span><span class="token function">isImported</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>existingClass<span class="token punctuation">.</span><span class="token function">isImported</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        existingClass<span class="token punctuation">.</span><span class="token function">mergeImportedBy</span><span class="token punctuation">(</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Otherwise ignore new imported config class; existing non-imported class overrides it.</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">// Explicit bean definition found, probably replacing an import.</span>
        <span class="token comment">// Let&#39;s remove the old one and go with the new one.</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>configurationClasses<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>knownSuperclasses<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeIf</span><span class="token punctuation">(</span>configClass<span class="token operator">::</span><span class="token function">equals</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Recursively process the configuration class and its superclass hierarchy.</span>
        <span class="token class-name">SourceClass</span> sourceClass<span class="token operator">=</span><span class="token function">asSourceClass</span><span class="token punctuation">(</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span><span class="token punctuation">{</span>
        <span class="token comment">//\u5FAA\u73AF\u5904\u7406bean,\u5982\u679C\u6709\u7236\u7C7B\uFF0C\u5219\u5904\u7406\u7236\u7C7B\uFF0C\u76F4\u81F3\u7ED3\u675F</span>
        sourceClass<span class="token operator">=</span><span class="token function">doProcessConfigurationClass</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>sourceClass<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>configurationClasses<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="10"><li>\u7EE7\u7EED\u8DDF\u8FDBdoProcessConfigurationClass\u65B9\u6CD5\uFF0C\u6B64\u65B9\u5F0F\u662F\u652F\u6301\u6CE8\u89E3\u914D\u7F6E\u7684\u6838\u5FC3\u903B\u8F91</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Apply processing and build a complete <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">ConfigurationClass</span></span><span class="token punctuation">}</span> by reading the
 * annotations, members and methods from the source class. This method can be called
 * multiple times as relevant sources are discovered.
 * <span class="token keyword">@param</span> <span class="token parameter">configClass</span> the configuration class being build
 * <span class="token keyword">@param</span> <span class="token parameter">sourceClass</span> a source class
 * <span class="token keyword">@return</span> the superclass, or <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token keyword">null</span></span></span><span class="token punctuation">}</span> if none found or previously processed
 */</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">SourceClass</span> <span class="token function">doProcessConfigurationClass</span><span class="token punctuation">(</span><span class="token class-name">ConfigurationClass</span> configClass<span class="token punctuation">,</span><span class="token class-name">SourceClass</span> sourceClass<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>

        <span class="token comment">//\u5904\u7406\u5185\u90E8\u7C7B\u903B\u8F91\uFF0C\u7531\u4E8E\u4F20\u6765\u7684\u53C2\u6570\u662F\u542F\u52A8\u7C7B\uFF0C\u5E76\u4E0D\u5305\u542B\u5185\u90E8\u7C7B\uFF0C\u6240\u4EE5\u8DF3\u8FC7</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>configClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isAnnotated</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// Recursively process any member (nested) classes first</span>
        <span class="token function">processMemberClasses</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process any @PropertySource annotations</span>
        <span class="token comment">//\u9488\u5BF9\u5C5E\u6027\u914D\u7F6E\u7684\u89E3\u6790</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">AnnotationAttributes</span> propertySource<span class="token operator">:</span><span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">attributesForRepeatable</span><span class="token punctuation">(</span>
        sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">PropertySources</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span>PropertySource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>environment <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableEnvironment</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">processPropertySource</span><span class="token punctuation">(</span>propertySource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Ignoring @PropertySource annotation on [&quot;</span><span class="token operator">+</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>
        <span class="token string">&quot;]. Reason: Environment must implement ConfigurableEnvironment&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process any @ComponentScan annotations</span>
        <span class="token comment">// \u8FD9\u91CC\u662F\u6839\u636E\u542F\u52A8\u7C7B@ComponentScan\u6CE8\u89E3\u6765\u626B\u63CF\u9879\u76EE\u4E2D\u7684bean</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AnnotationAttributes</span><span class="token punctuation">&gt;</span></span> componentScans<span class="token operator">=</span><span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">attributesForRepeatable</span><span class="token punctuation">(</span>
        sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">ComponentScans</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">ComponentScan</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>componentScans<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>conditionEvaluator<span class="token punctuation">.</span><span class="token function">shouldSkip</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">ConfigurationPhase</span><span class="token punctuation">.</span>REGISTER_BEAN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">AnnotationAttributes</span> componentScan<span class="token operator">:</span>componentScans<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// The config class is annotated with @ComponentScan -&gt; perform the scan immediately</span>
        <span class="token comment">//\u904D\u5386\u9879\u76EE\u4E2D\u7684bean\uFF0C\u5982\u679C\u662F\u6CE8\u89E3\u5B9A\u4E49\u7684bean\uFF0C\u5219\u8FDB\u4E00\u6B65\u89E3\u6790</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BeanDefinitionHolder</span><span class="token punctuation">&gt;</span></span> scannedBeanDefinitions<span class="token operator">=</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>componentScanParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>componentScan<span class="token punctuation">,</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Check the set of scanned definitions for any further config classes and parse recursively if needed</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionHolder</span> holder<span class="token operator">:</span>scannedBeanDefinitions<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanDefinition</span> bdCand<span class="token operator">=</span>holder<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOriginatingBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>bdCand<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        bdCand<span class="token operator">=</span>holder<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">ConfigurationClassUtils</span><span class="token punctuation">.</span><span class="token function">checkConfigurationClassCandidate</span><span class="token punctuation">(</span>bdCand<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>metadataReaderFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u9012\u5F52\u89E3\u6790\uFF0C\u6240\u6709\u7684bean,\u5982\u679C\u6709\u6CE8\u89E3\uFF0C\u4F1A\u8FDB\u4E00\u6B65\u89E3\u6790\u6CE8\u89E3\u4E2D\u5305\u542B\u7684bean</span>
        <span class="token function">parse</span><span class="token punctuation">(</span>bdCand<span class="token punctuation">.</span><span class="token function">getBeanClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>holder<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process any @Import annotations</span>
        <span class="token comment">//\u9012\u5F52\u89E3\u6790\uFF0C\u83B7\u53D6\u5BFC\u5165\u7684\u914D\u7F6E\u7C7B\uFF0C\u5F88\u591A\u60C5\u51B5\u4E0B\uFF0C\u5BFC\u5165\u7684\u914D\u7F6E\u7C7B\u4E2D\u4F1A\u540C\u6837\u5305\u542B\u5BFC\u5165\u7C7B\u6CE8\u89E3</span>
        <span class="token function">processImports</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>sourceClass<span class="token punctuation">,</span><span class="token function">getImports</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Process any @ImportResource annotations</span>
        <span class="token comment">//\u89E3\u6790@ImportResource\u914D\u7F6E\u7C7B</span>
        <span class="token class-name">AnnotationAttributes</span> importResource<span class="token operator">=</span>
        <span class="token class-name">AnnotationConfigUtils</span><span class="token punctuation">.</span><span class="token function">attributesFor</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">ImportResource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>importResource<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>resources<span class="token operator">=</span>importResource<span class="token punctuation">.</span><span class="token function">getStringArray</span><span class="token punctuation">(</span><span class="token string">&quot;locations&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token keyword">extends</span> <span class="token class-name">BeanDefinitionReader</span><span class="token punctuation">&gt;</span></span> readerClass<span class="token operator">=</span>importResource<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token string">&quot;reader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> resource<span class="token operator">:</span>resources<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> resolvedResource<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>environment<span class="token punctuation">.</span><span class="token function">resolveRequiredPlaceholders</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        configClass<span class="token punctuation">.</span><span class="token function">addImportedResource</span><span class="token punctuation">(</span>resolvedResource<span class="token punctuation">,</span>readerClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process individual @Bean methods</span>
        <span class="token comment">//\u5904\u7406@Bean\u6CE8\u89E3\u4FEE\u9970\u7684\u7C7B</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MethodMetadata</span><span class="token punctuation">&gt;</span></span> beanMethods<span class="token operator">=</span><span class="token function">retrieveBeanMethodMetadata</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">MethodMetadata</span> methodMetadata<span class="token operator">:</span>beanMethods<span class="token punctuation">)</span><span class="token punctuation">{</span>
        configClass<span class="token punctuation">.</span><span class="token function">addBeanMethod</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BeanMethod</span><span class="token punctuation">(</span>methodMetadata<span class="token punctuation">,</span>configClass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process default methods on interfaces</span>
        <span class="token comment">// \u5904\u7406\u63A5\u53E3\u4E2D\u7684\u9ED8\u8BA4\u65B9\u6CD5</span>
        <span class="token function">processInterfaces</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Process superclass, if any</span>
        <span class="token comment">//\u5982\u679C\u8BE5\u7C7B\u6709\u7236\u7C7B\uFF0C\u5219\u7EE7\u7EED\u8FD4\u56DE\uFF0C\u4E0A\u5C42\u65B9\u6CD5\u5224\u65AD\u4E0D\u4E3A\u7A7A\uFF0C\u5219\u7EE7\u7EED\u9012\u5F52\u6267\u884C</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasSuperClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> superclass<span class="token operator">=</span>sourceClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSuperClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>superclass<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>superclass<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>
        <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>knownSuperclasses<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>superclass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>knownSuperclasses<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>superclass<span class="token punctuation">,</span>configClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Superclass found, return its annotation metadata and recurse</span>
        <span class="token keyword">return</span> sourceClass<span class="token punctuation">.</span><span class="token function">getSuperClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// No superclass -&gt; processing is complete</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="11"><li>\u67E5\u770B\u83B7\u53D6\u914D\u7F6E\u7C7B\u7684\u903B\u8F91</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token function">processImports</span><span class="token punctuation">(</span>configClass<span class="token punctuation">,</span>sourceClass<span class="token punctuation">,</span><span class="token function">getImports</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Returns <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Import</span></span></span><span class="token punctuation">}</span> class, considering all meta-annotations.
 */</span>
<span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SourceClass</span><span class="token punctuation">&gt;</span></span> <span class="token function">getImports</span><span class="token punctuation">(</span><span class="token class-name">SourceClass</span> sourceClass<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SourceClass</span><span class="token punctuation">&gt;</span></span> imports<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SourceClass</span><span class="token punctuation">&gt;</span></span> visited<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">collectImports</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">,</span>imports<span class="token punctuation">,</span>visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> imports<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token doc-comment comment">/**
 * Recursively collect all declared <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Import</span></span></span><span class="token punctuation">}</span> values. Unlike most
 * meta-annotations it is valid to have several <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Import</span></span></span><span class="token punctuation">}</span>s declared with
 * different values; the usual process of returning values from the first
 * meta-annotation on a class is not sufficient.
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>For example, it is common for a <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Configuration</span></span></span><span class="token punctuation">}</span> class to declare direct
 * <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Import</span></span></span><span class="token punctuation">}</span>s in addition to meta-imports originating from an <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token annotation punctuation">@Enable</span></span></span><span class="token punctuation">}</span>
 * annotation.
 * \u770B\u5230\u6240\u6709\u7684bean\u90FD\u4EE5\u5BFC\u5165\u7684\u65B9\u5F0F\u88AB\u52A0\u8F7D\u8FDB\u53BB
 */</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">collectImports</span><span class="token punctuation">(</span><span class="token class-name">SourceClass</span> sourceClass<span class="token punctuation">,</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SourceClass</span><span class="token punctuation">&gt;</span></span> imports<span class="token punctuation">,</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SourceClass</span><span class="token punctuation">&gt;</span></span> visited<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>visited<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">SourceClass</span> annotation<span class="token operator">:</span>sourceClass<span class="token punctuation">.</span><span class="token function">getAnnotations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> annName<span class="token operator">=</span>annotation<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>annName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Import</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">collectImports</span><span class="token punctuation">(</span>annotation<span class="token punctuation">,</span>imports<span class="token punctuation">,</span>visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        imports<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>sourceClass<span class="token punctuation">.</span><span class="token function">getAnnotationAttributes</span><span class="token punctuation">(</span><span class="token class-name">Import</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="12"><li>\u7EE7\u7EED\u56DE\u5230ConfigurationClassParser\u4E2D\u7684parse\u65B9\u6CD5\u4E2D\u7684\u6700\u540E\u4E00\u884C,\u7EE7\u7EED\u8DDF\u8FDB\u8BE5\u65B9\u6CD5\uFF1A</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">this</span><span class="token punctuation">.</span>deferredImportSelectorHandler<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DeferredImportSelectorHolder</span><span class="token punctuation">&gt;</span></span> deferredImports<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>deferredImportSelectors<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deferredImportSelectors<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>deferredImports<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">DeferredImportSelectorGroupingHandler</span> handler<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DeferredImportSelectorGroupingHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deferredImports<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>DEFERRED_IMPORT_COMPARATOR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        deferredImports<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>handler<span class="token operator">::</span><span class="token function">register</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        handler<span class="token punctuation">.</span><span class="token function">processGroupImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">finally</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deferredImportSelectors<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processGroupImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">DeferredImportSelectorGrouping</span> grouping<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupings<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        grouping<span class="token punctuation">.</span><span class="token function">getImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>entry<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token class-name">ConfigurationClass</span> configurationClass<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>configurationClasses<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>
        entry<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token function">processImports</span><span class="token punctuation">(</span>configurationClass<span class="token punctuation">,</span><span class="token function">asSourceClass</span><span class="token punctuation">(</span>configurationClass<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">asSourceClasses</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getImportClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionStoreException</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Failed to process import candidates for configuration class [&quot;</span><span class="token operator">+</span>
        configurationClass<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token doc-comment comment">/**
 * Return the imports defined by the group.
 * <span class="token keyword">@return</span> each import with its associated configuration class
 */</span>
<span class="token keyword">public</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Group<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&gt;</span></span><span class="token function">getImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">DeferredImportSelectorHolder</span> deferredImport<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>deferredImports<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>deferredImport<span class="token punctuation">.</span><span class="token function">getConfigurationClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        deferredImport<span class="token punctuation">.</span><span class="token function">getImportSelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">public</span> <span class="token class-name">DeferredImportSelector</span> <span class="token function">getImportSelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>importSelector<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">,</span><span class="token class-name">DeferredImportSelector</span> deferredImportSelector<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span>deferredImportSelector <span class="token keyword">instanceof</span> <span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;Only %s implementations are supported, got %s&quot;</span><span class="token punctuation">,</span>
        <span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        deferredImportSelector<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AutoConfigurationEntry</span> autoConfigurationEntry<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">)</span>deferredImportSelector<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token function">getAutoConfigurationMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autoConfigurationEntries<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>autoConfigurationEntry<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> importClassName<span class="token operator">:</span>autoConfigurationEntry<span class="token punctuation">.</span><span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>entries<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>importClassName<span class="token punctuation">,</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5982\u4F55\u7406\u89E3springboot\u4E2D\u7684starter" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u7406\u89E3springboot\u4E2D\u7684starter" aria-hidden="true">#</a> \u5982\u4F55\u7406\u89E3springboot\u4E2D\u7684starter\uFF1F</h2><p>\u4F7F\u7528spring+springmvc\u6846\u67B6\u8FDB\u884C\u5F00\u53D1\u7684\u65F6\u5019\uFF0C\u5982\u679C\u9700\u8981\u5F15\u5165mybatis\u6846\u67B6\uFF0C\u90A3\u4E48\u9700\u8981\u5728xml\u4E2D\u5B9A\u4E49\u9700\u8981\u7684bean\u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u5F88\u660E\u663E\u662F\u5F88\u9EBB\u70E6\u7684\uFF0C\u5982\u679C\u9700\u8981\u5F15\u5165\u989D\u5916\u7684\u5176\u4ED6\u7EC4\u4EF6\uFF0C\u90A3\u4E48\u4E5F\u9700\u8981\u8FDB\u884C\u590D\u6742\u7684\u914D\u7F6E\uFF0C\u56E0\u6B64\u5728springboot\u4E2D\u5F15\u5165\u4E86starter</p><p>\u200B starter\u5C31\u662F\u4E00\u4E2Ajar\u5305\uFF0C\u5199\u4E00\u4E2A@Configuration\u7684\u914D\u7F6E\u7C7B\uFF0C\u5C06\u8FD9\u4E9Bbean\u5B9A\u4E49\u5728\u5176\u4E2D\uFF0C\u7136\u540E\u518Dstarter\u5305\u7684META-INF/spring.factories\u4E2D\u5199\u5165\u914D\u7F6E\u7C7B\uFF0C\u90A3\u4E48springboot\u7A0B\u5E8F\u5728\u542F\u52A8\u7684\u65F6\u5019\u5C31\u4F1A\u6309\u7167\u7EA6\u5B9A\u6765\u52A0\u8F7D\u8BE5\u914D\u7F6E\u7C7B</p><p>\u200B \u5F00\u53D1\u4EBA\u5458\u53EA\u9700\u8981\u5C06\u76F8\u5E94\u7684starter\u5305\u4F9D\u8D56\u8FDB\u5E94\u7528\u4E2D\uFF0C\u8FDB\u884C\u76F8\u5173\u7684\u5C5E\u6027\u914D\u7F6E\uFF0C\u5C31\u53EF\u4EE5\u8FDB\u884C\u4EE3\u7801\u5F00\u53D1\uFF0C\u800C\u4E0D\u9700\u8981\u5355\u72EC\u8FDB\u884Cbean\u5BF9\u8C61\u7684\u914D\u7F6E</p><h2 id="\u4EC0\u4E48\u662F\u5D4C\u5165\u5F0F\u670D\u52A1\u5668-\u4E3A\u4EC0\u4E48\u4F7F\u7528\u5D4C\u5165\u5F0F\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F\u5D4C\u5165\u5F0F\u670D\u52A1\u5668-\u4E3A\u4EC0\u4E48\u4F7F\u7528\u5D4C\u5165\u5F0F\u670D\u52A1\u5668" aria-hidden="true">#</a> \u4EC0\u4E48\u662F\u5D4C\u5165\u5F0F\u670D\u52A1\u5668\uFF0C\u4E3A\u4EC0\u4E48\u4F7F\u7528\u5D4C\u5165\u5F0F\u670D\u52A1\u5668\uFF1F</h2><p>\u5728springboot\u6846\u67B6\u4E2D\uFF0C\u5927\u5BB6\u5E94\u8BE5\u53D1\u73B0\u4E86\u6709\u4E00\u4E2A\u5185\u5D4C\u7684tomcat\uFF0C\u5728\u4E4B\u524D\u7684\u5F00\u53D1\u6D41\u7A0B\u4E2D\uFF0C\u6BCF\u6B21\u5199\u597D\u4EE3\u7801\u4E4B\u540E\u5FC5\u987B\u8981\u5C06\u9879\u76EE\u90E8\u7F72\u5230\u4E00\u4E2A\u989D\u5916\u7684web\u670D\u52A1\u5668\u4E2D\uFF0C\u53EA\u6709\u8FD9\u6837\u624D\u53EF\u4EE5\u8FD0\u884C\uFF0C\u8FD9\u4E2A\u660E\u663E\u8981\u9EBB\u70E6\u5F88\u591A\uFF0C\u800C\u4F7F\u7528springboot\u7684\u65F6\u5019\uFF0C\u4F60\u4F1A\u53D1\u73B0\u5728\u542F\u52A8\u9879\u76EE\u7684\u65F6\u5019\u53EF\u4EE5\u76F4\u63A5\u6309\u7167java\u5E94\u7528\u7A0B\u5E8F\u7684\u65B9\u5F0F\u6765\u542F\u52A8\u9879\u76EE\uFF0C\u4E0D\u9700\u8981\u989D\u5916\u7684\u73AF\u5883\u652F\u6301\uFF0C\u4E5F\u4E0D\u9700\u8981tomcat\u670D\u52A1\u5668\uFF0C\u8FD9\u662F\u56E0\u4E3A\u5728springboot\u6846\u67B6\u4E2D\u5185\u7F6E\u4E86tomcat.jar\uFF0C\u6765\u901A\u8FC7main\u65B9\u6CD5\u542F\u52A8\u5BB9\u5668\uFF0C\u8FBE\u5230\u4E00\u952E\u5F00\u53D1\u90E8\u7F72\u7684\u65B9\u5F0F\uFF0C\u4E0D\u9700\u8981\u989D\u5916\u7684\u4EFB\u4F55\u5176\u4ED6\u64CD\u4F5C\u3002</p><h2 id="mybatis\u7684\u4F18\u7F3A\u70B9\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#mybatis\u7684\u4F18\u7F3A\u70B9\u6709\u54EA\u4E9B" aria-hidden="true">#</a> mybatis\u7684\u4F18\u7F3A\u70B9\u6709\u54EA\u4E9B\uFF1F</h2><p>1\u3001Mybait\u7684\u4F18\u70B9\uFF1A</p><p>\uFF081\uFF09\u7B80\u5355\u6613\u5B66\uFF0C\u5BB9\u6613\u4E0A\u624B\uFF08\u76F8\u6BD4\u4E8EHibernate\uFF09 \u57FA\u4E8ESQL\u7F16\u7A0B\uFF1B \uFF082\uFF09JDBC\u76F8\u6BD4\uFF0C\u51CF\u5C11\u4E8650%\u4EE5\u4E0A\u7684\u4EE3\u7801\u91CF\uFF0C\u6D88\u9664\u4E86JDBC\u5927\u91CF\u5197\u4F59\u7684\u4EE3\u7801\uFF0C\u4E0D\u9700\u8981\u624B\u52A8\u5F00\u5173\u8FDE\u63A5\uFF1B \uFF083\uFF09\u5F88\u597D\u7684\u4E0E\u5404\u79CD\u6570\u636E\u5E93\u517C\u5BB9\uFF08\u56E0\u4E3AMyBatis\u4F7F\u7528JDBC\u6765\u8FDE\u63A5\u6570\u636E\u5E93\uFF0C\u6240\u4EE5\u53EA\u8981JDBC\u652F\u6301\u7684\u6570\u636E\u5E93MyBatis\u90FD\u652F\u6301\uFF0C\u800CJDBC\u63D0\u4F9B\u4E86\u53EF\u6269\u5C55\u6027\uFF0C\u6240\u4EE5\u53EA\u8981\u8FD9\u4E2A\u6570\u636E\u5E93\u6709\u9488\u5BF9Java\u7684jar\u5305\u5C31\u53EF\u4EE5\u5C31\u53EF\u4EE5\u4E0EMyBatis\u517C\u5BB9\uFF09\uFF0C\u5F00\u53D1\u4EBA\u5458\u4E0D\u9700\u8981\u8003\u8651\u6570\u636E\u5E93\u7684\u5DEE\u5F02\u6027\u3002 \uFF084\uFF09\u63D0\u4F9B\u4E86\u5F88\u591A\u7B2C\u4E09\u65B9\u63D2\u4EF6\uFF08\u5206\u9875\u63D2\u4EF6 / \u9006\u5411\u5DE5\u7A0B\uFF09\uFF1B \uFF085\uFF09\u80FD\u591F\u4E0ESpring\u5F88\u597D\u7684\u96C6\u6210\uFF1B \uFF086\uFF09MyBatis\u76F8\u5F53\u7075\u6D3B\uFF0C\u4E0D\u4F1A\u5BF9\u5E94\u7528\u7A0B\u5E8F\u6216\u8005\u6570\u636E\u5E93\u7684\u73B0\u6709\u8BBE\u8BA1\u5F3A\u52A0\u4EFB\u4F55\u5F71\u54CD\uFF0CSQL\u5199\u5728XML\u91CC\uFF0C\u4ECE\u7A0B\u5E8F\u4EE3\u7801\u4E2D\u5F7B\u5E95\u5206\u79BB\uFF0C\u89E3\u9664sql\u4E0E\u7A0B\u5E8F\u4EE3\u7801\u7684\u8026\u5408\uFF0C\u4FBF\u4E8E\u7EDF\u4E00\u7BA1\u7406\u548C\u4F18\u5316\uFF0C\u5E76\u53EF\u91CD\u7528\u3002 \uFF087\uFF09\u63D0\u4F9BXML\u6807\u7B7E\uFF0C\u652F\u6301\u7F16\u5199\u52A8\u6001SQL\u8BED\u53E5\u3002 \uFF088\uFF09\u63D0\u4F9B\u6620\u5C04\u6807\u7B7E\uFF0C\u652F\u6301\u5BF9\u8C61\u4E0E\u6570\u636E\u5E93\u7684ORM\u5B57\u6BB5\u5173\u7CFB\u6620\u5C04\u3002 \uFF089\uFF09\u63D0\u4F9B\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04\u6807\u7B7E\uFF0C\u652F\u6301\u5BF9\u8C61\u5173\u7CFB\u7EC4\u5EFA\u7EF4\u62A4\u3002</p><p>2\u3001MyBatis\u6846\u67B6\u7684\u7F3A\u70B9\uFF1A</p><p>\uFF081\uFF09SQL\u8BED\u53E5\u7684\u7F16\u5199\u5DE5\u4F5C\u91CF\u8F83\u5927\uFF0C\u5C24\u5176\u662F\u5B57\u6BB5\u591A\u3001\u5173\u8054\u8868\u591A\u65F6\uFF0C\u66F4\u662F\u5982\u6B64\uFF0C\u5BF9\u5F00\u53D1\u4EBA\u5458\u7F16\u5199SQL\u8BED\u53E5\u7684\u529F\u5E95\u6709\u4E00\u5B9A\u8981\u6C42\u3002 \uFF082\uFF09SQL\u8BED\u53E5\u4F9D\u8D56\u4E8E\u6570\u636E\u5E93\uFF0C\u5BFC\u81F4\u6570\u636E\u5E93\u79FB\u690D\u6027\u5DEE\uFF0C\u4E0D\u80FD\u968F\u610F\u66F4\u6362\u6570\u636E\u5E93\u3002</p><h2 id="mybatis\u548Chibernate\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#mybatis\u548Chibernate\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> mybatis\u548Chibernate\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</h2><p>Hibernate\u7684\u4F18\u70B9\uFF1A</p><p>1\u3001hibernate\u662F\u5168\u81EA\u52A8\uFF0Chibernate\u5B8C\u5168\u53EF\u4EE5\u901A\u8FC7\u5BF9\u8C61\u5173\u7CFB\u6A21\u578B\u5B9E\u73B0\u5BF9\u6570\u636E\u5E93\u7684\u64CD\u4F5C\uFF0C\u62E5\u6709\u5B8C\u6574\u7684JavaBean\u5BF9\u8C61\u4E0E\u6570\u636E\u5E93\u7684\u6620\u5C04\u7ED3\u6784\u6765\u81EA\u52A8\u751F\u6210sql\u3002</p><p>2\u3001\u529F\u80FD\u5F3A\u5927\uFF0C\u6570\u636E\u5E93\u65E0\u5173\u6027\u597D\uFF0CO/R\u6620\u5C04\u80FD\u529B\u5F3A\uFF0C\u9700\u8981\u5199\u7684\u4EE3\u7801\u5F88\u5C11\uFF0C\u5F00\u53D1\u901F\u5EA6\u5F88\u5FEB\u3002</p><p>3\u3001\u6709\u66F4\u597D\u7684\u4E8C\u7EA7\u7F13\u5B58\u673A\u5236\uFF0C\u53EF\u4EE5\u4F7F\u7528\u7B2C\u4E09\u65B9\u7F13\u5B58\u3002</p><p>4\u3001\u6570\u636E\u5E93\u79FB\u690D\u6027\u826F\u597D\u3002</p><p>5\u3001hibernate\u62E5\u6709\u5B8C\u6574\u7684\u65E5\u5FD7\u7CFB\u7EDF\uFF0Chibernate\u65E5\u5FD7\u7CFB\u7EDF\u975E\u5E38\u5065\u5168\uFF0C\u6D89\u53CA\u5E7F\u6CDB\uFF0C\u5305\u62ECsql\u8BB0\u5F55\u3001\u5173\u7CFB\u5F02\u5E38\u3001\u4F18\u5316\u8B66\u544A\u3001\u7F13\u5B58\u63D0\u793A\u3001\u810F\u6570\u636E\u8B66\u544A\u7B49</p><p>Hibernate\u7684\u7F3A\u70B9\uFF1A</p><p>1\u3001\u5B66\u4E60\u95E8\u69DB\u9AD8\uFF0C\u7CBE\u901A\u95E8\u69DB\u66F4\u9AD8\uFF0C\u7A0B\u5E8F\u5458\u5982\u4F55\u8BBE\u8BA1O/R\u6620\u5C04\uFF0C\u5728\u6027\u80FD\u548C\u5BF9\u8C61\u6A21\u578B\u4E4B\u95F4\u5982\u4F55\u53D6\u5F97\u5E73\u8861\uFF0C\u4EE5\u53CA\u600E\u6837\u7528\u597DHibernate\u65B9\u9762\u9700\u8981\u7684\u7ECF\u9A8C\u548C\u80FD\u529B\u90FD\u5F88\u5F3A\u624D\u884C</p><p>2\u3001hibernate\u7684sql\u5F88\u591A\u90FD\u662F\u81EA\u52A8\u751F\u6210\u7684\uFF0C\u65E0\u6CD5\u76F4\u63A5\u7EF4\u62A4sql\uFF1B\u867D\u7136\u6709hql\u67E5\u8BE2\uFF0C\u4F46\u529F\u80FD\u8FD8\u662F\u4E0D\u53CAsql\u5F3A\u5927\uFF0C\u89C1\u5230\u62A5\u8868\u7B49\u53D8\u6001\u9700\u6C42\u65F6\uFF0Chql\u67E5\u8BE2\u8981\u865A\uFF0C\u4E5F\u5C31\u662F\u8BF4hql\u67E5\u8BE2\u662F\u6709\u5C40\u9650\u7684\uFF1Bhibernate\u867D\u7136\u4E5F\u652F\u6301\u539F\u751Fsql\u67E5\u8BE2\uFF0C\u4F46\u5F00\u53D1\u6A21\u5F0F\u4E0A\u5374\u4E0Eorm\u4E0D\u540C\uFF0C\u9700\u8981\u8F6C\u6362\u601D\u7EF4\uFF0C\u56E0\u6B64\u4F7F\u7528\u4E0A\u6709\u4E9B\u4E0D\u65B9\u4FBF\u3002\u603B\u4E4B\u5199sql\u7684\u7075\u6D3B\u5EA6\u4E0Ahibernate\u4E0D\u53CAmybatis\u3002</p><p>Mybatis\u7684\u4F18\u70B9\uFF1A</p><p>1\u3001\u6613\u4E8E\u4E0A\u624B\u548C\u638C\u63E1\uFF0C\u63D0\u4F9B\u4E86\u6570\u636E\u5E93\u67E5\u8BE2\u7684\u81EA\u52A8\u5BF9\u8C61\u7ED1\u5B9A\u529F\u80FD\uFF0C\u800C\u4E14\u5EF6\u7EED\u4E86\u5F88\u597D\u7684SQL\u4F7F\u7528\u7ECF\u9A8C\uFF0C\u5BF9\u4E8E\u6CA1\u6709\u90A3\u4E48\u9AD8\u7684\u5BF9\u8C61\u6A21\u578B\u8981\u6C42\u7684\u9879\u76EE\u6765\u8BF4\uFF0C\u76F8\u5F53\u5B8C\u7F8E\u3002</p><p>2\u3001sql\u5199\u5728xml\u91CC\uFF0C\u4FBF\u4E8E\u7EDF\u4E00\u7BA1\u7406\u548C\u4F18\u5316\uFF0C \u89E3\u9664sql\u4E0E\u7A0B\u5E8F\u4EE3\u7801\u7684\u8026\u5408\u3002</p><p>3\u3001\u63D0\u4F9B\u6620\u5C04\u6807\u7B7E\uFF0C\u652F\u6301\u5BF9\u8C61\u4E0E\u6570\u636E\u5E93\u7684orm\u5B57\u6BB5\u5173\u7CFB\u6620\u5C04</p><p>4\u3001 \u63D0\u4F9B\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04\u6807\u7B7E\uFF0C\u652F\u6301\u5BF9\u8C61\u5173\u7CFB\u7EC4\u5EFA\u7EF4\u62A4</p><p>5\u3001\u63D0\u4F9Bxml\u6807\u7B7E\uFF0C\u652F\u6301\u7F16\u5199\u52A8\u6001sql\u3002</p><p>6\u3001\u901F\u5EA6\u76F8\u5BF9\u4E8EHibernate\u7684\u901F\u5EA6\u8F83\u5FEB</p><p>Mybatis\u7684\u7F3A\u70B9\uFF1A</p><p>1\u3001\u5173\u8054\u8868\u591A\u65F6\uFF0C\u5B57\u6BB5\u591A\u7684\u65F6\u5019\uFF0Csql\u5DE5\u4F5C\u91CF\u5F88\u5927\u3002</p><p>2\u3001sql\u4F9D\u8D56\u4E8E\u6570\u636E\u5E93\uFF0C\u5BFC\u81F4\u6570\u636E\u5E93\u79FB\u690D\u6027\u5DEE\u3002</p><p>3\u3001\u7531\u4E8Exml\u91CC\u6807\u7B7Eid\u5FC5\u987B\u552F\u4E00\uFF0C\u5BFC\u81F4DAO\u4E2D\u65B9\u6CD5\u4E0D\u652F\u6301\u65B9\u6CD5\u91CD\u8F7D\u3002</p><p>4\u3001\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04\u6807\u7B7E\u548C\u5B57\u6BB5\u6620\u5C04\u6807\u7B7E\u4EC5\u4EC5\u662F\u5BF9\u6620\u5C04\u5173\u7CFB\u7684\u63CF\u8FF0\uFF0C\u5177\u4F53\u5B9E\u73B0\u4ECD\u7136\u4F9D\u8D56\u4E8Esql\u3002</p><p>5\u3001DAO\u5C42\u8FC7\u4E8E\u7B80\u5355\uFF0C\u5BF9\u8C61\u7EC4\u88C5\u7684\u5DE5\u4F5C\u91CF\u8F83\u5927\u3002</p><p>6\u3001\u4E0D\u652F\u6301\u7EA7\u8054\u66F4\u65B0\u3001\u7EA7\u8054\u5220\u9664\u3002</p><p>7\u3001Mybatis\u7684\u65E5\u5FD7\u9664\u4E86\u57FA\u672C\u8BB0\u5F55\u529F\u80FD\u5916\uFF0C\u5176\u5B83\u529F\u80FD\u8584\u5F31\u5F88\u591A\u3002</p><p>8\u3001\u7F16\u5199\u52A8\u6001sql\u65F6,\u4E0D\u65B9\u4FBF\u8C03\u8BD5\uFF0C\u5C24\u5176\u903B\u8F91\u590D\u6742\u65F6\u3002</p><p>9\u3001\u63D0\u4F9B\u7684\u5199\u52A8\u6001sql\u7684xml\u6807\u7B7E\u529F\u80FD\u7B80\u5355\uFF0C\u7F16\u5199\u52A8\u6001sql\u4ECD\u7136\u53D7\u9650\uFF0C\u4E14\u53EF\u8BFB\u6027\u4F4E\u3002</p><h2 id="mybatis\u4E2D-\u548C-\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mybatis\u4E2D-\u548C-\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> mybatis\u4E2D#{}\u548C\${}\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><p>a\u3001#{}\u662F\u9884\u7F16\u8BD1\u5904\u7406\uFF0C\${} \u662F\u5B57\u7B26\u4E32\u66FF\u6362\u3002</p><p>b\u3001Mybatis \u5728\u5904\u7406#{}\u65F6\uFF0C\u4F1A\u5C06 sql \u4E2D\u7684#{}\u66FF\u6362\u4E3A?\u53F7\uFF0C\u8C03\u7528 PreparedStatement \u7684 set \u65B9\u6CD5\u6765\u8D4B\u503C\uFF1B</p><p>c\u3001Mybatis \u5728\u5904\u7406\${}\u65F6\uFF0C\u5C31\u662F\u628A\${}\u66FF\u6362\u6210\u53D8\u91CF\u7684\u503C\u3002</p><p>d\u3001\u4F7F\u7528#{}\u53EF\u4EE5\u6709\u6548\u7684\u9632\u6B62 SQL \u6CE8\u5165\uFF0C\u63D0\u9AD8\u7CFB\u7EDF\u5B89\u5168\u6027</p><h2 id="\u7B80\u8FF0\u4E00\u4E0Bmybatis\u63D2\u4EF6\u8FD0\u884C\u539F\u7406\u53CA\u5F00\u53D1\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7B80\u8FF0\u4E00\u4E0Bmybatis\u63D2\u4EF6\u8FD0\u884C\u539F\u7406\u53CA\u5F00\u53D1\u6D41\u7A0B" aria-hidden="true">#</a> \u7B80\u8FF0\u4E00\u4E0Bmybatis\u63D2\u4EF6\u8FD0\u884C\u539F\u7406\u53CA\u5F00\u53D1\u6D41\u7A0B\uFF1F</h2><p>mybatis\u53EA\u652F\u6301\u9488\u5BF9ParameterHandler\u3001ResultSetHandler\u3001StatementHandler\u3001Executor\u8FD9\u56DB\u79CD\u63A5\u53E3\u7684\u63D2\u4EF6\uFF0Cmybatis\u4F7F\u7528jdk\u7684\u52A8\u6001\u4EE3\u7406\uFF0C\u4E3A\u9700\u8981\u62E6\u622A\u7684\u63A5\u53E3\u751F\u6210\u4EE3\u7406\u5BF9\u8C61\u4EE5\u5B9E\u73B0\u63A5\u53E3\u65B9\u6CD5\u62E6\u622A\u529F\u80FD\uFF0C\u6BCF\u5F53\u6267\u884C\u8FD9\u56DB\u79CD\u63A5\u53E3\u5BF9\u8C61\u7684\u65B9\u6CD5\u65F6\uFF0C\u5C31\u4F1A\u8FDB\u5165\u62E6\u622A\u65B9\u6CD5\uFF0C\u5177\u4F53\u5C31\u662FInvocationHandler\u7684invoke\u65B9\u6CD5\uFF0C\u62E6\u622A\u90A3\u4E9B\u4F60\u6307\u5B9A\u9700\u8981\u62E6\u622A\u7684\u65B9\u6CD5\u3002</p><p>\u7F16\u5199\u63D2\u4EF6\uFF1A\u5B9E\u73B0Mybatis\u7684Interceptor\u63A5\u53E3\u5E76\u590D\u5199intercept\u65B9\u6CD5\u554A\uFF0C\u7136\u540E\u7ED9\u63D2\u4EF6\u7F16\u5199\u6CE8\u89E3\uFF0C\u6307\u5B9A\u8981\u62E6\u622A\u54EA\u4E00\u4E2A\u63A5\u53E3\u7684\u54EA\u4E9B\u65B9\u6CD5\uFF0C\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u914D\u7F6E\u7F16\u5199\u7684\u63D2\u4EF6\u5373\u53EF\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Intercepts</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token annotation punctuation">@Signature</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">StatementHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">&quot;parameterize&quot;</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token class-name">Statement</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u7D22\u5F15\u7684\u57FA\u672C\u539F\u7406</p><p>1\u3001\u4E3A\u4EC0\u4E48\u8981\u6709\u7D22\u5F15? \u4E00\u822C\u7684\u5E94\u7528\u7CFB\u7EDF\uFF0C\u8BFB\u5199\u6BD4\u4F8B\u572810:1\u5DE6\u53F3\uFF0C\u800C\u4E14\u63D2\u5165\u64CD\u4F5C\u548C\u4E00\u822C\u7684\u66F4\u65B0\u64CD\u4F5C\u5F88\u5C11\u51FA\u73B0\u6027\u80FD\u95EE\u9898\uFF0C\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u6211\u4EEC\u9047\u5230\u6700\u591A\u7684\uFF0C\u4E5F\u662F\u6700\u5BB9\u6613\u51FA\u95EE\u9898\u7684\uFF0C\u8FD8\u662F\u4E00\u4E9B\u590D\u6742\u7684\u67E5\u8BE2\u64CD\u4F5C\uFF0C\u56E0\u6B64\u5BF9\u67E5\u8BE2\u8BED\u53E5\u7684\u4F18\u5316\u663E\u7136\u662F\u91CD\u4E2D\u4E4B\u91CD\u3002\u8BF4\u8D77\u52A0\u901F\u67E5\u8BE2\uFF0C\u5C31\u4E0D\u5F97\u4E0D\u63D0\u5230\u7D22\u5F15\u4E86\u3002 2\u3001\u4EC0\u4E48\u662F\u7D22\u5F15\uFF1F \u7D22\u5F15\u5728MySQL\u4E2D\u4E5F\u53EB\u662F\u4E00\u79CD\u201C\u952E\u201D\uFF0C\u662F\u5B58\u50A8\u5F15\u64CE\u7528\u4E8E\u5FEB\u901F\u627E\u5230\u8BB0\u5F55\u7684\u4E00\u79CD\u6570\u636E\u7ED3\u6784\u3002\u7D22\u5F15\u5BF9\u4E8E\u826F\u597D\u7684\u6027\u80FD \u975E\u5E38\u5173\u952E\uFF0C\u5C24\u5176\u662F\u5F53\u8868\u4E2D\u7684\u6570\u636E\u91CF\u8D8A\u6765\u8D8A\u5927\u65F6\uFF0C\u7D22\u5F15\u5BF9\u4E8E\u6027\u80FD\u7684\u5F71\u54CD\u6108\u53D1\u91CD\u8981\u3002 \u7D22\u5F15\u4F18\u5316\u5E94\u8BE5\u662F\u5BF9\u67E5\u8BE2\u6027\u80FD\u4F18\u5316\u6700\u6709\u6548\u7684\u624B\u6BB5\u4E86\u3002\u7D22\u5F15\u80FD\u591F\u8F7B\u6613\u5C06\u67E5\u8BE2\u6027\u80FD\u63D0\u9AD8\u597D\u51E0\u4E2A\u6570\u91CF\u7EA7\u3002 \u7D22\u5F15\u76F8\u5F53\u4E8E\u5B57\u5178\u7684\u97F3\u5E8F\u8868\uFF0C\u5982\u679C\u8981\u67E5\u67D0\u4E2A\u5B57\uFF0C\u5982\u679C\u4E0D\u4F7F\u7528\u97F3\u5E8F\u8868\uFF0C\u5219\u9700\u8981\u4ECE\u51E0\u767E\u9875\u4E2D\u9010\u9875\u53BB\u67E5\u3002</p><p>3\u3001\u7D22\u5F15\u7684\u539F\u7406</p><p>\u7D22\u5F15\u7684\u76EE\u7684\u5728\u4E8E\u63D0\u9AD8\u67E5\u8BE2\u6548\u7387\uFF0C\u4E0E\u6211\u4EEC\u67E5\u9605\u56FE\u4E66\u6240\u7528\u7684\u76EE\u5F55\u662F\u4E00\u4E2A\u9053\u7406\uFF1A\u5148\u5B9A\u4F4D\u5230\u7AE0\uFF0C\u7136\u540E\u5B9A\u4F4D\u5230\u8BE5\u7AE0\u4E0B\u7684\u4E00\u4E2A\u5C0F\u8282\uFF0C\u7136\u540E\u627E\u5230\u9875\u6570\u3002\u76F8\u4F3C\u7684\u4F8B\u5B50\u8FD8\u6709\uFF1A\u67E5\u5B57\u5178\uFF0C\u67E5\u706B\u8F66\u8F66\u6B21\uFF0C\u98DE\u673A\u822A\u73ED\u7B49</p><p>\u672C\u8D28\u90FD\u662F\uFF1A\u901A\u8FC7\u4E0D\u65AD\u5730\u7F29\u5C0F\u60F3\u8981\u83B7\u53D6\u6570\u636E\u7684\u8303\u56F4\u6765\u7B5B\u9009\u51FA\u6700\u7EC8\u60F3\u8981\u7684\u7ED3\u679C\uFF0C\u540C\u65F6\u628A\u968F\u673A\u7684\u4E8B\u4EF6\u53D8\u6210\u987A\u5E8F\u7684\u4E8B\u4EF6\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u6709\u4E86\u8FD9\u79CD\u7D22\u5F15\u673A\u5236\uFF0C\u6211\u4EEC\u53EF\u4EE5\u603B\u662F\u7528\u540C\u4E00\u79CD\u67E5\u627E\u65B9\u5F0F\u6765\u9501\u5B9A\u6570\u636E\u3002</p><p>\u6570\u636E\u5E93\u4E5F\u662F\u4E00\u6837\uFF0C\u4F46\u663E\u7136\u8981\u590D\u6742\u7684\u591A\uFF0C\u56E0\u4E3A\u4E0D\u4EC5\u9762\u4E34\u7740\u7B49\u503C\u67E5\u8BE2\uFF0C\u8FD8\u6709\u8303\u56F4\u67E5\u8BE2(&gt;\u3001&lt;\u3001between\u3001in)\u3001\u6A21\u7CCA\u67E5\u8BE2(like)\u3001\u5E76\u96C6\u67E5\u8BE2(or) \u7B49\u7B49\u3002\u6570\u636E\u5E93\u5E94\u8BE5\u9009\u62E9\u600E\u4E48\u6837\u7684\u65B9\u5F0F\u6765\u5E94\u5BF9\u6240\u6709\u7684\u95EE\u9898\u5462\uFF1F\u6211\u4EEC\u56DE\u60F3\u5B57\u5178\u7684\u4F8B\u5B50\uFF0C\u80FD\u4E0D\u80FD\u628A\u6570\u636E\u5206\u6210\u6BB5\uFF0C\u7136\u540E\u5206\u6BB5\u67E5\u8BE2\u5462\uFF1F\u6700\u7B80\u5355\u7684\u5982\u679C1000\u6761\u6570\u636E\uFF0C1\u5230100\u5206\u6210\u7B2C\u4E00\u6BB5\uFF0C101\u5230200\u5206\u6210\u7B2C\u4E8C\u6BB5\uFF0C201\u5230300\u5206\u6210\u7B2C\u4E09\u6BB5\u2026\u8FD9\u6837\u67E5\u7B2C250\u6761\u6570\u636E\uFF0C\u53EA\u8981\u627E\u7B2C\u4E09\u6BB5\u5C31\u53EF\u4EE5\u4E86\uFF0C\u4E00\u4E0B\u5B50\u53BB\u9664\u4E8690%\u7684\u65E0\u6548\u6570\u636E\u3002\u4F46\u5982\u679C\u662F1\u5343\u4E07\u7684\u8BB0\u5F55\u5462\uFF0C\u5206\u6210\u51E0\u6BB5\u6BD4\u8F83\u597D\uFF1F\u6309\u7167\u641C\u7D22\u6811\u7684\u6A21\u578B\uFF0C\u5176\u5E73\u5747\u590D\u6742\u5EA6\u662FlgN\uFF0C\u5177\u6709\u4E0D\u9519\u7684\u67E5\u8BE2\u6027\u80FD\u3002\u4F46\u8FD9\u91CC\u6211\u4EEC\u5FFD\u7565\u4E86\u4E00\u4E2A\u5173\u952E\u7684\u95EE\u9898\uFF0C\u590D\u6742\u5EA6\u6A21\u578B\u662F\u57FA\u4E8E\u6BCF\u6B21\u76F8\u540C\u7684\u64CD\u4F5C\u6210\u672C\u6765\u8003\u8651\u7684\u3002\u800C\u6570\u636E\u5E93\u5B9E\u73B0\u6BD4\u8F83\u590D\u6742\uFF0C\u4E00\u65B9\u9762\u6570\u636E\u662F\u4FDD\u5B58\u5728\u78C1\u76D8\u4E0A\u7684\uFF0C\u53E6\u5916\u4E00\u65B9\u9762\u4E3A\u4E86\u63D0\u9AD8\u6027\u80FD\uFF0C\u6BCF\u6B21\u53C8\u53EF\u4EE5\u628A\u90E8\u5206\u6570\u636E\u8BFB\u5165\u5185\u5B58\u6765\u8BA1\u7B97\uFF0C\u56E0\u4E3A\u6211\u4EEC\u77E5\u9053\u8BBF\u95EE\u78C1\u76D8\u7684\u6210\u672C\u5927\u6982\u662F\u8BBF\u95EE\u5185\u5B58\u7684\u5341\u4E07\u500D\u5DE6\u53F3\uFF0C\u6240\u4EE5\u7B80\u5355\u7684\u641C\u7D22\u6811\u96BE\u4EE5\u6EE1\u8DB3\u590D\u6742\u7684\u5E94\u7528\u573A\u666F\u3002</p><p>4\u3001\u7D22\u5F15\u7684\u6570\u636E\u7ED3\u6784</p><p>MySQL\u4E3B\u8981\u7528\u5230\u4E24\u79CD\u7ED3\u6784\uFF1AB+ Tree\u7D22\u5F15\u548CHash\u7D22\u5F15 Inodb\u5B58\u50A8\u5F15\u64CE \u9ED8\u8BA4\u662F B+Tree\u7D22\u5F15 Memory \u5B58\u50A8\u5F15\u64CE \u9ED8\u8BA4 Hash\u7D22\u5F15\uFF1B MySQL\u4E2D\uFF0C\u53EA\u6709Memory(Memory\u8868\u53EA\u5B58\u5728\u5185\u5B58\u4E2D\uFF0C\u65AD\u7535\u4F1A\u6D88\u5931\uFF0C\u9002\u7528\u4E8E\u4E34\u65F6\u8868) \u5B58\u50A8\u5F15\u64CE\u663E\u793A\u652F\u6301Hash\u7D22\u5F15\uFF0C\u662FMemory\u8868\u7684\u9ED8\u8BA4\u7D22\u5F15\u7C7B\u578B\uFF0C\u5C3D\u7BA1Memory\u8868\u4E5F\u53EF\u4EE5\u4F7F\u7528B+Tree\u7D22\u5F15\u3002Hash\u7D22\u5F15\u628A\u6570\u636E\u4EE5hash\u5F62\u5F0F\u7EC4\u7EC7\u8D77\u6765\uFF0C\u56E0\u6B64\u5F53\u67E5\u627E\u67D0\u4E00\u6761\u8BB0\u5F55\u7684\u65F6\u5019\uFF0C\u901F\u5EA6\u975E\u5E38\u5FEB\u3002\u4F46\u662F\u56E0\u4E3Ahash\u7ED3\u6784\uFF0C\u6BCF\u4E2A\u952E\u53EA\u5BF9\u5E94\u4E00\u4E2A\u503C\uFF0C\u800C\u4E14\u662F\u6563\u5217\u7684\u65B9\u5F0F\u5206\u5E03\u3002\u6240\u4EE5\u5B83\u5E76\u4E0D\u652F\u6301\u8303\u56F4\u67E5\u627E\u548C\u6392\u5E8F\u7B49\u529F\u80FD\u3002 B+Tree\u662Fmysql\u4F7F\u7528\u6700\u9891\u7E41\u7684\u4E00\u4E2A\u7D22\u5F15\u6570\u636E\u7ED3\u6784\uFF0C\u662FInnoDB\u548CMyISAM\u5B58\u50A8\u5F15\u64CE\u6A21\u5F0F\u7684\u7D22\u5F15\u7C7B\u578B\u3002\u76F8\u5BF9Hash\u7D22\u5F15\uFF0CB+Tree\u5728\u67E5\u627E\u5355\u6761\u8BB0\u5F55\u7684\u901F\u5EA6\u6BD4\u4E0D\u4E0AHash\u7D22\u5F15\uFF0C\u4F46\u662F\u56E0\u4E3A\u66F4\u9002\u5408\u6392\u5E8F\u7B49\u64CD\u4F5C\uFF0C\u6240\u4EE5\u5B83\u66F4\u53D7\u6B22\u8FCE\u3002\u6BD5\u7ADF\u4E0D\u53EF\u80FD\u53EA\u5BF9\u6570\u636E\u5E93\u8FDB\u884C\u5355\u6761\u8BB0\u5F55\u7684\u64CD\u4F5C\u3002 \u5BF9\u6BD4\uFF1A hash\u7C7B\u578B\u7684\u7D22\u5F15\uFF1A\u67E5\u8BE2\u5355\u6761\u5FEB\uFF0C\u8303\u56F4\u67E5\u8BE2\u6162 btree\u7C7B\u578B\u7684\u7D22\u5F15\uFF1Ab+\u6811\uFF0C\u5C42\u6570\u8D8A\u591A\uFF0C\u6570\u636E\u91CF\u6307\u6570\u7EA7\u589E\u957F\uFF08\u6211\u4EEC\u5C31\u7528\u5B83\uFF0C\u56E0\u4E3Ainnodb\u9ED8\u8BA4\u652F\u6301\u5B83\uFF09</p><h2 id="mysql\u805A\u7C07\u548C\u975E\u805A\u7C07\u7D22\u5F15\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mysql\u805A\u7C07\u548C\u975E\u805A\u7C07\u7D22\u5F15\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> mysql\u805A\u7C07\u548C\u975E\u805A\u7C07\u7D22\u5F15\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><p>mysql\u7684\u7D22\u5F15\u7C7B\u578B\u8DDF\u5B58\u50A8\u5F15\u64CE\u662F\u76F8\u5173\u7684\uFF0Cinnodb\u5B58\u50A8\u5F15\u64CE\u6570\u636E\u6587\u4EF6\u8DDF\u7D22\u5F15\u6587\u4EF6\u5168\u90E8\u653E\u5728ibd\u6587\u4EF6\u4E2D\uFF0C\u800Cmyisam\u7684\u6570\u636E\u6587\u4EF6\u653E\u5728myd\u6587\u4EF6\u4E2D\uFF0C\u7D22\u5F15\u653E\u5728myi\u6587\u4EF6\u4E2D\uFF0C\u5176\u5B9E\u533A\u5206\u805A\u7C07\u7D22\u5F15\u548C\u975E\u805A\u7C07\u7D22\u5F15\u975E\u5E38\u7B80\u5355\uFF0C\u53EA\u8981\u5224\u65AD\u6570\u636E\u8DDF\u7D22\u5F15\u662F\u5426\u5B58\u50A8\u5728\u4E00\u8D77\u5C31\u53EF\u4EE5\u4E86\u3002</p><p>\u200B innodb\u5B58\u50A8\u5F15\u64CE\u5728\u8FDB\u884C\u6570\u636E\u63D2\u5165\u7684\u65F6\u5019\uFF0C\u6570\u636E\u5FC5\u987B\u8981\u8DDF\u7D22\u5F15\u653E\u5728\u4E00\u8D77\uFF0C\u5982\u679C\u6709\u4E3B\u952E\u5C31\u4F7F\u7528\u4E3B\u952E\uFF0C\u6CA1\u6709\u4E3B\u952E\u5C31\u4F7F\u7528\u552F\u4E00\u952E\uFF0C\u6CA1\u6709\u552F\u4E00\u952E\u5C31\u4F7F\u75286\u5B57\u8282\u7684rowid\uFF0C\u56E0\u6B64\u8DDF\u6570\u636E\u7ED1\u5B9A\u5728\u4E00\u8D77\u7684\u5C31\u662F\u805A\u7C07\u7D22\u5F15\uFF0C\u800C\u4E3A\u4E86\u907F\u514D\u6570\u636E\u5197\u4F59\u5B58\u50A8\uFF0C\u5176\u4ED6\u7684\u7D22\u5F15\u7684\u53F6\u5B50\u8282\u70B9\u4E2D\u5B58\u50A8\u7684\u90FD\u662F\u805A\u7C07\u7D22\u5F15\u7684key\u503C\uFF0C\u56E0\u6B64innodb\u4E2D\u65E2\u6709\u805A\u7C07\u7D22\u5F15\u4E5F\u6709\u975E\u805A\u7C07\u7D22\u5F15\uFF0C\u800Cmyisam\u4E2D\u53EA\u6709\u975E\u805A\u7C07\u7D22\u5F15\u3002</p><h2 id="mysql\u7D22\u5F15\u7ED3\u6784\u6709\u54EA\u4E9B-\u5404\u81EA\u7684\u4F18\u52A3\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mysql\u7D22\u5F15\u7ED3\u6784\u6709\u54EA\u4E9B-\u5404\u81EA\u7684\u4F18\u52A3\u662F\u4EC0\u4E48" aria-hidden="true">#</a> mysql\u7D22\u5F15\u7ED3\u6784\u6709\u54EA\u4E9B\uFF0C\u5404\u81EA\u7684\u4F18\u52A3\u662F\u4EC0\u4E48\uFF1F</h2><p>\u7D22\u5F15\u7684\u6570\u636E\u7ED3\u6784\u548C\u5177\u4F53\u5B58\u50A8\u5F15\u64CE\u7684\u5B9E\u73B0\u6709\u5173\uFF0Cmysql\u4E2D\u4F7F\u7528\u8F83\u591A\u7684\u7D22\u5F15\u6709hash\u7D22\u5F15\uFF0CB+\u6811\u7D22\u5F15\uFF0Cinnodb\u7684\u7D22\u5F15\u5B9E\u73B0\u4E3AB+\u6811\uFF0Cmemory\u5B58\u50A8\u5F15\u64CE\u4E3Ahash\u7D22\u5F15\u3002</p><p>B+\u6811\u662F\u4E00\u4E2A\u5E73\u8861\u7684\u591A\u53C9\u6811\uFF0C\u4ECE\u6839\u8282\u70B9\u5230\u6BCF\u4E2A\u53F6\u5B50\u8282\u70B9\u7684\u9AD8\u5EA6\u5DEE\u503C\u4E0D\u8D85\u8FC71\uFF0C\u800C\u4E14\u540C\u5C42\u7EA7\u7684\u4E8C\u8282\u70B9\u95F4\u6709\u6307\u9488\u76F8\u5173\u8FDE\u63A5\uFF0C\u5728B+\u6811\u4E0A\u7684\u5E38\u89C4\u68C0\u7D22\uFF0C\u4ECE\u6839\u8282\u70B9\u5230\u53F6\u5B50\u8282\u70B9\u7684\u641C\u7D22\u6548\u7387\u57FA\u672C\u76F8\u5F53\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u5927\u5E45\u6CE2\u52A8\uFF0C\u800C\u4E14\u57FA\u4E8E\u7D22\u5F15\u7684\u987A\u5E8F\u626B\u63CF\u65F6\uFF0C\u4E5F\u53EF\u4EE5\u5229\u7528\u53CC\u5411\u6307\u9488\u5FEB\u901F\u5DE6\u53F3\u79FB\u52A8\uFF0C\u6548\u7387\u975E\u5E38\u9AD8\u3002\u56E0\u4E3A\uFF0CB+\u6811\u7D22\u5F15\u88AB\u5E7F\u6CDB\u5E94\u7528\u4E8E\u6570\u636E\u5E93\u3001\u6587\u4EF6\u7CFB\u7EDF\u7B49\u573A\u666F\u3002</p><p>\u54C8\u5E0C\u7D22\u5F15\u5C31\u662F\u91C7\u7528\u4E00\u5B9A\u7684\u54C8\u5E0C\u7B97\u6CD5\uFF0C\u628A\u952E\u503C\u6362\u7B97\u6210\u65B0\u7684\u54C8\u5E0C\u503C\uFF0C\u68C0\u7D22\u65F6\u4E0D\u9700\u8981\u7C7B\u4F3CB+\u6811\u90A3\u6837\u4ECE\u6839\u8282\u70B9\u5230\u53F6\u5B50\u8282\u70B9\u9010\u7EA7\u67E5\u627E\uFF0C\u53EA\u9700\u4E00\u6B21\u54C8\u5E0C\u7B97\u6CD5\u5373\u53EF\u7ACB\u523B\u5B9A\u4F4D\u5230\u76F8\u5E94\u7684\u4F4D\u7F6E\uFF0C\u901F\u5EA6\u975E\u5E38\u5FEB\u3002</p><p>\u5982\u679C\u662F\u7B49\u503C\u67E5\u8BE2\uFF0C\u90A3\u4E48\u54C8\u5E0C\u7D22\u5F15\u660E\u663E\u6709\u7EDD\u5BF9\u4F18\u52BF\uFF0C\u56E0\u4E3A\u53EA\u9700\u8981\u7ECF\u8FC7\u4E00\u6B21\u7B97\u6CD5\u5373\u53EF\u627E\u5230\u76F8\u5E94\u7684\u952E\u503C\uFF0C\u524D\u63D0\u662F\u952E\u503C\u90FD\u662F\u552F\u4E00\u7684\u3002\u5982\u679C\u952E\u503C\u4E0D\u662F\u552F\u4E00\u7684\uFF0C\u5C31\u9700\u8981\u5148\u627E\u5230\u8BE5\u952E\u6240\u5728\u4F4D\u7F6E\uFF0C\u7136\u540E\u518D\u6839\u636E\u94FE\u8868\u5F80\u540E\u626B\u63CF\uFF0C\u77E5\u9053\u627E\u5230\u5BF9\u5E94\u7684\u6570\u636E</p><p>\u5982\u679C\u662F\u8303\u56F4\u67E5\u8BE2\u68C0\u7D22\uFF0C\u8FD9\u65F6\u5019\u54C8\u5F90\u7D22\u5F15\u5C31\u6BEB\u65E0\u7528\u6B66\u4E4B\u5730\u4E86\uFF0C\u56E0\u4E3A\u539F\u5148\u662F\u6709\u5E8F\u7684\u952E\u503C\uFF0C\u7ECF\u8FC7\u54C8\u5E0C\u7B97\u6CD5\u540E\uFF0C\u6709\u53EF\u80FD\u53D8\u6210\u4E0D\u8FDE\u7EED\u7684\u4E86\uFF0C\u5C31\u6CA1\u529E\u6CD5\u518D\u5229\u7528\u7D22\u5F15\u5B8C\u6210\u8303\u56F4\u67E5\u8BE2\u68C0\u7D22</p><p>\u54C8\u5E0C\u6240\u6709\u4E5F\u6CA1\u529E\u6CD5\u5229\u7528\u7D22\u5F15\u5B8C\u6210\u6392\u5E8F\uFF0C\u4EE5\u53CAlike\u8FD9\u6837\u7684\u90E8\u5206\u6A21\u7CCA\u67E5\u8BE2</p><p>\u54C8\u5E0C\u7D22\u5F15\u4E5F\u4E0D\u652F\u6301\u591A\u5217\u8054\u5408\u7D22\u5F15\u7684\u6700\u5DE6\u5339\u914D\u89C4\u5219</p><p>B+\u6811\u7D22\u5F15\u7684\u5173\u952E\u5B57\u68C0\u7D22\u6548\u7387\u6BD4\u8F83\u5E73\u5747\uFF0C\u4E0D\u50CFB\u6811\u90A3\u6837\u6CE2\u52A8\u5927\uFF0C\u5728\u6709\u5927\u91CF\u91CD\u590D\u952E\u503C\u60C5\u51B5\u4E0B\uFF0C\u54C8\u5E0C\u7D22\u5F15\u7684\u6548\u7387\u4E5F\u662F\u6781\u4F4E\u7684\uFF0C\u56E0\u6B64\u5B58\u5728\u54C8\u5E0C\u78B0\u649E\u95EE\u9898\u3002</p><h2 id="\u7D22\u5F15\u7684\u8BBE\u8BA1\u539F\u5219\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u7D22\u5F15\u7684\u8BBE\u8BA1\u539F\u5219\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u7D22\u5F15\u7684\u8BBE\u8BA1\u539F\u5219\u6709\u54EA\u4E9B\uFF1F</h2><p>\u5728\u8FDB\u884C\u7D22\u5F15\u8BBE\u8BA1\u7684\u65F6\u5019\uFF0C\u5E94\u8BE5\u4FDD\u8BC1\u7D22\u5F15\u5B57\u6BB5\u5360\u7528\u7684\u7A7A\u95F4\u8D8A\u5C0F\u8D8A\u597D\uFF0C\u8FD9\u53EA\u662F\u4E00\u4E2A\u5927\u7684\u65B9\u5411\uFF0C\u8FD8\u6709\u4E00\u4E9B\u7EC6\u8282\u70B9\u9700\u8981\u6CE8\u610F\u4E0B\uFF1A</p><p>\u200B 1\u3001\u9002\u5408\u7D22\u5F15\u7684\u5217\u662F\u51FA\u73B0\u5728where\u5B57\u53E5\u4E2D\u7684\u5217\uFF0C\u6216\u8005\u8FDE\u63A5\u5B50\u53E5\u4E2D\u6307\u5B9A\u7684\u5217</p><p>\u200B 2\u3001\u57FA\u6570\u8F83\u5C0F\u7684\u8868\uFF0C\u7D22\u5F15\u6548\u679C\u5DEE\uFF0C\u6CA1\u5FC5\u8981\u521B\u5EFA\u7D22\u5F15</p><p>\u200B 3\u3001\u5728\u9009\u62E9\u7D22\u5F15\u5217\u7684\u65F6\u5019\uFF0C\u8D8A\u77ED\u8D8A\u597D\uFF0C\u53EF\u4EE5\u6307\u5B9A\u67D0\u4E9B\u5217\u7684\u4E00\u90E8\u5206\uFF0C\u6CA1\u5FC5\u8981\u7528\u5168\u90E8\u5B57\u6BB5\u7684\u503C</p><p>\u200B 4\u3001\u4E0D\u8981\u7ED9\u8868\u4E2D\u7684\u6BCF\u4E00\u4E2A\u5B57\u6BB5\u90FD\u521B\u5EFA\u7D22\u5F15\uFF0C\u5E76\u4E0D\u662F\u7D22\u5F15\u8D8A\u591A\u8D8A\u597D</p><p>\u200B 5\u3001\u5B9A\u4E49\u6709\u5916\u952E\u7684\u6570\u636E\u5217\u4E00\u5B9A\u8981\u521B\u5EFA\u7D22\u5F15</p><p>\u200B 6\u3001\u66F4\u65B0\u9891\u7E41\u7684\u5B57\u6BB5\u4E0D\u8981\u6709\u7D22\u5F15</p><p>\u200B 7\u3001\u521B\u5EFA\u7D22\u5F15\u7684\u5217\u4E0D\u8981\u8FC7\u591A\uFF0C\u53EF\u4EE5\u521B\u5EFA\u7EC4\u5408\u7D22\u5F15\uFF0C\u4F46\u662F\u7EC4\u5408\u7D22\u5F15\u7684\u5217\u7684\u4E2A\u6570\u4E0D\u5EFA\u8BAE\u592A\u591A</p><p>\u200B 8\u3001\u5927\u6587\u672C\u3001\u5927\u5BF9\u8C61\u4E0D\u8981\u521B\u5EFA\u7D22\u5F15</p><h2 id="mysql\u9501\u7684\u7C7B\u578B\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#mysql\u9501\u7684\u7C7B\u578B\u6709\u54EA\u4E9B" aria-hidden="true">#</a> mysql\u9501\u7684\u7C7B\u578B\u6709\u54EA\u4E9B\uFF1F</h2><p>\u57FA\u4E8E\u9501\u7684\u5C5E\u6027\u5206\u7C7B\uFF1A\u5171\u4EAB\u9501\u3001\u6392\u4ED6\u9501\u3002</p><p>\u57FA\u4E8E\u9501\u7684\u7C92\u5EA6\u5206\u7C7B\uFF1A\u884C\u7EA7\u9501\uFF08innodb \uFF09\u3001\u8868\u7EA7\u9501\uFF08 innodb \u3001myisam\uFF09\u3001\u9875\u7EA7\u9501\uFF08 innodb\u5F15\u64CE\uFF09\u3001\u8BB0\u5F55\u9501\u3001\u95F4\u9699\u9501\u3001\u4E34\u952E\u9501\u3002</p><p>\u57FA\u4E8E\u9501\u7684\u72B6\u6001\u5206\u7C7B\uFF1A\u610F\u5411\u5171\u4EAB\u9501\u3001\u610F\u5411\u6392\u5B83\u9501\u3002</p><p>\u5171\u4EAB\u9501\uFF08share lock\uFF09\uFF1A \u5171\u4EAB\u9501\u53C8\u79F0\u8BFB\u9501\uFF0C\u7B80\u79F0 S \u9501\uFF1B\u5F53\u4E00\u4E2A\u4E8B\u52A1\u4E3A\u6570\u636E\u52A0\u4E0A\u8BFB\u9501\u4E4B\u540E\uFF0C\u5176\u4ED6\u4E8B\u52A1\u53EA\u80FD\u5BF9\u8BE5\u6570\u636E\u52A0\u8BFB\u9501\uFF0C\u800C\u4E0D\u80FD\u5BF9\u6570\u636E\u52A0\u5199\u9501\uFF0C\u76F4\u5230\u6240\u6709\u7684\u8BFB\u9501\u91CA\u653E\u4E4B\u540E\u5176\u4ED6\u4E8B\u52A1\u624D\u80FD\u5BF9\u5176\u8FDB\u884C\u52A0\u6301\u5199\u9501\u3002\u5171\u4EAB\u9501\u7684\u7279\u6027\u4E3B\u8981\u662F\u4E3A\u4E86\u652F\u6301\u5E76\u53D1\u7684\u8BFB\u53D6\u6570\u636E\uFF0C\u8BFB\u53D6\u6570\u636E\u7684\u65F6\u5019\u4E0D\u652F\u6301\u4FEE\u6539\uFF0C\u907F\u514D\u51FA\u73B0\u91CD\u590D\u8BFB\u7684\u95EE\u9898\u3002</p><p>\u6392\u4ED6\u9501\uFF08exclusive lock\uFF09\uFF1A\u6392\u4ED6\u9501\u53C8\u79F0\u5199\u9501\uFF0C\u7B80\u79F0 X \u9501\uFF1B\u5F53\u4E00\u4E2A\u4E8B\u52A1\u4E3A\u6570\u636E\u52A0\u4E0A\u5199\u9501\u65F6\uFF0C\u5176\u4ED6\u8BF7\u6C42\u5C06\u4E0D\u80FD\u518D\u4E3A\u6570\u636E\u52A0\u4EFB\u4F55\u9501\uFF0C\u76F4\u5230\u8BE5\u9501\u91CA\u653E\u4E4B\u540E\uFF0C\u5176\u4ED6\u4E8B\u52A1\u624D\u80FD\u5BF9\u6570\u636E\u8FDB\u884C\u52A0\u9501\u3002\u6392\u4ED6\u9501\u7684\u76EE\u7684\u662F\u5728\u6570\u636E\u4FEE\u6539\u65F6\u5019\uFF0C\u4E0D\u5141\u8BB8\u5176\u4ED6\u4EBA\u540C\u65F6\u4FEE\u6539\uFF0C\u4E5F\u4E0D\u5141\u8BB8\u5176\u4ED6\u4EBA\u8BFB\u53D6\uFF0C\u907F\u514D\u4E86\u51FA\u73B0\u810F\u6570\u636E\u548C\u810F\u8BFB\u7684\u95EE\u9898\u3002</p><p>\u8868\u9501\uFF08table lock\uFF09\uFF1A\u8868\u9501\u662F\u6307\u4E0A\u9501\u7684\u65F6\u5019\u9501\u4F4F\u7684\u662F\u6574\u4E2A\u8868\uFF0C\u5F53\u4E0B\u4E00\u4E2A\u4E8B\u52A1\u8BBF\u95EE\u8BE5\u8868\u7684\u65F6\u5019\uFF0C\u5FC5\u987B\u7B49\u524D\u4E00\u4E2A\u4E8B\u52A1\u91CA\u653E\u4E86\u9501\u624D\u80FD\u8FDB\u884C\u5BF9\u8868\u8FDB\u884C\u8BBF\u95EE\uFF1B\u7279\u70B9\uFF1A\u7C92\u5EA6\u5927\uFF0C\u52A0\u9501\u7B80\u5355\uFF0C\u5BB9\u6613\u51B2\u7A81\uFF1B</p><p>\u884C\u9501\uFF1A\u884C\u9501\u662F\u6307\u4E0A\u9501\u7684\u65F6\u5019\u9501\u4F4F\u7684\u662F\u8868\u7684\u67D0\u4E00\u884C\u6216\u591A\u884C\u8BB0\u5F55\uFF0C\u5176\u4ED6\u4E8B\u52A1\u8BBF\u95EE\u540C\u4E00\u5F20\u8868\u65F6\uFF0C\u53EA\u6709\u88AB\u9501\u4F4F\u7684\u8BB0\u5F55\u4E0D\u80FD\u8BBF\u95EE\uFF0C\u5176\u4ED6\u7684\u8BB0\u5F55\u53EF\u6B63\u5E38\u8BBF\u95EE\uFF0C\u7279\u70B9\uFF1A\u7C92\u5EA6\u5C0F\uFF0C\u52A0\u9501\u6BD4\u8868\u9501\u9EBB\u70E6\uFF0C\u4E0D\u5BB9\u6613\u51B2\u7A81\uFF0C\u76F8\u6BD4\u8868\u9501\u652F\u6301\u7684\u5E76\u53D1\u8981\u9AD8</p><p>\u8BB0\u5F55\u9501\uFF08Record lock\uFF09: \u8BB0\u5F55\u9501\u4E5F\u5C5E\u4E8E\u884C\u9501\u4E2D\u7684\u4E00\u79CD\uFF0C\u53EA\u4E0D\u8FC7\u8BB0\u5F55\u9501\u7684\u8303\u56F4\u53EA\u662F\u8868\u4E2D\u7684\u67D0\u4E00\u6761\u8BB0\u5F55\uFF0C\u8BB0\u5F55\u9501\u662F\u8BF4\u4E8B\u52A1\u5728\u52A0\u9501\u540E\u9501\u4F4F\u7684\u53EA\u662F\u8868\u7684\u67D0\u4E00\u6761\u8BB0\u5F55\uFF0C\u52A0\u4E86\u8BB0\u5F55\u9501\u4E4B\u540E\u6570\u636E\u53EF\u4EE5\u907F\u514D\u6570\u636E\u5728\u67E5\u8BE2\u7684\u65F6\u5019\u88AB\u4FEE\u6539\u7684\u91CD\u590D\u8BFB\u95EE\u9898\uFF0C\u4E5F\u907F\u514D\u4E86\u5728\u4FEE\u6539\u7684\u4E8B\u52A1\u672A\u63D0\u4EA4\u524D\u88AB\u5176\u4ED6\u4E8B\u52A1\u8BFB\u53D6\u7684\u810F\u8BFB\u95EE\u9898</p><p>\u9875\u9501\uFF1A\u9875\u7EA7\u9501\u662F MysQL \u4E2D\u9501\u5B9A\u7C92\u5EA6\u4ECB\u4E8E\u884C\u7EA7\u9501\u548C\u8868\u7EA7\u9501\u4E2D\u95F4\u7684\u4E00\u79CD\u9501\uFF0E\u8868\u7EA7\u9501\u901F\u5EA6\u5FEB\uFF0C\u4F46\u51B2\u7A81\u591A\uFF0C\u884C\u7EA7\u51B2\u7A81\u5C11\uFF0C\u4F46\u901F\u5EA6\u6162\u3002\u6240\u4EE5\u53D6\u4E86\u6298\u8877\u7684\u9875\u7EA7\uFF0C\u4E00\u6B21\u9501\u5B9A\u76F8\u90BB\u7684\u4E00\u7EC4\u8BB0\u5F55\u3002\u7279\u70B9\uFF1A\u5F00\u9500\u548C\u52A0\u9501\u65F6\u95F4\u754C\u4E8E\u8868\u9501\u548C\u884C\u9501\u4E4B\u95F4\uFF0C\u4F1A\u51FA\u73B0\u6B7B\u9501\uFF1B\u9501\u5B9A\u7C92\u5EA6\u754C\u4E8E\u8868\u9501\u548C\u884C\u9501\u4E4B\u95F4\uFF0C\u5E76\u53D1\u5EA6\u4E00\u822C\u3002</p><p>\u95F4\u9699\u9501\uFF1A\u662F\u5C5E\u4E8E\u884C\u9501\u7684\u4E00\u79CD\uFF0C\u95F4\u9699\u9501\u662F\u5728\u4E8B\u52A1\u52A0\u9501\u540E\u5176\u9501\u4F4F\u7684\u662F\u8868\u8BB0\u5F55\u7684\u67D0\u4E00\u4E2A\u533A\u95F4\uFF0C\u5F53\u8868\u7684\u76F8\u90BBID\u4E4B\u95F4\u51FA\u73B0\u7A7A\u9699\u5219\u4F1A\u5F62\u6210\u4E00\u4E2A\u533A\u95F4\uFF0C\u9075\u5FAA\u5DE6\u5F00\u53F3\u95ED\u539F\u5219\u3002\u8303\u56F4\u67E5\u8BE2\u5E76\u4E14\u67E5\u8BE2\u672A\u547D\u4E2D\u8BB0\u5F55\uFF0C\u67E5\u8BE2\u6761\u4EF6\u5FC5\u987B\u547D\u4E2D\u7D22\u5F15\u3001\u95F4\u9699\u9501\u53EA\u4F1A\u51FA\u73B0\u5728REPEATABLE_READ\uFF08\u91CD\u590D\u8BFB\uFF09\u7684\u4E8B\u52A1\u7EA7\u522B\u4E2D\u3002</p><p>\u4E34\u952E\u9501\uFF08Next-Key lock)\uFF1A\u4E5F\u5C5E\u4E8E\u884C\u9501\u7684\u4E00\u79CD\uFF0C\u5E76\u4E14\u5B83\u662FINNODB\u7684\u884C\u9501\u9ED8\u8BA4\u7B97\u6CD5\uFF0C\u603B\u7ED3\u6765\u8BF4\u5B83\u5C31\u662F\u8BB0\u5F55\u9501\u548C\u95F4\u9699\u9501\u7684\u7EC4\u5408\uFF0C\u4E34\u952E\u9501\u4F1A\u628A\u67E5\u8BE2\u51FA\u6765\u7684\u8BB0\u5F55\u9501\u4F4F\uFF0C\u540C\u65F6\u4E5F\u4F1A\u628A\u8BE5\u8303\u56F4\u67E5\u8BE2\u5185\u7684\u6240\u6709\u95F4\u9699\u7A7A\u95F4\u4E5F\u4F1A\u9501\u4F4F\uFF0C\u518D\u4E4B\u5B83\u4F1A\u628A\u76F8\u90BB\u7684\u4E0B\u4E00\u4E2A\u533A\u95F4\u4E5F\u4F1A\u9501\u4F4F\u3002</p><h2 id="mysql\u6267\u884C\u8BA1\u5212\u600E\u4E48\u770B" tabindex="-1"><a class="header-anchor" href="#mysql\u6267\u884C\u8BA1\u5212\u600E\u4E48\u770B" aria-hidden="true">#</a> mysql\u6267\u884C\u8BA1\u5212\u600E\u4E48\u770B\uFF1F</h2><p>\u5728\u4F01\u4E1A\u7684\u5E94\u7528\u573A\u666F\u4E2D\uFF0C\u4E3A\u4E86\u77E5\u9053\u4F18\u5316SQL\u8BED\u53E5\u7684\u6267\u884C\uFF0C\u9700\u8981\u67E5\u770BSQL\u8BED\u53E5\u7684\u5177\u4F53\u6267\u884C\u8FC7\u7A0B\uFF0C\u4EE5\u52A0\u5FEBSQL\u8BED\u53E5\u7684\u6267\u884C\u6548\u7387\u3002</p><p>\u200B \u53EF\u4EE5\u4F7F\u7528explain+SQL\u8BED\u53E5\u6765\u6A21\u62DF\u4F18\u5316\u5668\u6267\u884CSQL\u67E5\u8BE2\u8BED\u53E5\uFF0C\u4ECE\u800C\u77E5\u9053mysql\u662F\u5982\u4F55\u5904\u7406sql\u8BED\u53E5\u7684\u3002</p><p>\u200B \u5B98\u7F51\u5730\u5740\uFF1A https://dev.mysql.com/doc/refman/5.7/en/explain-output.html</p><p>1\u3001\u6267\u884C\u8BA1\u5212\u4E2D\u5305\u542B\u7684\u4FE1\u606F</p><table><thead><tr><th>Column</th><th>Meaning</th></tr></thead><tbody><tr><td>id</td><td>The <code>SELECT</code> identifier</td></tr><tr><td>select_type</td><td>The <code>SELECT</code> type</td></tr><tr><td>table</td><td>The table for the output row</td></tr><tr><td>partitions</td><td>The matching partitions</td></tr><tr><td>type</td><td>The join type</td></tr><tr><td>possible_keys</td><td>The possible indexes to choose</td></tr><tr><td>key</td><td>The index actually chosen</td></tr><tr><td>key_len</td><td>The length of the chosen key</td></tr><tr><td>ref</td><td>The columns compared to the index</td></tr><tr><td>rows</td><td>Estimate of rows to be examined</td></tr><tr><td>filtered</td><td>Percentage of rows filtered by table condition</td></tr><tr><td>extra</td><td>Additional information</td></tr></tbody></table><p><strong>id</strong></p><p>select\u67E5\u8BE2\u7684\u5E8F\u5217\u53F7\uFF0C\u5305\u542B\u4E00\u7EC4\u6570\u5B57\uFF0C\u8868\u793A\u67E5\u8BE2\u4E2D\u6267\u884Cselect\u5B50\u53E5\u6216\u8005\u64CD\u4F5C\u8868\u7684\u987A\u5E8F</p><p>id\u53F7\u5206\u4E3A\u4E09\u79CD\u60C5\u51B5\uFF1A</p><p>\u200B 1\u3001\u5982\u679Cid\u76F8\u540C\uFF0C\u90A3\u4E48\u6267\u884C\u987A\u5E8F\u4ECE\u4E0A\u5230\u4E0B</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
         <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno
         <span class="token keyword">join</span> salgrade sg <span class="token keyword">on</span> e<span class="token punctuation">.</span>sal <span class="token operator">between</span> sg<span class="token punctuation">.</span>losal <span class="token operator">and</span> sg<span class="token punctuation">.</span>hisal<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u200B 2\u3001\u5982\u679Cid\u4E0D\u540C\uFF0C\u5982\u679C\u662F\u5B50\u67E5\u8BE2\uFF0Cid\u7684\u5E8F\u53F7\u4F1A\u9012\u589E\uFF0Cid\u503C\u8D8A\u5927\u4F18\u5148\u7EA7\u8D8A\u9AD8\uFF0C\u8D8A\u5148\u88AB\u6267\u884C</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> d<span class="token punctuation">.</span>deptno <span class="token keyword">from</span> dept d <span class="token keyword">where</span> d<span class="token punctuation">.</span>dname <span class="token operator">=</span> <span class="token string">&#39;SALES&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u200B 3\u3001id\u76F8\u540C\u548C\u4E0D\u540C\u7684\uFF0C\u540C\u65F6\u5B58\u5728\uFF1A\u76F8\u540C\u7684\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E00\u7EC4\uFF0C\u4ECE\u4E0A\u5F80\u4E0B\u987A\u5E8F\u6267\u884C\uFF0C\u5728\u6240\u6709\u7EC4\u4E2D\uFF0Cid\u503C\u8D8A\u5927\uFF0C\u4F18\u5148\u7EA7\u8D8A\u9AD8\uFF0C\u8D8A\u5148\u6267\u884C</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
         <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno
         <span class="token keyword">join</span> salgrade sg <span class="token keyword">on</span> e<span class="token punctuation">.</span>sal <span class="token operator">between</span> sg<span class="token punctuation">.</span>losal <span class="token operator">and</span> sg<span class="token punctuation">.</span>hisal
<span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> d<span class="token punctuation">.</span>deptno <span class="token keyword">from</span> dept d <span class="token keyword">where</span> d<span class="token punctuation">.</span>dname <span class="token operator">=</span> <span class="token string">&#39;SALES&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>select_type</strong></p><p>\u4E3B\u8981\u7528\u6765\u5206\u8FA8\u67E5\u8BE2\u7684\u7C7B\u578B\uFF0C\u662F\u666E\u901A\u67E5\u8BE2\u8FD8\u662F\u8054\u5408\u67E5\u8BE2\u8FD8\u662F\u5B50\u67E5\u8BE2</p><table><thead><tr><th><code>select_type</code> Value</th><th>Meaning</th></tr></thead><tbody><tr><td>SIMPLE</td><td>Simple SELECT (not using UNION or subqueries)</td></tr><tr><td>PRIMARY</td><td>Outermost SELECT</td></tr><tr><td>UNION</td><td>Second or later SELECT statement in a UNION</td></tr><tr><td>DEPENDENT UNION</td><td>Second or later SELECT statement in a UNION, dependent on outer query</td></tr><tr><td>UNION RESULT</td><td>Result of a UNION.</td></tr><tr><td>SUBQUERY</td><td>First SELECT in subquery</td></tr><tr><td>DEPENDENT SUBQUERY</td><td>First SELECT in subquery, dependent on outer query</td></tr><tr><td>DERIVED</td><td>Derived table</td></tr><tr><td>UNCACHEABLE SUBQUERY</td><td>A subquery for which the result cannot be cached and must be re-evaluated for each row of the outer query</td></tr><tr><td>UNCACHEABLE UNION</td><td>The second or later select in a UNION that belongs to an uncacheable subquery (see UNCACHEABLE SUBQUERY)</td></tr></tbody></table><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--sample:\u7B80\u5355\u7684\u67E5\u8BE2\uFF0C\u4E0D\u5305\u542B\u5B50\u67E5\u8BE2\u548Cunion</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--primary:\u67E5\u8BE2\u4E2D\u82E5\u5305\u542B\u4EFB\u4F55\u590D\u6742\u7684\u5B50\u67E5\u8BE2\uFF0C\u6700\u5916\u5C42\u67E5\u8BE2\u5219\u88AB\u6807\u8BB0\u4E3APrimary</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> staname<span class="token punctuation">,</span> ename supname
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> ename staname<span class="token punctuation">,</span> mgr <span class="token keyword">from</span> emp<span class="token punctuation">)</span> t
         <span class="token keyword">join</span> emp <span class="token keyword">on</span> t<span class="token punctuation">.</span>mgr <span class="token operator">=</span> emp<span class="token punctuation">.</span>empno<span class="token punctuation">;</span>

<span class="token comment">--union:\u82E5\u7B2C\u4E8C\u4E2Aselect\u51FA\u73B0\u5728union\u4E4B\u540E\uFF0C\u5219\u88AB\u6807\u8BB0\u4E3Aunion</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> sal <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">--dependent union:\u8DDFunion\u7C7B\u4F3C\uFF0C\u6B64\u5904\u7684depentent\u8868\u793Aunion\u6216union all\u8054\u5408\u800C\u6210\u7684\u7ED3\u679C\u4F1A\u53D7\u5916\u90E8\u8868\u5F71\u54CD</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>empno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token keyword">union</span> <span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">)</span>
          <span class="token operator">-</span> <span class="token operator">-</span>
<span class="token keyword">union</span>
result:\u4ECE<span class="token keyword">union</span>\u8868\u83B7\u53D6\u7ED3\u679C\u7684<span class="token keyword">select</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> sal <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">--subquery:\u5728select\u6216\u8005where\u5217\u8868\u4E2D\u5305\u542B\u5B50\u67E5\u8BE2</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> sal <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--dependent subquery:subquery\u7684\u5B50\u67E5\u8BE2\u8981\u53D7\u5230\u5916\u90E8\u8868\u67E5\u8BE2\u7684\u5F71\u54CD</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--DERIVED: from\u5B50\u53E5\u4E2D\u51FA\u73B0\u7684\u5B50\u67E5\u8BE2\uFF0C\u4E5F\u53EB\u505A\u6D3E\u751F\u7C7B\uFF0C</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> staname<span class="token punctuation">,</span> ename supname
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> ename staname<span class="token punctuation">,</span> mgr <span class="token keyword">from</span> emp<span class="token punctuation">)</span> t
         <span class="token keyword">join</span> emp <span class="token keyword">on</span> t<span class="token punctuation">.</span>mgr <span class="token operator">=</span> emp<span class="token punctuation">.</span>empno<span class="token punctuation">;</span>

<span class="token comment">--UNCACHEABLE SUBQUERY\uFF1A\u8868\u793A\u4F7F\u7528\u5B50\u67E5\u8BE2\u7684\u7ED3\u679C\u4E0D\u80FD\u88AB\u7F13\u5B58</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> empno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> @<span class="token variable">@sort_buffer_size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--uncacheable union:\u8868\u793Aunion\u7684\u67E5\u8BE2\u7ED3\u679C\u4E0D\u80FD\u88AB\u7F13\u5B58\uFF1Asql\u8BED\u53E5\u672A\u9A8C\u8BC1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>table</strong></p><p>\u5BF9\u5E94\u884C\u6B63\u5728\u8BBF\u95EE\u54EA\u4E00\u4E2A\u8868\uFF0C\u8868\u540D\u6216\u8005\u522B\u540D\uFF0C\u53EF\u80FD\u662F\u4E34\u65F6\u8868\u6216\u8005union\u5408\u5E76\u7ED3\u679C\u96C6 1\u3001\u5982\u679C\u662F\u5177\u4F53\u7684\u8868\u540D\uFF0C\u5219\u8868\u660E\u4ECE\u5B9E\u9645\u7684\u7269\u7406\u8868\u4E2D\u83B7\u53D6\u6570\u636E\uFF0C\u5F53\u7136\u4E5F\u53EF\u4EE5\u662F\u8868\u7684\u522B\u540D</p><p>\u200B 2\u3001\u8868\u540D\u662FderivedN\u7684\u5F62\u5F0F\uFF0C\u8868\u793A\u4F7F\u7528\u4E86id\u4E3AN\u7684\u67E5\u8BE2\u4EA7\u751F\u7684\u884D\u751F\u8868</p><p>\u200B 3\u3001\u5F53\u6709union result\u7684\u65F6\u5019\uFF0C\u8868\u540D\u662Funion n1,n2\u7B49\u7684\u5F62\u5F0F\uFF0Cn1,n2\u8868\u793A\u53C2\u4E0Eunion\u7684id</p><p><strong>type</strong></p><p>type\u663E\u793A\u7684\u662F\u8BBF\u95EE\u7C7B\u578B\uFF0C\u8BBF\u95EE\u7C7B\u578B\u8868\u793A\u6211\u662F\u4EE5\u4F55\u79CD\u65B9\u5F0F\u53BB\u8BBF\u95EE\u6211\u4EEC\u7684\u6570\u636E\uFF0C\u6700\u5BB9\u6613\u60F3\u7684\u662F\u5168\u8868\u626B\u63CF\uFF0C\u76F4\u63A5\u66B4\u529B\u7684\u904D\u5386\u4E00\u5F20\u8868\u53BB\u5BFB\u627E\u9700\u8981\u7684\u6570\u636E\uFF0C\u6548\u7387\u975E\u5E38\u4F4E\u4E0B\uFF0C\u8BBF\u95EE\u7684\u7C7B\u578B\u6709\u5F88\u591A\uFF0C\u6548\u7387\u4ECE\u6700\u597D\u5230\u6700\u574F\u4F9D\u6B21\u662F\uFF1A</p><p>system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</p><p>\u4E00\u822C\u60C5\u51B5\u4E0B\uFF0C\u5F97\u4FDD\u8BC1\u67E5\u8BE2\u81F3\u5C11\u8FBE\u5230range\u7EA7\u522B\uFF0C\u6700\u597D\u80FD\u8FBE\u5230ref</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--all:\u5168\u8868\u626B\u63CF\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\u51FA\u73B0\u8FD9\u6837\u7684sql\u8BED\u53E5\u800C\u4E14\u6570\u636E\u91CF\u6BD4\u8F83\u5927\u7684\u8BDD\u90A3\u4E48\u5C31\u9700\u8981\u8FDB\u884C\u4F18\u5316\u3002</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--index\uFF1A\u5168\u7D22\u5F15\u626B\u63CF\u8FD9\u4E2A\u6BD4all\u7684\u6548\u7387\u8981\u597D\uFF0C\u4E3B\u8981\u6709\u4E24\u79CD\u60C5\u51B5\uFF0C\u4E00\u79CD\u662F\u5F53\u524D\u7684\u67E5\u8BE2\u65F6\u8986\u76D6\u7D22\u5F15\uFF0C\u5373\u6211\u4EEC\u9700\u8981\u7684\u6570\u636E\u5728\u7D22\u5F15\u4E2D\u5C31\u53EF\u4EE5\u7D22\u53D6\uFF0C\u6216\u8005\u662F\u4F7F\u7528\u4E86\u7D22\u5F15\u8FDB\u884C\u6392\u5E8F\uFF0C\u8FD9\u6837\u5C31\u907F\u514D\u6570\u636E\u7684\u91CD\u6392\u5E8F</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> empno
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--range\uFF1A\u8868\u793A\u5229\u7528\u7D22\u5F15\u67E5\u8BE2\u7684\u65F6\u5019\u9650\u5236\u4E86\u8303\u56F4\uFF0C\u5728\u6307\u5B9A\u8303\u56F4\u5185\u8FDB\u884C\u67E5\u8BE2\uFF0C\u8FD9\u6837\u907F\u514D\u4E86index\u7684\u5168\u7D22\u5F15\u626B\u63CF\uFF0C\u9002\u7528\u7684\u64CD\u4F5C\u7B26\uFF1A =, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, BETWEEN, LIKE, or IN()</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> empno <span class="token operator">between</span> <span class="token number">7000</span> <span class="token operator">and</span> <span class="token number">7500</span><span class="token punctuation">;</span>

<span class="token comment">--index_subquery\uFF1A\u5229\u7528\u7D22\u5F15\u6765\u5173\u8054\u5B50\u67E5\u8BE2\uFF0C\u4E0D\u518D\u626B\u63CF\u5168\u8868</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>job <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job <span class="token keyword">from</span> t_job<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--unique_subquery:\u8BE5\u8FDE\u63A5\u7C7B\u578B\u7C7B\u4F3C\u4E0Eindex_subquery,\u4F7F\u7528\u7684\u662F\u552F\u4E00\u7D22\u5F15</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--index_merge\uFF1A\u5728\u67E5\u8BE2\u8FC7\u7A0B\u4E2D\u9700\u8981\u591A\u4E2A\u7D22\u5F15\u7EC4\u5408\u4F7F\u7528\uFF0C\u6CA1\u6709\u6A21\u62DF\u51FA\u6765</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> rental
<span class="token keyword">where</span> rental_date <span class="token operator">like</span> <span class="token string">&#39;2005-05-26 07:12:2%&#39;</span>
  <span class="token operator">and</span> inventory_id <span class="token operator">=</span> <span class="token number">3926</span>
  <span class="token operator">and</span> customer_id <span class="token operator">=</span> <span class="token number">321</span>\\G

<span class="token comment">--ref_or_null\uFF1A\u5BF9\u4E8E\u67D0\u4E2A\u5B57\u6BB5\u5373\u9700\u8981\u5173\u8054\u6761\u4EF6\uFF0C\u4E5F\u9700\u8981null\u503C\u7684\u60C5\u51B5\u4E0B\uFF0C\u67E5\u8BE2\u4F18\u5316\u5668\u4F1A\u9009\u62E9\u8FD9\u79CD\u8BBF\u95EE\u65B9\u5F0F</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>mgr <span class="token operator">is</span> <span class="token boolean">null</span>
   <span class="token operator">or</span> e<span class="token punctuation">.</span>mgr <span class="token operator">=</span> <span class="token number">7369</span><span class="token punctuation">;</span>

<span class="token comment">--ref\uFF1A\u4F7F\u7528\u4E86\u975E\u552F\u4E00\u6027\u7D22\u5F15\u8FDB\u884C\u6570\u636E\u7684\u67E5\u627E</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_3 <span class="token keyword">on</span> emp <span class="token punctuation">(</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e<span class="token punctuation">,</span>
     dept d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>

<span class="token comment">--eq_ref \uFF1A\u4F7F\u7528\u552F\u4E00\u6027\u7D22\u5F15\u8FDB\u884C\u6570\u636E\u67E5\u627E</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     emp2
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>empno <span class="token operator">=</span> emp2<span class="token punctuation">.</span>empno<span class="token punctuation">;</span>

<span class="token comment">--const\uFF1A\u8FD9\u4E2A\u8868\u81F3\u591A\u6709\u4E00\u4E2A\u5339\u914D\u884C\uFF0C</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> empno <span class="token operator">=</span> <span class="token number">7369</span><span class="token punctuation">;</span>

<span class="token comment">--system\uFF1A\u8868\u53EA\u6709\u4E00\u884C\u8BB0\u5F55\uFF08\u7B49\u4E8E\u7CFB\u7EDF\u8868\uFF09\uFF0C\u8FD9\u662Fconst\u7C7B\u578B\u7684\u7279\u4F8B\uFF0C\u5E73\u65F6\u4E0D\u4F1A\u51FA\u73B0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>possible_keys</strong></p><p>\u200B \u663E\u793A\u53EF\u80FD\u5E94\u7528\u5728\u8FD9\u5F20\u8868\u4E2D\u7684\u7D22\u5F15\uFF0C\u4E00\u4E2A\u6216\u591A\u4E2A\uFF0C\u67E5\u8BE2\u6D89\u53CA\u5230\u7684\u5B57\u6BB5\u4E0A\u82E5\u5B58\u5728\u7D22\u5F15\uFF0C\u5219\u8BE5\u7D22\u5F15\u5C06\u88AB\u5217\u51FA\uFF0C\u4F46\u4E0D\u4E00\u5B9A\u88AB\u67E5\u8BE2\u5B9E\u9645\u4F7F\u7528</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno
  <span class="token operator">and</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>key</strong></p><p>\u200B \u5B9E\u9645\u4F7F\u7528\u7684\u7D22\u5F15\uFF0C\u5982\u679C\u4E3Anull\uFF0C\u5219\u6CA1\u6709\u4F7F\u7528\u7D22\u5F15\uFF0C\u67E5\u8BE2\u4E2D\u82E5\u4F7F\u7528\u4E86\u8986\u76D6\u7D22\u5F15\uFF0C\u5219\u8BE5\u7D22\u5F15\u548C\u67E5\u8BE2\u7684select\u5B57\u6BB5\u91CD\u53E0\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno
  <span class="token operator">and</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>key_len</strong></p><p>\u8868\u793A\u7D22\u5F15\u4E2D\u4F7F\u7528\u7684\u5B57\u8282\u6570\uFF0C\u53EF\u4EE5\u901A\u8FC7key_len\u8BA1\u7B97\u67E5\u8BE2\u4E2D\u4F7F\u7528\u7684\u7D22\u5F15\u957F\u5EA6\uFF0C\u5728\u4E0D\u635F\u5931\u7CBE\u5EA6\u7684\u60C5\u51B5\u4E0B\u957F\u5EA6\u8D8A\u77ED\u8D8A\u597D\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno
  <span class="token operator">and</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ref</strong></p><p>\u663E\u793A\u7D22\u5F15\u7684\u54EA\u4E00\u5217\u88AB\u4F7F\u7528\u4E86\uFF0C\u5982\u679C\u53EF\u80FD\u7684\u8BDD\uFF0C\u662F\u4E00\u4E2A\u5E38\u6570</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno
  <span class="token operator">and</span> emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>rows</strong></p><p>\u6839\u636E\u8868\u7684\u7EDF\u8BA1\u4FE1\u606F\u53CA\u7D22\u5F15\u4F7F\u7528\u60C5\u51B5\uFF0C\u5927\u81F4\u4F30\u7B97\u51FA\u627E\u51FA\u6240\u9700\u8BB0\u5F55\u9700\u8981\u8BFB\u53D6\u7684\u884C\u6570\uFF0C\u6B64\u53C2\u6570\u5F88\u91CD\u8981\uFF0C\u76F4\u63A5\u53CD\u5E94\u7684sql\u627E\u4E86\u591A\u5C11\u6570\u636E\uFF0C\u5728\u5B8C\u6210\u76EE\u7684\u7684\u60C5\u51B5\u4E0B\u8D8A\u5C11\u8D8A\u597D</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>extra</strong></p><p>\u5305\u542B\u989D\u5916\u7684\u4FE1\u606F\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--using filesort:\u8BF4\u660Emysql\u65E0\u6CD5\u5229\u7528\u7D22\u5F15\u8FDB\u884C\u6392\u5E8F\uFF0C\u53EA\u80FD\u5229\u7528\u6392\u5E8F\u7B97\u6CD5\u8FDB\u884C\u6392\u5E8F\uFF0C\u4F1A\u6D88\u8017\u989D\u5916\u7684\u4F4D\u7F6E</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">order</span> <span class="token keyword">by</span> sal<span class="token punctuation">;</span>

<span class="token comment">--using temporary:\u5EFA\u7ACB\u4E34\u65F6\u8868\u6765\u4FDD\u5B58\u4E2D\u95F4\u7ED3\u679C\uFF0C\u67E5\u8BE2\u5B8C\u6210\u4E4B\u540E\u628A\u4E34\u65F6\u8868\u5220\u9664</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> ename<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> ename<span class="token punctuation">;</span>

<span class="token comment">--using index:\u8FD9\u4E2A\u8868\u793A\u5F53\u524D\u7684\u67E5\u8BE2\u65F6\u8986\u76D6\u7D22\u5F15\u7684\uFF0C\u76F4\u63A5\u4ECE\u7D22\u5F15\u4E2D\u8BFB\u53D6\u6570\u636E\uFF0C\u800C\u4E0D\u7528\u8BBF\u95EE\u6570\u636E\u8868\u3002\u5982\u679C\u540C\u65F6\u51FA\u73B0using where \u8868\u540D\u7D22\u5F15\u88AB\u7528\u6765\u6267\u884C\u7D22\u5F15\u952E\u503C\u7684\u67E5\u627E\uFF0C\u5982\u679C\u6CA1\u6709\uFF0C\u8868\u9762\u7D22\u5F15\u88AB\u7528\u6765\u8BFB\u53D6\u6570\u636E\uFF0C\u800C\u4E0D\u662F\u771F\u7684\u67E5\u627E</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> deptno<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> emp
<span class="token keyword">group</span> <span class="token keyword">by</span> deptno
<span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">--using where:\u4F7F\u7528where\u8FDB\u884C\u6761\u4EF6\u8FC7\u6EE4</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> t_user
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">--using join buffer:\u4F7F\u7528\u8FDE\u63A5\u7F13\u5B58\uFF0C\u60C5\u51B5\u6CA1\u6709\u6A21\u62DF\u51FA\u6765</span>

<span class="token comment">--impossible where\uFF1Awhere\u8BED\u53E5\u7684\u7ED3\u679C\u603B\u662Ffalse</span>
<span class="token keyword">explain</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> empno <span class="token operator">=</span> <span class="token number">7469</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4E8B\u52A1\u7684\u57FA\u672C\u7279\u6027\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u52A1\u7684\u57FA\u672C\u7279\u6027\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u4E8B\u52A1\u7684\u57FA\u672C\u7279\u6027\u662F\u4EC0\u4E48\uFF1F</h2><p>\u6570\u636E\u5E93\u4E8B\u52A1\u7684\u51E0\u4E2A\u7279\u6027\uFF1A\u539F\u5B50\u6027(Atomicity )\u3001\u4E00\u81F4\u6027( Consistency )\u3001\u9694\u79BB\u6027\u6216\u72EC\u7ACB\u6027( Isolation) \u548C\u6301\u4E45\u6027(Durabilily),\u7B80\u79F0\u5C31\u662FACID;</p><ol><li>\u539F\u5B50\u6027\uFF08Atomicity\uFF09 \u4E00\u7CFB\u5217\u7684\u64CD\u4F5C\u6574\u4F53\u4E0D\u53EF\u62C6\u5206\uFF0C\u8981\u4E48\u540C\u65F6\u6210\u529F\uFF0C\u8981\u4E48\u540C\u65F6\u5931\u8D25</li><li>\u4E00\u81F4\u6027\uFF08Consistency\uFF09 \u6570\u636E\u5728\u4E8B\u52A1\u7684\u524D\u540E\uFF0C\u4E1A\u52A1\u6574\u4F53\u4E00\u81F4\u3002 \u25A0\u8F6C\u8D26\u3002A:1000; B:1000;\u8F6C200\u4E8B\u52A1\u6210\u529F;A: 800B: 1200</li><li>\u9694\u79BB\u6027\uFF08Isolation\uFF09 \u4E8B\u52A1\u4E4B\u95F4\u4E92\u76F8\u9694\u79BB\u3002 \u9694\u79BB\u6027\u610F\u5473\u7740\u4E8B\u52A1\u5FC5\u987B\u5728\u4E0D\u5E72\u6270\u5176\u4ED6\u8FDB\u7A0B\u6216\u4E8B\u52A1\u7684\u524D\u63D0\u4E0B\u72EC\u7ACB\u6267\u884C\u3002\u6362\u8A00\u4E4B\uFF0C\u5728\u4E8B\u52A1\u6216\u5DE5\u4F5C\u5355\u5143\u6267\u884C\u5B8C\u6BD5\u4E4B\u524D\uFF0C\u5176\u6240\u8BBF\u95EE\u7684\u6570\u636E\u4E0D\u80FD\u53D7\u7CFB\u7EDF\u5176\u4ED6\u90E8\u5206\u7684\u5F71\u54CD\u3002</li><li>\u6301\u4E45\u6027\uFF08Durability\uFF09 \u4E00\u65E6\u4E8B\u52A1\u6210\u529F\uFF0C\u6570\u636E\u4E00\u5B9A\u4F1A\u843D\u76D8\u5728\u6570\u636E\u5E93</li></ol><h2 id="mysql\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#mysql\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B" aria-hidden="true">#</a> MySQL\u7684\u9694\u79BB\u7EA7\u522B\u6709\u54EA\u4E9B\uFF1F</h2><table><thead><tr><th style="text-align:center;">\u9694\u79BB\u7EA7\u522B</th><th style="text-align:left;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">DEFAULT</td><td style="text-align:left;">\u4F7F\u7528\u5E95\u5C42\u6570\u636E\u5B58\u50A8\u7684\u9ED8\u8BA4\u9694\u79BB\u7EA7\u522B\u3002 \u6240\u6709\u5176\u4ED6\u7EA7\u522B\u5BF9\u5E94\u4E8E JDBC \u9694\u79BB\u7EA7\u522B\u3002</td></tr><tr><td style="text-align:center;">READ_UNCOMMITTED</td><td style="text-align:left;">\u6307\u793A\u53EF\u80FD\u53D1\u751F**</td></tr><tr><td style="text-align:center;">\u810F\u8BFB**\u7684\u5E38\u91CF\u3002 \u6B64\u7EA7\u522B\u5141\u8BB8\u7531\u4E00\u4E2A\u4E8B\u52A1\u66F4\u6539\u7684\u884C\u5728\u63D0\u4EA4\u8BE5\u884C\u4E2D\u7684\u4EFB\u4F55\u66F4\u6539\u4E4B\u524D\u88AB\u53E6\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\uFF08\u201C\u810F\u8BFB\u201D\uFF09\u3002 \u5982\u679C\u4EFB\u4F55\u66F4\u6539\u88AB\u56DE\u6EDA\uFF0C\u5219\u7B2C\u4E8C\u4E2A\u4E8B\u52A1\u5C06\u68C0\u7D22\u5230\u65E0\u6548\u884C\u3002</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;">READ_COMMITTED</td><td style="text-align:left;">\u4E00\u4E2A\u4E8B\u52A1\u53EF\u4EE5\u8BFB\u53D6\u53E6\u4E00\u4E2A\u5DF2\u63D0\u4EA4\u7684\u4E8B\u52A1\uFF0C\u591A\u6B21\u8BFB\u53D6\u4F1A\u9020\u6210\u4E0D\u4E00\u6837\u7684\u7ED3\u679C\uFF0C\u6B64\u73B0\u8C61\u79F0\u4E3A**</td></tr><tr><td style="text-align:center;">\u4E0D\u53EF\u91CD\u590D\u8BFB\u95EE\u9898**\uFF0COracle\u548CSQL Server\u7684\u9ED8\u8BA4\u9694\u79BB\u7EA7\u522B</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;"><strong>REPEATABLE_READ</strong></td><td style="text-align:left;">\u8868\u793A\u9632\u6B62\u810F\u8BFB\u7684\u5E38\u91CF\uFF1B\u53EF\u80FD\u4F1A\u53D1\u751F<strong>\u5E7B\u8BFB</strong>\u3002\u6B64\u7EA7\u522B\u4EC5\u7981\u6B62\u4E8B\u52A1\u8BFB\u53D6\u5176\u4E2D\u5305\u542B\u672A\u63D0\u4EA4\u66F4\u6539\u7684\u884C\u3002*MySQL</td></tr><tr><td style="text-align:center;">\u9ED8\u8BA4\u7684\u9694\u79BB\u7EA7\u522B*</td><td style="text-align:left;"></td></tr><tr><td style="text-align:center;">SERIALIZABLE</td><td style="text-align:left;">\u6307\u793A\u9632\u6B62\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u548C\u5E7B\u8BFB\u7684\u5E38\u91CF\u3002\u8BE5\u7EA7\u522B\u5305\u62ECISOLATION_REPEATABLE_READ\u7684\u7981\u6B62\uFF0C\u5E76\u8FDB\u4E00\u6B65\u7981\u6B62\u8FD9\u6837\u4E00\u79CD\u60C5\u51B5\uFF0C\u5373\u4E00\u4E2A\u4E8B\u52A1\u8BFB\u53D6\u6EE1\u8DB3WHERE\u6761\u4EF6\u7684\u6240\u6709\u884C\uFF0C\u7B2C\u4E8C\u4E2A\u4E8B\u52A1\u63D2\u5165\u6EE1\u8DB3WHERE\u6761\u4EF6\u7684\u884C\uFF0C\u7B2C\u4E00\u4E2A\u4E8B\u52A1\u4E3A\u76F8\u540C\u6761\u4EF6\u91CD\u65B0\u8BFB\u53D6\uFF0C\u68C0\u7D22\u989D\u5916\u7684\u201C\u7B2C\u4E8C\u6B21\u9605\u8BFB\u4E2D\u7684\u5E7B\u5F71\u201D\u884C\u3002</td></tr></tbody></table><p><a href="#%E8%84%8F%E8%AF%BB%E3%80%81%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E3%80%81%E8%99%9A%E8%AF%BB-%E5%B9%BB%E8%AF%BB">\u810F\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u3001\u865A\u8BFB\uFF08\u5E7B\u8BFB\uFF09</a></p><h2 id="\u600E\u4E48\u5904\u7406mysql\u7684\u6162\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u600E\u4E48\u5904\u7406mysql\u7684\u6162\u67E5\u8BE2" aria-hidden="true">#</a> \u600E\u4E48\u5904\u7406MySQL\u7684\u6162\u67E5\u8BE2\uFF1F</h2><p>1\u3001\u5F00\u542F\u6162\u67E5\u8BE2\u65E5\u5FD7\uFF0C\u51C6\u786E\u5B9A\u4F4D\u5230\u54EA\u4E2Asql\u8BED\u53E5\u51FA\u73B0\u4E86\u95EE\u9898</p><p>2\u3001\u5206\u6790sql\u8BED\u53E5\uFF0C\u770B\u770B\u662F\u5426load\u4E86\u989D\u5916\u7684\u6570\u636E\uFF0C\u53EF\u80FD\u662F\u67E5\u8BE2\u4E86\u591A\u4F59\u7684\u884C\u5E76\u4E14\u629B\u5F03\u6389\u4E86\uFF0C\u53EF\u80FD\u662F\u52A0\u8F7D\u4E86\u8BB8\u591A\u7ED3\u679C\u4E2D\u5E76\u4E0D\u9700\u8981\u7684\u5217\uFF0C\u5BF9\u8BED\u53E5\u8FDB\u884C\u5206\u6790\u4EE5\u53CA\u91CD\u5199</p><p>3\u3001\u5206\u6790\u8BED\u53E5\u7684\u6267\u884C\u8BA1\u5212\uFF0C\u7136\u540E\u83B7\u5F97\u5176\u4F7F\u7528\u7D22\u5F15\u7684\u60C5\u51B5\uFF0C\u4E4B\u540E\u4FEE\u6539\u8BED\u53E5\u6216\u8005\u4FEE\u6539\u7D22\u5F15\uFF0C\u4F7F\u5F97\u8BED\u53E5\u53EF\u4EE5\u5C3D\u53EF\u80FD\u7684\u547D\u4E2D\u7D22\u5F15</p><p>4\u3001\u5982\u679C\u5BF9\u8BED\u53E5\u7684\u4F18\u5316\u5DF2\u7ECF\u65E0\u6CD5\u8FDB\u884C\uFF0C\u53EF\u4EE5\u8003\u8651\u8868\u4E2D\u7684\u6570\u636E\u91CF\u662F\u5426\u592A\u5927\uFF0C\u5982\u679C\u662F\u7684\u8BDD\u53EF\u4EE5\u8FDB\u884C\u6A2A\u5411\u6216\u8005\u7EB5\u5411\u7684\u5206\u8868\u3002</p><h2 id="acid\u662F\u9760\u4EC0\u4E48\u4FDD\u8BC1\u7684" tabindex="-1"><a class="header-anchor" href="#acid\u662F\u9760\u4EC0\u4E48\u4FDD\u8BC1\u7684" aria-hidden="true">#</a> ACID\u662F\u9760\u4EC0\u4E48\u4FDD\u8BC1\u7684\uFF1F</h2><p>\u539F\u5B50\u6027\u7531undolog\u65E5\u5FD7\u6765\u4FDD\u8BC1\uFF0C\u5B83\u8BB0\u5F55\u4E86\u9700\u8981\u56DE\u6EDA\u7684\u65E5\u5FD7\u4FE1\u606F\uFF0C\u4E8B\u52A1\u56DE\u6EDA\u65F6\u64A4\u9500\u5DF2\u7ECF\u6267\u884C\u6210\u529F\u7684sql</p><p>\u4E00\u81F4\u6027\u662F\u7531\u5176\u4ED6\u4E09\u5927\u7279\u6027\u4FDD\u8BC1\uFF0C\u7A0B\u5E8F\u4EE3\u7801\u8981\u4FDD\u8BC1\u4E1A\u52A1\u4E0A\u7684\u4E00\u81F4\u6027</p><p>\u9694\u79BB\u6027\u662F\u7531MVCC\u6765\u4FDD\u8BC1</p><p>\u6301\u4E45\u6027\u7531redolog\u6765\u4FDD\u8BC1\uFF0Cmysql\u4FEE\u6539\u6570\u636E\u7684\u65F6\u5019\u4F1A\u5728redolog\u4E2D\u8BB0\u5F55\u4E00\u4EFD\u65E5\u5FD7\u6570\u636E\uFF0C\u5C31\u7B97\u6570\u636E\u6CA1\u6709\u4FDD\u5B58\u6210\u529F\uFF0C\u53EA\u8981\u65E5\u5FD7\u4FDD\u5B58\u6210\u529F\u4E86\uFF0C\u6570\u636E\u4ECD\u7136\u4E0D\u4F1A\u4E22\u5931</p><h2 id="\u4EC0\u4E48\u662Fmvcc" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fmvcc" aria-hidden="true">#</a> \u4EC0\u4E48\u662FMVCC\uFF1F</h2><p>1\u3001MVCC</p><p>\u200B MVCC\uFF0C\u5168\u79F0Multi-Version Concurrency Control\uFF0C\u5373\u591A\u7248\u672C\u5E76\u53D1\u63A7\u5236\u3002MVCC\u662F\u4E00\u79CD\u5E76\u53D1\u63A7\u5236\u7684\u65B9\u6CD5\uFF0C\u4E00\u822C\u5728\u6570\u636E\u5E93\u7BA1\u7406\u7CFB\u7EDF\u4E2D\uFF0C\u5B9E\u73B0\u5BF9\u6570\u636E\u5E93\u7684\u5E76\u53D1\u8BBF\u95EE\uFF0C\u5728\u7F16\u7A0B\u8BED\u8A00\u4E2D\u5B9E\u73B0\u4E8B\u52A1\u5185\u5B58\u3002</p><p>\u200B MVCC\u5728MySQL InnoDB\u4E2D\u7684\u5B9E\u73B0\u4E3B\u8981\u662F\u4E3A\u4E86\u63D0\u9AD8\u6570\u636E\u5E93\u5E76\u53D1\u6027\u80FD\uFF0C\u7528\u66F4\u597D\u7684\u65B9\u5F0F\u53BB\u5904\u7406\u8BFB\u5199\u51B2\u7A81\uFF0C\u505A\u5230\u5373\u4F7F\u6709\u8BFB\u5199\u51B2\u7A81\u65F6\uFF0C\u4E5F\u80FD\u505A\u5230\u4E0D\u52A0\u9501\uFF0C\u975E\u963B\u585E\u5E76\u53D1\u8BFB\u3002</p><p>2\u3001\u5F53\u524D\u8BFB</p><p>\u200B \u50CFselect lock in share mode(\u5171\u4EAB\u9501), select for update ; update, insert ,delete(\u6392\u4ED6\u9501) \u8FD9\u4E9B\u64CD\u4F5C\u90FD\u662F\u4E00\u79CD\u5F53\u524D\u8BFB\uFF0C\u4E3A\u4EC0\u4E48\u53EB\u5F53\u524D\u8BFB\uFF1F\u5C31\u662F\u5B83\u8BFB\u53D6\u7684\u662F\u8BB0\u5F55\u7684\u6700\u65B0\u7248\u672C\uFF0C\u8BFB\u53D6\u65F6\u8FD8\u8981\u4FDD\u8BC1\u5176\u4ED6\u5E76\u53D1\u4E8B\u52A1\u4E0D\u80FD\u4FEE\u6539\u5F53\u524D\u8BB0\u5F55\uFF0C\u4F1A\u5BF9\u8BFB\u53D6\u7684\u8BB0\u5F55\u8FDB\u884C\u52A0\u9501\u3002</p><p>3\u3001\u5FEB\u7167\u8BFB\uFF08\u63D0\u9AD8\u6570\u636E\u5E93\u7684\u5E76\u53D1\u67E5\u8BE2\u80FD\u529B\uFF09</p><p>\u200B \u50CF\u4E0D\u52A0\u9501\u7684select\u64CD\u4F5C\u5C31\u662F\u5FEB\u7167\u8BFB\uFF0C\u5373\u4E0D\u52A0\u9501\u7684\u975E\u963B\u585E\u8BFB\uFF1B\u5FEB\u7167\u8BFB\u7684\u524D\u63D0\u662F\u9694\u79BB\u7EA7\u522B\u4E0D\u662F\u4E32\u884C\u7EA7\u522B\uFF0C\u4E32\u884C\u7EA7\u522B\u4E0B\u7684\u5FEB\u7167\u8BFB\u4F1A\u9000\u5316\u6210\u5F53\u524D\u8BFB\uFF1B\u4E4B\u6240\u4EE5\u51FA\u73B0\u5FEB\u7167\u8BFB\u7684\u60C5\u51B5\uFF0C\u662F\u57FA\u4E8E\u63D0\u9AD8\u5E76\u53D1\u6027\u80FD\u7684\u8003\u8651\uFF0C\u5FEB\u7167\u8BFB\u7684\u5B9E\u73B0\u662F\u57FA\u4E8E\u591A\u7248\u672C\u5E76\u53D1\u63A7\u5236\uFF0C\u5373MVCC,\u53EF\u4EE5\u8BA4\u4E3AMVCC\u662F\u884C\u9501\u7684\u4E00\u4E2A\u53D8\u79CD\uFF0C\u4F46\u5B83\u5728\u5F88\u591A\u60C5\u51B5\u4E0B\uFF0C\u907F\u514D\u4E86\u52A0\u9501\u64CD\u4F5C\uFF0C\u964D\u4F4E\u4E86\u5F00\u9500\uFF1B\u65E2\u7136\u662F\u57FA\u4E8E\u591A\u7248\u672C\uFF0C\u5373\u5FEB\u7167\u8BFB\u53EF\u80FD\u8BFB\u5230\u7684\u5E76\u4E0D\u4E00\u5B9A\u662F\u6570\u636E\u7684\u6700\u65B0\u7248\u672C\uFF0C\u800C\u6709\u53EF\u80FD\u662F\u4E4B\u524D\u7684\u5386\u53F2\u7248\u672C</p><p>4\u3001\u5F53\u524D\u8BFB\u3001\u5FEB\u7167\u8BFB\u3001MVCC\u5173\u7CFB</p><p>\u200B MVCC\u591A\u7248\u672C\u5E76\u53D1\u63A7\u5236\u6307\u7684\u662F\u7EF4\u6301\u4E00\u4E2A\u6570\u636E\u7684\u591A\u4E2A\u7248\u672C\uFF0C\u4F7F\u5F97\u8BFB\u5199\u64CD\u4F5C\u6CA1\u6709\u51B2\u7A81\uFF0C\u5FEB\u7167\u8BFB\u662FMySQL\u4E3A\u5B9E\u73B0MVCC\u7684\u4E00\u4E2A\u975E\u963B\u585E\u8BFB\u529F\u80FD\u3002MVCC\u6A21\u5757\u5728MySQL\u4E2D\u7684\u5177\u4F53\u5B9E\u73B0\u662F\u7531\u4E09\u4E2A\u9690\u5F0F\u5B57\u6BB5\uFF0Cundo\u65E5\u5FD7\u3001read view\u4E09\u4E2A\u7EC4\u4EF6\u6765\u5B9E\u73B0\u7684\u3002</p><h2 id="mvcc\u89E3\u51B3\u7684\u95EE\u9898\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mvcc\u89E3\u51B3\u7684\u95EE\u9898\u662F\u4EC0\u4E48" aria-hidden="true">#</a> MVCC\u89E3\u51B3\u7684\u95EE\u9898\u662F\u4EC0\u4E48\uFF1F</h2><p>\u6570\u636E\u5E93\u5E76\u53D1\u573A\u666F\u6709\u4E09\u79CD\uFF0C\u5206\u522B\u4E3A\uFF1A</p><p>\u200B 1\u3001\u8BFB\u8BFB\uFF1A\u4E0D\u5B58\u5728\u4EFB\u4F55\u95EE\u9898\uFF0C\u4E5F\u4E0D\u9700\u8981\u5E76\u53D1\u63A7\u5236</p><p>\u200B 2\u3001\u8BFB\u5199\uFF1A\u6709\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u53EF\u80FD\u4F1A\u9020\u6210\u4E8B\u52A1\u9694\u79BB\u6027\u95EE\u9898\uFF0C\u53EF\u80FD\u9047\u5230\u810F\u8BFB\u3001\u5E7B\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB</p><p>\u200B 3\u3001\u5199\u5199\uFF1A\u6709\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u53EF\u80FD\u5B58\u5728\u66F4\u65B0\u4E22\u5931\u95EE\u9898</p><p>\u200B MVCC\u662F\u4E00\u79CD\u7528\u6765\u89E3\u51B3\u8BFB\u5199\u51B2\u7A81\u7684\u65E0\u9501\u5E76\u53D1\u63A7\u5236\uFF0C\u4E5F\u5C31\u662F\u4E3A\u4E8B\u52A1\u5206\u914D\u5355\u9879\u589E\u957F\u7684\u65F6\u95F4\u6233\uFF0C\u4E3A\u6BCF\u4E2A\u4FEE\u6539\u4FDD\u5B58\u4E00\u4E2A\u7248\u672C\uFF0C\u7248\u672C\u4E0E\u4E8B\u52A1\u65F6\u95F4\u6233\u5173\u8054\uFF0C\u8BFB\u64CD\u4F5C\u53EA\u8BFB\u8BE5\u4E8B\u52A1\u5F00\u59CB\u524D\u7684\u6570\u636E\u5E93\u7684\u5FEB\u7167\uFF0C\u6240\u4EE5MVCC\u53EF\u4EE5\u4E3A\u6570\u636E\u5E93\u89E3\u51B3\u4E00\u4E0B\u95EE\u9898\uFF1A</p><p>\u200B 1\u3001\u5728\u5E76\u53D1\u8BFB\u5199\u6570\u636E\u5E93\u65F6\uFF0C\u53EF\u4EE5\u505A\u5230\u5728\u8BFB\u64CD\u4F5C\u65F6\u4E0D\u7528\u963B\u585E\u5199\u64CD\u4F5C\uFF0C\u5199\u64CD\u4F5C\u4E5F\u4E0D\u7528\u963B\u585E\u8BFB\u64CD\u4F5C\uFF0C\u63D0\u9AD8\u4E86\u6570\u636E\u5E93\u5E76\u53D1\u8BFB\u5199\u7684\u6027\u80FD</p><p>\u200B 2\u3001\u89E3\u51B3\u810F\u8BFB\u3001\u5E7B\u8BFB\u3001\u4E0D\u53EF\u91CD\u590D\u8BFB\u7B49\u4E8B\u52A1\u9694\u79BB\u95EE\u9898\uFF0C\u4F46\u662F\u4E0D\u80FD\u89E3\u51B3\u66F4\u65B0\u4E22\u5931\u95EE\u9898</p><h2 id="mvcc\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mvcc\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> MVCC\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>mvcc\u7684\u5B9E\u73B0\u539F\u7406\u4E3B\u8981\u4F9D\u8D56\u4E8E\u8BB0\u5F55\u4E2D\u7684\u4E09\u4E2A\u9690\u85CF\u5B57\u6BB5\uFF0Cundolog\uFF0Cread view\u6765\u5B9E\u73B0\u7684\u3002</p><p>\u200B <strong>\u9690\u85CF\u5B57\u6BB5</strong></p><p>\u200B \u6BCF\u884C\u8BB0\u5F55\u9664\u4E86\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684\u5B57\u6BB5\u5916\uFF0C\u8FD8\u6709\u6570\u636E\u5E93\u9690\u5F0F\u5B9A\u4E49\u7684DB_TRX_ID,DB_ROLL_PTR,DB_ROW_ID\u7B49\u5B57\u6BB5</p><p>\u200B DB_TRX_ID</p><p>\u200B 6\u5B57\u8282\uFF0C\u6700\u8FD1\u4FEE\u6539\u4E8B\u52A1id\uFF0C\u8BB0\u5F55\u521B\u5EFA\u8FD9\u6761\u8BB0\u5F55\u6216\u8005\u6700\u540E\u4E00\u6B21\u4FEE\u6539\u8BE5\u8BB0\u5F55\u7684\u4E8B\u52A1id</p><p>\u200B DB_ROLL_PTR</p><p>\u200B 7\u5B57\u8282\uFF0C\u56DE\u6EDA\u6307\u9488\uFF0C\u6307\u5411\u8FD9\u6761\u8BB0\u5F55\u7684\u4E0A\u4E00\u4E2A\u7248\u672C,\u7528\u4E8E\u914D\u5408undolog\uFF0C\u6307\u5411\u4E0A\u4E00\u4E2A\u65E7\u7248\u672C</p><p>\u200B DB_ROW_JD</p><p>\u200B 6\u5B57\u8282\uFF0C\u9690\u85CF\u7684\u4E3B\u952E\uFF0C\u5982\u679C\u6570\u636E\u8868\u6CA1\u6709\u4E3B\u952E\uFF0C\u90A3\u4E48innodb\u4F1A\u81EA\u52A8\u751F\u6210\u4E00\u4E2A6\u5B57\u8282\u7684row_id</p><p>\u200B \u8BB0\u5F55\u5982\u56FE\u6240\u793A\uFF1A</p><p>\u200B \u5728\u4E0A\u56FE\u4E2D\uFF0CDB_ROW_ID\u662F\u6570\u636E\u5E93\u9ED8\u8BA4\u4E3A\u8BE5\u884C\u8BB0\u5F55\u751F\u6210\u7684\u552F\u4E00\u9690\u5F0F\u4E3B\u952E\uFF0CDB_TRX_ID\u662F\u5F53\u524D\u64CD\u4F5C\u8BE5\u8BB0\u5F55\u7684\u4E8B\u52A1ID\uFF0CDB_ROLL_PTR\u662F\u4E00\u4E2A\u56DE\u6EDA\u6307\u9488\uFF0C\u7528\u4E8E\u914D\u5408undo\u65E5\u5FD7\uFF0C\u6307\u5411\u4E0A\u4E00\u4E2A\u65E7\u7248\u672C</p><p>\u200B <strong>undo log</strong></p><p>\u200B undolog\u88AB\u79F0\u4E4B\u4E3A\u56DE\u6EDA\u65E5\u5FD7\uFF0C\u8868\u793A\u5728\u8FDB\u884Cinsert\uFF0Cdelete\uFF0Cupdate\u64CD\u4F5C\u7684\u65F6\u5019\u4EA7\u751F\u7684\u65B9\u4FBF\u56DE\u6EDA\u7684\u65E5\u5FD7</p><p>\u200B \u5F53\u8FDB\u884Cinsert\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u4EA7\u751F\u7684undolog\u53EA\u5728\u4E8B\u52A1\u56DE\u6EDA\u7684\u65F6\u5019\u9700\u8981\uFF0C\u5E76\u4E14\u5728\u4E8B\u52A1\u63D0\u4EA4\u4E4B\u540E\u53EF\u4EE5\u88AB\u7ACB\u523B\u4E22\u5F03</p><p>\u200B \u5F53\u8FDB\u884Cupdate\u548Cdelete\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u4EA7\u751F\u7684undolog\u4E0D\u4EC5\u4EC5\u5728\u4E8B\u52A1\u56DE\u6EDA\u7684\u65F6\u5019\u9700\u8981\uFF0C\u5728\u5FEB\u7167\u8BFB\u7684\u65F6\u5019\u4E5F\u9700\u8981\uFF0C\u6240\u4EE5\u4E0D\u80FD\u968F\u4FBF\u5220\u9664\uFF0C\u53EA\u6709\u5728\u5FEB\u7167\u8BFB\u6216\u4E8B\u52A1\u56DE\u6EDA\u4E0D\u6D89\u53CA\u8BE5\u65E5\u5FD7\u65F6\uFF0C\u5BF9\u5E94\u7684\u65E5\u5FD7\u624D\u4F1A\u88ABpurge\u7EBF\u7A0B\u7EDF\u4E00\u6E05\u9664\uFF08\u5F53\u6570\u636E\u53D1\u751F\u66F4\u65B0\u548C\u5220\u9664\u64CD\u4F5C\u7684\u65F6\u5019\u90FD\u53EA\u662F\u8BBE\u7F6E\u4E00\u4E0B\u8001\u8BB0\u5F55\u7684deleted_bit\uFF0C\u5E76\u4E0D\u662F\u771F\u6B63\u7684\u5C06\u8FC7\u65F6\u7684\u8BB0\u5F55\u5220\u9664\uFF0C\u56E0\u4E3A\u4E3A\u4E86\u8282\u7701\u78C1\u76D8\u7A7A\u95F4\uFF0Cinnodb\u6709\u4E13\u95E8\u7684purge\u7EBF\u7A0B\u6765\u6E05\u9664deleted_bit\u4E3Atrue\u7684\u8BB0\u5F55\uFF0C\u5982\u679C\u67D0\u4E2A\u8BB0\u5F55\u7684deleted_id\u4E3Atrue\uFF0C\u5E76\u4E14DB_TRX_ID\u76F8\u5BF9\u4E8Epurge\u7EBF\u7A0B\u7684read view \u53EF\u89C1\uFF0C\u90A3\u4E48\u8FD9\u6761\u8BB0\u5F55\u4E00\u5B9A\u65F6\u53EF\u4EE5\u88AB\u6E05\u9664\u7684\uFF09</p><p>\u200B <strong>\u4E0B\u9762\u6211\u4EEC\u6765\u770B\u4E00\u4E0Bundolog\u751F\u6210\u7684\u8BB0\u5F55\u94FE</strong></p><p>\u200B 1\u3001\u5047\u8BBE\u6709\u4E00\u4E2A\u4E8B\u52A1\u7F16\u53F7\u4E3A1\u7684\u4E8B\u52A1\u5411\u8868\u4E2D\u63D2\u5165\u4E00\u6761\u8BB0\u5F55\uFF0C\u90A3\u4E48\u6B64\u65F6\u884C\u6570\u636E\u7684\u72B6\u6001\u4E3A\uFF1A</p><p>\u200B 2\u3001\u5047\u8BBE\u6709\u7B2C\u4E8C\u4E2A\u4E8B\u52A1\u7F16\u53F7\u4E3A2\u5BF9\u8BE5\u8BB0\u5F55\u7684name\u505A\u51FA\u4FEE\u6539\uFF0C\u6539\u4E3Alisi</p><p>\u200B \u5728\u4E8B\u52A12\u4FEE\u6539\u8BE5\u884C\u8BB0\u5F55\u6570\u636E\u65F6\uFF0C\u6570\u636E\u5E93\u4F1A\u5BF9\u8BE5\u884C\u52A0\u6392\u4ED6\u9501</p><p>\u200B \u7136\u540E\u628A\u8BE5\u884C\u6570\u636E\u62F7\u8D1D\u5230undolog\u4E2D\uFF0C\u4F5C\u4E3A \u65E7\u8BB0\u5F55\uFF0C\u5373\u5728undolog\u4E2D\u6709\u5F53\u524D\u884C\u7684\u62F7\u8D1D\u526F\u672C</p><p>\u200B \u62F7\u8D1D\u5B8C\u6BD5\u540E\uFF0C\u4FEE\u6539\u8BE5\u884Cname\u4E3Alisi\uFF0C\u5E76\u4E14\u4FEE\u6539\u9690\u85CF\u5B57\u6BB5\u7684\u4E8B\u52A1id\u4E3A\u5F53\u524D\u4E8B\u52A12\u7684id\uFF0C\u56DE\u6EDA\u6307\u9488\u6307\u5411\u62F7\u8D1D\u5230undolog\u7684\u526F\u672C\u8BB0\u5F55\u4E2D\u4E8B\u52A1\u63D0\u4EA4\u540E\uFF0C\u91CA\u653E\u9501</p><p>\u200B 3\u3001\u5047\u8BBE\u6709\u7B2C\u4E09\u4E2A\u4E8B\u52A1\u7F16\u53F7\u4E3A3\u5BF9\u8BE5\u8BB0\u5F55\u7684age\u505A\u4E86\u4FEE\u6539\uFF0C\u6539\u4E3A32</p><p>\u200B \u5728\u4E8B\u52A13\u4FEE\u6539\u8BE5\u884C\u6570\u636E\u7684\u65F6\uFF0C\u6570\u636E\u5E93\u4F1A\u5BF9\u8BE5\u884C\u52A0\u6392\u4ED6\u9501</p><p>\u200B \u7136\u540E\u628A\u8BE5\u884C\u6570\u636E\u62F7\u8D1D\u5230undolog\u4E2D\uFF0C\u4F5C\u4E3A\u65E7\u7EAA\u5F55\uFF0C\u53D1\u73B0\u8BE5\u884C\u8BB0\u5F55\u5DF2\u7ECF\u6709undolog\u4E86\uFF0C\u90A3\u4E48\u6700\u65B0\u7684\u65E7\u6570\u636E\u4F5C\u4E3A\u94FE\u8868\u7684\u8868\u5934\uFF0C\u63D2\u5728\u8BE5\u884C\u8BB0\u5F55\u7684undolog\u6700\u524D\u9762</p><p>\u200B \u4FEE\u6539\u8BE5\u884Cage\u4E3A32\u5C81\uFF0C\u5E76\u4E14\u4FEE\u6539\u9690\u85CF\u5B57\u6BB5\u7684\u4E8B\u52A1id\u4E3A\u5F53\u524D\u4E8B\u52A13\u7684id\uFF0C\u56DE\u6EDA\u6307\u9488\u6307\u5411\u521A\u521A\u62F7\u8D1D\u7684undolog\u7684\u526F\u672C\u8BB0\u5F55</p><p>\u200B \u4E8B\u52A1\u63D0\u4EA4\uFF0C\u91CA\u653E\u9501</p><p>\u200B \u4ECE\u4E0A\u8FF0\u7684\u4E00\u7CFB\u5217\u56FE\u4E2D\uFF0C\u5927\u5BB6\u53EF\u4EE5\u53D1\u73B0\uFF0C\u4E0D\u540C\u4E8B\u52A1\u6216\u8005\u76F8\u540C\u4E8B\u52A1\u7684\u5BF9\u540C\u4E00\u8BB0\u5F55\u7684\u4FEE\u6539\uFF0C\u4F1A\u5BFC\u81F4\u8BE5\u8BB0\u5F55\u7684undolog\u751F\u6210\u4E00\u6761\u8BB0\u5F55\u7248\u672C\u7EBF\u6027\u8868\uFF0C\u5373\u94FE\u8868\uFF0Cundolog\u7684\u94FE\u9996\u5C31\u662F\u6700\u65B0\u7684\u65E7\u8BB0\u5F55\uFF0C\u94FE\u5C3E\u5C31\u662F\u6700\u65E9\u7684\u65E7\u8BB0\u5F55\u3002</p><p>\u200B <strong>Read View</strong></p><p>\u200B \u4E0A\u9762\u7684\u6D41\u7A0B\u5982\u679C\u770B\u660E\u767D\u4E86\uFF0C\u90A3\u4E48\u5927\u5BB6\u9700\u8981\u518D\u6DF1\u5165\u7406\u89E3\u4E0Bread view\u7684\u6982\u5FF5\u4E86\u3002</p><p>\u200B Read View\u662F\u4E8B\u52A1\u8FDB\u884C\u5FEB\u7167\u8BFB\u64CD\u4F5C\u7684\u65F6\u5019\u751F\u4EA7\u7684\u8BFB\u89C6\u56FE\uFF0C\u5728\u8BE5\u4E8B\u52A1\u6267\u884C\u5FEB\u7167\u8BFB\u7684\u90A3\u4E00\u523B\uFF0C\u4F1A\u751F\u6210\u4E00\u4E2A\u6570\u636E\u7CFB\u7EDF\u5F53\u524D\u7684\u5FEB\u7167\uFF0C\u8BB0\u5F55\u5E76\u7EF4\u62A4\u7CFB\u7EDF\u5F53\u524D\u6D3B\u8DC3\u4E8B\u52A1\u7684id\uFF0C\u4E8B\u52A1\u7684id\u503C\u662F\u9012\u589E\u7684\u3002</p><p>\u200B \u5176\u5B9ERead View\u7684\u6700\u5927\u4F5C\u7528\u662F\u7528\u6765\u505A\u53EF\u89C1\u6027\u5224\u65AD\u7684\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5F53\u67D0\u4E2A\u4E8B\u52A1\u5728\u6267\u884C\u5FEB\u7167\u8BFB\u7684\u65F6\u5019\uFF0C\u5BF9\u8BE5\u8BB0\u5F55\u521B\u5EFA\u4E00\u4E2ARead View\u7684\u89C6\u56FE\uFF0C\u628A\u5B83\u5F53\u4F5C\u6761\u4EF6\u53BB\u5224\u65AD\u5F53\u524D\u4E8B\u52A1\u80FD\u591F\u770B\u5230\u54EA\u4E2A\u7248\u672C\u7684\u6570\u636E\uFF0C\u6709\u53EF\u80FD\u8BFB\u53D6\u5230\u7684\u662F\u6700\u65B0\u7684\u6570\u636E\uFF0C\u4E5F\u6709\u53EF\u80FD\u8BFB\u53D6\u7684\u662F\u5F53\u524D\u884C\u8BB0\u5F55\u7684undolog\u4E2D\u67D0\u4E2A\u7248\u672C\u7684\u6570\u636E</p><p>\u200B Read View\u9075\u5FAA\u7684\u53EF\u89C1\u6027\u7B97\u6CD5\u4E3B\u8981\u662F\u5C06\u8981\u88AB\u4FEE\u6539\u7684\u6570\u636E\u7684\u6700\u65B0\u8BB0\u5F55\u4E2D\u7684DB_TRX_ID\uFF08\u5F53\u524D\u4E8B\u52A1id\uFF09\u53D6\u51FA\u6765\uFF0C\u4E0E\u7CFB\u7EDF\u5F53\u524D\u5176\u4ED6\u6D3B\u8DC3\u4E8B\u52A1\u7684id\u53BB\u5BF9\u6BD4\uFF0C\u5982\u679CDB_TRX_ID\u8DDFRead View\u7684\u5C5E\u6027\u505A\u4E86\u6BD4\u8F83\uFF0C\u4E0D\u7B26\u5408\u53EF\u89C1\u6027\uFF0C\u90A3\u4E48\u5C31\u901A\u8FC7DB_ROLL_PTR\u56DE\u6EDA\u6307\u9488\u53BB\u53D6\u51FAundolog\u4E2D\u7684DB_TRX_ID\u505A\u6BD4\u8F83\uFF0C\u5373\u904D\u5386\u94FE\u8868\u4E2D\u7684DB_TRX_ID\uFF0C\u76F4\u5230\u627E\u5230\u6EE1\u8DB3\u6761\u4EF6\u7684DB_TRX_ID,\u8FD9\u4E2ADB_TRX_ID\u6240\u5728\u7684\u65E7\u8BB0\u5F55\u5C31\u662F\u5F53\u524D\u4E8B\u52A1\u80FD\u770B\u5230\u7684\u6700\u65B0\u8001\u7248\u672C\u6570\u636E\u3002</p><p>\u200B Read View\u7684\u53EF\u89C1\u6027\u89C4\u5219\u5982\u4E0B\u6240\u793A\uFF1A</p><p>\u200B \u9996\u5148\u8981\u77E5\u9053Read View\u4E2D\u7684\u4E09\u4E2A\u5168\u5C40\u5C5E\u6027\uFF1A</p><p>\u200B trx_list:\u4E00\u4E2A\u6570\u503C\u5217\u8868\uFF0C\u7528\u6765\u7EF4\u62A4Read View\u751F\u6210\u65F6\u523B\u7CFB\u7EDF\u6B63\u6D3B\u8DC3\u7684\u4E8B\u52A1ID\uFF081,2,3\uFF09</p><p>\u200B up_limit_id:\u8BB0\u5F55trx_list\u5217\u8868\u4E2D\u4E8B\u52A1ID\u6700\u5C0F\u7684ID\uFF081\uFF09</p><p>\u200B low_limit_id:Read View\u751F\u6210\u65F6\u523B\u7CFB\u7EDF\u5C1A\u672A\u5206\u914D\u7684\u4E0B\u4E00\u4E2A\u4E8B\u52A1ID\uFF0C\uFF084\uFF09</p><p>\u200B \u5177\u4F53\u7684\u6BD4\u8F83\u89C4\u5219\u5982\u4E0B\uFF1A</p><ol><li>\u9996\u5148\u6BD4\u8F83DB_TRX_ID &lt; up_limit_id,\u5982\u679C\u5C0F\u4E8E\uFF0C\u5219\u5F53\u524D\u4E8B\u52A1\u80FD\u770B\u5230DB_TRX_ID\u6240\u5728\u7684\u8BB0\u5F55\uFF0C\u5982\u679C\u5927\u4E8E\u7B49\u4E8E\u8FDB\u5165\u4E0B\u4E00\u4E2A\u5224\u65AD</li><li>\u63A5\u4E0B\u6765\u5224\u65ADDB_TRX_ID &gt;= low_limit_id,\u5982\u679C\u5927\u4E8E\u7B49\u4E8E\u5219\u4EE3\u8868DB_TRX_ID\u6240\u5728\u7684\u8BB0\u5F55\u5728Read View\u751F\u6210\u540E\u624D\u51FA\u73B0\u7684\uFF0C\u90A3\u4E48\u5BF9\u4E8E\u5F53\u524D\u4E8B\u52A1\u80AF\u5B9A\u4E0D\u53EF\u89C1\uFF0C\u5982\u679C\u5C0F\u4E8E\uFF0C\u5219\u8FDB\u5165\u4E0B\u4E00\u6B65\u5224\u65AD</li><li>\u5224\u65ADDB_TRX_ID\u662F\u5426\u5728\u6D3B\u8DC3\u4E8B\u52A1\u4E2D\uFF0C\u5982\u679C\u5728\uFF0C\u5219\u4EE3\u8868\u5728Read View\u751F\u6210\u65F6\u523B\uFF0C\u8FD9\u4E2A\u4E8B\u52A1\u8FD8\u662F\u6D3B\u8DC3\u72B6\u6001\uFF0C\u8FD8\u6CA1\u6709commit\uFF0C\u4FEE\u6539\u7684\u6570\u636E\uFF0C\u5F53\u524D\u4E8B\u52A1\u4E5F\u662F\u770B\u4E0D\u5230\uFF0C\u5982\u679C\u4E0D\u5728\uFF0C\u5219\u8BF4\u660E\u8FD9\u4E2A\u4E8B\u52A1\u5728Read View\u751F\u6210\u4E4B\u524D\u5C31\u5DF2\u7ECF\u5F00\u59CBcommit\uFF0C\u90A3\u4E48\u4FEE\u6539\u7684\u7ED3\u679C\u662F\u80FD\u591F\u770B\u89C1\u7684\u3002</li></ol><p>7\u3001MVCC\u7684\u6574\u4F53\u5904\u7406\u6D41\u7A0B</p><p>\u5047\u8BBE\u6709\u56DB\u4E2A\u4E8B\u52A1\u540C\u65F6\u5728\u6267\u884C\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><table><thead><tr><th>\u4E8B\u52A11</th><th>\u4E8B\u52A12</th><th>\u4E8B\u52A13</th><th>\u4E8B\u52A14</th></tr></thead><tbody><tr><td>\u4E8B\u52A1\u5F00\u59CB</td><td>\u4E8B\u52A1\u5F00\u59CB</td><td>\u4E8B\u52A1\u5F00\u59CB</td><td>\u4E8B\u52A1\u5F00\u59CB</td></tr><tr><td>......</td><td>......</td><td>......</td><td>\u4FEE\u6539\u4E14\u5DF2\u63D0\u4EA4</td></tr><tr><td>\u8FDB\u884C\u4E2D</td><td>\u5FEB\u7167\u8BFB</td><td>\u8FDB\u884C\u4E2D</td><td></td></tr><tr><td>......</td><td>......</td><td>......</td><td></td></tr></tbody></table><p>\u4ECE\u4E0A\u8FF0\u8868\u683C\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\uFF0C\u5F53\u4E8B\u52A12\u5BF9\u67D0\u884C\u6570\u636E\u6267\u884C\u4E86\u5FEB\u7167\u8BFB\uFF0C\u6570\u636E\u5E93\u4E3A\u8BE5\u884C\u6570\u636E\u751F\u6210\u4E00\u4E2ARead View\u89C6\u56FE\uFF0C\u53EF\u4EE5\u770B\u5230\u4E8B\u52A11\u548C\u4E8B\u52A13\u8FD8\u5728\u6D3B\u8DC3\u72B6\u6001\uFF0C\u4E8B\u52A14\u5728\u4E8B\u52A12\u5FEB\u7167\u8BFB\u7684\u524D\u4E00\u523B\u63D0\u4EA4\u4E86\u66F4\u65B0\uFF0C\u6240\u4EE5\uFF0C\u5728Read View\u4E2D\u8BB0\u5F55\u4E86\u7CFB\u7EDF\u5F53\u524D\u6D3B\u8DC3\u4E8B\u52A11\uFF0C3\uFF0C\u7EF4\u62A4\u5728\u4E00\u4E2A\u5217\u8868\u4E2D\u3002\u540C\u65F6\u53EF\u4EE5\u770B\u5230up_limit_id\u7684\u503C\u4E3A1\uFF0C\u800Clow_limit_id\u4E3A5\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p>\u5728\u4E0A\u8FF0\u7684\u4F8B\u5B50\u4E2D\uFF0C\u53EA\u6709\u4E8B\u52A14\u4FEE\u6539\u8FC7\u8BE5\u884C\u8BB0\u5F55\uFF0C\u5E76\u5728\u4E8B\u52A12\u8FDB\u884C\u5FEB\u7167\u8BFB\u524D\uFF0C\u5C31\u63D0\u4EA4\u4E86\u4E8B\u52A1\uFF0C\u6240\u4EE5\u8BE5\u884C\u5F53\u524D\u6570\u636E\u7684undolog\u5982\u4E0B\u6240\u793A\uFF1A</p><p>\u5F53\u4E8B\u52A12\u5728\u5FEB\u7167\u8BFB\u8BE5\u884C\u8BB0\u5F55\u7684\u662F\uFF0C\u4F1A\u62FF\u7740\u8BE5\u884C\u8BB0\u5F55\u7684DB_TRX_ID\u53BB\u8DDFup_limit_id,lower_limit_id\u548C\u6D3B\u8DC3\u4E8B\u52A1\u5217\u8868\u8FDB\u884C\u6BD4\u8F83\uFF0C\u5224\u8BFB\u4E8B\u52A12\u80FD\u770B\u5230\u8BE5\u884C\u8BB0\u5F55\u7684\u7248\u672C\u662F\u54EA\u4E2A\u3002</p><p>\u5177\u4F53\u6D41\u7A0B\u5982\u4E0B\uFF1A\u5148\u62FF\u8BE5\u884C\u8BB0\u5F55\u7684\u4E8B\u52A1ID\uFF084\uFF09\u53BB\u8DDFRead View\u4E2D\u7684up_limit_id\u76F8\u6BD4\u8F83\uFF0C\u5224\u65AD\u662F\u5426\u5C0F\u4E8E\uFF0C\u901A\u8FC7\u5BF9\u6BD4\u53D1\u73B0\u4E0D\u5C0F\u4E8E\uFF0C\u6240\u4EE5\u4E0D\u7B26\u5408\u6761\u4EF6\uFF0C\u7EE7\u7EED\u5224\u65AD4\u662F\u5426\u5927\u4E8E\u7B49\u4E8Elow_limit_id,\u901A\u8FC7\u6BD4\u8F83\u53D1\u73B0\u4E5F\u4E0D\u5927\u4E8E\uFF0C\u6240\u4EE5\u4E0D\u7B26\u5408\u6761\u4EF6\uFF0C\u5224\u65AD\u4E8B\u52A14\u662F\u5426\u5904\u7406trx_list\u5217\u8868\u4E2D\uFF0C\u53D1\u73B0\u4E0D\u518D\u6B21\u5217\u8868\u4E2D\uFF0C\u90A3\u4E48\u7B26\u5408\u53EF\u89C1\u6027\u6761\u4EF6\uFF0C\u6240\u4EE5\u4E8B\u52A14\u4FEE\u6539\u540E\u63D0\u4EA4\u7684\u6700\u65B0\u7ED3\u679C\u5BF9\u4E8B\u52A12 \u7684\u5FEB\u7167\u662F\u53EF\u89C1\u7684\uFF0C\u56E0\u6B64\uFF0C\u4E8B\u52A12\u8BFB\u53D6\u5230\u7684\u6700\u65B0\u6570\u636E\u8BB0\u5F55\u662F\u4E8B\u52A14\u6240\u63D0\u4EA4\u7684\u7248\u672C\uFF0C\u800C\u4E8B\u52A14\u63D0\u4EA4\u7684\u7248\u672C\u4E5F\u662F\u5168\u5C40\u89D2\u5EA6\u7684\u6700\u65B0\u7248\u672C\u3002\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p>\u5F53\u4E0A\u8FF0\u7684\u5185\u5BB9\u90FD\u770B\u660E\u767D\u4E86\u7684\u8BDD\uFF0C\u90A3\u4E48\u5927\u5BB6\u5C31\u5E94\u8BE5\u80FD\u591F\u641E\u6E05\u695A\u8FD9\u51E0\u4E2A\u6838\u5FC3\u6982\u5FF5\u4E4B\u95F4\u7684\u5173\u7CFB\u4E86\uFF0C\u4E0B\u9762\u6211\u4EEC\u8BB2\u4E00\u4E2A\u4E0D\u540C\u7684\u9694\u79BB\u7EA7\u522B\u4E0B\u7684\u5FEB\u7167\u8BFB\u7684\u4E0D\u540C\u3002</p><p>8\u3001RC\u3001RR\u7EA7\u522B\u4E0B\u7684InnoDB\u5FEB\u7167\u8BFB\u6709\u4EC0\u4E48\u4E0D\u540C</p><p>\u56E0\u4E3ARead View\u751F\u6210\u65F6\u673A\u7684\u4E0D\u540C\uFF0C\u4ECE\u800C\u9020\u6210RC\u3001RR\u7EA7\u522B\u4E0B\u5FEB\u7167\u8BFB\u7684\u7ED3\u679C\u7684\u4E0D\u540C</p><ol><li>\u5728RR\u7EA7\u522B\u4E0B\u7684\u67D0\u4E2A\u4E8B\u52A1\u7684\u5BF9\u67D0\u6761\u8BB0\u5F55\u7684\u7B2C\u4E00\u6B21\u5FEB\u7167\u8BFB\u4F1A\u521B\u5EFA\u4E00\u4E2A\u5FEB\u7167\u5373Read View,\u5C06\u5F53\u524D\u7CFB\u7EDF\u6D3B\u8DC3\u7684\u5176\u4ED6\u4E8B\u52A1\u8BB0\u5F55\u8D77\u6765\uFF0C\u6B64\u540E\u5728\u8C03\u7528\u5FEB\u7167\u8BFB\u7684\u65F6\u5019\uFF0C\u8FD8\u662F\u4F7F\u7528\u7684\u662F\u540C\u4E00\u4E2ARead View,\u6240\u4EE5\u53EA\u8981\u5F53\u524D\u4E8B\u52A1\u5728\u5176\u4ED6\u4E8B\u52A1\u63D0\u4EA4\u66F4\u65B0\u4E4B\u524D\u4F7F\u7528\u8FC7\u5FEB\u7167\u8BFB\uFF0C\u90A3\u4E48\u4E4B\u540E\u7684\u5FEB\u7167\u8BFB\u4F7F\u7528\u7684\u90FD\u662F\u540C\u4E00\u4E2ARead View,\u6240\u4EE5\u5BF9\u4E4B\u540E\u7684\u4FEE\u6539\u4E0D\u53EF\u89C1</li><li>\u5728RR\u7EA7\u522B\u4E0B\uFF0C\u5FEB\u7167\u8BFB\u751F\u6210Read View\u65F6\uFF0CRead View\u4F1A\u8BB0\u5F55\u6B64\u65F6\u6240\u6709\u5176\u4ED6\u6D3B\u52A8\u548C\u4E8B\u52A1\u7684\u5FEB\u7167\uFF0C\u8FD9\u4E9B\u4E8B\u52A1\u7684\u4FEE\u6539\u5BF9\u4E8E\u5F53\u524D\u4E8B\u52A1\u90FD\u662F\u4E0D\u53EF\u89C1\u7684\uFF0C\u800C\u65E9\u4E8ERead View\u521B\u5EFA\u7684\u4E8B\u52A1\u6240\u505A\u7684\u4FEE\u6539\u5747\u662F\u53EF\u89C1</li><li>\u5728RC\u7EA7\u522B\u4E0B\uFF0C\u4E8B\u52A1\u4E2D\uFF0C\u6BCF\u6B21\u5FEB\u7167\u8BFB\u90FD\u4F1A\u65B0\u751F\u6210\u4E00\u4E2A\u5FEB\u7167\u548CRead View,\u8FD9\u5C31\u662F\u6211\u4EEC\u5728RC\u7EA7\u522B\u4E0B\u7684\u4E8B\u52A1\u4E2D\u53EF\u4EE5\u770B\u5230\u522B\u7684\u4E8B\u52A1\u63D0\u4EA4\u7684\u66F4\u65B0\u7684\u539F\u56E0\u3002</li></ol><p><strong>\u603B\u7ED3\uFF1A\u5728RC\u9694\u79BB\u7EA7\u522B\u4E0B\uFF0C\u662F\u6BCF\u4E2A\u5FEB\u7167\u8BFB\u90FD\u4F1A\u751F\u6210\u5E76\u83B7\u53D6\u6700\u65B0\u7684Read View,\u800C\u5728RR\u9694\u79BB\u7EA7\u522B\u4E0B\uFF0C\u5219\u662F\u540C\u4E00\u4E2A\u4E8B\u52A1\u4E2D\u7684\u7B2C\u4E00\u4E2A\u5FEB\u7167\u8BFB\u624D\u4F1A\u521B\u5EFARead View\uFF0C\u4E4B\u540E\u7684\u5FEB\u7167\u8BFB\u83B7\u53D6\u7684\u90FD\u662F\u540C\u4E00\u4E2ARead View.</strong></p><h2 id="\u4EC0\u4E48\u662Fmysql\u7684\u4E3B\u4ECE\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fmysql\u7684\u4E3B\u4ECE\u590D\u5236" aria-hidden="true">#</a> \u4EC0\u4E48\u662Fmysql\u7684\u4E3B\u4ECE\u590D\u5236\uFF1F</h2><p>MySQL \u4E3B\u4ECE\u590D\u5236\u662F\u6307\u6570\u636E\u53EF\u4EE5\u4ECE\u4E00\u4E2AMySQL\u6570\u636E\u5E93\u670D\u52A1\u5668\u4E3B\u8282\u70B9\u590D\u5236\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u4ECE\u8282\u70B9\u3002MySQL \u9ED8\u8BA4\u91C7\u7528\u5F02\u6B65\u590D\u5236\u65B9\u5F0F\uFF0C\u8FD9\u6837\u4ECE\u8282\u70B9\u4E0D\u7528\u4E00\u76F4\u8BBF\u95EE\u4E3B\u670D\u52A1\u5668\u6765\u66F4\u65B0\u81EA\u5DF1\u7684\u6570\u636E\uFF0C\u6570\u636E\u7684\u66F4\u65B0\u53EF\u4EE5\u5728\u8FDC\u7A0B\u8FDE\u63A5\u4E0A\u8FDB\u884C\uFF0C\u4ECE\u8282\u70B9\u53EF\u4EE5\u590D\u5236\u4E3B\u6570\u636E\u5E93\u4E2D\u7684\u6240\u6709\u6570\u636E\u5E93\u6216\u8005\u7279\u5B9A\u7684\u6570\u636E\u5E93\uFF0C\u6216\u8005\u7279\u5B9A\u7684\u8868\u3002</p><h2 id="mysql\u4E3A\u4EC0\u4E48\u9700\u8981\u4E3B\u4ECE\u540C\u6B65" tabindex="-1"><a class="header-anchor" href="#mysql\u4E3A\u4EC0\u4E48\u9700\u8981\u4E3B\u4ECE\u540C\u6B65" aria-hidden="true">#</a> mysql\u4E3A\u4EC0\u4E48\u9700\u8981\u4E3B\u4ECE\u540C\u6B65\uFF1F</h2><p>1\u3001\u5728\u4E1A\u52A1\u590D\u6742\u7684\u7CFB\u7EDF\u4E2D\uFF0C\u6709\u8FD9\u4E48\u4E00\u4E2A\u60C5\u666F\uFF0C\u6709\u4E00\u53E5sql\u8BED\u53E5\u9700\u8981\u9501\u8868\uFF0C\u5BFC\u81F4\u6682\u65F6\u4E0D\u80FD\u4F7F\u7528\u8BFB\u7684\u670D\u52A1\uFF0C\u90A3\u4E48\u5C31\u5F88\u5F71\u54CD\u8FD0\u884C\u4E2D\u7684\u4E1A\u52A1\uFF0C\u4F7F\u7528\u4E3B\u4ECE\u590D\u5236\uFF0C\u8BA9\u4E3B\u5E93\u8D1F\u8D23\u5199\uFF0C\u4ECE\u5E93\u8D1F\u8D23\u8BFB\uFF0C\u8FD9\u6837\uFF0C\u5373\u4F7F\u4E3B\u5E93\u51FA\u73B0\u4E86\u9501\u8868\u7684\u60C5\u666F\uFF0C\u901A\u8FC7\u8BFB\u4ECE\u5E93\u4E5F\u53EF\u4EE5\u4FDD\u8BC1\u4E1A\u52A1\u7684\u6B63\u5E38\u8FD0\u4F5C\u3002</p><p>2\u3001\u505A\u6570\u636E\u7684\u70ED\u5907</p><p>3\u3001\u67B6\u6784\u7684\u6269\u5C55\u3002\u4E1A\u52A1\u91CF\u8D8A\u6765\u8D8A\u5927\uFF0CI/O\u8BBF\u95EE\u9891\u7387\u8FC7\u9AD8\uFF0C\u5355\u673A\u65E0\u6CD5\u6EE1\u8DB3\uFF0C\u6B64\u65F6\u505A\u591A\u5E93\u7684\u5B58\u50A8\uFF0C\u964D\u4F4E\u78C1\u76D8I/O\u8BBF\u95EE\u7684\u9891\u7387\uFF0C\u63D0\u9AD8\u5355\u4E2A\u673A\u5668\u7684I/O\u6027\u80FD\u3002</p><h2 id="mysql\u590D\u5236\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#mysql\u590D\u5236\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> mysql\u590D\u5236\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\uFF081\uFF09master\u670D\u52A1\u5668\u5C06\u6570\u636E\u7684\u6539\u53D8\u8BB0\u5F55\u4E8C\u8FDB\u5236binlog\u65E5\u5FD7\uFF0C\u5F53master\u4E0A\u7684\u6570\u636E\u53D1\u751F\u6539\u53D8\u65F6\uFF0C\u5219\u5C06\u5176\u6539\u53D8\u5199\u5165\u4E8C\u8FDB\u5236\u65E5\u5FD7\u4E2D\uFF1B</p><p>\uFF082\uFF09slave\u670D\u52A1\u5668\u4F1A\u5728\u4E00\u5B9A\u65F6\u95F4\u95F4\u9694\u5185\u5BF9master\u4E8C\u8FDB\u5236\u65E5\u5FD7\u8FDB\u884C\u63A2\u6D4B\u5176\u662F\u5426\u53D1\u751F\u6539\u53D8\uFF0C\u5982\u679C\u53D1\u751F\u6539\u53D8\uFF0C\u5219\u5F00\u59CB\u4E00\u4E2AI/OThread\u8BF7\u6C42master\u4E8C\u8FDB\u5236\u4E8B\u4EF6</p><p>\uFF083\uFF09\u540C\u65F6\u4E3B\u8282\u70B9\u4E3A\u6BCF\u4E2AI/O\u7EBF\u7A0B\u542F\u52A8\u4E00\u4E2Adump\u7EBF\u7A0B\uFF0C\u7528\u4E8E\u5411\u5176\u53D1\u9001\u4E8C\u8FDB\u5236\u4E8B\u4EF6\uFF0C\u5E76\u4FDD\u5B58\u81F3\u4ECE\u8282\u70B9\u672C\u5730\u7684\u4E2D\u7EE7\u65E5\u5FD7\u4E2D\uFF0C\u4ECE\u8282\u70B9\u5C06\u542F\u52A8SQL\u7EBF\u7A0B\u4ECE\u4E2D\u7EE7\u65E5\u5FD7\u4E2D\u8BFB\u53D6\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF0C\u5728\u672C\u5730\u91CD\u653E\uFF0C\u4F7F\u5F97\u5176\u6570\u636E\u548C\u4E3B\u8282\u70B9\u7684\u4FDD\u6301\u4E00\u81F4\uFF0C\u6700\u540EI/OThread\u548CSQLThread\u5C06\u8FDB\u5165\u7761\u7720\u72B6\u6001\uFF0C\u7B49\u5F85\u4E0B\u4E00\u6B21\u88AB\u5524\u9192\u3002</p><p>\u4E5F\u5C31\u662F\u8BF4\uFF1A</p><ul><li>\u4ECE\u5E93\u4F1A\u751F\u6210\u4E24\u4E2A\u7EBF\u7A0B,\u4E00\u4E2AI/O\u7EBF\u7A0B,\u4E00\u4E2ASQL\u7EBF\u7A0B;</li><li>I/O\u7EBF\u7A0B\u4F1A\u53BB\u8BF7\u6C42\u4E3B\u5E93\u7684binlog,\u5E76\u5C06\u5F97\u5230\u7684binlog\u5199\u5230\u672C\u5730\u7684relay-log(\u4E2D\u7EE7\u65E5\u5FD7)\u6587\u4EF6\u4E2D;</li><li>\u4E3B\u5E93\u4F1A\u751F\u6210\u4E00\u4E2Alog dump\u7EBF\u7A0B,\u7528\u6765\u7ED9\u4ECE\u5E93I/O\u7EBF\u7A0B\u4F20binlog;</li><li>SQL\u7EBF\u7A0B,\u4F1A\u8BFB\u53D6relay log\u6587\u4EF6\u4E2D\u7684\u65E5\u5FD7,\u5E76\u89E3\u6790\u6210sql\u8BED\u53E5\u9010\u4E00\u6267\u884C;</li></ul><p>\u6CE8\u610F\uFF1A</p><p>1--master\u5C06\u64CD\u4F5C\u8BED\u53E5\u8BB0\u5F55\u5230binlog\u65E5\u5FD7\u4E2D\uFF0C\u7136\u540E\u6388\u4E88slave\u8FDC\u7A0B\u8FDE\u63A5\u7684\u6743\u9650\uFF08master\u4E00\u5B9A\u8981\u5F00\u542Fbinlog\u4E8C\u8FDB\u5236\u65E5\u5FD7\u529F\u80FD\uFF1B\u901A\u5E38\u4E3A\u4E86\u6570\u636E\u5B89\u5168\u8003\u8651\uFF0Cslave\u4E5F\u5F00\u542Fbinlog\u529F\u80FD\uFF09\u3002</p><p>2--slave\u5F00\u542F\u4E24\u4E2A\u7EBF\u7A0B\uFF1AIO\u7EBF\u7A0B\u548CSQL\u7EBF\u7A0B\u3002\u5176\u4E2D\uFF1AIO\u7EBF\u7A0B\u8D1F\u8D23\u8BFB\u53D6master\u7684binlog\u5185\u5BB9\u5230\u4E2D\u7EE7\u65E5\u5FD7relay log\u91CC\uFF1BSQL\u7EBF\u7A0B\u8D1F\u8D23\u4ECErelay log\u65E5\u5FD7\u91CC\u8BFB\u51FAbinlog\u5185\u5BB9\uFF0C\u5E76\u66F4\u65B0\u5230slave\u7684\u6570\u636E\u5E93\u91CC\uFF0C\u8FD9\u6837\u5C31\u80FD\u4FDD\u8BC1slave\u6570\u636E\u548Cmaster\u6570\u636E\u4FDD\u6301\u4E00\u81F4\u4E86\u3002</p><p>3--Mysql\u590D\u5236\u81F3\u5C11\u9700\u8981\u4E24\u4E2AMysql\u7684\u670D\u52A1\uFF0C\u5F53\u7136Mysql\u670D\u52A1\u53EF\u4EE5\u5206\u5E03\u5728\u4E0D\u540C\u7684\u670D\u52A1\u5668\u4E0A\uFF0C\u4E5F\u53EF\u4EE5\u5728\u4E00\u53F0\u670D\u52A1\u5668\u4E0A\u542F\u52A8\u591A\u4E2A\u670D\u52A1\u3002</p><p>4--Mysql\u590D\u5236\u6700\u597D\u786E\u4FDDmaster\u548Cslave\u670D\u52A1\u5668\u4E0A\u7684Mysql\u7248\u672C\u76F8\u540C\uFF08\u5982\u679C\u4E0D\u80FD\u6EE1\u8DB3\u7248\u672C\u4E00\u81F4\uFF0C\u90A3\u4E48\u8981\u4FDD\u8BC1master\u4E3B\u8282\u70B9\u7684\u7248\u672C\u4F4E\u4E8Eslave\u4ECE\u8282\u70B9\u7684\u7248\u672C\uFF09</p><p>5--master\u548Cslave\u4E24\u8282\u70B9\u95F4\u65F6\u95F4\u9700\u540C\u6B65</p><p>\u5177\u4F53\u6B65\u9AA4\uFF1A</p><ol><li><p>\u4ECE\u5E93\u901A\u8FC7\u624B\u5DE5\u6267\u884Cchange master to \u8BED\u53E5\u8FDE\u63A5\u4E3B\u5E93\uFF0C\u63D0\u4F9B\u4E86\u8FDE\u63A5\u7684\u7528\u6237\u4E00\u5207\u6761\u4EF6\uFF08user \u3001password\u3001port\u3001ip\uFF09\uFF0C\u5E76\u4E14\u8BA9\u4ECE\u5E93\u77E5\u9053\uFF0C\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u8D77\u70B9\u4F4D\u7F6E\uFF08file\u540D position \u53F7\uFF09\uFF1B start slave</p></li><li><p>\u4ECE\u5E93\u7684IO\u7EBF\u7A0B\u548C\u4E3B\u5E93\u7684dump\u7EBF\u7A0B\u5EFA\u7ACB\u8FDE\u63A5\u3002</p></li><li><p>\u4ECE\u5E93\u6839\u636Echange master to \u8BED\u53E5\u63D0\u4F9B\u7684file\u540D\u548Cposition\u53F7\uFF0CIO\u7EBF\u7A0B\u5411\u4E3B\u5E93\u53D1\u8D77binlog\u7684\u8BF7\u6C42\u3002</p></li><li><p>\u4E3B\u5E93dump\u7EBF\u7A0B\u6839\u636E\u4ECE\u5E93\u7684\u8BF7\u6C42\uFF0C\u5C06\u672C\u5730binlog\u4EE5events\u7684\u65B9\u5F0F\u53D1\u7ED9\u4ECE\u5E93IO\u7EBF\u7A0B\u3002</p></li><li><p>\u4ECE\u5E93IO\u7EBF\u7A0B\u63A5\u6536binlog events\uFF0C\u5E76\u5B58\u653E\u5230\u672C\u5730relay-log\u4E2D\uFF0C\u4F20\u9001\u8FC7\u6765\u7684\u4FE1\u606F\uFF0C\u4F1A\u8BB0\u5F55\u5230master.info\u4E2D</p></li><li><p>\u4ECE\u5E93SQL\u7EBF\u7A0B\u5E94\u7528relay-log\uFF0C\u5E76\u4E14\u628A\u5E94\u7528\u8FC7\u7684\u8BB0\u5F55\u5230relay-log.info\u4E2D\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5DF2\u7ECF\u5E94\u7528\u8FC7\u7684relay \u4F1A\u81EA\u52A8\u88AB\u6E05\u7406purge</p></li></ol><h2 id="\u7B80\u8FF0myisam\u548Cinnodb\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#\u7B80\u8FF0myisam\u548Cinnodb\u7684\u533A\u522B" aria-hidden="true">#</a> \u7B80\u8FF0Myisam\u548CInnodb\u7684\u533A\u522B\uFF1F</h2><p>InnoDB\uFF1A</p><ol><li>\u652F\u6301\u4E8B\u52A1\u3001\u5916\u952E\u3001\u884C\u9501\uFF0C\u662F\u805A\u65CF\u7D22\u5F15\uFF0C\u4E0D\u5B58\u50A8\u8868\u7684\u884C\u6570\uFF0C</li><li>\u8BFB\u7684\u6548\u7387\u4F4E\u4E8EMYISAM\uFF0C</li><li>\u5199\u7684\u6548\u7387\u9AD8\u4F18\u4E8EMYISAM\uFF0C</li><li>\u9002\u5408\u9891\u7E41\u4FEE\u6539\u4EE5\u53CA\u8BBE\u8BA1\u5230\u5B89\u5168\u6027\u8F83\u9AD8\u7684\u5E94\u7528</li><li>\u6E05\u7A7A\u6574\u4E2A\u8868\u7684\u65F6\u5019\uFF0CInnodb\u662F\u4E00\u884C\u4E00\u884C\u7684\u5220\u9664\uFF0C\u3002</li></ol><p>MylSAM\uFF1A</p><ol><li>\u4E0D\u652F\u6301\u4E8B\u52A1\u3001\u5916\u952E\uFF1B\u652F\u6301\u884C\u9501\uFF0C\u662F\u975E\u805A\u65CF\u7D22\u5F15\uFF0C\u5B58\u50A8\u8868\u7684\u884C\u6570\uFF0C</li><li>\u8BFB\u7684\u6548\u7387\u4F18\u4E8EInnoDB\uFF0C</li><li>\u5199\u7684\u6548\u7387\u4F4E\u4E8EInnoDB\uFF0C</li><li>\u9002\u5408\u67E5\u8BE2\u4EE5\u53CA\u63D2\u5165\u4E3A\u4E3B\u7684\u5E94\u7528</li><li>\u6E05\u7A7A\u6574\u4E2A\u8868\u7684\u65F6\u5019\uFF0CMYISAM\u5219\u4F1A\u65B0\u5EFA\u8868\u3002</li></ol><p><a href="#mysql%E8%81%9A%E7%B0%87%E5%92%8C%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88">#mysql\u805A\u7C07\u548C\u975E\u805A\u7C07\u7D22\u5F15\u7684\u533A\u522B\u662F\u4EC0\u4E48</a></p><h2 id="\u7B80\u8FF0mysql\u4E2D\u7D22\u5F15\u7C7B\u578B\u6709\u54EA\u4E9B-\u4EE5\u53CA\u5BF9\u6570\u636E\u5E93\u7684\u6027\u80FD\u7684\u5F71\u54CD" tabindex="-1"><a class="header-anchor" href="#\u7B80\u8FF0mysql\u4E2D\u7D22\u5F15\u7C7B\u578B\u6709\u54EA\u4E9B-\u4EE5\u53CA\u5BF9\u6570\u636E\u5E93\u7684\u6027\u80FD\u7684\u5F71\u54CD" aria-hidden="true">#</a> \u7B80\u8FF0mysql\u4E2D\u7D22\u5F15\u7C7B\u578B\u6709\u54EA\u4E9B\uFF0C\u4EE5\u53CA\u5BF9\u6570\u636E\u5E93\u7684\u6027\u80FD\u7684\u5F71\u54CD\uFF1F</h2><p><strong>\u666E\u901A\u7D22\u5F15</strong>\uFF1A\u5141\u8BB8\u88AB\u7D22\u5F15\u7684\u6570\u636E\u5217\u5305\u542B\u91CD\u590D\u7684\u503C</p><p><strong>\u552F\u4E00\u7D22\u5F15</strong>\uFF1A\u53EF\u4EE5\u4FDD\u8BC1\u6570\u636E\u8BB0\u5F55\u7684\u552F\u4E00\u6027</p><p><strong>\u4E3B\u952E\u7D22\u5F15</strong>\uFF1A\u662F\u4E00\u79CD\u7279\u6B8A\u7684\u552F\u4E00\u7D22\u5F15\uFF0C\u5728\u4E00\u5F20\u8868\u4E2D\u53EA\u80FD\u5B9A\u4E49\u4E00\u4E2A\u4E3B\u952E\u7D22\u5F15\uFF0C\u4E3B\u952E\u7528\u4E8E\u552F\u4E00\u6807\u8BC6\u4E00\u6761\u8BB0\u5F55\uFF0C\u4F7F\u7528\u5173\u952E\u5B57primary key\u6765\u521B\u5EFA</p><p><strong>\u8054\u5408\u7D22\u5F15</strong>\uFF1A\u7D22\u5F15\u53EF\u4EE5\u8986\u76D6\u591A\u4E2A\u6570\u636E\u5217</p><p><strong>\u5168\u6587\u7D22\u5F15</strong>\uFF1A\u901A\u8FC7\u5EFA\u7ACB\u5012\u6392\u7D22\u5F15\uFF0C\u53EF\u4EE5\u6781\u5927\u7684\u63D0\u5347\u68C0\u7D22\u6548\u7387\uFF0C\u89E3\u51B3\u5224\u65AD\u5B57\u6BB5\u662F\u5426\u5305\u542B\u7684\u95EE\u9898\uFF0C\u662F\u76EE\u524D\u641C\u7D22\u5F15\u64CE\u4F7F\u7528\u7684\u4E00\u79CD\u5173\u952E\u6280\u672F</p><p>\u7D22\u5F15\u53EF\u4EE5\u6781\u5927\u5730\u63D0\u9AD8\u6570\u636E\u7684\u67E5\u8BE2\u901F\u5EA6</p><p>\u901A\u8FC7\u4F7F\u7528\u7D22\u5F15\uFF0C\u53EF\u4EE5\u5728\u67E5\u8BE2\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u4F7F\u7528\u4F18\u5316\u9690\u85CF\u5668\uFF0C\u63D0\u9AD8\u7CFB\u7EDF\u7684\u6027\u80FD</p><p>\u4F46\u662F\u4F1A\u964D\u4F4E\u63D2\u5165\u3001\u5220\u9664\u3001\u66F4\u65B0\u8868\u7684\u901F\u5EA6\uFF0C\u56E0\u4E3A\u5728\u6267\u884C\u8FD9\u4E9B\u5199\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u8FD8\u8981\u64CD\u4F5C\u7D22\u5F15\u6587\u4EF6</p><p>\u7D22\u5F15\u9700\u8981\u5360\u7269\u7406\u7A7A\u95F4\uFF0C\u9664\u4E86\u6570\u636E\u8868\u5360\u6570\u636E\u7A7A\u95F4\u4E4B\u5916\uFF0C\u6BCF\u4E00\u4E2A\u7D22\u5F15\u8FD8\u8981\u5360\u4E00\u5B9A\u7684\u7269\u7406\u7A7A\u95F4\uFF0C\u5982\u679C\u8981\u7B80\u5386\u805A\u7C07\u7D22\u5F15\uFF0C\u90A3\u4E48\u9700\u8981\u7684\u7A7A\u95F4\u5C31\u4F1A\u66F4\u5927\uFF0C\u5982\u679C\u975E\u805A\u7C07\u7D22\u5F15\u5F88\u591A\uFF0C\u4E00\u65E6\u805A\u7C07\u7D22\u5F15\u6539\u53D8\uFF0C\u90A3\u4E48\u6240\u6709\u975E\u805A\u7C07\u7D22\u5F15\u90FD\u4F1A\u8DDF\u7740\u53D8</p><h2 id="\u4EC0\u4E48\u662F\u5B57\u8282\u7801" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F\u5B57\u8282\u7801" aria-hidden="true">#</a> \u4EC0\u4E48\u662F\u5B57\u8282\u7801\uFF1F</h2><p>\u56E0\u4E3AJVM\u9488\u5BF9\u5404\u79CD\u64CD\u4F5C\u7CFB\u7EDF\u548C\u5E73\u53F0\u90FD\u8FDB\u884C\u4E86\u5B9A\u5236\uFF0C\u65E0\u8BBA\u5728\u4EC0\u4E48\u5E73\u53F0\uFF0C\u90FD\u53EF\u4EE5\u901A\u8FC7javac\u547D\u4EE4\u5C06\u4E00\u4E2A.java\u6587\u4EF6\u7F16\u8BD1\u6210\u56FA\u5B9A\u683C\u5F0F\u7684\u5B57\u8282\u7801\uFF08.class\u6587\u4EF6\uFF09\u4F9BJVM\u4F7F\u7528\u3002\u4E4B\u6240\u4EE5\u88AB\u79F0\u4E3A\u5B57\u8282\u7801\uFF0C\u662F\u56E0\u4E3A** .class\u6587\u4EF6\u662F\u7531\u5341\u516D\u8FDB\u5236\u503C\u7EC4\u6210\u7684\uFF0CJVM\u4EE5\u4E24\u4E2A\u5341\u516D\u8FDB\u5236\u503C\u4E3A\u4E00\u7EC4\uFF0C\u5C31\u662F\u4EE5\u5B57\u8282\u4E3A\u5355\u4F4D\u8FDB\u884C\u8BFB\u53D6** \u683C\u5F0F\u5982\u4E0B</p><h2 id="\u5B57\u8282\u7801\u7684\u7EC4\u6210\u7ED3\u6784\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u5B57\u8282\u7801\u7684\u7EC4\u6210\u7ED3\u6784\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u5B57\u8282\u7801\u7684\u7EC4\u6210\u7ED3\u6784\u662F\u4EC0\u4E48\uFF1F</h2><p>JVM\u5BF9\u5B57\u8282\u7801\u7684\u89C4\u8303\u662F\u6709\u8981\u6C42\u7684\uFF0C\u8981\u6C42\u6BCF\u4E00\u4E2A\u5B57\u8282\u7801\u6587\u4EF6\u90FD\u8981\u6709\u5341\u90E8\u5206\u56FA\u5B9A\u7684\u987A\u5E8F\u7EC4\u6210\uFF0C\u5982\u4E0B\u56FE\uFF1A</p><ol><li>\u9B54\u6570</li></ol><p>\u6240\u6709\u7684.class\u6587\u4EF6\u7684\u524D4\u4E2A\u5B57\u8282\u90FD\u662F\u9B54\u6570\uFF0C\u9B54\u6570\u4EE5\u4E00\u4E2A\u56FA\u5B9A\u503C\uFF1A0xCAFEBABE\uFF0C\u653E\u5728\u6587\u4EF6\u7684\u5F00\u5934\uFF0CJVM\u5C31\u53EF\u4EE5\u6839\u636E\u8FD9\u4E2A\u6587\u4EF6\u7684\u5F00\u5934\u6765\u5224\u65AD\u8FD9\u4E2A\u6587\u4EF6\u662F\u5426\u53EF\u80FD\u662F\u4E00\u4E2A.class\u6587\u4EF6\uFF0C\u5982\u679C\u662F\u4EE5\u8FD9\u4E2A\u5F00\u5934\uFF0C\u624D\u4F1A\u5F80\u540E\u6267\u884C\u4E0B\u9762\u7684\u64CD\u4F5C\uFF0C\u8FD9\u4E2A\u9B54\u6570\u7684\u56FA\u5B9A\u503C\u662FJava\u4E4B\u7236James Gosling\u6307\u5B9A\u7684\uFF0C\u610F\u4E3ACafeBabe\uFF08\u5496\u5561\u5B9D\u8D1D\uFF09</p><ol start="2"><li>\u7248\u672C\u53F7</li></ol><p>\u7248\u672C\u53F7\u662F\u9B54\u672F\u4E4B\u540E\u76844\u4E2A\u5B57\u8282\uFF0C\u524D\u4E24\u4E2A\u5B57\u8282\u8868\u793A\u6B21\u7248\u672C\u53F7\uFF08Minor Version\uFF09\uFF0C\u540E\u4E24\u4E2A\u5B57\u8282\u8868\u793A\u4E3B\u7248\u672C\u53F7\uFF08Major Version\uFF09\uFF0C\u4E0A\u9762\u76840000 0032\uFF0C\u6B21\u7248\u672C\u53F70000\u8F6C\u4E3A\u5341\u8FDB\u5236\u662F0\uFF0C\u4E3B\u7248\u672C\u53F70032 \u8F6C\u4E3A\u5341\u8FDB\u523650\uFF0C\u5BF9\u5E94\u4E0B\u56FE\u7684\u7248\u672C\u6620\u5C04\u5173\u7CFB\uFF0C\u53EF\u4EE5\u770B\u5230\u5BF9\u5E94\u7684java\u7248\u672C\u53F7\u662F1.6</p><ol start="3"><li>\u5E38\u91CF\u6C60</li></ol><p>\u7D27\u63A5\u7740\u4E3B\u7248\u672C\u53F7\u4E4B\u540E\u7684\u5B57\u8282\u4E3A\u5E38\u91CF\u6C60\u5165\u53E3\uFF0C\u5E38\u91CF\u6C60\u4E2D\u6709\u4E24\u7C7B\u5E38\u91CF\uFF1A\u5B57\u9762\u91CF\u548C\u7B26\u53F7\u5F15\u7528\uFF0C\u5B57\u9762\u91CF\u662F\u4EE3\u7801\u4E2D\u7533\u660E\u4E3AFinal\u7684\u5E38\u91CF\u503C\uFF0C\u7B26\u53F7\u5F15\u7528\u662F\u5982\u7C7B\u548C\u63A5\u53E3\u7684\u5168\u5C40\u9650\u5B9A\u540D\u3001\u5B57\u6BB5\u7684\u540D\u79F0\u548C\u63CF\u8FF0\u7B26\u3001\u65B9\u6CD5\u7684\u540D\u79F0\u548C\u63CF\u8FF0\u7B26\u3002\u5E38\u91CF\u6C60\u6574\u4F53\u5206\u4E3A\u4E24\u4E2A\u90E8\u5206\uFF1A\u5E38\u91CF\u6C60\u8BA1\u6570\u5668\u4EE5\u53CA\u5E38\u91CF\u6C60\u6570\u636E\u533A</p><ol start="4"><li>\u8BBF\u95EE\u6807\u5FD7</li></ol><p>\u5E38\u91CF\u6C60\u7ED3\u675F\u540E\u7684\u4E24\u4E2A\u5B57\u8282\uFF0C\u63CF\u8FF0\u7684\u662F\u7C7B\u8FD8\u662F\u63A5\u53E3\uFF0C\u4EE5\u53CA\u662F\u5426\u88ABPublic\u3001Abstract\u3001Final\u7B49\u4FEE\u9970\u7B26\u4FEE\u9970\uFF0CJVM\u89C4\u8303\u89C4\u5B9A\u4E869\u79CD\u8BBF\u95EE\u6807\u793A\uFF08Access_Flag\uFF09JVM\u662F\u901A\u8FC7\u6309\u4F4D\u6216\u64CD\u4F5C\u6765\u63CF\u8FF0\u6240\u6709\u7684\u8BBF\u95EE\u6807\u793A\u7684\uFF0C\u6BD4\u5982\u7C7B\u7684\u4FEE\u9970\u7B26\u662FPublic Final\uFF0C\u5219\u5BF9\u5E94\u7684\u8BBF\u95EE\u4FEE\u9970\u7B26\u7684\u503C\u4E3AACC_PUBLIC | ACC_FINAL\uFF0C\u53730x0001 | 0x0010=0x0011</p><ol start="5"><li>\u5F53\u524D\u7C7B\u7D22\u5F15</li></ol><p>\u8BBF\u95EE\u6807\u5FD7\u540E\u7684\u4E24\u4E2A\u5B57\u8282\uFF0C\u63CF\u8FF0\u7684\u662F\u5F53\u524D\u7C7B\u7684\u5168\u9650\u5B9A\u540D\uFF0C\u8FD9\u4E24\u4E2A\u5B57\u8282\u4FDD\u5B58\u7684\u503C\u662F\u5E38\u91CF\u6C60\u4E2D\u7684\u7D22\u5F15\u503C\uFF0C\u6839\u636E\u7D22\u5F15\u503C\u5C31\u80FD\u5728\u5E38\u91CF\u6C60\u4E2D\u627E\u5230\u8FD9\u4E2A\u7C7B\u7684\u5168\u9650\u5B9A\u540D</p><ol start="6"><li>\u7236\u7C7B\u7D22\u5F15</li></ol><p>\u5F53\u524D\u7C7B\u540D\u540E\u7684\u4E24\u4E2A\u5B57\u8282\uFF0C\u63CF\u8FF0\u7684\u7236\u7C7B\u7684\u5168\u9650\u5B9A\u540D\uFF0C\u4E5F\u662F\u4FDD\u5B58\u7684\u5E38\u91CF\u6C60\u4E2D\u7684\u7D22\u5F15\u503C</p><ol start="7"><li>\u63A5\u53E3\u7D22\u5F15</li></ol><p>\u7236\u7C7B\u540D\u79F0\u540E\u7684\u4E24\u4E2A\u5B57\u8282\uFF0C\u662F\u63A5\u53E3\u8BA1\u6570\u5668\uFF0C\u63CF\u8FF0\u4E86\u8BE5\u7C7B\u6216\u8005\u7236\u7C7B\u5B9E\u73B0\u7684\u63A5\u53E3\u6570\u91CF\uFF0C\u7D27\u63A5\u7740\u7684n\u4E2A\u5B57\u8282\u662F\u6240\u6709\u63A5\u53E3\u540D\u79F0\u7684\u5B57\u7B26\u4E32\u5E38\u91CF\u7684\u7D22\u5F15\u503C</p><ol start="8"><li>\u5B57\u6BB5\u8868</li></ol><p>\u7528\u4E8E\u63CF\u8FF0\u7C7B\u548C\u63A5\u53E3\u4E2D\u58F0\u660E\u7684\u53D8\u91CF\uFF0C\u5305\u542B\u7C7B\u7EA7\u522B\u7684\u53D8\u91CF\u548C\u5B9E\u4F8B\u53D8\u91CF\uFF0C\u4F46\u662F\u4E0D\u5305\u542B\u65B9\u6CD5\u5185\u90E8\u58F0\u660E\u7684\u5C40\u90E8\u53D8\u91CF\uFF0C\u5B57\u6BB5\u8868\u4E5F\u5206\u4E3A\u4E24\u4E2A\u90E8\u5206\uFF0C\u7B2C\u4E00\u90E8\u5206\u662F\u4E24\u4E2A\u5B57\u8282\uFF0C\u63CF\u8FF0\u5B57\u6BB5\u4E2A\u6570\uFF0C\u7B2C\u4E8C\u90E8\u5206\u662F\u6BCF\u4E2A\u5B57\u6BB5\u7684\u8BE6\u7EC6\u4FE1\u606Ffields_info</p><ol start="9"><li>\u65B9\u6CD5\u8868</li></ol><p>\u5B57\u6BB5\u8868\u7ED3\u675F\u540E\u4E3A\u65B9\u6CD5\u8868\uFF0C\u65B9\u6CD5\u8868\u4E5F\u5206\u4E3A\u4E24\u4E2A\u90E8\u5206\uFF0C\u7B2C\u4E00\u4E2A\u90E8\u5206\u662F\u4E24\u4E2A\u5B57\u8282\u8868\u8FF0\u65B9\u6CD5\u7684\u4E2A\u6570\uFF0C\u7B2C\u4E8C\u90E8\u5206\u662F\u6BCF\u4E2A\u65B9\u6CD5\u7684\u8BE6\u7EC6\u4FE1\u606F \u65B9\u6CD5\u7684\u8BBF\u95EE\u4FE1\u606F\u6BD4\u8F83\u590D\u6742\uFF0C\u5305\u62EC\u65B9\u6CD5\u7684\u8BBF\u95EE\u6807\u5FD7\u3001\u65B9\u6CD5\u540D\u3001\u65B9\u6CD5\u7684\u63CF\u8FF0\u7B26\u548C\u65B9\u6CD5\u7684\u5C5E\u6027\uFF1A</p><ol start="10"><li>\u9644\u52A0\u5C5E\u6027</li></ol><p>\u5B57\u8282\u7801\u7684\u6700\u540E\u4E00\u90E8\u5206\uFF0C\u8BE5\u9879\u5B58\u653E\u4E86\u5728\u8BE5\u6587\u4EF6\u4E2D\u7C7B\u6216\u63A5\u53E3\u6240\u5B9A\u4E49\u5C5E\u6027\u7684\u57FA\u672C\u4FE1\u606F\u3002</p><h2 id="class\u521D\u59CB\u5316\u8FC7\u7A0B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#class\u521D\u59CB\u5316\u8FC7\u7A0B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> class\u521D\u59CB\u5316\u8FC7\u7A0B\u662F\u4EC0\u4E48\uFF1F</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u9996\u5148\u7C7B\u52A0\u8F7D\u7684\u673A\u5236\u8FC7\u7A0B\u5206\u4E3A5\u4E2A\u90E8\u5206\uFF1A\u52A0\u8F7D\u3001\u9A8C\u8BC1\u3001\u51C6\u5907\u3001\u89E3\u6790\u3001\u521D\u59CB\u5316

\u6211\u4EEC\u73B0\u5728\u4E3B\u8981\u5206\u6790\u7C7B\u7684\u521D\u59CB\u5316\u8FC7\u7A0B\uFF1A

1) \u7C7B\u7684\u521D\u59CB\u5316\u9636\u6BB5\uFF0C\u662F\u771F\u6B63\u5F00\u59CB\u6267\u884C\u7C7B\u4E2D\u5B9A\u4E49\u7684java\u7A0B\u5E8F\u4EE3\u7801(\u5B57\u8282\u7801)\u5E76\u6309\u7A0B\u5E8F\u5458\u7684\u610F\u56FE\u53BB\u521D\u59CB\u5316\u7C7B\u53D8\u91CF\u7684\u8FC7\u7A0B\u3002\u66F4\u76F4\u63A5\u5730\u8BF4\uFF0C\u521D\u59CB\u5316\u9636\u6BB5\u5C31\u662F\u6267\u884C\u7C7B\u6784\u9020\u5668&lt;clinit&gt;()\u65B9\u6CD5\u7684\u8FC7\u7A0B\u3002&lt;clinit&gt;()\u65B9\u6CD5\u662F\u7531\u7F16\u8BD1\u5668\u81EA\u52A8\u6536\u96C6\u7C7B\u4E2D\u7684\u6240\u6709\u7C7B\u53D8\u91CF\u7684\u8D4B\u503C\u52A8\u4F5C\u548C\u9759\u6001\u4EE3\u7801\u5757static{}\u4E2D\u7684\u8BED\u53E5\u5408\u5E76\u4EA7\u751F\u7684\uFF0C\u5176\u4E2D\u7F16\u8BD1\u5668\u6536\u96C6\u7684\u987A\u5E8F\u662F\u7531\u8BED\u53E5\u5728\u6E90\u6587\u4EF6\u4E2D\u51FA\u73B0\u7684\u987A\u5E8F\u6240\u51B3\u5B9A\u3002
2) \u5173\u4E8E\u7C7B\u521D\u59CB\u5316\u7684\u987A\u5E8F **\uFF08\u9759\u6001\u53D8\u91CF\u3001\u9759\u6001\u521D\u59CB\u5316\u5757\uFF1A\u51B3\u4E8E\u5B83\u4EEC\u5728\u7C7B\u4E2D\u51FA\u73B0\u7684\u5148\u540E\u987A\u5E8F\uFF09&gt;\uFF08\u53D8\u91CF\u3001\u521D\u59CB\u5316\u5757\uFF1A\u51B3\u4E8E\u5B83\u4EEC\u5728\u7C7B\u4E2D\u51FA\u73B0\u7684\u5148\u540E\u987A\u5E8F\uFF09&gt;\u6784\u9020\u5668** 
3) \u5173\u4E8E\u7C7B\u521D\u59CB\u5316\u7684\u8BE6\u7EC6\u8FC7\u7A0B\uFF0C\u53C2\u89C1 Java\u865A\u62DF\u673A\u89C4\u8303\u4E00\u4E66\u4E2D\uFF0C\u5176\u4E2D\u7C7B\u521D\u59CB\u5316\u8FC7\u7A0B\u5982\u4E0B\uFF1A
   1) \u6BCF\u4E2A\u7C7B\u90FD\u6709\u4E00\u4E2A\u521D\u59CB\u5316\u9501LC\uFF0C\u8FDB\u7A0B\u83B7\u53D6LC\uFF0C\u8FD9\u4E2A\u64CD\u4F5C\u4F1A\u5BFC\u81F4\u5F53\u524D\u7EBF\u7A0B\u4E00\u76F4\u7B49\u5F85\uFF0C\u76F4\u5230\u83B7\u53D6\u5230LC\u9501
   2) \u5982\u679CC\u6B63\u5728\u88AB\u5176\u4ED6\u7EBF\u7A0B\u521D\u59CB\u5316\uFF0C\u5F53\u524D\u7EBF\u7A0B\u4F1A\u91CA\u653ELC\u8FDB\u53BB\u963B\u585E\u72B6\u6001\uFF0C\u5E76\u7B49\u5F85C\u521D\u59CB\u5316\u5B8C\u6210\u3002\u6B64\u65F6\u5F53\u524D\u7EBF\u7A0B\u9700\u8981\u91CD\u8BD5\u8FD9\u4E00\u8FC7\u7A0B\u3002\u6267\u884C\u521D\u59CB\u5316\u8FC7\u7A0B\u65F6\uFF0C\u7EBF\u7A0B\u7684\u4E2D\u65AD\u72B6\u6001\u4E0D\u53D7\u5F71\u54CD
   3) \u5982\u679CC\u6B63\u5728\u88AB\u672C\u7EBF\u7A0B\u521D\u59CB\u5316\uFF0C\u5373\u9012\u5F52\u521D\u59CB\u5316\uFF0C\u91CA\u653ELC\u5E76\u4E14\u6B63\u5E38\u8FD4\u56DE
   4) \u5982\u679CC\u5DF2\u7ECF\u88AB\u521D\u59CB\u5316\u5B8C\u6210\uFF0C\u91CA\u653ELC\u5E76\u4E14\u6B63\u5E38\u8FD4\u56DE
   5) \u5982\u679CC\u5904\u4E8E\u9519\u8BEF\u72B6\u6001\uFF0C\u8868\u660E\u4E0D\u53EF\u80FD\u518D\u5B8C\u6210\u521D\u59CB\u5316\uFF0C\u91CA\u653ELC\u5E76\u629B\u51FA\u5F02\u5E38NoClassDefFoundError\u5F02\u5E38
   6) \u5426\u5219\uFF0C\u5C06C\u6807\u8BB0\u4E3A\u6B63\u5728\u88AB\u672C\u7EBF\u7A0B\u521D\u59CB\u5316\uFF0C\u91CA\u653ELC\uFF1B\u7136\u540E\uFF0C\u521D\u59CB\u5316\u90A3\u4E9Bfinal\u4E14\u4E3A\u57FA\u7840\u7C7B\u578B\u7684\u7C7B\u6210\u5458\u53D8\u91CF
   7) \u5982\u679CC\u662F\u7C7B\u800C\u4E0D\u662F\u63A5\u53E3\uFF0C\u4E14C\u7684\u7236\u7C7BSuper Class\uFF08SC\uFF09\u548C\u5404\u4E2A\u63A5\u53E3SI_n\uFF08\u6309\u7167implements\u5B50\u53E5\u4E2D\u7684\u987A\u5E8F\u6765\uFF09\u8FD8\u6CA1\u6709\u521D\u59CB\u5316\uFF0C\u90A3\u4E48\u5C31\u5728SC\u4E0A\u9762\u9012\u5F52\u5730\u8FDB\u884C\u5B8C\u6574\u7684\u521D\u59CB\u5316\u8FC7\u7A0B\uFF0C\u5982\u679C\u6709\u5FC5\u8981\uFF0C\u9700\u8981\u5148\u9A8C\u8BC1\u548C\u51C6\u5907SC \uFF1B\u5982\u679CSC\u6216SIn\u521D\u59CB\u5316\u8FC7\u7A0B\u4E2D\u629B\u51FA\u5F02\u5E38\uFF0C\u5219\u83B7\u53D6LC\uFF0C\u5C06C\u6807\u8BB0\u4E3A\u9519\u8BEF\u72B6\u6001\uFF0C\u5E76\u901A\u77E5\u6240\u6709\u6B63\u5728\u7B49\u5F85\u7684\u7EBF\u7A0B\uFF0C\u7136\u540E\u91CA\u653ELC\uFF0C\u7136\u540E\u518D\u629B\u51FA\u540C\u6837\u7684\u5F02\u5E38\u3002
   8) \u4ECEC\u7684classloader\u5904\u83B7\u53D6assertion\u65AD\u8A00\u673A\u5236\u662F\u5426\u88AB\u6253\u5F00
   9) \u63A5\u4E0B\u6765\uFF0C\u6309\u7167\u6587\u672C\u987A\u5E8F\u6267\u884C\u7C7B\u53D8\u91CF\u521D\u59CB\u5316\u548C\u9759\u6001\u4EE3\u7801\u5757\uFF0C\u6216\u63A5\u53E3\u7684\u5B57\u6BB5\u521D\u59CB\u5316\uFF0C\u628A\u5B83\u4EEC\u5F53\u4F5C\u662F\u4E00\u4E2A\u4E2A\u5355\u72EC\u7684\u4EE3\u7801\u5757\u3002
   10) \u5982\u679C\u6267\u884C\u6B63\u5E38\uFF0C\u90A3\u5C31\u83B7\u53D6LC\uFF0C\u6807\u8BB0C\u5BF9\u8C61\u4E3A\u5DF2\u521D\u59CB\u5316\uFF0C\u5E76\u901A\u77E5\u6240\u6709\u6B63\u5728\u7B49\u5F85\u7684\u7EBF\u7A0B\uFF0C\u7136\u540E\u91CA\u653ELC\uFF0C\u6B63\u5E38\u9000\u51FA\u6574\u4E2A\u8FC7\u7A0B
   11) \u5426\u5219\uFF0C\u5982\u679C\u629B\u51FA\u4E86\u5F02\u5E38E\u90A3\u4E48\u4F1A\u4E2D\u65AD\u9000\u51FA\u3002\u82E5E\u4E0D\u662FError\uFF0C\u5219\u4EE5E\u4E3A\u53C2\u6570\u521B\u5EFA\u65B0\u7684\u5F02\u5E38ExceptionInInitializerError\u4F5C\u4E3AE\u3002\u5982\u679C\u56E0\u4E3AOutOfMemoryError\u5BFC\u81F4\u65E0\u6CD5\u521B\u5EFAExceptionInInitializerError\uFF0C\u5219\u5C06OutOfMemoryError\u4F5C\u4E3AE\u3002
   12) \u83B7\u53D6LC\uFF0C\u5C06C\u6807\u8BB0\u4E3A\u9519\u8BEF\u72B6\u6001\uFF0C\u901A\u77E5\u6240\u6709\u7B49\u5F85\u7684\u7EBF\u7A0B\uFF0C\u91CA\u653ELC\uFF0C\u5E76\u629B\u51FA\u5F02\u5E38E\u3002

\u53EF\u4EE5\u770B\u5230 JLS\u786E\u5B9E\u89C4\u5B9A\u4E86\u7236\u7C7B\u5148\u521D\u59CB\u5316\u3001static\u5757\u548C\u7C7B\u53D8\u91CF\u8D4B\u503C\u6309\u7167\u6587\u672C\u987A\u5E8F\u6765
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="jvm\u5185\u5B58\u6A21\u578B\u5982\u4F55\u5206\u914D\u7684" tabindex="-1"><a class="header-anchor" href="#jvm\u5185\u5B58\u6A21\u578B\u5982\u4F55\u5206\u914D\u7684" aria-hidden="true">#</a> JVM\u5185\u5B58\u6A21\u578B\u5982\u4F55\u5206\u914D\u7684\uFF1F</h2><h2 id="jvm\u6027\u80FD\u8C03\u4F18\u7684\u539F\u5219\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#jvm\u6027\u80FD\u8C03\u4F18\u7684\u539F\u5219\u6709\u54EA\u4E9B" aria-hidden="true">#</a> JVM\u6027\u80FD\u8C03\u4F18\u7684\u539F\u5219\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>\u591A\u6570\u7684Java\u5E94\u7528\u4E0D\u9700\u8981\u5728\u670D\u52A1\u5668\u4E0A\u8FDB\u884CGC\u4F18\u5316\uFF0C\u865A\u62DF\u673A\u5185\u90E8\u5DF2\u6709\u5F88\u591A\u4F18\u5316\u6765\u4FDD\u8BC1\u5E94\u7528\u7684\u7A33\u5B9A\u8FD0\u884C\uFF0C\u6240\u4EE5\u4E0D\u8981\u4E3A\u4E86\u8C03\u4F18\u800C\u8C03\u4F18\uFF0C\u4E0D\u5F53\u7684\u8C03\u4F18\u53EF\u80FD\u9002\u5F97\u5176\u53CD</li><li>\u5728\u5E94\u7528\u4E0A\u7EBF\u4E4B\u524D\uFF0C\u5148\u8003\u8651\u5C06\u673A\u5668\u7684JVM\u53C2\u6570\u8BBE\u7F6E\u5230\u6700\u4F18\uFF08\u9002\u5408\uFF09</li><li>\u5728\u8FDB\u884CGC\u4F18\u5316\u4E4B\u524D\uFF0C\u9700\u8981\u786E\u8BA4\u9879\u76EE\u7684\u67B6\u6784\u548C\u4EE3\u7801\u7B49\u5DF2\u7ECF\u6CA1\u6709\u4F18\u5316\u7A7A\u95F4\u3002\u6211\u4EEC\u4E0D\u80FD\u6307\u671B\u4E00\u4E2A\u7CFB\u7EDF\u67B6\u6784\u6709\u7F3A\u9677\u6216\u8005\u4EE3\u7801\u5C42\u6B21\u4F18\u5316\u6CA1\u6709\u7A77\u5C3D\u7684\u5E94\u7528\uFF0C\u901A\u8FC7GC\u4F18\u5316\u4EE4\u5176\u6027\u80FD\u8FBE\u5230\u4E00\u4E2A\u8D28\u7684\u98DE\u8DC3</li><li>GC\u4F18\u5316\u662F\u4E00\u4E2A\u7CFB\u7EDF\u800C\u590D\u6742\u7684\u5DE5\u4F5C\uFF0C\u6CA1\u6709\u4E07\u80FD\u7684\u8C03\u4F18\u7B56\u7565\u53EF\u4EE5\u6EE1\u8DB3\u6240\u6709\u7684\u6027\u80FD\u6307\u6807\u3002GC\u4F18\u5316\u5FC5\u987B\u5EFA\u7ACB\u5728\u6211\u4EEC\u6DF1\u5165\u7406\u89E3\u5404\u79CD\u5783\u573E\u56DE\u6536\u5668\u7684\u57FA\u7840\u4E0A\uFF0C\u624D\u80FD\u6709\u4E8B\u534A\u529F\u500D\u7684\u6548\u679C</li><li>\u5904\u7406\u541E\u5410\u91CF\u548C\u5EF6\u8FDF\u95EE\u9898\u65F6\uFF0C\u5783\u573E\u5904\u7406\u5668\u80FD\u4F7F\u7528\u7684\u5185\u5B58\u8D8A\u5927\uFF0C\u5373java\u5806\u7A7A\u95F4\u8D8A\u5927\u5783\u573E\u6536\u96C6\u6548\u679C\u8D8A\u597D\uFF0C\u5E94\u7528\u8FD0\u884C\u4E5F\u8D8A\u6D41\u7545\u3002\u8FD9\u79F0\u4E4B\u4E3AGC\u5185\u5B58\u6700\u5927\u5316\u539F\u5219</li><li>\u5728\u8FD9\u4E09\u4E2A\u5C5E\u6027\uFF08\u541E\u5410\u91CF\u3001\u5EF6\u8FDF\u3001\u5185\u5B58\uFF09\u4E2D\u9009\u62E9\u5176\u4E2D\u4E24\u4E2A\u8FDB\u884Cjvm\u8C03\u4F18\uFF0C\u79F0\u4E4B\u4E3AGC\u8C03\u4F183\u90092</li></ol><h2 id="\u4EC0\u4E48\u60C5\u51B5\u4E0B\u9700\u8981jvm\u8C03\u4F18" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u60C5\u51B5\u4E0B\u9700\u8981jvm\u8C03\u4F18" aria-hidden="true">#</a> \u4EC0\u4E48\u60C5\u51B5\u4E0B\u9700\u8981JVM\u8C03\u4F18\uFF1F</h2><ul><li>Heap\u5185\u5B58\uFF08\u8001\u5E74\u4EE3\uFF09\u6301\u7EED\u4E0A\u6DA8\u8FBE\u5230\u8BBE\u7F6E\u7684\u6700\u5927\u5185\u5B58\u503C</li><li>Full GC \u6B21\u6570\u9891\u7E41</li><li>GC \u505C\u987F\uFF08Stop World\uFF09\u65F6\u95F4\u8FC7\u957F\uFF08\u8D85\u8FC71\u79D2\uFF0C\u5177\u4F53\u503C\u6309\u5E94\u7528\u573A\u666F\u800C\u5B9A\uFF09</li><li>\u5E94\u7528\u51FA\u73B0OutOfMemory \u7B49\u5185\u5B58\u5F02\u5E38</li><li>\u5E94\u7528\u51FA\u73B0OutOfDirectMemoryError\u7B49\u5185\u5B58\u5F02\u5E38\uFF08 failed to allocate 16777216 byte(s) of direct memory (used: 1056964615, max: 1073741824)\uFF09</li><li>\u5E94\u7528\u4E2D\u6709\u4F7F\u7528\u672C\u5730\u7F13\u5B58\u4E14\u5360\u7528\u5927\u91CF\u5185\u5B58\u7A7A\u95F4</li><li>\u7CFB\u7EDF\u541E\u5410\u91CF\u4E0E\u54CD\u5E94\u6027\u80FD\u4E0D\u9AD8\u6216\u4E0B\u964D</li><li>\u5E94\u7528\u7684CPU\u5360\u7528\u8FC7\u9AD8\u4E0D\u4E0B\u6216\u5185\u5B58\u5360\u7528\u8FC7\u9AD8\u4E0D\u4E0B</li></ul><h2 id="\u5728jvm\u8C03\u4F18\u65F6-\u4F60\u5173\u6CE8\u54EA\u4E9B\u6307\u6807" tabindex="-1"><a class="header-anchor" href="#\u5728jvm\u8C03\u4F18\u65F6-\u4F60\u5173\u6CE8\u54EA\u4E9B\u6307\u6807" aria-hidden="true">#</a> \u5728JVM\u8C03\u4F18\u65F6\uFF0C\u4F60\u5173\u6CE8\u54EA\u4E9B\u6307\u6807\uFF1F</h2><ol><li><strong>\u541E\u5410\u91CF\uFF1A</strong> \u7528\u6237\u4EE3\u7801\u65F6\u95F4 / \uFF08\u7528\u6237\u4EE3\u7801\u6267\u884C\u65F6\u95F4 + \u5783\u573E\u56DE\u6536\u65F6\u95F4\uFF09\u3002\u662F\u8BC4\u4EF7\u5783\u573E\u6536\u96C6\u5668\u80FD\u529B\u7684\u91CD\u8981\u6307\u6807\u4E4B\u4E00\uFF0C\u662F\u4E0D\u8003\u8651\u5783\u573E\u6536\u96C6\u5F15\u8D77\u7684\u505C\u987F\u65F6\u95F4\u6216\u5185\u5B58\u6D88\u8017\uFF0C\u5783\u573E\u6536\u96C6\u5668\u80FD\u652F\u6491\u5E94\u7528\u7A0B\u5E8F\u8FBE\u5230\u7684\u6700\u9AD8\u6027\u80FD\u6307\u6807\u3002\u541E\u5410\u91CF\u8D8A\u9AD8\u7B97\u6CD5\u8D8A\u597D\u3002</li><li><strong>\u4F4E\u5EF6\u8FDF\uFF1A</strong> STW\u8D8A\u77ED\uFF0C\u54CD\u5E94\u65F6\u95F4\u8D8A\u597D\u3002\u8BC4\u4EF7\u5783\u573E\u6536\u96C6\u5668\u80FD\u529B\u7684\u91CD\u8981\u6307\u6807\uFF0C\u5EA6\u91CF\u6807\u51C6\u662F\u7F29\u77ED\u7531\u4E8E\u5783\u573E\u6536\u96C6\u5F15\u8D77\u7684\u505C\u987F\u65F6\u95F4\u6216\u5B8C\u5168\u6D88\u9664\u56E0\u5783\u573E\u6536\u96C6\u6240\u5F15\u8D77\u7684\u505C\u987F\uFF0C\u907F\u514D\u5E94\u7528\u7A0B\u5E8F\u8FD0\u884C\u65F6\u53D1\u751F\u6296\u52A8\u3002\u6682\u505C\u65F6\u95F4\u8D8A\u77ED\u7B97\u6CD5\u8D8A\u597D</li><li>\u5728\u8BBE\u8BA1\uFF08\u6216\u4F7F\u7528\uFF09GC \u7B97\u6CD5\u65F6\uFF0C\u6211\u4EEC\u5FC5\u987B\u786E\u5B9A\u6211\u4EEC\u7684\u76EE\u6807\uFF1A\u4E00\u4E2A GC \u7B97\u6CD5\u53EA\u53EF\u80FD\u9488\u5BF9\u4E24\u4E2A\u76EE\u6807\u4E4B\u4E00\uFF08\u5373\u53EA\u4E13\u6CE8\u4E8E\u6700\u5927\u541E\u5410\u91CF\u6216\u6700\u5C0F\u6682\u505C\u65F6\u95F4\uFF09\uFF0C\u6216\u5C1D\u8BD5\u627E\u5230\u4E00\u4E2A\u4E8C\u8005\u7684\u6298\u8877</li><li>MinorGC\u5C3D\u53EF\u80FD\u591A\u7684\u6536\u96C6\u5783\u573E\u5BF9\u8C61\u3002\u6211\u4EEC\u628A\u8FD9\u4E2A\u79F0\u4F5CMinorGC\u539F\u5219\uFF0C\u9075\u5B88\u8FD9\u4E00\u539F\u5219\u53EF\u4EE5\u964D\u4F4E\u5E94\u7528\u7A0B\u5E8FFullGC \u7684\u53D1\u751F\u9891\u7387\u3002FullGC \u8F83\u8017\u65F6\uFF0C\u662F\u5E94\u7528\u7A0B\u5E8F\u65E0\u6CD5\u8FBE\u5230\u5EF6\u8FDF\u8981\u6C42\u6216\u541E\u5410\u91CF\u7684\u7F6A\u9B41\u7978\u9996</li><li>\u5806\u5927\u5C0F\u8C03\u6574\u7684\u7740\u624B\u70B9\u3001\u5206\u6790\u70B9\uFF1A</li></ol><ul><li>\u7EDF\u8BA1Minor GC \u6301\u7EED\u65F6\u95F4</li><li>\u7EDF\u8BA1Minor GC \u7684\u6B21\u6570</li><li>\u7EDF\u8BA1Full GC\u7684\u6700\u957F\u6301\u7EED\u65F6\u95F4</li><li>\u7EDF\u8BA1\u6700\u5DEE\u60C5\u51B5\u4E0BFull GC\u9891\u7387</li><li>\u7EDF\u8BA1GC\u6301\u7EED\u65F6\u95F4\u548C\u9891\u7387\u5BF9\u4F18\u5316\u5806\u7684\u5927\u5C0F\u662F\u4E3B\u8981\u7740\u624B\u70B9</li><li>\u6211\u4EEC\u6309\u7167\u4E1A\u52A1\u7CFB\u7EDF\u5BF9\u5EF6\u8FDF\u548C\u541E\u5410\u91CF\u7684\u9700\u6C42\uFF0C\u5728\u6309\u7167\u8FD9\u4E9B\u5206\u6790\u6211\u4EEC\u53EF\u4EE5\u8FDB\u884C\u5404\u4E2A\u533A\u5927\u5C0F\u7684\u8C03\u6574</li></ul><ol start="7"><li>\u4E00\u822C\u6765\u8BF4\u541E\u5410\u91CF\u4F18\u5148\u7684\u5783\u573E\u56DE\u6536\u5668\uFF1A-XX:+UseParallelGC -XX:+UseParallelOldGC\uFF0C\u5373\u5E38\u89C4\u7684\uFF08PS/PO\uFF09</li><li>\u54CD\u5E94\u65F6\u95F4\u4F18\u5148\u7684\u5783\u573E\u56DE\u6536\u5668\uFF1ACMS\u3001G1</li></ol><h2 id="jvm\u5E38\u7528\u53C2\u6570\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#jvm\u5E38\u7528\u53C2\u6570\u6709\u54EA\u4E9B" aria-hidden="true">#</a> JVM\u5E38\u7528\u53C2\u6570\u6709\u54EA\u4E9B\uFF1F</h2><ol><li><p><strong>Xms</strong> \u662F\u6307\u8BBE\u5B9A\u7A0B\u5E8F\u542F\u52A8\u65F6\u5360\u7528\u5185\u5B58\u5927\u5C0F\u3002\u4E00\u822C\u6765\u8BB2\uFF0C\u5927\u70B9\uFF0C\u7A0B\u5E8F\u4F1A\u542F\u52A8\u7684\u5FEB\u4E00\u70B9\uFF0C\u4F46\u662F\u4E5F\u53EF\u80FD\u4F1A\u5BFC\u81F4\u673A\u5668\u6682\u65F6\u95F4\u53D8\u6162</p></li><li><p><strong>Xmx</strong> \u662F\u6307\u8BBE\u5B9A\u7A0B\u5E8F\u8FD0\u884C\u671F\u95F4\u6700\u5927\u53EF\u5360\u7528\u7684\u5185\u5B58\u5927\u5C0F\u3002\u5982\u679C\u7A0B\u5E8F\u8FD0\u884C\u9700\u8981\u5360\u7528\u66F4\u591A\u7684\u5185\u5B58\uFF0C\u8D85\u51FA\u4E86\u8FD9\u4E2A\u8BBE\u7F6E\u503C\uFF0C\u5C31\u4F1A\u629B\u51FAOutOfMemory\u5F02\u5E38</p></li><li><p><strong>Xss</strong> \u662F\u6307\u8BBE\u5B9A\u6BCF\u4E2A\u7EBF\u7A0B\u7684\u5806\u6808\u5927\u5C0F\u3002\u8FD9\u4E2A\u5C31\u8981\u4F9D\u636E\u4F60\u7684\u7A0B\u5E8F\uFF0C\u770B\u4E00\u4E2A\u7EBF\u7A0B\u5927\u7EA6\u9700\u8981\u5360\u7528\u591A\u5C11\u5185\u5B58\uFF0C\u53EF\u80FD\u4F1A\u6709\u591A\u5C11\u7EBF\u7A0B\u540C\u65F6\u8FD0\u884C\u7B49</p></li><li><p><strong>-Xmn\u3001-XX:NewSize/-XX:MaxNewSize\u3001-XX:NewRatio</strong></p><p>\u9AD8\u4F18\u5148\u7EA7\uFF1A-XX:NewSize/-XX:MaxNewSize</p><p>\u4E2D\u4F18\u5148\u7EA7\uFF1A-Xmn\uFF08\u9ED8\u8BA4\u7B49\u6548 -Xmn=-XX:NewSize=-XX:MaxNewSize=?\uFF09</p><p>\u4F4E\u4F18\u5148\u7EA7\uFF1A-XX:NewRatio</p></li><li><p>\u5982\u679C\u60F3\u5728\u65E5\u5FD7\u4E2D\u8FFD\u8E2A\u7C7B\u52A0\u8F7D\u4E0E\u7C7B\u5378\u8F7D\u7684\u60C5\u51B5\uFF0C\u53EF\u4EE5\u4F7F\u7528\u542F\u52A8\u53C2\u6570 **-XX:TraceClassLoading -XX:TraceClassUnloading **</p></li></ol><h2 id="jvm\u5E38\u7528\u6027\u80FD\u8C03\u4F18\u5DE5\u5177\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#jvm\u5E38\u7528\u6027\u80FD\u8C03\u4F18\u5DE5\u5177\u6709\u54EA\u4E9B" aria-hidden="true">#</a> JVM\u5E38\u7528\u6027\u80FD\u8C03\u4F18\u5DE5\u5177\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>MAT \u63D0\u793A\u53EF\u80FD\u7684\u5185\u5B58\u6CC4\u9732\u7684\u70B9</li><li>jvisualvm</li><li>jconsole</li><li>Arthas</li><li>show-busy-java-threads https://github.com/oldratlee/useful-scripts/blob/master/docs/java.md#-show-busy-java-threads</li></ol><h2 id="\u7EBF\u4E0A\u6392\u67E5\u95EE\u9898\u7684\u4E00\u822C\u6D41\u7A0B\u662F\u600E\u4E48\u6837\u7684" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u4E0A\u6392\u67E5\u95EE\u9898\u7684\u4E00\u822C\u6D41\u7A0B\u662F\u600E\u4E48\u6837\u7684" aria-hidden="true">#</a> \u7EBF\u4E0A\u6392\u67E5\u95EE\u9898\u7684\u4E00\u822C\u6D41\u7A0B\u662F\u600E\u4E48\u6837\u7684\uFF1F</h2><ol><li><p>CPU\u5360\u7528\u8FC7\u9AD8\u6392\u67E5\u6D41\u7A0B</p><p>\u5229\u7528 top \u547D\u4EE4\u53EF\u4EE5\u67E5\u51FA\u5360 CPU \u6700\u9AD8\u7684\u7684\u8FDB\u7A0Bpid \uFF0C\u5982\u679Cpid\u4E3A 9876</p><p>\u7136\u540E\u67E5\u770B\u8BE5\u8FDB\u7A0B\u4E0B\u5360\u7528\u6700\u9AD8\u7684\u7EBF\u7A0Bid\u3010top -Hp 9876\u3011</p><p>\u5047\u8BBE\u5360\u7528\u7387\u6700\u9AD8\u7684\u7EBF\u7A0B ID \u4E3A 6900\uFF0C\u5C06\u5176\u8F6C\u6362\u4E3A 16 \u8FDB\u5236\u5F62\u5F0F (\u56E0\u4E3A java native \u7EBF\u7A0B\u4EE5 16 \u8FDB\u5236\u5F62\u5F0F\u8F93\u51FA) \u3010printf &#39;%x\\n&#39; 6900\u3011</p><p>\u5229\u7528 jstack \u6253\u5370\u51FA java \u7EBF\u7A0B\u8C03\u7528\u6808\u4FE1\u606F\u3010jstack 9876 | grep &#39;0x1af4&#39; -A 50 --color\u3011\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u66F4\u597D\u5B9A\u4F4D\u95EE\u9898</p></li><li><p>\u5185\u5B58\u5360\u7528\u8FC7\u9AD8\u6392\u67E5\u6D41\u7A0B</p><p>\u67E5\u627E\u8FDB\u7A0Bid: \u3010top -d 2 -c\u3011</p><p>\u67E5\u770BJVM\u5806\u5185\u5B58\u5206\u914D\u60C5\u51B5\uFF1Ajmap -heap pid</p><p>\u67E5\u770B\u5360\u7528\u5185\u5B58\u6BD4\u8F83\u591A\u7684\u5BF9\u8C61 jmap -histo pid | head -n 100</p><p>\u67E5\u770B\u5360\u7528\u5185\u5B58\u6BD4\u8F83\u591A\u7684\u5B58\u6D3B\u5BF9\u8C61 jmap -histo:live pid | head -n 100</p></li></ol><h2 id="\u4EC0\u4E48\u60C5\u51B5\u4E0B-\u4F1A\u629B\u51FAoom\u5462" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u60C5\u51B5\u4E0B-\u4F1A\u629B\u51FAoom\u5462" aria-hidden="true">#</a> \u4EC0\u4E48\u60C5\u51B5\u4E0B\uFF0C\u4F1A\u629B\u51FAOOM\u5462\uFF1F</h2><ul><li>JVM98%\u7684\u65F6\u95F4\u90FD\u82B1\u8D39\u5728\u5185\u5B58\u56DE\u6536</li><li>\u6BCF\u6B21\u56DE\u6536\u7684\u5185\u5B58\u5C0F\u4E8E2%</li></ul><p>\u6EE1\u8DB3\u8FD9\u4E24\u4E2A\u6761\u4EF6\u5C06\u89E6\u53D1OutOfMemoryException\uFF0C\u8FD9\u5C06\u4F1A\u7559\u7ED9\u7CFB\u7EDF\u4E00\u4E2A\u5FAE\u5C0F\u7684\u95F4\u9699\u4EE5\u505A\u4E00\u4E9BDown\u4E4B\u524D\u7684\u64CD\u4F5C\uFF0C\u6BD4\u5982\u624B\u52A8\u6253\u5370Heap Dump\u3002\u5E76\u4E0D\u662F\u5185\u5B58\u88AB\u8017\u7A7A\u7684\u65F6\u5019\u624D\u629B\u51FA</p><h2 id="\u7CFB\u7EDFoom\u4E4B\u524D\u90FD\u6709\u54EA\u4E9B\u73B0\u8C61" tabindex="-1"><a class="header-anchor" href="#\u7CFB\u7EDFoom\u4E4B\u524D\u90FD\u6709\u54EA\u4E9B\u73B0\u8C61" aria-hidden="true">#</a> \u7CFB\u7EDFOOM\u4E4B\u524D\u90FD\u6709\u54EA\u4E9B\u73B0\u8C61\uFF1F</h2><ul><li>\u6BCF\u6B21\u5783\u573E\u56DE\u6536\u7684\u65F6\u95F4\u8D8A\u6765\u8D8A\u957F\uFF0C\u7531\u4E4B\u524D\u768410ms\u5EF6\u957F\u523050ms\u5DE6\u53F3\uFF0CFullGC\u7684\u65F6\u95F4\u4E5F\u6709\u4E4B\u524D\u76840.5s\u5EF6\u957F\u52304\u30015s</li><li>FullGC\u7684\u6B21\u6570\u8D8A\u6765\u8D8A\u591A\uFF0C\u6700\u9891\u7E41\u65F6\u9694\u4E0D\u52301\u5206\u949F\u5C31\u8FDB\u884C\u4E00\u6B21FullGC</li><li>\u8001\u5E74\u4EE3\u7684\u5185\u5B58\u8D8A\u6765\u8D8A\u5927\u5E76\u4E14\u6BCF\u6B21FullGC\u540E\uFF0C\u8001\u5E74\u4EE3\u53EA\u6709\u5C11\u91CF\u7684\u5185\u5B58\u88AB\u91CA\u653E\u6389</li></ul><h2 id="\u5982\u4F55\u8FDB\u884C\u5806dump\u6587\u4EF6\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u8FDB\u884C\u5806dump\u6587\u4EF6\u5206\u6790" aria-hidden="true">#</a> \u5982\u4F55\u8FDB\u884C\u5806Dump\u6587\u4EF6\u5206\u6790\uFF1F</h2><p>\u53EF\u4EE5\u901A\u8FC7\u6307\u5B9A\u542F\u52A8\u53C2\u6570 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/usr/app/data/dump/heapdump.hpro \u5728\u53D1\u751FOOM\u7684\u65F6\u5019\u81EA\u52A8\u5BFC\u51FADump\u6587\u4EF6</p><h2 id="\u5982\u4F55\u8FDB\u884Cgc\u65E5\u5FD7\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u8FDB\u884Cgc\u65E5\u5FD7\u5206\u6790" aria-hidden="true">#</a> \u5982\u4F55\u8FDB\u884CGC\u65E5\u5FD7\u5206\u6790\uFF1F</h2><p>\u4E3A\u4E86\u65B9\u4FBF\u5206\u6790GC\u65E5\u5FD7\u4FE1\u606F\uFF0C\u53EF\u4EE5\u6307\u5B9A\u542F\u52A8\u53C2\u6570 \u3010-Xloggc: app-gc.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps\u3011,\u65B9\u4FBF\u8BE6\u7EC6\u5730\u67E5\u770BGC\u65E5\u5FD7\u4FE1\u606F</p>`,333),h=n("li",null,"\u4F7F\u7528 \u3010jinfo pid\u3011\u67E5\u770B\u5F53\u524DJVM\u5806\u7684\u76F8\u5173\u53C2\u6570",-1),g=n("li",null,"\u7EE7\u7EED\u4F7F\u7528 \u3010jstat -gcutil 2315 1s 10\u3011\u67E5\u770B10s\u5185\u5F53\u524D\u5806\u7684\u5360\u7528\u60C5\u51B5",-1),f=n("li",null,"\u4E5F\u53EF\u4EE5\u4F7F\u7528\u3010jmap -heap pid\u3011\u67E5\u770B\u5F53\u524DJVM\u5806\u7684\u60C5\u51B5",-1),y=n("li",null,"\u6211\u4EEC\u53EF\u4EE5\u7EE7\u7EED\u4F7F\u7528 \u3010jmap -F -histo pid | head -n 20\u3011\uFF0C\u67E5\u770B\u524D20\u884C\u6253\u5370\uFF0C\u5373\u67E5\u770B\u5F53\u524Dtop20\u7684\u5927\u5BF9\u8C61\uFF0C\u4E00\u822C\u4ECE\u8FD9\u91CC\u53EF\u4EE5\u53D1\u73B0\u4E00\u4E9B\u5F02\u5E38\u7684\u5927\u5BF9\u8C61\uFF0C\u5982\u679C\u6CA1\u6709\uFF0C\u90A3\u4E48\u53EF\u4EE5\u7EE7\u7EED\u6392\u540D\u524D50\u7684\u5927\u5BF9\u8C61\uFF0C\u5206\u6790",-1),w=n("li",null,"\u6700\u540E\u4F7F\u7528\u3010jmap -F -dump:file=a.bin pid\u3011\uFF0C\u5982\u679Cdump\u6587\u4EF6\u5F88\u5927\uFF0C\u53EF\u4EE5\u538B\u7F29\u4E00\u4E0B\u3010tar -czvf a.tar.gz a.bin\u3011",-1),C=n("li",null,"\u518D\u4E4B\u540E\uFF0C\u5C31\u662F\u5BF9dump\u6587\u4EF6\u8FDB\u884C\u5206\u6790\u4E86\uFF0C\u4F7F\u7528MAT\u5206\u6790\u5185\u5B58\u6CC4\u9732",-1),x=s("\u53C2\u8003\u6848\u4F8B\uFF1A "),S={href:"https://www.lagou.com/lgeduarticle/142372.html",target:"_blank",rel:"noopener noreferrer"},P=s("https://www.lagou.com/lgeduarticle/142372.html"),A=e('<h2 id="\u7EBF\u4E0A\u6B7B\u9501\u662F\u5982\u4F55\u6392\u67E5\u7684" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u4E0A\u6B7B\u9501\u662F\u5982\u4F55\u6392\u67E5\u7684" aria-hidden="true">#</a> \u7EBF\u4E0A\u6B7B\u9501\u662F\u5982\u4F55\u6392\u67E5\u7684\uFF1F</h2><ol><li>jps \u67E5\u627E\u4E00\u4E2A\u53EF\u80FD\u6709\u95EE\u9898\u7684<strong>\u8FDB\u7A0Bid</strong></li><li>\u7136\u540E\u6267\u884C \u3010jstack -F <strong>\u8FDB\u7A0Bid</strong>\u3011</li><li>\u5982\u679C\u73AF\u5883\u5141\u8BB8\u8FDC\u7A0B\u8FDE\u63A5JVM\uFF0C\u53EF\u4EE5\u4F7F\u7528jconsole\u6216\u8005jvisualvm\uFF0C\u56FE\u5F62\u5316\u754C\u9762\u68C0\u6D4B\u662F\u5426\u5B58\u5728\u6B7B\u9501</li></ol><h2 id="\u7EBF\u4E0Aygc\u8017\u65F6\u8FC7\u957F\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u4E0Aygc\u8017\u65F6\u8FC7\u957F\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u7EBF\u4E0AYGC\u8017\u65F6\u8FC7\u957F\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B\uFF1F</h2>',3),B=n("li",null,"\u5982\u679C\u751F\u547D\u5468\u671F\u8FC7\u957F\u7684\u5BF9\u8C61\u8D8A\u6765\u8D8A\u591A\uFF08\u6BD4\u5982\u5168\u5C40\u53D8\u91CF\u6216\u8005\u9759\u6001\u53D8\u91CF\u7B49\uFF09\uFF0C\u4F1A\u5BFC\u81F4\u6807\u6CE8\u548C\u590D\u5236\u8FC7\u7A0B\u7684\u8017\u65F6\u589E\u52A0",-1),q=n("li",null,"\u5BF9\u5B58\u6D3B\u5BF9\u8C61\u6807\u6CE8\u65F6\u95F4\u8FC7\u957F\uFF1A\u6BD4\u5982\u91CD\u8F7D\u4E86Object\u7C7B\u7684Finalize\u65B9\u6CD5\uFF0C\u5BFC\u81F4\u6807\u6CE8Final Reference\u8017\u65F6\u8FC7\u957F\uFF1B\u6216\u8005String.intern\u65B9\u6CD5\u4F7F\u7528\u4E0D\u5F53\uFF0C\u5BFC\u81F4YGC\u626B\u63CFStringTable\u65F6\u95F4\u8FC7\u957F\u3002\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u53C2\u6570\u663E\u793AGC\u5904\u7406Reference\u7684\u8017\u65F6-XX:+PrintReferenceGC",-1),E=n("li",null,"\u957F\u5468\u671F\u5BF9\u8C61\u79EF\u7D2F\u8FC7\u591A\uFF1A\u6BD4\u5982\u672C\u5730\u7F13\u5B58\u4F7F\u7528\u4E0D\u5F53\uFF0C\u79EF\u7D2F\u4E86\u592A\u591A\u5B58\u6D3B\u5BF9\u8C61\uFF1B\u6216\u8005\u9501\u7ADE\u4E89\u4E25\u91CD\u5BFC\u81F4\u7EBF\u7A0B\u963B\u585E\uFF0C\u5C40\u90E8\u53D8\u91CF\u7684\u751F\u547D\u5468\u671F\u53D8\u957F",-1),R=s("\u6848\u4F8B\u53C2\u8003\uFF1A "),M={href:"https://my.oschina.net/lishangzhi/blog/4703942",target:"_blank",rel:"noopener noreferrer"},D=s("https://my.oschina.net/lishangzhi/blog/4703942"),T=e('<h2 id="\u7EBF\u4E0A\u9891\u7E41fullgc\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u4E0A\u9891\u7E41fullgc\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u7EBF\u4E0A\u9891\u7E41FullGC\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>\u7EBF\u4E0A\u9891\u7E41FullGC\u4E00\u822C\u4F1A\u6709\u8FD9\u4E48\u51E0\u4E2A\u7279\u5F81\uFF1A</li></ol><ul><li>\u7EBF\u4E0A\u591A\u4E2A\u7EBF\u7A0B\u7684CPU\u90FD\u8D85\u8FC7\u4E86100%\uFF0C\u901A\u8FC7jstack\u547D\u4EE4\u53EF\u4EE5\u770B\u5230\u8FD9\u4E9B\u7EBF\u7A0B\u4E3B\u8981\u662F\u5783\u573E\u56DE\u6536\u7EBF\u7A0B</li><li>\u901A\u8FC7jstat\u547D\u4EE4\u76D1\u63A7GC\u60C5\u51B5\uFF0C\u53EF\u4EE5\u770B\u5230Full GC\u6B21\u6570\u975E\u5E38\u591A\uFF0C\u5E76\u4E14\u6B21\u6570\u5728\u4E0D\u65AD\u589E\u52A0</li></ul><ol start="2"><li>\u6392\u67E5\u6D41\u7A0B\uFF1A</li></ol><ul><li>top\u627E\u5230cpu\u5360\u7528\u6700\u9AD8\u7684\u4E00\u4E2A <strong>\u8FDB\u7A0Bid</strong></li><li>\u7136\u540E \u3010top -Hp \u8FDB\u7A0Bid\u3011\uFF0C\u627E\u5230cpu\u5360\u7528\u6700\u9AD8\u7684 <strong>\u7EBF\u7A0Bid</strong></li><li>\u3010printf &quot;%x\\n&quot; <strong>\u7EBF\u7A0Bid \u3011</strong>\uFF0C\u5047\u8BBE16\u8FDB\u5236\u7ED3\u679C\u4E3A a</li><li>jstack \u7EBF\u7A0Bid | grep &#39;0xa&#39; -A 50 --color</li><li>\u5982\u679C\u662F\u6B63\u5E38\u7684\u7528\u6237\u7EBF\u7A0B\uFF0C \u5219\u901A\u8FC7\u8BE5\u7EBF\u7A0B\u7684\u5806\u6808\u4FE1\u606F\u67E5\u770B\u5176\u5177\u4F53\u662F\u5728\u54EA\u5904\u7528\u6237\u4EE3\u7801\u5904\u8FD0\u884C\u6BD4\u8F83\u6D88\u8017CPU</li><li>\u5982\u679C\u8BE5\u7EBF\u7A0B\u662F VMThread\uFF0C\u5219\u901A\u8FC7 jstat-gcutil\u547D\u4EE4\u76D1\u63A7\u5F53\u524D\u7CFB\u7EDF\u7684GC\u72B6\u51B5\uFF0C\u7136\u540E\u901A\u8FC7 jmapdump: format=b,file=\u5BFC\u51FA\u7CFB\u7EDF\u5F53\u524D\u7684\u5185\u5B58\u6570\u636E\u3002\u5BFC\u51FA\u4E4B\u540E\u5C06\u5185\u5B58\u60C5\u51B5\u653E\u5230eclipse\u7684mat\u5DE5\u5177\u4E2D\u8FDB\u884C\u5206\u6790\u5373\u53EF\u5F97\u51FA\u5185\u5B58\u4E2D\u4E3B\u8981\u662F\u4EC0\u4E48\u5BF9\u8C61\u6BD4\u8F83\u6D88\u8017\u5185\u5B58\uFF0C\u8FDB\u800C\u53EF\u4EE5\u5904\u7406\u76F8\u5173\u4EE3\u7801\uFF1B\u6B63\u5E38\u60C5\u51B5\u4E0B\u4F1A\u53D1\u73B0VM Thread\u6307\u7684\u5C31\u662F\u5783\u573E\u56DE\u6536\u7684\u7EBF\u7A0B</li><li>\u518D\u6267\u884C\u3010jstat -gcutil **\u8FDB\u7A0Bid\u3011, **\u770B\u5230\u7ED3\u679C\uFF0C\u5982\u679CFGC\u7684\u6570\u91CF\u5F88\u9AD8\uFF0C\u4E14\u5728\u4E0D\u65AD\u589E\u957F\uFF0C\u90A3\u4E48\u53EF\u4EE5\u5B9A\u4F4D\u662F\u7531\u4E8E\u5185\u5B58\u6EA2\u51FA\u5BFC\u81F4FullGC\u9891\u7E41\uFF0C\u7CFB\u7EDF\u7F13\u6162</li><li>\u7136\u540E\u5C31\u53EF\u4EE5Dump\u51FA\u5185\u5B58\u65E5\u5FD7\uFF0C\u7136\u540E\u4F7F\u7528MAT\u7684\u5DE5\u5177\u5206\u6790\u54EA\u4E9B\u5BF9\u8C61\u5360\u7528\u5185\u5B58\u8F83\u5927\uFF0C\u7136\u540E\u627E\u5230\u5BF9\u8C61\u7684\u521B\u5EFA\u4F4D\u7F6E\uFF0C\u5904\u7406\u5373\u53EF</li></ul>',5),j={start:"3"},I=s("\u53C2\u8003\u6848\u4F8B\uFF1A"),O={href:"https://mp.weixin.qq.com/s/g8KJhOtiBHWb6wNFrCcLVg",target:"_blank",rel:"noopener noreferrer"},L=s("https://mp.weixin.qq.com/s/g8KJhOtiBHWb6wNFrCcLVg"),_=e('<h2 id="\u5982\u4F55\u8FDB\u884C\u7EBF\u4E0A\u5806\u5916\u5185\u5B58\u6CC4\u6F0F\u7684\u5206\u6790-netty\u5C24\u5176\u5C45\u591A" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u8FDB\u884C\u7EBF\u4E0A\u5806\u5916\u5185\u5B58\u6CC4\u6F0F\u7684\u5206\u6790-netty\u5C24\u5176\u5C45\u591A" aria-hidden="true">#</a> \u5982\u4F55\u8FDB\u884C\u7EBF\u4E0A\u5806\u5916\u5185\u5B58\u6CC4\u6F0F\u7684\u5206\u6790\uFF1F\uFF08Netty\u5C24\u5176\u5C45\u591A\uFF09</h2><ol><li>JVM\u7684\u5806\u5916\u5185\u5B58\u6CC4\u9732\u7684\u5B9A\u4F4D\u4E00\u76F4\u662F\u4E2A\u6BD4\u8F83\u68D8\u624B\u7684\u95EE\u9898</li><li>\u5BF9\u5916\u5185\u5B58\u7684\u6CC4\u6F0F\u5206\u6790\u4E00\u822C\u90FD\u662F\u5148\u4ECE\u5806\u5185\u5185\u5B58\u5206\u6790\u7684\u8FC7\u7A0B\u4E2D\u884D\u751F\u51FA\u6765\u7684\u3002\u6709\u53EF\u80FD\u6211\u4EEC\u5206\u6790\u5806\u5185\u5185\u5B58\u6CC4\u9732\u8FC7\u7A0B\u4E2D\u53D1\u73B0\uFF0C\u6211\u4EEC\u8BA1\u7B97\u51FA\u6765\u7684JVM\u5806\u5185\u5B58\u7ADF\u7136\u5927\u4E8E\u4E86\u6574\u4E2AJVM\u7684<strong>Xmx</strong>\u7684\u5927\u5C0F\uFF0C\u90A3\u8BF4\u660E\u591A\u51FA\u6765\u7684\u662F\u5806\u5916\u5185\u5B58</li><li>\u5982\u679C\u4F7F\u7528\u4E86 Netty \u5806\u5916\u5185\u5B58\uFF0C\u90A3\u4E48\u53EF\u4EE5\u81EA\u884C\u76D1\u63A7\u5806\u5916\u5185\u5B58\u7684\u4F7F\u7528\u60C5\u51B5\uFF0C\u4E0D\u9700\u8981\u501F\u52A9\u7B2C\u4E09\u65B9\u5DE5\u5177\uFF0C\u6211\u4EEC\u662F\u4F7F\u7528\u7684\u201C\u53CD\u5C04\u201D\u62FF\u5230\u7684\u5806\u5916\u5185\u5B58\u7684\u60C5\u51B5</li><li>\u9010\u6E10\u7F29\u5C0F\u8303\u56F4\uFF0C\u76F4\u5230 Bug \u88AB\u627E\u5230\u3002\u5F53\u6211\u4EEC\u786E\u8BA4\u67D0\u4E2A\u7EBF\u7A0B\u7684\u6267\u884C\u5E26\u6765 Bug \u65F6\uFF0C\u53EF\u5355\u6B65\u6267\u884C\uFF0C\u53EF\u4E8C\u5206\u6267\u884C\uFF0C\u5B9A\u4F4D\u5230\u67D0\u884C\u4EE3\u7801\u4E4B\u540E\uFF0C\u8DDF\u5230\u8FD9\u6BB5\u4EE3\u7801\uFF0C\u7136\u540E\u7EE7\u7EED\u5355\u6B65\u6267\u884C\u6216\u8005\u4E8C\u5206\u7684\u65B9\u5F0F\u6765\u5B9A\u4F4D\u6700\u7EC8\u51FA Bug \u7684\u4EE3\u7801\u3002\u8FD9\u4E2A\u65B9\u6CD5\u5C61\u8BD5\u4E0D\u723D\uFF0C\u6700\u540E\u603B\u80FD\u627E\u5230\u60F3\u8981\u7684 Bug</li><li>\u719F\u7EC3\u638C\u63E1 idea \u7684\u8C03\u8BD5\uFF0C\u8BA9\u6211\u4EEC\u7684\u201C\u6349\u866B\u201D\u901F\u5EA6\u5FEB\u5982\u95EA\u7535\uFF08\u201C\u95EA\u7535\u4FA0\u201D\u5C31\u662F\u8FD9\u4E48\u6765\u7684\uFF09\u3002\u8FD9\u91CC\uFF0C\u6700\u5E38\u89C1\u7684\u8C03\u8BD5\u65B9\u5F0F\u662F<strong>\u9884\u6267\u884C\u8868\u8FBE\u5F0F</strong>\uFF0C\u4EE5\u53CA\u901A\u8FC7<strong>\u7EBF\u7A0B\u8C03\u7528\u6808</strong>\uFF0C\u6B7B\u76EF\u67D0\u4E2A\u5BF9\u8C61\uFF0C\u5C31\u80FD\u591F\u638C\u63E1\u8FD9\u4E2A\u5BF9\u8C61\u7684\u5B9A\u4E49\u3001\u8D4B\u503C\u4E4B\u7C7B</li><li>\u5728\u4F7F\u7528\u76F4\u63A5\u5185\u5B58\u7684\u9879\u76EE\u4E2D\uFF0C\u6700\u597D\u5EFA\u8BAE\u914D\u7F6E -XX:MaxDirectMemorySize\uFF0C\u8BBE\u5B9A\u4E00\u4E2A\u7CFB\u7EDF\u5B9E\u9645\u53EF\u8FBE\u7684\u6700\u5927\u7684\u76F4\u63A5\u5185\u5B58\u7684\u503C\uFF0C\u9ED8\u8BA4\u7684\u6700\u5927\u76F4\u63A5\u5185\u5B58\u5927\u5C0F\u7B49\u4E8E -Xmx\u7684\u503C</li><li>\u6392\u67E5\u5806\u5916\u6CC4\u9732\uFF0C\u5EFA\u8BAE\u6307\u5B9A\u542F\u52A8\u53C2\u6570\uFF1A -XX:NativeMemoryTracking=summary - Dio.netty.leakDetection.targetRecords=100-Dio.netty.leakDetection.level=PARANOID\uFF0C\u540E\u9762\u4E24\u4E2A\u53C2\u6570\u662FNetty\u7684\u76F8\u5173\u5185\u5B58\u6CC4\u9732\u68C0\u6D4B\u7684\u7EA7\u522B\u4E0E\u91C7\u6837\u7EA7\u522B</li><li></li></ol>',2),N=s("\u53C2\u8003\u6848\u4F8B\uFF1A"),F={href:"https://tech.meituan.com/2018/10/18/netty-direct-memory-screening.html",target:"_blank",rel:"noopener noreferrer"},H=s("https://tech.meituan.com/2018/10/18/netty-direct-memory-screening.html"),J=n("h2",{id:"\u7EBF\u4E0A\u5143\u7A7A\u95F4\u5185\u5B58\u6CC4\u9732\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u7EBF\u4E0A\u5143\u7A7A\u95F4\u5185\u5B58\u6CC4\u9732\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B","aria-hidden":"true"},"#"),s(" \u7EBF\u4E0A\u5143\u7A7A\u95F4\u5185\u5B58\u6CC4\u9732\u4F18\u5316\u65B9\u6848\u6709\u54EA\u4E9B\uFF1F")],-1),U=n("ol",null,[n("li",null,"\u9700\u8981\u6CE8\u610F\u7684\u4E00\u70B9\u662F Java8\u4EE5\u53CAJava8+\u7684JVM\u5DF2\u7ECF\u5C06\u6C38\u4E45\u4EE3\u5E9F\u5F03\u4E86\uFF0C\u53D6\u800C\u4EE3\u4E4B\u7684\u662F\u5143\u7A7A\u95F4\uFF0C\u4E14\u5143\u7A7A\u95F4\u662F\u4E0D\u662F\u5728JVM\u5806\u4E2D\u7684\uFF0C\u800C\u5C5E\u4E8E\u5806\u5916\u5185\u5B58\uFF0C\u53D7\u6700\u5927\u7269\u7406\u5185\u5B58\u9650\u5236\u3002\u6700\u4F73\u5B9E\u8DF5\u5C31\u662F\u6211\u4EEC\u5728\u542F\u52A8\u53C2\u6570\u4E2D\u6700\u597D\u8BBE\u7F6E\u4E0A -XX: MetaspaceSize=1024m -XX:MaxMetaspaceSize=1024m\u3002\u5177\u4F53\u7684\u503C\u6839\u636E\u60C5\u51B5\u8BBE\u7F6E\u3002\u4E3A\u907F\u514D\u52A8\u6001\u7533\u8BF7\uFF0C\u53EF\u4EE5\u76F4\u63A5\u90FD\u8BBE\u7F6E\u4E3A\u6700\u5927\u503C"),n("li")],-1),G=n("p",null,"\u5143\u7A7A\u95F4\u4E3B\u8981\u5B58\u653E\u7684\u662F\u7C7B\u5143\u6570\u636E\uFF0C\u800C\u4E14metaspace\u5224\u65AD\u7C7B\u5143\u6570\u636E\u662F\u5426\u53EF\u4EE5\u56DE\u6536\uFF0C\u662F\u6839\u636E\u52A0\u8F7D\u8FD9\u4E9B\u7C7B\u5143\u6570\u636E\u7684Classloader\u662F\u5426\u53EF\u4EE5\u56DE\u6536\u6765\u5224\u65AD\u7684\uFF0C\u53EA\u8981Classloader\u4E0D\u80FD\u56DE\u6536\uFF0C\u901A\u8FC7\u5176\u52A0\u8F7D\u7684\u7C7B\u5143\u6570\u636E\u5C31\u4E0D\u4F1A\u88AB\u56DE\u6536\u3002\u6240\u4EE5\u7EBF\u4E0A\u6709\u65F6\u5019\u4F1A\u51FA\u73B0\u4E00\u79CD\u95EE\u9898\uFF0C\u7531\u4E8E\u6846\u67B6\u4E2D\uFF0C\u5F80\u5F80\u5927\u91CF\u91C7\u7528\u7C7B\u4F3CASM\u3001javassist\u7B49\u5DE5\u5177\u8FDB\u884C\u5B57\u8282\u7801\u589E\u5F3A\uFF0C\u751F\u6210\u4EE3\u7406\u7C7B\u3002\u5982\u679C\u9879\u76EE\u4E2D\u7531\u4E3B\u7EBF\u7A0B\u9891\u7E41\u751F\u6210\u52A8\u6001\u4EE3\u7406\u7C7B\uFF0C\u90A3\u4E48\u5C31\u4F1A\u5BFC\u81F4\u5143\u7A7A\u95F4\u8FC5\u901F\u5360\u6EE1\uFF0C\u65E0\u6CD5\u56DE\u6536",-1),V={start:"3"},X=s("\u5177\u4F53\u6848\u4F8B\u53EF\u4EE5\u53C2\u89C1\uFF1A"),W={href:"https://zhuanlan.zhihu.com/p/200802910",target:"_blank",rel:"noopener noreferrer"},z=s("https://zhuanlan.zhihu.com/p/200802910"),K=e('<h2 id="java\u7C7B\u52A0\u8F7D\u5668\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#java\u7C7B\u52A0\u8F7D\u5668\u6709\u54EA\u4E9B" aria-hidden="true">#</a> java\u7C7B\u52A0\u8F7D\u5668\u6709\u54EA\u4E9B\uFF1F</h2><p><strong>Bootstrap\u7C7B\u52A0\u8F7D\u5668</strong></p><p>\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668\u4E3B\u8981\u52A0\u8F7D\u7684\u662FJVM\u81EA\u8EAB\u9700\u8981\u7684\u7C7B\uFF0C\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u4F7F\u7528C++\u8BED\u8A00\u5B9E\u73B0\u7684\uFF0C\u6CA1\u6709\u7236\u7C7B\uFF0C\u662F\u865A\u62DF\u673A\u81EA\u8EAB\u7684\u4E00\u90E8\u5206\uFF0C\u5B83\u8D1F\u8D23\u5C06 <strong>&lt;JAVA_HOME&gt;/lib\u8DEF\u5F84\u4E0B\u7684\u6838\u5FC3\u7C7B\u5E93</strong>\u6216**-Xbootclasspath\u53C2\u6570\u6307\u5B9A\u7684\u8DEF\u5F84\u4E0B\u7684jar\u5305** \u52A0\u8F7D\u5230\u5185\u5B58\u4E2D\uFF0C\u6CE8\u610F\u5FC5\u7531\u4E8E\u865A\u62DF\u673A\u662F\u6309\u7167\u6587\u4EF6\u540D\u8BC6\u522B\u52A0\u8F7Djar\u5305\u7684\uFF0C\u5982rt.jar\uFF0C\u5982\u679C\u6587\u4EF6\u540D\u4E0D\u88AB\u865A\u62DF\u673A\u8BC6\u522B\uFF0C\u5373\u4F7F\u628Ajar\u5305\u4E22\u5230lib\u76EE\u5F55\u4E0B\u4E5F\u662F\u6CA1\u6709\u4F5C\u7528\u7684(\u51FA\u4E8E\u5B89\u5168\u8003\u8651\uFF0CBootstrap\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668\u53EA\u52A0\u8F7D\u5305\u540D\u4E3Ajava\u3001javax\u3001sun\u7B49\u5F00\u5934</p><p><strong>Extention \u7C7B\u52A0\u8F7D\u5668</strong></p><p>\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668\u662F\u6307Sun\u516C\u53F8\u5B9E\u73B0\u7684sun.misc.Launcher$ExtClassLoader\u7C7B\uFF0C<strong>\u7531Java\u8BED\u8A00\u5B9E\u73B0\u7684</strong>\uFF0C\u7236\u7C7B\u52A0\u8F7D\u5668\u4E3Anull\uFF0C\u662FLauncher\u7684\u9759\u6001\u5185\u90E8\u7C7B\uFF0C\u5B83\u8D1F\u8D23\u52A0\u8F7D**&lt;JAVA_HOME&gt; /lib/ext\u76EE\u5F55\u4E0B<strong>\u6216\u8005\u7531\u7CFB\u7EDF\u53D8\u91CF</strong>-Djava.ext.dir\u6307\u5B9A\u4F4D\u8DEF\u5F84\u4E2D\u7684\u7C7B\u5E93**\uFF0C\u5F00\u53D1\u8005\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u6807\u51C6\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668</p>',5),Q={href:"https://blog.csdn.net/javazejian/article/details/73413292",target:"_blank",rel:"noopener noreferrer"},Z=s("https://blog.csdn.net/javazejian/article/details/73413292"),Y=e(`<p><strong>Application\u7C7B\u52A0\u8F7D\u5668</strong></p><p>\u79F0\u5E94\u7528\u7A0B\u5E8F\u52A0\u8F7D\u5668\u662F\u6307 Sun\u516C\u53F8\u5B9E\u73B0\u7684sun.misc.Launcher$AppClassLoader\u3002\u7236\u7C7B\u52A0\u8F7D\u5668\u4E3AExtClassLoader\uFF0C\u5B83\u8D1F\u8D23\u52A0\u8F7D<strong>\u7CFB\u7EDF\u7C7B\u8DEF\u5F84java -classpath</strong>\u6216**-D java.class.path \u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684\u7C7B\u5E93**\uFF0C\u4E5F\u5C31\u662F\u6211\u4EEC\u7ECF\u5E38\u7528\u5230\u7684<strong>classpath\u8DEF\u5F84</strong> \uFF0C\u5F00\u53D1\u8005\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u7CFB\u7EDF\u7C7B\u52A0\u8F7D\u5668\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\u8BE5\u7C7B\u52A0\u8F7D\u662F\u7A0B\u5E8F\u4E2D\u9ED8\u8BA4\u7684\u7C7B\u52A0\u8F7D\u5668\uFF0C\u901A\u8FC7ClassLoader#getSystemClassLoader()\u65B9\u6CD5\u53EF\u4EE5\u83B7\u53D6\u5230\u8BE5\u7C7B\u52A0\u8F7D\u5668</p><p><strong>Custom\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</strong></p><p>\u5E94\u7528\u7A0B\u5E8F\u53EF\u4EE5\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\uFF0C\u7236\u7C7B\u52A0\u8F7D\u5668\u4E3AAppClassLoader</p><h2 id="\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u53CC\u4EB2\u59D4\u6D3E\u673A\u5236\u662F\u4EC0\u4E48\uFF1F</h2><p>\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236</p><p>\u53CC\u4EB2\u59D4\u6D3E\u6A21\u5F0F\u662F\u5728Java 1.2\u540E\u5F15\u5165\u7684\uFF0C\u5176\u5DE5\u4F5C\u539F\u7406\u7684\u662F\uFF0C\u5982\u679C\u4E00\u4E2A\u7C7B\u52A0\u8F7D\u5668\u6536\u5230\u4E86\u7C7B\u52A0\u8F7D\u8BF7\u6C42\uFF0C\u5B83\u5E76\u4E0D\u4F1A\u81EA\u5DF1\u5148\u53BB\u52A0\u8F7D\uFF0C\u800C\u662F\u628A\u8FD9\u4E2A<strong>\u8BF7\u6C42\u59D4\u6258\u7ED9\u7236\u7C7B\u7684\u52A0\u8F7D\u5668\u53BB\u6267\u884C</strong>\uFF0C\u5982\u679C\u7236\u7C7B\u52A0\u8F7D\u5668\u8FD8\u5B58\u5728\u5176\u7236\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5219<strong>\u8FDB\u4E00\u6B65\u5411\u4E0A\u59D4\u6258\uFF0C\u4F9D\u6B21\u9012\u5F52</strong>\uFF0C** \u8BF7\u6C42\u6700\u7EC8\u5C06\u5230\u8FBE\u9876\u5C42\u7684\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668**\uFF0C\u5982\u679C\u7236\u7C7B\u52A0\u8F7D\u5668\u53EF\u4EE5\u5B8C\u6210\u7C7B\u52A0\u8F7D\u4EFB\u52A1\uFF0C\u5C31\u6210\u529F\u8FD4\u56DE\uFF0C\u5018\u82E5\u7236\u7C7B\u52A0\u8F7D\u5668\u65E0\u6CD5\u5B8C\u6210\u6B64\u52A0\u8F7D\u4EFB\u52A1\uFF0C\u5B50\u52A0\u8F7D\u5668\u624D\u4F1A\u5C1D\u8BD5\u81EA\u5DF1\u53BB\u52A0\u8F7D\uFF0C\u8FD9\u5C31\u662F\u53CC\u4EB2\u59D4\u6D3E\u6A21\u5F0F\u3002</p><p>\u53CC\u4EB2\u59D4\u6D3E\u7684\u597D\u5904</p><ul><li>\u6BCF\u4E00\u4E2A\u7C7B\u90FD\u53EA\u4F1A\u88AB\u52A0\u8F7D\u4E00\u6B21\uFF0C\u907F\u514D\u4E86\u91CD\u590D\u52A0\u8F7D</li><li>\u6BCF\u4E00\u4E2A\u7C7B\u90FD\u4F1A\u88AB\u5C3D\u53EF\u80FD\u7684\u52A0\u8F7D\uFF08\u4ECE\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668\u5F80\u4E0B\uFF0C\u6BCF\u4E2A\u52A0\u8F7D\u5668\u90FD\u53EF\u80FD\u4F1A\u6839\u636E\u4F18\u5148\u6B21\u5E8F\u5C1D\u8BD5\u52A0\u8F7D\u5B83\uFF09</li><li>\u6709\u6548\u907F\u514D\u4E86\u67D0\u4E9B\u6076\u610F\u7C7B\u7684\u52A0\u8F7D\uFF08\u6BD4\u5982\u81EA\u5B9A\u4E49\u4E86Java.lang.Object\u7C7B\uFF0C\u4E00\u822C\u800C\u8A00\u5728\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u4E0B\u4F1A\u52A0\u8F7D\u7CFB\u7EDF\u7684Object\u7C7B\u800C\u4E0D\u662F\u81EA\u5B9A\u4E49\u7684Object\u7C7B\uFF09</li></ul><p>\u53E6\u5916\uFF0C\u53EF\u4EE5\u591A\u8BB2\u4E00\u4E0B\uFF0C\u5982\u4F55\u7834\u574F\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B</p><ol><li>\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u7684\u7B2C\u4E00\u6B21\u201C\u88AB\u7834\u574F\u201D\u662F\u91CD\u5199\u81EA\u5B9A\u4E49\u52A0\u8F7D\u5668\u7684loadClass(),jdk\u4E0D\u63A8\u8350\u3002\u4E00\u822C\u90FD\u53EA\u662F\u91CD\u5199findClass()\uFF0C\u8FD9\u6837\u53EF\u4EE5\u4FDD\u6301\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236.\u800CloadClass\u65B9\u6CD5\u52A0\u8F7D\u89C4\u5219\u7531\u81EA\u5DF1\u5B9A\u4E49\uFF0C\u5C31\u53EF\u4EE5\u968F\u5FC3\u6240\u6B32\u7684\u52A0\u8F7D\u7C7B</li><li>\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u7684\u7B2C\u4E8C\u6B21\u201C\u88AB\u7834\u574F\u201D\u662FServiceLoader\u548CThread.setContextClassLoader() \u3002\u5373\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\uFF08contextClassLoader\uFF09\u3002\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u5F88\u597D\u5730\u89E3\u51B3\u4E86\u5404\u4E2A\u7C7B\u52A0\u8F7D\u5668\u7684\u57FA\u7840\u7C7B\u7EDF\u4E00\u95EE\u9898(\u8D8A\u57FA\u7840\u7684\u7C7B\u7531\u8D8A\u4E0A\u5C42\u7684\u52A0\u8F7D\u5668\u8FDB\u884C\u52A0\u8F7D) \uFF0C\u57FA\u7840\u7C7B\u4E4B\u6240\u4EE5\u88AB\u79F0\u4E3A\u201C\u57FA\u7840\u201D\uFF0C\u662F\u56E0\u4E3A\u5B83\u4EEC\u603B\u662F\u4F5C\u4E3A\u88AB\u8C03\u7528\u4EE3\u7801\u8C03\u7528\u7684API\u3002\u4F46\u662F\uFF0C\u5982\u679C\u57FA\u7840\u7C7B\u53C8\u8981\u8C03\u7528\u7528\u6237\u7684\u4EE3\u7801\uFF0C\u90A3\u8BE5\u600E\u4E48\u529E\u5462\uFF1F\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\u5C31\u51FA\u73B0\u4E86\u3002</li></ol><ul><li>SPI\u3002\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u5668\u53EF\u4EE5\u901A\u8FC7java.lang.Thread\u7C7B\u7684setContextClassLoader() \u65B9\u6CD5\u8FDB\u884C\u8BBE\u7F6E\uFF0C\u5982\u679C\u521B\u5EFA\u7EBF\u7A0B\u65F6\u8FD8\u672A\u8BBE\u7F6E\uFF0C\u5B83\u5C06\u4F1A\u4ECE\u7236\u7EBF\u7A0B\u4E2D\u7EE7\u627F\u4E00\u4E2A\uFF1B\u5982\u679C\u5728\u5E94\u7528\u7A0B\u5E8F\u7684\u5168\u5C40\u8303\u56F4\u5185\u90FD\u6CA1\u6709\u8BBE\u7F6E\u8FC7\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u5668\u9ED8\u8BA4\u5C31\u662F\u5E94\u7528\u7A0B\u5E8F\u7C7B\u52A0\u8F7D\u5668\u3002\u4E86\u6709\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\uFF0CJNDI\u670D\u52A1\u4F7F\u7528\u8FD9\u4E2A\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\u53BB\u52A0\u8F7D\u6240\u9700\u8981\u7684SPI\u4EE3\u7801\uFF0C\u4E5F\u5C31\u662F\u7236\u7C7B\u52A0\u8F7D\u5668\u8BF7\u6C42\u5B50\u7C7B\u52A0\u8F7D\u5668\u53BB\u5B8C\u6210\u7C7B\u52A0\u8F7D\u52A8\u4F5C\uFF0C\u8FD9\u79CD\u884C\u4E3A\u5B9E\u9645\u4E0A\u5C31\u662F\u6253\u901A\u4E86\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u7684\u5C42\u6B21\u7ED3\u6784\u6765\u9006\u5411\u4F7F\u7528\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5DF2\u7ECF\u8FDD\u80CC\u4E86\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\uFF0C\u4F46\u8FD9\u4E5F\u662F\u65E0\u53EF\u5948\u4F55\u7684\u4E8B\u60C5\u3002Java\u4E2D\u6240\u6709\u6D89\u53CASPI\u7684\u52A0\u8F7D\u52A8\u4F5C\u57FA\u672C\u4E0A\u90FD\u91C7\u7528\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u4F8B\u5982JNDI,JDBC,JCE,JAXB\u548CJBI\u7B49\u3002</li><li>\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u5C31\u662FAppClassLoader\uFF0C\u90A3\u4E3A\u4EC0\u4E48\u4E0D\u76F4\u63A5\u901A\u8FC7getSystemClassLoader() \u83B7\u53D6\u7C7B\u52A0\u8F7D\u5668\u6765\u52A0\u8F7Dclasspath\u8DEF\u5F84\u4E0B\u7684\u7C7B\u7684\u5462\uFF1F\u5176\u5B9E\u662F\u53EF\u884C\u7684\uFF0C\u4F46\u8FD9\u79CD\u76F4\u63A5\u4F7F\u7528getSystemClassLoader() \u65B9\u6CD5\u83B7\u53D6AppClassLoader\u52A0\u8F7D\u7C7B\u6709\u4E00\u4E2A\u7F3A\u70B9\uFF0C\u90A3\u5C31\u662F\u4EE3\u7801\u90E8\u7F72\u5230\u4E0D\u540C\u670D\u52A1\u65F6\u4F1A\u51FA\u73B0\u95EE\u9898\uFF0C\u5982\u628A\u4EE3\u7801\u90E8\u7F72\u5230Java Web\u5E94\u7528\u670D\u52A1\u6216\u8005EJB\u4E4B\u7C7B\u7684\u670D\u52A1\u5C06\u4F1A\u51FA\u95EE\u9898\uFF0C\u56E0\u4E3A\u8FD9\u4E9B\u670D\u52A1\u4F7F\u7528\u7684\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\u5E76\u975EAppClassLoader\uFF0C\u800C\u662FJava Web\u5E94\u7528\u670D\u81EA\u5BB6\u7684\u7C7B\u52A0\u8F7D\u5668\uFF0C\u7C7B\u52A0\u8F7D\u5668\u4E0D\u540C\u3002\uFF0C\u6240\u4EE5\u6211\u4EEC\u5E94\u7528\u8BE5\u5C11\u7528getSystemClassLoader() \u3002\u603B\u4E4B\u4E0D\u540C\u7684\u670D\u52A1\u4F7F\u7528\u7684\u53EF\u80FD\u9ED8\u8BA4ClassLoader\u662F\u4E0D\u540C\u7684\uFF0C\u4F46\u4F7F\u7528\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7C7B\u52A0\u8F7D\u5668\u603B\u80FD\u83B7\u53D6\u5230\u4E0E\u5F53\u524D\u7A0B\u5E8F\u6267\u884C\u76F8\u540C\u7684ClassLoader\uFF0C\u4ECE\u800C\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u95EE\u9898</li></ul><ol start="3"><li>\u53CC\u4EB2\u59D4\u6D3E\u6A21\u578B\u7684\u7B2C\u4E09\u6B21\u201C\u88AB\u7834\u574F\u201D\u662F\u7531\u4E8E\u7528\u6237\u5BF9\u7A0B\u5E8F\u52A8\u6001\u6027\u7684\u8FFD\u6C42\u5BFC\u81F4\u7684\uFF0C\u8FD9\u91CC\u6240\u8BF4\u7684\u201C\u52A8\u6001\u6027\u201D\u6307\u7684\u662F\u5F53\u524D\u4E00\u4E9B\u975E\u5E38\u201C\u70ED\u95E8\u201D\u7684\u540D\u8BCD\uFF1A\u4EE3\u7801\u70ED\u66FF\u6362\u3001\u6A21\u5757\u70ED\u90E8\u7F72\u7B49\uFF0C\u7B80\u7B54\u7684\u8BF4\u5C31\u662F\u673A\u5668\u4E0D\u7528\u91CD\u542F\uFF0C\u53EA\u8981\u90E8\u7F72\u4E0A\u5C31\u80FD\u7528\u3002</li></ol><h2 id="gc\u5982\u4F55\u5224\u65AD\u5BF9\u8C61\u53EF\u4EE5\u88AB\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#gc\u5982\u4F55\u5224\u65AD\u5BF9\u8C61\u53EF\u4EE5\u88AB\u56DE\u6536" aria-hidden="true">#</a> GC\u5982\u4F55\u5224\u65AD\u5BF9\u8C61\u53EF\u4EE5\u88AB\u56DE\u6536\uFF1F</h2><ol><li>\u5F15\u7528\u8BA1\u6570\u6CD5\uFF08\u5DF2\u88AB\u6DD8\u6C70\u7684\u7B97\u6CD5\uFF09</li></ol><ul><li>\u6BCF\u4E00\u4E2A\u5BF9\u8C61\u6709\u4E00\u4E2A\u5F15\u7528\u5C5E\u6027\uFF0C\u65B0\u589E\u4E00\u4E2A\u5F15\u7528\u65F6\u52A0\u4E00\uFF0C\u5F15\u7528\u91CA\u653E\u65F6\u51CF\u4E00\uFF0C\u8BA1\u6570\u4E3A0\u7684\u65F6\u5019\u53EF\u4EE5\u56DE\u6536\u3002</li></ul><p>\u4F46\u662F\u8FD9\u79CD\u8BA1\u7B97\u65B9\u6CD5\uFF0C\u6709\u4E00\u4E2A\u81F4\u547D\u7684\u95EE\u9898\uFF0C\u65E0\u6CD5\u89E3\u51B3\u5FAA\u73AF\u5F15\u7528\u7684\u95EE\u9898</p><ol start="2"><li>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\uFF08\u6839\u5F15\u7528\uFF09</li></ol><ul><li><p>\u4ECEGcRoot\u5F00\u59CB\u5411\u4E0B\u641C\u7D22\uFF0C\u641C\u7D22\u6240\u8D70\u8FC7\u7684\u8DEF\u5F84\u88AB\u79F0\u4E3A\u5F15\u7528\u94FE\uFF0C\u5F53\u4E00\u4E2A\u5BF9\u8C61\u5230GcRoot\u6CA1\u6709\u4EFB\u4F55\u5F15\u7528\u94FE\u76F8\u8FDE\u65F6\uFF0C\u5219\u8BC1\u660E\u6B64\u5BF9\u8C61\u662F\u4E0D\u53EF\u7528\u7684\uFF0C\u90A3\u4E48\u865A\u62DF\u673A\u5C31\u53EF\u4EE5\u5224\u5B9A\u56DE\u6536\u3002</p></li><li><p>\u90A3\u4E48GcRoot\u6709\u54EA\u4E9B\uFF1F</p></li><li><ul><li>\u865A\u62DF\u673A\u6808\u4E2D\u5F15\u7528\u7684\u5BF9\u8C61</li></ul></li><li><ul><li>\u65B9\u6CD5\u533A\u4E2D\u9759\u6001\u5C5E\u6027\u5F15\u7528\u7684\u5BF9\u8C61\u3002</li></ul></li><li><ul><li>\u65B9\u6CD5\u533A\u4E2D\u5E38\u91CF\u5F15\u7528\u7684\u5BF9\u8C61</li></ul></li><li><ul><li>\u672C\u5730\u65B9\u6CD5\u6808\u4E2D\uFF08\u5373\u4E00\u822C\u8BF4\u7684native\u65B9\u6CD5\uFF09\u5F15\u7528\u7684\u5BF9\u8C61</li></ul></li></ul><ol start="3"><li>\u6B64\u5916\uFF0C\u4E0D\u540C\u7684\u5F15\u7528\u7C7B\u578B\u7684\u56DE\u6536\u673A\u5236\u662F\u4E0D\u4E00\u6837\u7684</li></ol><ul><li><p>\u5F3A\u5F15\u7528\uFF1A\u901A\u8FC7\u5173\u952E\u5B57new\u7684\u5BF9\u8C61\u5C31\u662F\u5F3A\u5F15\u7528\u5BF9\u8C61\uFF0C\u5F3A\u5F15\u7528\u6307\u5411\u7684\u5BF9\u8C61\u4EFB\u4F55\u65F6\u5019\u90FD\u4E0D\u4F1A\u88AB\u56DE\u6536\uFF0C\u5B81\u613FOOM\u4E5F\u4E0D\u4F1A\u56DE\u6536\u3002</p></li><li><p>\u8F6F\u5F15\u7528\uFF1A\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u6301\u6709\u8F6F\u5F15\u7528\uFF0C\u90A3\u4E48\u5F53JVM\u5806\u7A7A\u95F4\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u88AB\u56DE\u6536\u3002\u4E00\u4E2A\u7C7B\u7684\u8F6F\u5F15\u7528\u53EF\u4EE5\u901A\u8FC7java.lang.ref.SoftReference\u6301\u6709\u3002</p></li><li><p>\u5F31\u5F15\u7528\uFF1A\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u6301\u6709\u5F31\u5F15\u7528\uFF0C\u90A3\u4E48\u5728GC\u65F6\uFF0C\u53EA\u8981\u53D1\u73B0\u5F31\u5F15\u7528\u5BF9\u8C61\uFF0C\u5C31\u4F1A\u88AB\u56DE\u6536\u3002\u4E00\u4E2A\u7C7B\u7684\u5F31\u5F15\u7528\u53EF\u4EE5\u901A\u8FC7java.lang.ref.WeakReference\u6301\u6709\u3002</p></li><li><p>\u865A\u5F15\u7528\uFF1A\u51E0\u4E4E\u548C\u6CA1\u6709\u4E00\u6837\uFF0C\u968F\u65F6\u53EF\u4EE5\u88AB\u56DE\u6536\u3002\u901A\u8FC7PhantomReference\u6301\u6709\u3002</p></li></ul><h2 id="\u5982\u4F55\u56DE\u6536\u5185\u5B58\u5BF9\u8C61-\u6709\u54EA\u4E9B\u56DE\u6536\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u56DE\u6536\u5185\u5B58\u5BF9\u8C61-\u6709\u54EA\u4E9B\u56DE\u6536\u7B97\u6CD5" aria-hidden="true">#</a> \u5982\u4F55\u56DE\u6536\u5185\u5B58\u5BF9\u8C61\uFF0C\u6709\u54EA\u4E9B\u56DE\u6536\u7B97\u6CD5\uFF1F</h2><p><strong>1.\u6807\u8BB0-\u6E05\u9664\uFF08Mark-Sweep\uFF09\u7B97\u6CD5</strong></p><p>\u5206\u4E3A\u6807\u8BB0\u548C\u6E05\u9664\u4E24\u4E2A\u9636\u6BB5\uFF1A\u9996\u5148\u6807\u8BB0\u51FA\u6240\u6709\u9700\u8981\u56DE\u6536\u7684\u5BF9\u8C61\uFF0C\u5728\u6807\u8BB0\u5B8C\u6210\u540E\u7EDF\u4E00\u56DE\u6536\u6240\u6709\u88AB\u6807\u8BB0\u7684\u5BF9\u8C61.</p><p>\u5B83\u7684\u4E3B\u8981\u4E0D\u8DB3\u6709\u4E24\u4E2A\uFF1A</p><ul><li>\u6548\u7387\u95EE\u9898\uFF0C\u6807\u8BB0\u548C\u6E05\u9664\u4E24\u4E2A\u8FC7\u7A0B\u7684\u6548\u7387\u90FD\u4E0D\u9AD8\u3002</li><li>\u7A7A\u95F4\u95EE\u9898\uFF0C\u6807\u8BB0\u6E05\u9664\u4E4B\u540E\u4F1A\u4EA7\u751F\u5927\u91CF\u4E0D\u8FDE\u7EED\u7684\u5185\u5B58\u788E\u7247\uFF0C\u7A7A\u95F4\u788E\u7247\u592A\u591A\u53EF\u80FD\u4F1A\u5BFC\u81F4\u4EE5\u540E\u5728\u7A0B\u5E8F\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u9700\u8981\u5206\u914D\u8F83\u5927\u5BF9\u8C61\u65F6\uFF0C\u65E0\u6CD5\u627E\u5230\u8DB3\u591F\u7684\u8FDE\u7EED\u5185\u5B58\u800C\u4E0D\u5F97\u4E0D\u63D0\u524D\u89E6\u53D1\u53E6\u4E00\u6B21\u5783\u573E\u6536\u96C6\u52A8\u4F5C\u3002</li></ul><ol start="2"><li><strong>\u590D\u5236\u7B97\u6CD5</strong></li></ol><p>\u4E3A\u4E86\u89E3\u51B3\u6548\u7387\u95EE\u9898\uFF0C\u4E00\u79CD\u79F0\u4E3A\u590D\u5236\uFF08Copying\uFF09\u7684\u6536\u96C6\u7B97\u6CD5\u51FA\u73B0\u4E86\uFF0C\u5B83\u5C06\u53EF\u7528\u5185\u5B58\u6309\u5BB9\u91CF\u5212\u5206\u4E3A\u5927\u5C0F\u76F8\u7B49\u7684\u4E24\u5757\uFF0C\u6BCF\u6B21\u53EA\u4F7F\u7528\u5176\u4E2D\u7684\u4E00\u5757\u3002\u5F53\u8FD9\u4E00\u5757\u7684\u5185\u5B58\u7528\u5B8C\u4E86\uFF0C\u5C31\u5C06\u8FD8\u5B58\u6D3B\u7740\u7684\u5BF9\u8C61\u590D\u5236\u5230\u53E6\u5916\u4E00\u5757\u4E0A\u9762\uFF0C\u7136\u540E\u518D\u628A\u5DF2\u4F7F\u7528\u8FC7\u7684\u5185\u5B58\u7A7A\u95F4\u4E00\u6B21\u6E05\u7406\u6389\u3002\u8FD9\u6837\u4F7F\u5F97\u6BCF\u6B21\u90FD\u662F\u5BF9\u6574\u4E2A\u534A\u533A\u8FDB\u884C\u5185\u5B58\u56DE\u6536\uFF0C\u5185\u5B58\u5206\u914D\u65F6\u4E5F\u5C31\u4E0D\u7528\u8003\u8651\u5185\u5B58\u788E\u7247\u7B49\u590D\u6742\u60C5\u51B5\uFF0C\u53EA\u8981\u79FB\u52A8\u5806\u9876\u6307\u9488\uFF0C\u6309\u987A\u5E8F\u5206\u914D\u5185\u5B58\u5373\u53EF\uFF0C\u5B9E\u73B0\u7B80\u5355\uFF0C\u8FD0\u884C\u9AD8\u6548\u3002 <strong>\u590D\u5236\u7B97\u6CD5\u7684\u4EE3\u4EF7</strong>\u662F\u5C06\u5185\u5B58\u7F29\u5C0F\u4E3A\u4E86\u539F\u6765\u7684\u4E00\u534A\uFF0C\u51CF\u5C11\u4E86\u5B9E\u9645\u53EF\u7528\u7684\u5185\u5B58\u3002\u73B0\u5728\u7684\u5546\u4E1A\u865A\u62DF\u673A\u90FD\u91C7\u7528\u8FD9\u79CD\u6536\u96C6\u7B97\u6CD5\u6765\u56DE\u6536\u65B0\u751F\u4EE3\uFF0CIBM\u516C\u53F8\u7684\u4E13\u95E8\u7814\u7A76\u8868\u660E\uFF0C\u65B0\u751F\u4EE3\u4E2D\u7684\u5BF9\u8C6198%\u662F\u201C\u671D\u751F\u5915\u6B7B\u201D\u7684\uFF0C\u6240\u4EE5\u5E76\u4E0D\u9700\u8981\u6309\u71671: 1\u7684\u6BD4\u4F8B\u6765\u5212\u5206\u5185\u5B58\u7A7A\u95F4\uFF0C\u800C\u662F\u5C06\u5185\u5B58\u5206\u4E3A\u4E00\u5757\u8F83\u5927\u7684Eden\u7A7A\u95F4\u548C\u4E24\u5757\u8F83\u5C0F\u7684Survivor\u7A7A\u95F4\uFF0C\u6BCF\u6B21\u4F7F\u7528Eden\u548C\u5176\u4E2D\u4E00\u5757Survivor\u3002\u5F53\u56DE\u6536\u65F6\uFF0C\u5C06Eden\u548CSurvivor\u4E2D\u8FD8\u5B58\u6D3B\u7740\u7684\u5BF9\u8C61\u4E00\u6B21\u6027\u5730\u590D\u5236\u5230\u53E6\u5916\u4E00\u5757Survivor\u7A7A\u95F4\u4E0A\uFF0C\u6700\u540E\u6E05\u7406\u6389Eden\u548C\u521A\u624D\u7528\u8FC7\u7684Survivor\u7A7A\u95F4\u3002HotSpot\u865A\u62DF\u673A\u9ED8\u8BA4Eden\u548CSurvivor\u7684\u5927\u5C0F\u6BD4\u4F8B\u662F8: 1\uFF0C\u4E5F\u5C31\u662F\u6BCF\u6B21\u65B0\u751F\u4EE3\u4E2D\u53EF\u7528\u5185\u5B58\u7A7A\u95F4\u4E3A\u6574\u4E2A\u65B0\u751F\u4EE3\u5BB9\u91CF\u768490%\uFF0880%+10%\uFF09\uFF0C\u53EA\u670910%\u7684\u5185\u5B58\u4F1A\u88AB\u201C\u6D6A\u8D39\u201D\u3002\u5F53\u7136\uFF0C98%\u7684\u5BF9\u8C61\u53EF\u56DE\u6536\u53EA\u662F\u4E00\u822C\u573A\u666F\u4E0B\u7684\u6570\u636E\uFF0C\u6211\u4EEC\u6CA1\u6709\u529E\u6CD5\u4FDD\u8BC1\u6BCF\u6B21\u56DE\u6536\u90FD\u53EA\u6709\u4E0D\u591A\u4E8E10%\u7684\u5BF9\u8C61\u5B58\u6D3B\uFF0C\u5F53Survivor\u7A7A\u95F4\u4E0D\u591F\u7528\u65F6\uFF0C\u9700\u8981\u4F9D\u8D56\u5176\u4ED6\u5185\u5B58\uFF08\u8FD9\u91CC\u6307\u8001\u5E74\u4EE3\uFF09\u8FDB\u884C\u5206\u914D\u62C5\u4FDD\uFF08Handle Promotion\uFF09\u3002</p><ol start="3"><li><strong>\u6807\u8BB0-\u6574\u7406\u7B97\u6CD5</strong></li></ol><p>\u590D\u5236\u6536\u96C6\u7B97\u6CD5\u5728\u5BF9\u8C61\u5B58\u6D3B\u7387\u8F83\u9AD8\u65F6\u5C31\u8981\u8FDB\u884C\u8F83\u591A\u7684\u590D\u5236\u64CD\u4F5C\uFF0C\u6548\u7387\u5C06\u4F1A\u53D8\u4F4E\u3002\u66F4\u5173\u952E\u7684\u662F\uFF0C\u5982\u679C\u4E0D\u60F3\u6D6A\u8D3950%\u7684\u7A7A\u95F4\uFF0C\u5C31\u9700\u8981\u6709\u989D\u5916\u7684\u7A7A\u95F4\u8FDB\u884C\u5206\u914D\u62C5\u4FDD\uFF0C\u4EE5\u5E94\u5BF9\u88AB\u4F7F\u7528\u7684\u5185\u5B58\u4E2D\u6240\u6709\u5BF9\u8C61\u90FD100%\u5B58\u6D3B\u7684\u6781\u7AEF\u60C5\u51B5\uFF0C\u6240\u4EE5\u5728\u8001\u5E74\u4EE3\u4E00\u822C\u4E0D\u80FD\u76F4\u63A5\u9009\u7528\u8FD9\u79CD\u7B97\u6CD5\u3002\u6839\u636E\u8001\u5E74\u4EE3\u7684\u7279\u70B9\uFF0C\u6709\u4EBA\u63D0\u51FA\u4E86\u53E6\u5916\u4E00\u79CD\u6807\u8BB0-\u6574\u7406\uFF08Mark-Compact\uFF09\u7B97\u6CD5\uFF0C\u6807\u8BB0\u8FC7\u7A0B\u4ECD\u7136\u4E0E\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5\u4E00\u6837\uFF0C\u4F46\u540E\u7EED\u6B65\u9AA4\u4E0D\u662F\u76F4\u63A5\u5BF9\u53EF\u56DE\u6536\u5BF9\u8C61\u8FDB\u884C\u6E05\u7406\uFF0C\u800C\u662F\u8BA9\u6240\u6709\u5B58\u6D3B\u7684\u5BF9\u8C61\u90FD\u5411\u4E00\u7AEF\u79FB\u52A8\uFF0C\u7136\u540E\u76F4\u63A5\u6E05\u7406\u6389\u7AEF\u8FB9\u754C\u4EE5\u5916\u7684\u5185\u5B58\u3002</p><ol start="4"><li><strong>\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5</strong></li></ol><p>\u5F53\u524D\u5546\u4E1A\u865A\u62DF\u673A\u7684\u5783\u573E\u6536\u96C6\u90FD\u91C7\u7528\u5206\u4EE3\u6536\u96C6\uFF08Generational Collection\uFF09\u7B97\u6CD5\uFF0C\u8FD9\u79CD\u7B97\u6CD5\u5E76\u6CA1\u6709\u4EC0\u4E48\u65B0\u7684\u601D\u60F3\uFF0C\u53EA\u662F\u6839\u636E\u5BF9\u8C61\u5B58\u6D3B\u5468\u671F\u7684\u4E0D\u540C\u5C06\u5185\u5B58\u5212\u5206\u4E3A\u51E0\u5757\u3002\u4E00\u822C\u662F\u628AJava\u5806\u5206\u4E3A\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u6839\u636E\u5404\u4E2A\u5E74\u4EE3\u7684\u7279\u70B9\u91C7\u7528\u6700\u9002\u5F53\u7684\u6536\u96C6\u7B97\u6CD5\u3002\u5728\u65B0\u751F\u4EE3\u4E2D\uFF0C\u6BCF\u6B21\u5783\u573E\u6536\u96C6\u65F6\u90FD\u53D1\u73B0\u6709\u5927\u6279\u5BF9\u8C61\u6B7B\u53BB\uFF0C\u53EA\u6709\u5C11\u91CF\u5B58\u6D3B\uFF0C\u90A3\u5C31\u9009\u7528\u590D\u5236\u7B97\u6CD5\uFF0C\u53EA\u9700\u8981\u4ED8\u51FA\u5C11\u91CF\u5B58\u6D3B\u5BF9\u8C61\u7684\u590D\u5236\u6210\u672C\u5C31\u53EF\u4EE5\u5B8C\u6210\u6536\u96C6\u3002\u800C\u8001\u5E74\u4EE3\u4E2D\u56E0\u4E3A\u5BF9\u8C61\u5B58\u6D3B\u7387\u9AD8\u3001\u6CA1\u6709\u989D\u5916\u7A7A\u95F4\u5BF9\u5B83\u8FDB\u884C\u5206\u914D\u62C5\u4FDD\uFF0C\u5C31\u5FC5\u987B\u4F7F\u7528\u6807\u8BB0\u2014\u6E05\u7406\u6216\u8005\u6807\u8BB0\u2014\u6574\u7406\u7B97\u6CD5\u6765\u8FDB\u884C\u56DE\u6536\u3002</p><h2 id="jvm\u6709\u54EA\u4E9B\u5783\u573E\u56DE\u6536\u5668-\u5B9E\u9645\u4E2D\u5982\u4F55\u9009\u62E9" tabindex="-1"><a class="header-anchor" href="#jvm\u6709\u54EA\u4E9B\u5783\u573E\u56DE\u6536\u5668-\u5B9E\u9645\u4E2D\u5982\u4F55\u9009\u62E9" aria-hidden="true">#</a> jvm\u6709\u54EA\u4E9B\u5783\u573E\u56DE\u6536\u5668\uFF0C\u5B9E\u9645\u4E2D\u5982\u4F55\u9009\u62E9\uFF1F</h2><p>\u56FE\u4E2D\u5C55\u793A\u4E867\u79CD\u4F5C\u7528\u4E8E\u4E0D\u540C\u5206\u4EE3\u7684\u6536\u96C6\u5668\uFF0C\u5982\u679C\u4E24\u4E2A\u6536\u96C6\u5668\u4E4B\u95F4\u5B58\u5728\u8FDE\u7EBF\uFF0C\u5219\u8BF4\u660E\u5B83\u4EEC\u53EF\u4EE5\u642D\u914D\u4F7F\u7528\u3002\u865A\u62DF\u673A\u6240\u5904\u7684\u533A\u57DF\u5219\u8868\u793A\u5B83\u662F\u5C5E\u4E8E\u65B0\u751F\u4EE3\u8FD8\u662F\u8001\u5E74\u4EE3\u6536\u96C6\u5668\u3002</p><p>\u65B0\u751F\u4EE3\u6536\u96C6\u5668\uFF08\u5168\u90E8\u7684\u90FD\u662F\u590D\u5236\u7B97\u6CD5\uFF09\uFF1ASerial\u3001ParNew\u3001Parallel Scavenge</p><p>\u8001\u5E74\u4EE3\u6536\u96C6\u5668\uFF1ACMS\uFF08\u6807\u8BB0-\u6E05\u7406\uFF09\u3001Serial Old\uFF08\u6807\u8BB0-\u6574\u7406\uFF09\u3001Parallel Old\uFF08\u6807\u8BB0\u6574\u7406\uFF09</p><p>\u6574\u5806\u6536\u96C6\u5668\uFF1A G1\uFF08\u4E00\u4E2ARegion\u4E2D\u662F\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5\uFF0C2\u4E2ARegion\u4E4B\u95F4\u662F\u590D\u5236\u7B97\u6CD5\uFF09</p><p>\u540C\u65F6\uFF0C\u5148\u89E3\u91CA\u51E0\u4E2A\u540D\u8BCD\uFF1A</p><ol><li><strong>\u5E76\u884C\uFF08Parallel\uFF09</strong>\uFF1A\u591A\u4E2A\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u5E76\u884C\u5DE5\u4F5C\uFF0C\u6B64\u65F6\u7528\u6237\u7EBF\u7A0B\u5904\u4E8E\u7B49\u5F85\u72B6\u6001</li><li><strong>\u5E76\u53D1\uFF08Concurrent\uFF09</strong>\uFF1A\u7528\u6237\u7EBF\u7A0B\u548C\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u540C\u65F6\u6267\u884C</li><li><strong>\u541E\u5410\u91CF</strong>\uFF1A\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4\uFF0F\uFF08\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4\uFF0B\u5783\u573E\u56DE\u6536\u65F6\u95F4\uFF09</li></ol><p><strong>1.Serial\u6536\u96C6\u5668\u662F\u6700\u57FA\u672C\u7684\u3001\u53D1\u5C55\u5386\u53F2\u6700\u60A0\u4E45\u7684\u6536\u96C6\u5668\u3002</strong></p><p><strong>\u7279\u70B9\uFF1A</strong> \u5355\u7EBF\u7A0B\u3001\u7B80\u5355\u9AD8\u6548\uFF08\u4E0E\u5176\u4ED6\u6536\u96C6\u5668\u7684\u5355\u7EBF\u7A0B\u76F8\u6BD4\uFF09\uFF0C\u5BF9\u4E8E\u9650\u5B9A\u5355\u4E2ACPU\u7684\u73AF\u5883\u6765\u8BF4\uFF0CSerial\u6536\u96C6\u5668\u7531\u4E8E\u6CA1\u6709\u7EBF\u7A0B\u4EA4\u4E92\u7684\u5F00\u9500\uFF0C\u4E13\u5FC3\u505A\u5783\u573E\u6536\u96C6\u81EA\u7136\u53EF\u4EE5\u83B7\u5F97\u6700\u9AD8\u7684\u5355\u7EBF\u7A0B\u624B\u673A\u6548\u7387\u3002\u6536\u96C6\u5668\u8FDB\u884C\u5783\u573E\u56DE\u6536\u65F6\uFF0C\u5FC5\u987B\u6682\u505C\u5176\u4ED6\u6240\u6709\u7684\u5DE5\u4F5C\u7EBF\u7A0B\uFF0C\u76F4\u5230\u5B83\u7ED3\u675F\uFF08Stop The World\uFF09\u3002</p><p><strong>\u5E94\u7528\u573A\u666F</strong>\uFF1A\u9002\u7528\u4E8EClient\u6A21\u5F0F\u4E0B\u7684\u865A\u62DF\u673A\u3002</p><p>Serial / Serial Old\u6536\u96C6\u5668\u8FD0\u884C\u793A\u610F\u56FE:</p><p><strong>2.ParNew\u6536\u96C6\u5668\u5176\u5B9E\u5C31\u662FSerial\u6536\u96C6\u5668\u7684\u591A\u7EBF\u7A0B\u7248\u672C\u3002</strong></p><p>\u9664\u4E86\u4F7F\u7528\u591A\u7EBF\u7A0B\u5916\u5176\u4F59\u884C\u4E3A\u5747\u548CSerial\u6536\u96C6\u5668\u4E00\u6A21\u4E00\u6837\uFF08\u53C2\u6570\u63A7\u5236\u3001\u6536\u96C6\u7B97\u6CD5\u3001Stop The World\u3001\u5BF9\u8C61\u5206\u914D\u89C4\u5219\u3001\u56DE\u6536\u7B56\u7565\u7B49\uFF09\u3002</p><p><strong>\u7279\u70B9</strong>\uFF1A\u591A\u7EBF\u7A0B\u3001ParNew\u6536\u96C6\u5668\u9ED8\u8BA4\u5F00\u542F\u7684\u6536\u96C6\u7EBF\u7A0B\u6570\u4E0ECPU\u7684\u6570\u91CF\u76F8\u540C\uFF0C\u5728CPU\u975E\u5E38\u591A\u7684\u73AF\u5883\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528-XX:ParallelGCThreads\u53C2\u6570\u6765\u9650\u5236\u5783\u573E\u6536\u96C6\u7684\u7EBF\u7A0B\u6570\u3002 \u548CSerial\u6536\u96C6\u5668\u4E00\u6837\u5B58\u5728Stop The World\u95EE\u9898</p><p><strong>\u5E94\u7528\u573A\u666F</strong>\uFF1AParNew\u6536\u96C6\u5668\u662F\u8BB8\u591A\u8FD0\u884C\u5728Server\u6A21\u5F0F\u4E0B\u7684\u865A\u62DF\u673A\u4E2D\u9996\u9009\u7684\u65B0\u751F\u4EE3\u6536\u96C6\u5668\uFF0C\u56E0\u4E3A\u5B83\u662F\u9664\u4E86Serial\u6536\u96C6\u5668\u5916\uFF0C\u552F\u4E00\u4E00\u4E2A\u80FD\u4E0ECMS\u6536\u96C6\u5668\u914D\u5408\u5DE5\u4F5C\u7684\u3002</p><p><em>ParNew/Serial Old\u7EC4\u5408\u6536\u96C6\u5668\u8FD0\u884C\u793A\u610F\u56FE\u5982\u4E0B\uFF1A</em></p><p><strong>3.Parallel Scavenge \u6536\u96C6\u5668\u4E0E\u541E\u5410\u91CF\u5173\u7CFB\u5BC6\u5207\uFF0C\u6545\u4E5F\u79F0\u4E3A\u541E\u5410\u91CF\u4F18\u5148\u6536\u96C6\u5668\u3002</strong></p><p><strong>\u7279\u70B9</strong>\uFF1A\u5C5E\u4E8E\u65B0\u751F\u4EE3\u6536\u96C6\u5668\u4E5F\u662F\u91C7\u7528\u590D\u5236\u7B97\u6CD5\u7684\u6536\u96C6\u5668\uFF0C\u53C8\u662F\u5E76\u884C\u7684\u591A\u7EBF\u7A0B\u6536\u96C6\u5668\uFF08\u4E0EParNew\u6536\u96C6\u5668\u7C7B\u4F3C\uFF09\u3002 \u8BE5\u6536\u96C6\u5668\u7684\u76EE\u6807\u662F\u8FBE\u5230\u4E00\u4E2A\u53EF\u63A7\u5236\u7684\u541E\u5410\u91CF\u3002\u8FD8\u6709\u4E00\u4E2A\u503C\u5F97\u5173\u6CE8\u7684\u70B9\u662F\uFF1AGC\u81EA\u9002\u5E94\u8C03\u8282\u7B56\u7565\uFF08\u4E0EParNew\u6536\u96C6\u5668\u6700\u91CD\u8981\u7684\u4E00\u4E2A\u533A\u522B\uFF09</p><p><strong>GC\u81EA\u9002\u5E94\u8C03\u8282\u7B56\u7565</strong>\uFF1AParallel Scavenge\u6536\u96C6\u5668\u53EF\u8BBE\u7F6E-XX:+UseAdptiveSizePolicy\u53C2\u6570\u3002\u5F53\u5F00\u5173\u6253\u5F00\u65F6\u4E0D\u9700\u8981\u624B\u52A8\u6307\u5B9A\u65B0\u751F\u4EE3\u7684\u5927\u5C0F\uFF08-Xmn\uFF09\u3001Eden\u4E0ESurvivor\u533A\u7684\u6BD4\u4F8B\uFF08-XX: SurvivorRation\uFF09\u3001\u664B\u5347\u8001\u5E74\u4EE3\u7684\u5BF9\u8C61\u5E74\u9F84\uFF08-XX:PretenureSizeThreshold) \u7B49\uFF0C\u865A\u62DF\u673A\u4F1A\u6839\u636E\u7CFB\u7EDF\u7684\u8FD0\u884C\u72B6\u51B5\u6536\u96C6\u6027\u80FD\u76D1\u63A7\u4FE1\u606F\uFF0C\u52A8\u6001\u8BBE\u7F6E\u8FD9\u4E9B\u53C2\u6570\u4EE5\u63D0\u4F9B\u6700\u4F18\u7684\u505C\u987F\u65F6\u95F4\u548C\u6700\u9AD8\u7684\u541E\u5410\u91CF\uFF0C\u8FD9\u79CD\u8C03\u8282\u65B9\u5F0F\u79F0\u4E3AGC\u7684\u81EA\u9002\u5E94\u8C03\u8282\u7B56\u7565\u3002</p><p>Parallel Scavenge\u6536\u96C6\u5668\u4F7F\u7528\u4E24\u4E2A\u53C2\u6570\u63A7\u5236\u541E\u5410\u91CF\uFF1A</p><ul><li>XX:MaxGCPauseMillis \u63A7\u5236\u6700\u5927\u7684\u5783\u573E\u6536\u96C6\u505C\u987F\u65F6\u95F4</li><li>XX:GCRatio \u76F4\u63A5\u8BBE\u7F6E\u541E\u5410\u91CF\u7684\u5927\u5C0F\u3002</li></ul><p><strong>4.Serial Old\u662FSerial\u6536\u96C6\u5668\u7684\u8001\u5E74\u4EE3\u7248\u672C\u3002</strong></p><p><strong>\u7279\u70B9</strong>\uFF1A\u540C\u6837\u662F\u5355\u7EBF\u7A0B\u6536\u96C6\u5668\uFF0C\u91C7\u7528\u6807\u8BB0-\u6574\u7406\u7B97\u6CD5\u3002</p><p><strong>\u5E94\u7528\u573A\u666F</strong>\uFF1A\u4E3B\u8981\u4E5F\u662F\u4F7F\u7528\u5728Client\u6A21\u5F0F\u4E0B\u7684\u865A\u62DF\u673A\u4E2D\u3002\u4E5F\u53EF\u5728Server\u6A21\u5F0F\u4E0B\u4F7F\u7528\u3002 Server\u6A21\u5F0F\u4E0B\u4E3B\u8981\u7684\u4E24\u5927\u7528\u9014</p><ol><li>\u5728JDK1.5\u4EE5\u53CA\u4EE5\u524D\u7684\u7248\u672C\u4E2D\u4E0EParallel Scavenge\u6536\u96C6\u5668\u642D\u914D\u4F7F\u7528\u3002</li><li>\u4F5C\u4E3ACMS\u6536\u96C6\u5668\u7684\u540E\u5907\u65B9\u6848\uFF0C\u5728\u5E76\u53D1\u6536\u96C6Concurent Mode Failure\u65F6\u4F7F\u7528\u3002</li></ol><p>Serial / Serial Old\u6536\u96C6\u5668\u5DE5\u4F5C\u8FC7\u7A0B\u56FE\uFF08Serial\u6536\u96C6\u5668\u56FE\u793A\u76F8\u540C\uFF09\uFF1A</p><p><strong>5.Parallel Old\u662FParallel Scavenge\u6536\u96C6\u5668\u7684\u8001\u5E74\u4EE3\u7248\u672C\u3002</strong></p><p><strong>\u7279\u70B9</strong>\uFF1A\u591A\u7EBF\u7A0B\uFF0C\u91C7\u7528\u6807\u8BB0-\u6574\u7406\u7B97\u6CD5\u3002</p><p><strong>\u5E94\u7528\u573A\u666F</strong>\uFF1A\u6CE8\u91CD\u9AD8\u541E\u5410\u91CF\u4EE5\u53CACPU\u8D44\u6E90\u654F\u611F\u7684\u573A\u5408\uFF0C\u90FD\u53EF\u4EE5\u4F18\u5148\u8003\u8651Parallel Scavenge+Parallel Old \u6536\u96C6\u5668\u3002</p><p><em>Parallel Scavenge/Parallel Old\u6536\u96C6\u5668\u5DE5\u4F5C\u8FC7\u7A0B\u56FE\uFF1A</em></p><p><strong>6.CMS\u6536\u96C6\u5668\u662F\u4E00\u79CD\u4EE5\u83B7\u53D6\u6700\u77ED\u56DE\u6536\u505C\u987F\u65F6\u95F4\u4E3A\u76EE\u6807\u7684\u6536\u96C6\u5668\u3002</strong></p><p><strong>\u7279\u70B9</strong>\uFF1A\u57FA\u4E8E\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5\u5B9E\u73B0\u3002\u5E76\u53D1\u6536\u96C6\u3001\u4F4E\u505C\u987F\u3002</p><p><strong>\u5E94\u7528\u573A\u666F</strong>\uFF1A\u9002\u7528\u4E8E\u6CE8\u91CD\u670D\u52A1\u7684\u54CD\u5E94\u901F\u5EA6\uFF0C\u5E0C\u671B\u7CFB\u7EDF\u505C\u987F\u65F6\u95F4\u6700\u77ED\uFF0C\u7ED9\u7528\u6237\u5E26\u6765\u66F4\u597D\u7684\u4F53\u9A8C\u7B49\u573A\u666F\u4E0B\u3002\u5982web\u7A0B\u5E8F\u3001b/s\u670D\u52A1\u3002</p><p><strong>CMS\u6536\u96C6\u5668\u7684\u8FD0\u884C\u8FC7\u7A0B\u5206\u4E3A\u4E0B\u52174\u6B65\uFF1A</strong></p><ol><li><strong>\u521D\u59CB\u6807\u8BB0</strong>\uFF1A\u6807\u8BB0GC Roots\u80FD\u76F4\u63A5\u5230\u7684\u5BF9\u8C61\u3002\u901F\u5EA6\u5F88\u5FEB\u4F46\u662F\u4ECD\u5B58\u5728Stop The World\u95EE\u9898\u3002</li><li><strong>\u5E76\u53D1\u6807\u8BB0</strong>\uFF1A\u8FDB\u884CGC Roots Tracing \u7684\u8FC7\u7A0B\uFF0C\u627E\u51FA\u5B58\u6D3B\u5BF9\u8C61\u4E14\u7528\u6237\u7EBF\u7A0B\u53EF\u5E76\u53D1\u6267\u884C\u3002</li><li><strong>\u91CD\u65B0\u6807\u8BB0</strong>\uFF1A\u4E3A\u4E86\u4FEE\u6B63\u5E76\u53D1\u6807\u8BB0\u671F\u95F4\u56E0\u7528\u6237\u7A0B\u5E8F\u7EE7\u7EED\u8FD0\u884C\u800C\u5BFC\u81F4\u6807\u8BB0\u4EA7\u751F\u53D8\u52A8\u7684\u90A3\u4E00\u90E8\u5206\u5BF9\u8C61\u7684\u6807\u8BB0\u8BB0\u5F55\u3002\u4ECD\u7136\u5B58\u5728Stop The World\u95EE\u9898\u3002</li><li><strong>\u5E76\u53D1\u6E05\u9664</strong>\uFF1A\u5BF9\u6807\u8BB0\u7684\u5BF9\u8C61\u8FDB\u884C\u6E05\u9664\u56DE\u6536\u3002</li></ol><p>CMS\u6536\u96C6\u5668\u7684\u5185\u5B58\u56DE\u6536\u8FC7\u7A0B\u662F\u4E0E\u7528\u6237\u7EBF\u7A0B\u4E00\u8D77\u5E76\u53D1\u6267\u884C\u7684\u3002</p><p>CMS\u6536\u96C6\u5668\u7684\u5DE5\u4F5C\u8FC7\u7A0B\u56FE\uFF1A</p><p>CMS\u6536\u96C6\u5668\u7684\u7F3A\u70B9\uFF1A</p><ul><li>\u5BF9CPU\u8D44\u6E90\u975E\u5E38\u654F\u611F\u3002</li><li>\u65E0\u6CD5\u5904\u7406\u6D6E\u52A8\u5783\u573E\uFF0C\u53EF\u80FD\u51FA\u73B0Concurrent Model Failure\u5931\u8D25\u800C\u5BFC\u81F4\u53E6\u4E00\u6B21Full GC\u7684\u4EA7\u751F\u3002</li><li>\u56E0\u4E3A\u91C7\u7528\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5\u6240\u4EE5\u4F1A\u5B58\u5728\u7A7A\u95F4\u788E\u7247\u7684\u95EE\u9898\uFF0C\u5BFC\u81F4\u5927\u5BF9\u8C61\u65E0\u6CD5\u5206\u914D\u7A7A\u95F4\uFF0C\u4E0D\u5F97\u4E0D\u63D0\u524D\u89E6\u53D1\u4E00\u6B21Full GC\u3002</li></ul><p><strong>7.G1\u6536\u96C6\u5668\u4E00\u6B3E\u9762\u5411\u670D\u52A1\u7AEF\u5E94\u7528\u7684\u5783\u573E\u6536\u96C6\u5668\u3002</strong></p><p><strong>\u7279\u70B9\u5982\u4E0B\uFF1A</strong></p><p>\u5E76\u884C\u4E0E\u5E76\u53D1\uFF1AG1\u80FD\u5145\u5206\u5229\u7528\u591ACPU\u3001\u591A\u6838\u73AF\u5883\u4E0B\u7684\u786C\u4EF6\u4F18\u52BF\uFF0C\u4F7F\u7528\u591A\u4E2ACPU\u6765\u7F29\u77EDStop-The-World\u505C\u987F\u65F6\u95F4\u3002\u90E8\u5206\u6536\u96C6\u5668\u539F\u672C\u9700\u8981\u505C\u987FJava\u7EBF\u7A0B\u6765\u6267\u884CGC\u52A8\u4F5C\uFF0CG1\u6536\u96C6\u5668\u4ECD\u7136\u53EF\u4EE5\u901A\u8FC7\u5E76\u53D1\u7684\u65B9\u5F0F\u8BA9Java\u7A0B\u5E8F\u7EE7\u7EED\u8FD0\u884C\u3002 \u5206\u4EE3\u6536\u96C6\uFF1AG1\u80FD\u591F\u72EC\u81EA\u7BA1\u7406\u6574\u4E2AJava\u5806\uFF0C\u5E76\u4E14\u91C7\u7528\u4E0D\u540C\u7684\u65B9\u5F0F\u53BB\u5904\u7406\u65B0\u521B\u5EFA\u7684\u5BF9\u8C61\u548C\u5DF2\u7ECF\u5B58\u6D3B\u4E86\u4E00\u6BB5\u65F6\u95F4\u3001\u71AC\u8FC7\u591A\u6B21GC\u7684\u65E7\u5BF9\u8C61\u4EE5\u83B7\u53D6\u66F4\u597D\u7684\u6536\u96C6\u6548\u679C\u3002 \u7A7A\u95F4\u6574\u5408\uFF1AG1\u8FD0\u4F5C\u671F\u95F4\u4E0D\u4F1A\u4EA7\u751F\u7A7A\u95F4\u788E\u7247\uFF0C\u6536\u96C6\u540E\u80FD\u63D0\u4F9B\u89C4\u6574\u7684\u53EF\u7528\u5185\u5B58\u3002 \u53EF\u9884\u6D4B\u7684\u505C\u987F\uFF1AG1\u9664\u4E86\u8FFD\u6C42\u4F4E\u505C\u987F\u5916\uFF0C\u8FD8\u80FD\u5EFA\u7ACB\u53EF\u9884\u6D4B\u7684\u505C\u987F\u65F6\u95F4\u6A21\u578B\u3002\u80FD\u8BA9\u4F7F\u7528\u8005\u660E\u786E\u6307\u5B9A\u5728\u4E00\u4E2A\u957F\u5EA6\u4E3AM\u6BEB\u79D2\u7684\u65F6\u95F4\u6BB5\u5185\uFF0C\u6D88\u8017\u5728\u5783\u573E\u6536\u96C6\u4E0A\u7684\u65F6\u95F4\u4E0D\u5F97\u8D85\u8FC7N\u6BEB\u79D2\u3002</p><p><strong>G1\u6536\u96C6\u5668\u8FD0\u884C\u793A\u610F\u56FE\uFF1A</strong></p><p>\u5173\u4E8Egc\u7684\u9009\u62E9 \u9664\u975E\u5E94\u7528\u7A0B\u5E8F\u6709\u975E\u5E38\u4E25\u683C\u7684\u6682\u505C\u65F6\u95F4\u8981\u6C42\uFF0C\u5426\u5219\u8BF7\u5148\u8FD0\u884C\u5E94\u7528\u7A0B\u5E8F\u5E76\u5141\u8BB8VM\u9009\u62E9\u6536\u96C6\u5668\uFF08\u5982\u679C\u6CA1\u6709\u7279\u522B\u8981\u6C42\u3002\u4F7F\u7528VM\u63D0\u4F9B\u7ED9\u7684\u9ED8\u8BA4GC\u5C31\u597D\uFF09\u3002 \u5982\u6709\u5FC5\u8981\uFF0C\u8C03\u6574\u5806\u5927\u5C0F\u4EE5\u63D0\u9AD8\u6027\u80FD\u3002 \u5982\u679C\u6027\u80FD\u4ECD\u7136\u4E0D\u80FD\u6EE1\u8DB3\u76EE\u6807\uFF0C\u8BF7\u4F7F\u7528\u4EE5\u4E0B\u51C6\u5219\u4F5C\u4E3A\u9009\u62E9\u6536\u96C6\u5668\u7684\u8D77\u70B9\uFF1A</p><ul><li>\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u7684\u6570\u636E\u96C6\u8F83\u5C0F\uFF08\u6700\u5927\u7EA6100 MB\uFF09\uFF0C\u5219\u9009\u62E9\u5E26\u6709\u9009\u9879-XX\uFF1A+ UseSerialGC\u7684\u4E32\u884C\u6536\u96C6\u5668\u3002</li><li>\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u5C06\u5728\u5355\u4E2A\u5904\u7406\u5668\u4E0A\u8FD0\u884C\uFF0C\u5E76\u4E14\u6CA1\u6709\u6682\u505C\u65F6\u95F4\u8981\u6C42\uFF0C\u5219\u9009\u62E9\u5E26\u6709\u9009\u9879-XX\uFF1A+ UseSerialGC\u7684\u4E32\u884C\u6536\u96C6\u5668\u3002</li><li>\u5982\u679C\uFF08a\uFF09\u5CF0\u503C\u5E94\u7528\u7A0B\u5E8F\u6027\u80FD\u662F\u7B2C\u4E00\u8981\u52A1\uFF0C\u5E76\u4E14\uFF08b\uFF09\u6CA1\u6709\u6682\u505C\u65F6\u95F4\u8981\u6C42\u6216\u53EF\u63A5\u53D7\u4E00\u79D2\u6216\u66F4\u957F\u65F6\u95F4\u7684\u6682\u505C\uFF0C\u5219\u8BA9VM\u9009\u62E9\u6536\u96C6\u5668\u6216\u4F7F\u7528-XX\uFF1A+ UseParallelGC\u9009\u62E9\u5E76\u884C\u6536\u96C6\u5668 \u3002</li><li>\u5982\u679C\u54CD\u5E94\u65F6\u95F4\u6BD4\u6574\u4F53\u541E\u5410\u91CF\u66F4\u91CD\u8981\uFF0C\u5E76\u4E14\u5783\u573E\u6536\u96C6\u6682\u505C\u65F6\u95F4\u5FC5\u987B\u4FDD\u6301\u5728\u5927\u7EA6\u4E00\u79D2\u949F\u4EE5\u5185\uFF0C\u5219\u9009\u62E9\u5177\u6709-XX\uFF1A+ UseG1GC\u3002\uFF08\u503C\u5F97\u6CE8\u610F\u7684\u662FJDK9\u4E2DCMS\u5DF2\u7ECF\u88ABDeprecated\uFF0C\u4E0D\u53EF\u4F7F\u7528\uFF01\u79FB\u9664\u8BE5\u9009\u9879\uFF09</li><li>\u5982\u679C\u4F7F\u7528\u7684\u662Fjdk8\uFF0C\u5E76\u4E14\u5806\u5185\u5B58\u8FBE\u5230\u4E8616G\uFF0C\u90A3\u4E48\u63A8\u8350\u4F7F\u7528G1\u6536\u96C6\u5668\uFF0C\u6765\u63A7\u5236\u6BCF\u6B21\u5783\u573E\u6536\u96C6\u7684\u65F6\u95F4\u3002</li><li>\u5982\u679C\u54CD\u5E94\u65F6\u95F4\u662F\u9AD8\u4F18\u5148\u7EA7\uFF0C\u6216\u4F7F\u7528\u7684\u5806\u975E\u5E38\u5927\uFF0C\u8BF7\u4F7F\u7528-XX\uFF1AUseZGC\u9009\u62E9\u5B8C\u5168\u5E76\u53D1\u7684\u6536\u96C6\u5668\u3002\uFF08\u503C\u5F97\u6CE8\u610F\u7684\u662FJDK11\u5F00\u59CB\u53EF\u4EE5\u542F\u52A8ZGC\uFF0C\u4F46\u662F\u6B64\u65F6ZGC\u5177\u6709\u5B9E\u9A8C\u6027\u8D28\uFF0C\u5728JDK15\u4E2D[202009\u53D1\u5E03] \u624D\u53D6\u6D88\u5B9E\u9A8C\u6027\u8D28\u7684\u6807\u7B7E\uFF0C\u53EF\u4EE5\u76F4\u63A5\u663E\u793A\u542F\u7528\uFF0C\u4F46\u662FJDK15\u9ED8\u8BA4GC\u4ECD\u7136\u662FG1\uFF09</li></ul><p>\u8FD9\u4E9B\u51C6\u5219\u4EC5\u63D0\u4F9B\u9009\u62E9\u6536\u96C6\u5668\u7684\u8D77\u70B9\uFF0C\u56E0\u4E3A\u6027\u80FD\u53D6\u51B3\u4E8E\u5806\u7684\u5927\u5C0F\uFF0C\u5E94\u7528\u7A0B\u5E8F\u7EF4\u62A4\u7684\u5B9E\u65F6\u6570\u636E\u91CF\u4EE5\u53CA\u53EF\u7528\u5904\u7406\u5668\u7684\u6570\u91CF\u548C\u901F\u5EA6\u3002 \u5982\u679C\u63A8\u8350\u7684\u6536\u96C6\u5668\u6CA1\u6709\u8FBE\u5230\u6240\u9700\u7684\u6027\u80FD\uFF0C\u5219\u9996\u5148\u5C1D\u8BD5\u8C03\u6574\u5806\u548C\u65B0\u751F\u4EE3\u5927\u5C0F\u4EE5\u8FBE\u5230\u6240\u9700\u7684\u76EE\u6807\u3002 \u5982\u679C\u6027\u80FD\u4ECD\u7136\u4E0D\u8DB3\uFF0C\u5C1D\u8BD5\u4F7F\u7528\u5176\u4ED6\u6536\u96C6\u5668 <strong>\u603B\u4F53\u539F\u5219</strong>\uFF1A\u51CF\u5C11STOP THE WORD\u65F6\u95F4\uFF0C\u4F7F\u7528\u5E76\u53D1\u6536\u96C6\u5668\uFF08\u6BD4\u5982CMS+ParNew\uFF0CG1\uFF09\u6765\u51CF\u5C11\u6682\u505C\u65F6\u95F4\uFF0C\u52A0\u5FEB\u54CD\u5E94\u65F6\u95F4\uFF0C\u5E76\u4F7F\u7528\u5E76\u884C\u6536\u96C6\u5668\u6765\u589E\u52A0\u591A\u5904\u7406\u5668\u786C\u4EF6\u4E0A\u7684\u603B\u4F53\u541E\u5410\u91CF\u3002</p><h2 id="jvm8\u4E3A\u4EC0\u4E48\u8981\u589E\u52A0\u5143\u7A7A\u95F4" tabindex="-1"><a class="header-anchor" href="#jvm8\u4E3A\u4EC0\u4E48\u8981\u589E\u52A0\u5143\u7A7A\u95F4" aria-hidden="true">#</a> JVM8\u4E3A\u4EC0\u4E48\u8981\u589E\u52A0\u5143\u7A7A\u95F4\uFF1F</h2><p>\u539F\u56E0\uFF1A</p><ol><li>\u5B57\u7B26\u4E32\u5B58\u5728\u6C38\u4E45\u4EE3\u4E2D\uFF0C\u5BB9\u6613\u51FA\u73B0\u6027\u80FD\u95EE\u9898\u548C\u5185\u5B58\u6EA2\u51FA\u3002</li><li>\u7C7B\u53CA\u65B9\u6CD5\u7684\u4FE1\u606F\u7B49\u6BD4\u8F83\u96BE\u786E\u5B9A\u5176\u5927\u5C0F\uFF0C\u56E0\u6B64\u5BF9\u4E8E\u6C38\u4E45\u4EE3\u7684\u5927\u5C0F\u6307\u5B9A\u6BD4\u8F83\u56F0\u96BE\uFF0C\u592A\u5C0F\u5BB9\u6613\u51FA\u73B0\u6C38\u4E45\u4EE3\u6EA2\u51FA\uFF0C\u592A\u5927\u5219\u5BB9\u6613\u5BFC\u81F4\u8001\u5E74\u4EE3\u6EA2\u51FA\u3002</li><li>\u6C38\u4E45\u4EE3\u4F1A\u4E3A GC \u5E26\u6765\u4E0D\u5FC5\u8981\u7684\u590D\u6742\u5EA6\uFF0C\u5E76\u4E14\u56DE\u6536\u6548\u7387\u504F\u4F4E\u3002</li></ol><h2 id="jvm8\u4E2D\u5143\u7A7A\u95F4\u6709\u54EA\u4E9B\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#jvm8\u4E2D\u5143\u7A7A\u95F4\u6709\u54EA\u4E9B\u7279\u70B9" aria-hidden="true">#</a> JVM8\u4E2D\u5143\u7A7A\u95F4\u6709\u54EA\u4E9B\u7279\u70B9\uFF1F</h2><ol><li>\u6BCF\u4E2A\u52A0\u8F7D\u5668\u6709\u4E13\u95E8\u7684\u5B58\u50A8\u7A7A\u95F4\u3002</li><li>\u4E0D\u4F1A\u5355\u72EC\u56DE\u6536\u67D0\u4E2A\u7C7B\u3002</li><li>\u5143\u7A7A\u95F4\u91CC\u7684\u5BF9\u8C61\u7684\u4F4D\u7F6E\u662F\u56FA\u5B9A\u7684\u3002</li><li>\u5982\u679C\u53D1\u73B0\u67D0\u4E2A\u52A0\u8F7D\u5668\u4E0D\u518D\u5B58\u8D27\u4E86\uFF0C\u4F1A\u628A\u76F8\u5173\u7684\u7A7A\u95F4\u6574\u4E2A\u56DE\u6536</li></ol><h2 id="\u5982\u4F55\u89E3\u51B3\u7EBF\u4E0Agc\u9891\u7E41\u7684\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u89E3\u51B3\u7EBF\u4E0Agc\u9891\u7E41\u7684\u95EE\u9898" aria-hidden="true">#</a> \u5982\u4F55\u89E3\u51B3\u7EBF\u4E0Agc\u9891\u7E41\u7684\u95EE\u9898\uFF1F</h2><ol><li>\u67E5\u770B\u76D1\u63A7\uFF0C\u4EE5\u4E86\u89E3\u51FA\u73B0\u95EE\u9898\u7684\u65F6\u95F4\u70B9\u4EE5\u53CA\u5F53\u524DFGC\u7684\u9891\u7387\uFF08\u53EF\u5BF9\u6BD4\u6B63\u5E38\u60C5\u51B5\u770B\u9891\u7387\u662F\u5426\u6B63\u5E38\uFF09</li><li>\u4E86\u89E3\u8BE5\u65F6\u95F4\u70B9\u4E4B\u524D\u6709\u6CA1\u6709\u7A0B\u5E8F\u4E0A\u7EBF\u3001\u57FA\u7840\u7EC4\u4EF6\u5347\u7EA7\u7B49\u60C5\u51B5\u3002</li><li>\u4E86\u89E3JVM\u7684\u53C2\u6570\u8BBE\u7F6E\uFF0C\u5305\u62EC\uFF1A\u5806\u7A7A\u95F4\u5404\u4E2A\u533A\u57DF\u7684\u5927\u5C0F\u8BBE\u7F6E\uFF0C\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\u5206\u522B\u91C7\u7528\u4E86\u54EA\u4E9B\u5783\u573E\u6536\u96C6\u5668\uFF0C\u7136\u540E\u5206\u6790JVM\u53C2\u6570\u8BBE\u7F6E\u662F\u5426\u5408\u7406\u3002</li><li>\u518D\u5BF9\u6B65\u9AA41\u4E2D\u5217\u51FA\u7684\u53EF\u80FD\u539F\u56E0\u505A\u6392\u9664\u6CD5\uFF0C\u5176\u4E2D\u5143\u7A7A\u95F4\u88AB\u6253\u6EE1\u3001\u5185\u5B58\u6CC4\u6F0F\u3001\u4EE3\u7801\u663E\u5F0F\u8C03\u7528gc\u65B9\u6CD5\u6BD4\u8F83\u5BB9\u6613\u6392\u67E5\u3002</li><li>\u9488\u5BF9\u5927\u5BF9\u8C61\u6216\u8005\u957F\u751F\u547D\u5468\u671F\u5BF9\u8C61\u5BFC\u81F4\u7684FGC\uFF0C\u53EF\u901A\u8FC7 jmap -histo \u547D\u4EE4\u5E76\u7ED3\u5408dump\u5806\u5185\u5B58\u6587\u4EF6\u4F5C\u8FDB\u4E00\u6B65\u5206\u6790\uFF0C\u9700\u8981\u5148\u5B9A\u4F4D\u5230\u53EF\u7591\u5BF9\u8C61\u3002</li><li>\u901A\u8FC7\u53EF\u7591\u5BF9\u8C61\u5B9A\u4F4D\u5230\u5177\u4F53\u4EE3\u7801\u518D\u6B21\u5206\u6790\uFF0C\u8FD9\u65F6\u5019\u8981\u7ED3\u5408GC\u539F\u7406\u548CJVM\u53C2\u6570\u8BBE\u7F6E\uFF0C\u5F04\u6E05\u695A\u53EF\u7591\u5BF9\u8C61\u662F\u5426\u6EE1\u8DB3\u4E86\u8FDB\u5165\u5230\u8001\u5E74\u4EE3\u7684\u6761\u4EF6\u624D\u80FD\u4E0B\u7ED3\u8BBA\u3002</li></ol><h2 id="\u5185\u5B58\u6EA2\u51FA\u7684\u539F\u56E0\u6709\u54EA\u4E9B-\u5982\u4F55\u6392\u67E5\u7EBF\u4E0A\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u6EA2\u51FA\u7684\u539F\u56E0\u6709\u54EA\u4E9B-\u5982\u4F55\u6392\u67E5\u7EBF\u4E0A\u95EE\u9898" aria-hidden="true">#</a> \u5185\u5B58\u6EA2\u51FA\u7684\u539F\u56E0\u6709\u54EA\u4E9B\uFF0C\u5982\u4F55\u6392\u67E5\u7EBF\u4E0A\u95EE\u9898\uFF1F</h2><ol><li><em>java.lang.OutOfMemoryError</em>: <code>......java heap space.....</code> \u5806\u6808\u6EA2\u51FA\uFF0C\u4EE3\u7801\u95EE\u9898\u7684\u53EF\u80FD\u6027\u6781\u5927</li><li><em>java.lang.OutOfMemoryError</em>: <code>GC over head limit exceeded</code> \u7CFB\u7EDF\u5904\u4E8E\u9AD8\u9891\u7684GC\u72B6\u6001\uFF0C\u800C\u4E14\u56DE\u6536\u7684\u6548\u679C\u4F9D\u7136\u4E0D\u4F73\u7684\u60C5\u51B5\uFF0C\u5C31\u4F1A\u5F00\u59CB\u62A5\u8FD9\u4E2A\u9519\u8BEF\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E00\u822C\u662F\u4EA7\u751F\u4E86\u5F88\u591A\u4E0D\u53EF\u4EE5\u88AB\u91CA\u653E\u7684\u5BF9\u8C61\uFF0C\u6709\u53EF\u80FD\u662F\u5F15\u7528\u4F7F\u7528\u4E0D\u5F53\u5BFC\u81F4\uFF0C\u6216\u7533\u8BF7\u5927\u5BF9\u8C61\u5BFC\u81F4\uFF0C\u4F46\u662Fjava heap space\u7684\u5185\u5B58\u6EA2\u51FA\u6709\u53EF\u80FD\u63D0\u524D\u4E0D\u4F1A\u62A5\u8FD9\u4E2A\u9519\u8BEF\uFF0C\u4E5F\u5C31\u662F\u53EF\u80FD\u5185\u5B58\u5C31\u76F4\u63A5\u4E0D\u591F\u5BFC\u81F4\uFF0C\u800C\u4E0D\u662F\u9AD8\u9891GC.</li><li><em>java.lang.OutOfMemoryError</em>: <code>PermGen space</code> jdk1.7\u4E4B\u524D\u624D\u4F1A\u51FA\u73B0\u7684\u95EE\u9898 \uFF0C\u539F\u56E0\u662F\u7CFB\u7EDF\u7684\u4EE3\u7801\u975E\u5E38\u591A\u6216\u5F15\u7528\u7684\u7B2C\u4E09\u65B9\u5305\u975E\u5E38\u591A\u3001\u6216\u4EE3\u7801\u4E2D\u4F7F\u7528\u4E86\u5927\u91CF\u7684\u5E38\u91CF\u3001\u6216\u901A\u8FC7intern\u6CE8\u5165\u5E38\u91CF\u3001\u6216\u8005\u901A\u8FC7\u52A8\u6001\u4EE3\u7801\u52A0\u8F7D\u7B49\u65B9\u6CD5\uFF0C\u5BFC\u81F4\u5E38\u91CF\u6C60\u7684\u81A8\u80C0</li><li><em>java.lang.OutOfMemoryError</em>: <code>Direct buffer memory</code> \u76F4\u63A5\u5185\u5B58\u4E0D\u8DB3\uFF0C\u56E0\u4E3Ajvm\u5783\u573E\u56DE\u6536\u4E0D\u4F1A\u56DE\u6536\u6389\u76F4\u63A5\u5185\u5B58\u8FD9\u90E8\u5206\u7684\u5185\u5B58\uFF0C\u6240\u4EE5\u53EF\u80FD\u539F\u56E0\u662F\u76F4\u63A5\u6216\u95F4\u63A5\u4F7F\u7528\u4E86ByteBuffer\u4E2D\u7684allocateDirect\u65B9\u6CD5\u7684\u65F6\u5019\uFF0C\u800C\u6CA1\u6709\u505Aclear</li><li><em>java.lang.StackOverflowError</em>: <code>- Xss</code>\u8BBE\u7F6E\u7684\u592A\u5C0F\u4E86</li><li><em>java.lang.OutOfMemoryError</em>: <code>unable to create new native thread</code> \u5806\u5916\u5185\u5B58\u4E0D\u8DB3\uFF0C\u65E0\u6CD5\u4E3A\u7EBF\u7A0B\u5206\u914D\u5185\u5B58\u533A\u57DF</li><li><em>java.lang.OutOfMemoryError</em>: <code>request {} byte for {}out of swap</code> \u5730\u5740\u7A7A\u95F4\u4E0D\u591F</li></ol><h2 id="happens-before\u89C4\u5219\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#happens-before\u89C4\u5219\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Happens-Before\u89C4\u5219\u662F\u4EC0\u4E48\uFF1F</h2><ol><li><strong>\u7A0B\u5E8F\u987A\u5E8F\u89C4\u5219</strong>\uFF1A\u4E00\u4E2A\u7EBF\u7A0B\u4E2D\u7684\u6BCF\u4E00\u4E2A\u64CD\u4F5C\uFF0Chappens-before\u4E8E\u8BE5\u7EBF\u7A0B\u4E2D\u7684\u4EFB\u610F\u540E\u7EED\u64CD\u4F5C\u3002</li><li><strong>\u76D1\u89C6\u5668\u89C4\u5219</strong>\uFF1A\u5BF9\u4E00\u4E2A\u9501\u7684\u89E3\u9501\uFF0Chappens-before\u4E8E\u968F\u540E\u5BF9\u8FD9\u4E2A\u9501\u7684\u52A0\u9501\u3002</li><li><strong>volatile\u89C4\u5219</strong>\uFF1A\u5BF9\u4E00\u4E2Avolatile\u53D8\u91CF\u7684\u5199\uFF0Chappens-before\u4E8E\u4EFB\u610F\u540E\u7EED\u5BF9\u4E00\u4E2Avolatile\u53D8\u91CF\u7684\u8BFB\u3002</li><li><strong>\u4F20\u9012\u6027</strong>\uFF1A\u82E5\u679CA happens-before B\uFF0CB happens-before C\uFF0C\u90A3\u4E48A happens-before C\u3002</li><li><strong>\u7EBF\u7A0B\u542F\u52A8\u89C4\u5219</strong>\uFF1AThread\u5BF9\u8C61\u7684start()\u65B9\u6CD5\uFF0Chappens-before\u4E8E\u8FD9\u4E2A\u7EBF\u7A0B\u7684\u4EFB\u610F\u540E\u7EED\u64CD\u4F5C\u3002</li><li><strong>\u7EBF\u7A0B\u7EC8\u6B62\u89C4\u5219</strong>\uFF1A\u7EBF\u7A0B\u4E2D\u7684\u4EFB\u610F\u64CD\u4F5C\uFF0Chappens-before\u4E8E\u8BE5\u7EBF\u7A0B\u7684\u7EC8\u6B62\u76D1\u6D4B\u3002\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7Thread.join()\u65B9\u6CD5\u7ED3\u675F\u3001Thread.isAlive()\u7684\u8FD4\u56DE\u503C\u7B49\u624B\u6BB5\u68C0\u6D4B\u5230\u7EBF\u7A0B\u5DF2\u7ECF\u7EC8\u6B62\u6267\u884C\u3002</li><li><strong>\u7EBF\u7A0B\u4E2D\u65AD\u64CD\u4F5C</strong>\uFF1A\u5BF9\u7EBF\u7A0Binterrupt()\u65B9\u6CD5\u7684\u8C03\u7528\uFF0Chappens-before\u4E8E\u88AB\u4E2D\u65AD\u7EBF\u7A0B\u7684\u4EE3\u7801\u68C0\u6D4B\u5230\u4E2D\u65AD\u4E8B\u4EF6\u7684\u53D1\u751F\uFF0C\u53EF\u4EE5\u901A\u8FC7Thread.interrupted()\u65B9\u6CD5\u68C0\u6D4B\u5230\u7EBF\u7A0B\u662F\u5426\u6709\u4E2D\u65AD\u53D1\u751F\u3002</li><li><strong>\u5BF9\u8C61\u7EC8\u7ED3\u89C4\u5219</strong>\uFF1A\u4E00\u4E2A\u5BF9\u8C61\u7684\u521D\u59CB\u5316\u5B8C\u6210\uFF0Chappens-before\u4E8E\u8FD9\u4E2A\u5BF9\u8C61\u7684finalize()\u65B9\u6CD5\u7684\u5F00\u59CB\u3002</li></ol><h2 id="\u4ECB\u7ECD\u4E00\u4E0B\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F\u53CA\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u4ECB\u7ECD\u4E00\u4E0B\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F\u53CA\u72B6\u6001" aria-hidden="true">#</a> \u4ECB\u7ECD\u4E00\u4E0B\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F\u53CA\u72B6\u6001\uFF1F</h2><p><strong>1.\u521B\u5EFA</strong> \u5F53\u7A0B\u5E8F\u4F7F\u7528new\u5173\u952E\u5B57\u521B\u5EFA\u4E86\u4E00\u4E2A\u7EBF\u7A0B\u4E4B\u540E\uFF0C\u8BE5\u7EBF\u7A0B\u5C31\u5904\u4E8E\u4E00\u4E2A\u65B0\u5EFA\u72B6\u6001\uFF08\u521D\u59CB\u72B6\u6001\uFF09\uFF0C\u6B64\u65F6\u5B83\u548C\u5176\u4ED6Java\u5BF9\u8C61\u4E00\u6837\uFF0C\u4EC5\u4EC5\u7531Java\u865A\u62DF\u673A\u4E3A\u5176\u5206\u914D\u4E86\u5185\u5B58\uFF0C\u5E76\u521D\u59CB\u5316\u4E86\u5176\u6210\u5458\u53D8\u91CF\u503C\u3002\u6B64\u65F6\u7684\u7EBF\u7A0B\u5BF9\u8C61\u6CA1\u6709\u8868\u73B0\u51FA\u4EFB\u4F55\u7EBF\u7A0B\u7684\u52A8\u6001\u7279\u5F81\uFF0C\u7A0B\u5E8F\u4E5F\u4E0D\u4F1A\u6267\u884C\u7EBF\u7A0B\u7684\u7EBF\u7A0B\u6267\u884C\u4F53\u3002</p><p><strong>2.\u5C31\u7EEA</strong> \u5F53\u7EBF\u7A0B\u5BF9\u8C61\u8C03\u7528\u4E86Thread.start()\u65B9\u6CD5\u4E4B\u540E\uFF0C\u8BE5\u7EBF\u7A0B\u5904\u4E8E\u5C31\u7EEA\u72B6\u6001\u3002Java\u865A\u62DF\u673A\u4F1A\u4E3A\u5176\u521B\u5EFA\u65B9\u6CD5\u8C03\u7528\u6808\u548C\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF0C\u5904\u4E8E\u8FD9\u4E2A\u72B6\u6001\u7684\u7EBF\u7A0B\u5E76\u6CA1\u6709\u5F00\u59CB\u8FD0\u884C\uFF0C\u5B83\u53EA\u662F\u8868\u793A\u8BE5\u7EBF\u7A0B\u53EF\u4EE5\u8FD0\u884C\u4E86\u3002\u4ECEstart() \u6E90\u7801\u4E2D\u770B\u51FA\uFF0Cstart\u540E\u6DFB\u52A0\u5230\u4E86\u7EBF\u7A0B\u5217\u8868\u4E2D\uFF0C\u63A5\u7740\u5728native\u5C42\u6DFB\u52A0\u5230VM\u4E2D\uFF0C\u81F3\u4E8E\u8BE5\u7EBF\u7A0B\u4F55\u65F6\u5F00\u59CB\u8FD0\u884C\uFF0C\u53D6\u51B3\u4E8EJVM\u91CC\u7EBF\u7A0B\u8C03\u5EA6\u5668\u7684\u8C03\u5EA6(\u5982\u679COS\u8C03\u5EA6\u9009\u4E2D\u4E86\uFF0C\u5C31\u4F1A\u8FDB\u5165\u5230\u8FD0\u884C\u72B6\u6001)\u3002</p><p><strong>3.\u8FD0\u884C</strong> \u5F53\u7EBF\u7A0B\u5BF9\u8C61\u8C03\u7528\u4E86Thread.start()\u65B9\u6CD5\u4E4B\u540E\uFF0C\u8BE5\u7EBF\u7A0B\u5904\u4E8E\u5C31\u7EEA\u72B6\u6001\u3002\u6DFB\u52A0\u5230\u4E86\u7EBF\u7A0B\u5217\u8868\u4E2D\uFF0C\u5982\u679COS\u8C03\u5EA6\u9009\u4E2D\u4E86\uFF0C\u5C31\u4F1A\u8FDB\u5165\u5230\u8FD0\u884C\u72B6\u6001</p><p><strong>4.\u963B\u585E</strong> \u963B\u585E\u72B6\u6001\u662F\u7EBF\u7A0B\u56E0\u4E3A\u67D0\u79CD\u539F\u56E0\u653E\u5F03CPU\u4F7F\u7528\u6743\uFF0C\u6682\u65F6\u505C\u6B62\u8FD0\u884C\u3002\u76F4\u5230\u7EBF\u7A0B\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF0C\u624D\u6709\u673A\u4F1A\u8F6C\u5230\u8FD0\u884C\u72B6\u6001\u3002\u963B\u585E\u7684\u60C5\u51B5\u5927\u6982\u4E09\u79CD\uFF1A</p><ul><li>1\u3001<strong>\u7B49\u5F85\u963B\u585E</strong>\uFF1A\u8FD0\u884C\u7684\u7EBF\u7A0B\u6267\u884Cwait()\u65B9\u6CD5\uFF0CJVM\u4F1A\u628A\u8BE5\u7EBF\u7A0B\u653E\u5165\u7B49\u5F85\u6C60\u4E2D\u3002(wait\u4F1A\u91CA\u653E\u6301\u6709\u7684\u9501)</li><li>2\u3001<strong>\u540C\u6B65\u963B\u585E</strong>\uFF1A\u8FD0\u884C\u7684\u7EBF\u7A0B\u5728\u83B7\u53D6\u5BF9\u8C61\u7684\u540C\u6B65\u9501\u65F6\uFF0C\u82E5\u8BE5\u540C\u6B65\u9501\u88AB\u522B\u7684\u7EBF\u7A0B\u5360\u7528\uFF0C\u5219JVM\u4F1A\u628A\u8BE5\u7EBF\u7A0B\u653E\u5165\u9501\u6C60\u4E2D\u3002</li><li>3\u3001<strong>\u5176\u4ED6\u963B\u585E</strong>\uFF1A\u8FD0\u884C\u7684\u7EBF\u7A0B\u6267\u884Csleep()\u6216join()\u65B9\u6CD5\uFF0C\u6216\u8005\u53D1\u51FA\u4E86I/O\u8BF7\u6C42\u65F6\uFF0CJVM\u4F1A\u628A\u8BE5\u7EBF\u7A0B\u7F6E\u4E3A\u963B\u585E\u72B6\u6001\u3002\u5F53sleep()\u72B6\u6001\u8D85\u65F6\u3001join() \u7B49\u5F85\u7EBF\u7A0B\u7EC8\u6B62\u6216\u8005\u8D85\u65F6\u3001\u6216\u8005I/O\u5904\u7406\u5B8C\u6BD5\u65F6\uFF0C\u7EBF\u7A0B\u91CD\u65B0\u8F6C\u5165\u5C31\u7EEA\u72B6\u6001\u3002\uFF08\u6CE8\u610F,sleep\u662F\u4E0D\u4F1A\u91CA\u653E\u6301\u6709\u7684\u9501\uFF09\u3002</li><li>\u7EBF\u7A0B\u7761\u7720\uFF1AThread.sleep(long millis)\u65B9\u6CD5\uFF0C\u4F7F\u7EBF\u7A0B\u8F6C\u5230\u963B\u585E\u72B6\u6001\u3002millis\u53C2\u6570\u8BBE\u5B9A\u7761\u7720\u7684\u65F6\u95F4\uFF0C\u4EE5\u6BEB\u79D2\u4E3A\u5355\u4F4D\u3002\u5F53\u7761\u7720\u7ED3\u675F\u540E\uFF0C\u5C31\u8F6C\u4E3A\u5C31\u7EEA\uFF08Runnable\uFF09\u72B6\u6001\u3002sleep()\u5E73\u53F0\u79FB\u690D\u6027\u597D\u3002</li><li>\u7EBF\u7A0B\u7B49\u5F85\uFF1AObject\u7C7B\u4E2D\u7684wait()\u65B9\u6CD5\uFF0C\u5BFC\u81F4\u5F53\u524D\u7684\u7EBF\u7A0B\u7B49\u5F85\uFF0C\u76F4\u5230\u5176\u4ED6\u7EBF\u7A0B\u8C03\u7528\u6B64\u5BF9\u8C61\u7684 notify() \u65B9\u6CD5\u6216 notifyAll() \u5524\u9192\u65B9\u6CD5\u3002\u8FD9\u4E2A\u4E24\u4E2A\u5524\u9192\u65B9\u6CD5\u4E5F\u662FObject\u7C7B\u4E2D\u7684\u65B9\u6CD5\uFF0C\u884C\u4E3A\u7B49\u4EF7\u4E8E\u8C03\u7528 wait(0) \u4E00\u6837\u3002\u5524\u9192\u7EBF\u7A0B\u540E\uFF0C\u5C31\u8F6C\u4E3A\u5C31\u7EEA\uFF08Runnable\uFF09\u72B6\u6001\u3002</li><li>\u7EBF\u7A0B\u8BA9\u6B65\uFF1AThread.yield() \u65B9\u6CD5\uFF0C\u6682\u505C\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684\u7EBF\u7A0B\u5BF9\u8C61\uFF0C\u628A\u6267\u884C\u673A\u4F1A\u8BA9\u7ED9\u76F8\u540C\u6216\u8005\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u7EBF\u7A0B\u3002</li><li>\u7EBF\u7A0B\u52A0\u5165\uFF1Ajoin()\u65B9\u6CD5\uFF0C\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B\u7EC8\u6B62\u3002\u5728\u5F53\u524D\u7EBF\u7A0B\u4E2D\u8C03\u7528\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684join()\u65B9\u6CD5\uFF0C\u5219\u5F53\u524D\u7EBF\u7A0B\u8F6C\u5165\u963B\u585E\u72B6\u6001\uFF0C\u76F4\u5230\u53E6\u4E00\u4E2A\u8FDB\u7A0B\u8FD0\u884C\u7ED3\u675F\uFF0C\u5F53\u524D\u7EBF\u7A0B\u518D\u7531\u963B\u585E\u8F6C\u4E3A\u5C31\u7EEA\u72B6\u6001\u3002</li><li>\u7EBF\u7A0BI/O\uFF1A\u7EBF\u7A0B\u6267\u884C\u67D0\u4E9BIO\u64CD\u4F5C\uFF0C\u56E0\u4E3A\u7B49\u5F85\u76F8\u5173\u7684\u8D44\u6E90\u800C\u8FDB\u5165\u4E86\u963B\u585E\u72B6\u6001\u3002\u6BD4\u5982\u8BF4\u76D1\u542Csystem.in\uFF0C\u4F46\u662F\u5C1A\u4E14\u6CA1\u6709\u6536\u5230\u952E\u76D8\u7684\u8F93\u5165\uFF0C\u5219\u8FDB\u5165\u963B\u585E\u72B6\u6001\u3002</li><li>\u7EBF\u7A0B\u5524\u9192\uFF1AObject\u7C7B\u4E2D\u7684notify()\u65B9\u6CD5\uFF0C\u5524\u9192\u5728\u6B64\u5BF9\u8C61\u76D1\u89C6\u5668\u4E0A\u7B49\u5F85\u7684\u5355\u4E2A\u7EBF\u7A0B\u3002\u5982\u679C\u6240\u6709\u7EBF\u7A0B\u90FD\u5728\u6B64\u5BF9\u8C61\u4E0A\u7B49\u5F85\uFF0C\u5219\u4F1A\u9009\u62E9\u5524\u9192\u5176\u4E2D\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u9009\u62E9\u662F\u4EFB\u610F\u6027\u7684\uFF0C\u5E76\u5728\u5BF9\u5B9E\u73B0\u505A\u51FA\u51B3\u5B9A\u65F6\u53D1\u751F\u3002\u7C7B\u4F3C\u7684\u65B9\u6CD5\u8FD8\u6709\u4E00\u4E2AnotifyAll() \uFF0C\u5524\u9192\u5728\u6B64\u5BF9\u8C61\u76D1\u89C6\u5668\u4E0A\u7B49\u5F85\u7684\u6240\u6709\u7EBF\u7A0B\u3002</li></ul><p><strong>5.\u6B7B\u4EA1</strong> \u7EBF\u7A0B\u4F1A\u4EE5\u4EE5\u4E0B\u4E09\u79CD\u65B9\u5F0F\u4E4B\u4E00\u7ED3\u675F\uFF0C\u7ED3\u675F\u540E\u5C31\u5904\u4E8E\u6B7B\u4EA1\u72B6\u6001:</p><ul><li>run()\u65B9\u6CD5\u6267\u884C\u5B8C\u6210\uFF0C\u7EBF\u7A0B\u6B63\u5E38\u7ED3\u675F\u3002</li><li>\u7EBF\u7A0B\u629B\u51FA\u4E00\u4E2A\u672A\u6355\u83B7\u7684Exception\u6216Error\u3002</li><li>\u76F4\u63A5\u8C03\u7528\u8BE5\u7EBF\u7A0B\u7684stop()\u65B9\u6CD5\u6765\u7ED3\u675F\u8BE5\u7EBF\u7A0B\u2014\u2014\u8BE5\u65B9\u6CD5\u5BB9\u6613\u5BFC\u81F4\u6B7B\u9501\uFF0C\u901A\u5E38\u4E0D\u63A8\u8350\u4F7F\u7528</li></ul><h2 id="\u7EBF\u7A0B\u7684sleep\u3001wait\u3001join\u3001yield\u5982\u4F55\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u7684sleep\u3001wait\u3001join\u3001yield\u5982\u4F55\u4F7F\u7528" aria-hidden="true">#</a> \u7EBF\u7A0B\u7684sleep\u3001wait\u3001join\u3001yield\u5982\u4F55\u4F7F\u7528\uFF1F</h2><p><strong>sleep</strong>:\u8BA9\u7EBF\u7A0B\u7761\u7720\uFF0C\u671F\u95F4\u4F1A\u51FA\u8BA9cpu\uFF0C\u5728\u540C\u6B65\u4EE3\u7801\u5757\u4E2D\uFF0C\u4E0D\u4F1A\u91CA\u653E\u9501</p><p><strong>wait</strong>(\u5FC5\u987B\u5148\u83B7\u5F97\u5BF9\u5E94\u7684\u9501\u624D\u80FD\u8C03\u7528):\u8BA9\u7EBF\u7A0B\u8FDB\u5165\u7B49\u5F85\u72B6\u6001,\u91CA\u653E\u5F53\u524D\u7EBF\u7A0B\u6301\u6709\u7684\u9501\u8D44\u6E90\u7EBF\u7A0B\u53EA\u6709\u5728notify \u6216\u8005notifyAll\u65B9\u6CD5\u8C03\u7528\u540E\u624D\u4F1A\u88AB\u5524\u9192,\u7136\u540E\u53BB\u4E89\u593A\u9501.</p><p><strong>join</strong>:\u7EBF\u7A0B\u4E4B\u95F4\u534F\u540C\u65B9\u5F0F,\u4F7F\u7528\u573A\u666F: \u7EBF\u7A0BA\u5FC5\u987B\u7B49\u5F85\u7EBF\u7A0BB\u8FD0\u884C\u5B8C\u6BD5\u540E\u624D\u53EF\u4EE5\u6267\u884C,\u90A3\u4E48\u5C31\u53EF\u4EE5\u5728\u7EBF\u7A0BA\u7684\u4EE3\u7801\u4E2D\u52A0\u5165ThreadB.join();</p><p><strong>yield</strong>:\u8BA9\u5F53\u524D\u6B63\u5728\u8FD0\u884C\u7684\u7EBF\u7A0B\u56DE\u5230\u53EF\u8FD0\u884C\u72B6\u6001\uFF0C\u4EE5\u5141\u8BB8\u5177\u6709\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u5176\u4ED6\u7EBF\u7A0B\u83B7\u5F97\u8FD0\u884C\u7684\u673A\u4F1A\u3002\u56E0\u6B64\uFF0C\u4F7F\u7528yield()\u7684\u76EE\u7684\u662F\u8BA9\u5177\u6709\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u7EBF\u7A0B\u4E4B\u95F4\u80FD\u591F\u9002\u5F53\u7684\u8F6E\u6362\u6267\u884C\u3002\u4F46\u662F\uFF0C\u5B9E\u9645\u4E2D\u65E0\u6CD5\u4FDD\u8BC1yield() \u8FBE\u5230\u8BA9\u6B65\u7684\u76EE\u7684\uFF0C\u56E0\u4E3A\uFF0C\u8BA9\u6B65\u7684\u7EBF\u7A0B\u53EF\u80FD\u88AB\u7EBF\u7A0B\u8C03\u5EA6\u7A0B\u5E8F\u518D\u6B21\u9009\u4E2D\u3002</p><h2 id="\u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u4E9B\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u4E9B\u65B9\u5F0F" aria-hidden="true">#</a> \u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u4E9B\u65B9\u5F0F\uFF1F</h2><ol><li>\u7EE7\u627FThread\u7C7B\u521B\u5EFA\u7EBF\u7A0B</li><li>\u5B9E\u73B0Runnable\u63A5\u53E3\u521B\u5EFA\u7EBF\u7A0B</li><li>\u4F7F\u7528Callable\u548CFuture\u521B\u5EFA\u7EBF\u7A0B</li><li>\u4F7F\u7528\u7EBF\u7A0B\u6C60\u4F8B\u5982\u7528Executor\u6846\u67B6</li></ol><h2 id="\u4EC0\u4E48\u662F\u5B88\u62A4\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F\u5B88\u62A4\u7EBF\u7A0B" aria-hidden="true">#</a> \u4EC0\u4E48\u662F\u5B88\u62A4\u7EBF\u7A0B\uFF1F</h2><p>\u5728Java\u4E2D\u6709\u4E24\u7C7B\u7EBF\u7A0B\uFF1AUser Thread(\u7528\u6237\u7EBF\u7A0B)\u3001Daemon Thread(\u5B88\u62A4\u7EBF\u7A0B) \u4EFB\u4F55\u4E00\u4E2A\u5B88\u62A4\u7EBF\u7A0B\u90FD\u662F\u6574\u4E2AJVM\u4E2D\u6240\u6709\u975E\u5B88\u62A4\u7EBF\u7A0B\u7684\u4FDD\u59C6\uFF1A \u53EA\u8981\u5F53\u524DJVM\u5B9E\u4F8B\u4E2D\u5C1A\u5B58\u5728\u4EFB\u4F55\u4E00\u4E2A\u975E\u5B88\u62A4\u7EBF\u7A0B\u6CA1\u6709\u7ED3\u675F\uFF0C\u5B88\u62A4\u7EBF\u7A0B\u5C31\u5168\u90E8\u5DE5\u4F5C\uFF1B\u53EA\u6709\u5F53\u6700\u540E\u4E00\u4E2A\u975E\u5B88\u62A4\u7EBF\u7A0B\u7ED3\u675F\u65F6\uFF0C\u5B88\u62A4\u7EBF\u7A0B\u968F\u7740JVM\u4E00\u540C\u7ED3\u675F\u5DE5\u4F5C\u3002</p><p>Daemon\u7684\u4F5C\u7528\u662F\u4E3A\u5176\u4ED6\u7EBF\u7A0B\u7684\u8FD0\u884C\u63D0\u4F9B\u4FBF\u5229\u670D\u52A1\uFF0C\u5B88\u62A4\u7EBF\u7A0B\u6700\u5178\u578B\u7684\u5E94\u7528\u5C31\u662F GC (\u5783\u573E\u56DE\u6536\u5668)\uFF0C\u5B83\u5C31\u662F\u4E00\u4E2A\u5F88\u79F0\u804C\u7684\u5B88\u62A4\u8005\u3002 User\u548CDaemon\u4E24\u8005\u51E0\u4E4E\u6CA1\u6709\u533A\u522B\uFF0C\u552F\u4E00\u7684\u4E0D\u540C\u4E4B\u5904\u5C31\u5728\u4E8E\u865A\u62DF\u673A\u7684\u79BB\u5F00\uFF1A\u5982\u679C User Thread\u5DF2\u7ECF\u5168\u90E8\u9000\u51FA\u8FD0\u884C\u4E86\uFF0C\u53EA\u5269\u4E0BDaemon Thread\u5B58\u5728\u4E86\uFF0C \u865A\u62DF\u673A\u4E5F\u5C31\u9000\u51FA\u4E86\u3002 \u56E0\u4E3A\u6CA1\u6709\u4E86\u88AB\u5B88\u62A4\u8005\uFF0CDaemon\u4E5F\u5C31\u6CA1\u6709\u5DE5\u4F5C\u53EF\u505A\u4E86\uFF0C\u4E5F\u5C31\u6CA1\u6709\u7EE7\u7EED\u8FD0\u884C\u7A0B\u5E8F\u7684\u5FC5\u8981\u4E86\u3002</p><p>\u6CE8\u610F\u4E8B\u9879:</p><p>(1) thread.setDaemon(true)\u5FC5\u987B\u5728thread.start()\u4E4B\u524D\u8BBE\u7F6E\uFF0C\u5426\u5219\u4F1A\u51FA\u73B0\u4E00\u4E2AIllegalThreadStateException\u5F02\u5E38\u3002\u53EA\u80FD\u5728\u7EBF\u7A0B\u672A\u5F00\u59CB\u8FD0\u884C\u4E4B\u524D\u8BBE\u7F6E\u4E3A\u5B88\u62A4\u7EBF\u7A0B\u3002</p><p>(2) \u5728Daemon\u7EBF\u7A0B\u4E2D\u4EA7\u751F\u7684\u65B0\u7EBF\u7A0B\u4E5F\u662FDaemon\u7684\u3002</p><p>(3) \u4E0D\u8981\u8BA4\u4E3A\u6240\u6709\u7684\u5E94\u7528\u90FD\u53EF\u4EE5\u5206\u914D\u7ED9Daemon\u6765\u8FDB\u884C\u8BFB\u5199\u64CD\u4F5C\u6216\u8005\u8BA1\u7B97\u903B\u8F91\uFF0C\u56E0\u4E3A\u8FD9\u4F1A\u53EF\u80FD\u56DE\u5230\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u72B6\u6001\u3002</p><h2 id="threadlocal\u7684\u539F\u7406\u662F\u4EC0\u4E48-\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#threadlocal\u7684\u539F\u7406\u662F\u4EC0\u4E48-\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B" aria-hidden="true">#</a> ThreadLocal\u7684\u539F\u7406\u662F\u4EC0\u4E48\uFF0C\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B\uFF1F</h2><p>Thread\u7C7B\u4E2D\u6709\u4E24\u4E2A\u53D8\u91CFthreadLocals\u548CinheritableThreadLocals\uFF0C\u4E8C\u8005\u90FD\u662FThreadLocal\u5185\u90E8\u7C7BThreadLocalMap\u7C7B\u578B\u7684\u53D8\u91CF\uFF0C\u6211\u4EEC\u901A\u8FC7\u67E5\u770B\u5185\u90E8\u5185ThreadLocalMap\u53EF\u4EE5\u53D1\u73B0\u5B9E\u9645\u4E0A\u5B83\u7C7B\u4F3C\u4E8E\u4E00\u4E2AHashMap\u3002\u5728\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u4E2D\u7684\u8FD9\u4E24\u4E2A\u53D8\u91CF\u90FD\u4E3Anull:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ThreadLocal<span class="token punctuation">.</span>ThreadLocalMap</span> threadLocals<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ThreadLocal<span class="token punctuation">.</span>ThreadLocalMap</span> inheritableThreadLocals<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EA\u6709\u5F53\u7EBF\u7A0B\u7B2C\u4E00\u6B21\u8C03\u7528ThreadLocal\u7684set\u6216\u8005get\u65B9\u6CD5\u7684\u65F6\u5019\u624D\u4F1A\u521B\u5EFA\u4ED6\u4EEC\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t<span class="token operator">=</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ThreadLocalMap</span> map<span class="token operator">=</span><span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ThreadLocalMap<span class="token punctuation">.</span>Entry</span> e<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
                <span class="token class-name">T</span> result<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">return</span> <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token class-name">ThreadLocalMap</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token keyword">return</span> t<span class="token punctuation">.</span>threadLocals<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9664\u6B64\u4E4B\u5916\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u7684\u672C\u5730\u53D8\u91CF\u4E0D\u662F\u5B58\u653E\u5728ThreadLocal\u5B9E\u4F8B\u4E2D\uFF0C\u800C\u662F\u653E\u5728\u8C03\u7528\u7EBF\u7A0B\u7684<strong>ThreadLocals</strong>\u53D8\u91CF\u91CC\u9762\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C<strong>ThreadLocal\u7C7B\u578B\u7684\u672C\u5730\u53D8\u91CF\u662F\u5B58\u653E\u5728\u5177\u4F53\u7684\u7EBF\u7A0B\u7A7A\u95F4\u4E0A</strong> \uFF0C\u5176\u672C\u8EAB\u76F8\u5F53\u4E8E\u4E00\u4E2A\u88C5\u8F7D\u672C\u5730\u53D8\u91CF\u7684\u8F7D\u4F53\uFF0C\u901A\u8FC7set\u65B9\u6CD5\u5C06value\u6DFB\u52A0\u5230\u8C03\u7528\u7EBF\u7A0B\u7684threadLocals\u4E2D\uFF0C\u5F53\u8C03\u7528\u7EBF\u7A0B\u8C03\u7528get\u65B9\u6CD5\u65F6\u5019\u80FD\u591F\u4ECE\u5B83\u7684threadLocals\u4E2D\u53D6\u51FA\u53D8\u91CF\u3002\u5982\u679C\u8C03\u7528\u7EBF\u7A0B\u4E00\u76F4\u4E0D\u7EC8\u6B62\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u672C\u5730\u53D8\u91CF\u5C06\u4F1A\u4E00\u76F4\u5B58\u653E\u5728\u4ED6\u7684threadLocals\u4E2D\uFF0C\u6240\u4EE5\u4E0D\u4F7F\u7528\u672C\u5730\u53D8\u91CF\u7684\u65F6\u5019\u9700\u8981\u8C03\u7528remove\u65B9\u6CD5\u5C06threadLocals\u4E2D\u5220\u9664\u4E0D\u7528\u7684\u672C\u5730\u53D8\u91CF,\u9632\u6B62\u51FA\u73B0\u5185\u5B58\u6CC4\u6F0F\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t<span class="token operator">=</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ThreadLocalMap</span> map<span class="token operator">=</span><span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
        <span class="token function">createMap</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ThreadLocalMap</span> m<span class="token operator">=</span><span class="token function">getMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        m<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="threadlocal\u6709\u54EA\u4E9B\u5185\u5B58\u6CC4\u9732\u95EE\u9898-\u5982\u4F55\u907F\u514D" tabindex="-1"><a class="header-anchor" href="#threadlocal\u6709\u54EA\u4E9B\u5185\u5B58\u6CC4\u9732\u95EE\u9898-\u5982\u4F55\u907F\u514D" aria-hidden="true">#</a> ThreadLocal\u6709\u54EA\u4E9B\u5185\u5B58\u6CC4\u9732\u95EE\u9898\uFF0C\u5982\u4F55\u907F\u514D\uFF1F</h2><p>\u6BCF\u4E2AThread\u90FD\u6709\u4E00\u4E2AThreadLocal.ThreadLocalMap\u7684map\uFF0C\u8BE5map\u7684key\u4E3AThreadLocal\u5B9E\u4F8B\uFF0C\u5B83\u4E3A\u4E00\u4E2A\u5F31\u5F15\u7528\uFF0C\u6211\u4EEC\u77E5\u9053\u5F31\u5F15\u7528\u6709\u5229\u4E8EGC\u56DE\u6536\u3002\u5F53ThreadLocal\u7684key == null\u65F6\uFF0CGC\u5C31\u4F1A\u56DE\u6536\u8FD9\u90E8\u5206\u7A7A\u95F4\uFF0C\u4F46\u662Fvalue\u5374\u4E0D\u4E00\u5B9A\u80FD\u591F\u88AB\u56DE\u6536\uFF0C\u56E0\u4E3A\u4ED6\u8FD8\u4E0ECurrent Thread\u5B58\u5728\u4E00\u4E2A\u5F3A\u5F15\u7528\u5173\u7CFB\uFF0C\u5982\u4E0B</p><p>\u7531\u4E8E\u5B58\u5728\u8FD9\u4E2A\u5F3A\u5F15\u7528\u5173\u7CFB\uFF0C\u4F1A\u5BFC\u81F4value\u65E0\u6CD5\u56DE\u6536\u3002\u5982\u679C\u8FD9\u4E2A\u7EBF\u7A0B\u5BF9\u8C61\u4E0D\u4F1A\u9500\u6BC1\u90A3\u4E48\u8FD9\u4E2A\u5F3A\u5F15\u7528\u5173\u7CFB\u5219\u4F1A\u4E00\u76F4\u5B58\u5728\uFF0C\u5C31\u4F1A\u51FA\u73B0\u5185\u5B58\u6CC4\u6F0F\u60C5\u51B5\u3002\u6240\u4EE5\u8BF4\u53EA\u8981\u8FD9\u4E2A\u7EBF\u7A0B\u5BF9\u8C61\u80FD\u591F\u53CA\u65F6\u88ABGC\u56DE\u6536\uFF0C\u5C31\u4E0D\u4F1A\u51FA\u73B0\u5185\u5B58\u6CC4\u6F0F\u3002\u5982\u679C\u78B0\u5230\u7EBF\u7A0B\u6C60\uFF0C\u90A3\u5C31\u66F4\u5751\u4E86\u3002 \u90A3\u4E48\u8981\u600E\u4E48\u907F\u514D\u8FD9\u4E2A\u95EE\u9898\u5462\uFF1F \u5728\u524D\u9762\u63D0\u8FC7\uFF0C\u5728ThreadLocalMap\u4E2D\u7684setEntry()\u3001getEntry()\uFF0C\u5982\u679C\u9047\u5230key == null\u7684\u60C5\u51B5\uFF0C\u4F1A\u5BF9value\u8BBE\u7F6E\u4E3Anull\u3002\u5F53\u7136\u6211\u4EEC\u4E5F\u53EF\u4EE5\u663E\u793A\u8C03\u7528ThreadLocal\u7684remove()\u65B9\u6CD5\u8FDB\u884C\u5904\u7406\u3002 \u4E0B\u9762\u518D\u5BF9ThreadLocal\u8FDB\u884C\u7B80\u5355\u7684\u603B\u7ED3\uFF1A</p><ul><li>ThreadLocal \u4E0D\u662F\u7528\u4E8E\u89E3\u51B3\u5171\u4EAB\u53D8\u91CF\u7684\u95EE\u9898\u7684\uFF0C\u4E5F\u4E0D\u662F\u4E3A\u4E86\u534F\u8C03\u7EBF\u7A0B\u540C\u6B65\u800C\u5B58\u5728\uFF0C\u800C\u662F\u4E3A\u4E86\u65B9\u4FBF\u6BCF\u4E2A\u7EBF\u7A0B\u5904\u7406\u81EA\u5DF1\u7684\u72B6\u6001\u800C\u5F15\u5165\u7684\u4E00\u4E2A\u673A\u5236\u3002\u8FD9\u70B9\u81F3\u5173\u91CD\u8981\u3002</li><li>\u6BCF\u4E2AThread\u5185\u90E8\u90FD\u6709\u4E00\u4E2AThreadLocal.ThreadLocalMap\u7C7B\u578B\u7684\u6210\u5458\u53D8\u91CF\uFF0C\u8BE5\u6210\u5458\u53D8\u91CF\u7528\u6765\u5B58\u50A8\u5B9E\u9645\u7684ThreadLocal\u53D8\u91CF\u526F\u672C\u3002</li><li>ThreadLocal\u5E76\u4E0D\u662F\u4E3A\u7EBF\u7A0B\u4FDD\u5B58\u5BF9\u8C61\u7684\u526F\u672C\uFF0C\u5B83\u4EC5\u4EC5\u53EA\u8D77\u5230\u4E00\u4E2A\u7D22\u5F15\u7684\u4F5C\u7528\u3002\u5B83\u7684\u4E3B\u8981\u6728\u5F97\u89C6\u4E3A\u6BCF\u4E00\u4E2A\u7EBF\u7A0B\u9694\u79BB\u4E00\u4E2A\u7C7B\u7684\u5B9E\u4F8B\uFF0C\u8FD9\u4E2A\u5B9E\u4F8B\u7684\u4F5C\u7528\u8303\u56F4\u4EC5\u9650\u4E8E\u7EBF\u7A0B\u5185\u90E8\u3002</li></ul><h2 id="\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528\u7EBF\u7A0B\u6C60\uFF1F</h2><p>\u4E3A\u4E86\u51CF\u5C11\u521B\u5EFA\u548C\u9500\u6BC1\u7EBF\u7A0B\u7684\u6B21\u6570\uFF0C\u8BA9\u6BCF\u4E2A\u7EBF\u7A0B\u53EF\u4EE5\u591A\u6B21\u4F7F\u7528,\u53EF\u6839\u636E\u7CFB\u7EDF\u60C5\u51B5<strong>\u8C03\u6574\u6267\u884C</strong>\u7684\u7EBF\u7A0B\u6570\u91CF\uFF0C\u9632\u6B62\u6D88\u8017\u8FC7\u591A\u5185\u5B58,\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u7EBF\u7A0B\u6C60.</p><h2 id="\u7EBF\u7A0B\u6C60\u7EBF\u7A0B\u590D\u7528\u7684\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u7EBF\u7A0B\u590D\u7528\u7684\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u7EBF\u7A0B\u590D\u7528\u7684\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u601D\u8003\u8FD9\u4E48\u4E00\u4E2A\u95EE\u9898\uFF1A\u4EFB\u52A1\u7ED3\u675F\u540E\u4F1A\u4E0D\u4F1A\u56DE\u6536\u7EBF\u7A0B\uFF1F</p><p>\u7B54\u6848\u662F\uFF1AallowCoreThreadTimeOut\u63A7\u5236</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">/</span>java<span class="token operator">/</span>util<span class="token operator">/</span>concurrent<span class="token operator">/</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1127</span>
<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">runWorker</span><span class="token punctuation">(</span><span class="token class-name">Worker</span> w<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> wt<span class="token operator">=</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Runnable</span> task<span class="token operator">=</span>w<span class="token punctuation">.</span>firstTask<span class="token punctuation">;</span>
        w<span class="token punctuation">.</span>firstTask<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// allow interrupts</span>
        <span class="token keyword">boolean</span> completedAbruptly<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>task<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">||</span><span class="token punctuation">(</span>task<span class="token operator">=</span><span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\u6267\u884C\u4EFB\u52A1<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
        completedAbruptly<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
        <span class="token function">processWorkerExit</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>completedAbruptly<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9996\u5148\u7EBF\u7A0B\u6C60\u5185\u7684\u7EBF\u7A0B\u90FD\u88AB\u5305\u88C5\u6210\u4E86\u4E00\u4E2A\u4E2A\u7684java.util.concurrent.ThreadPoolExecutor.Worker,\u7136\u540E\u8FD9\u4E2Aworker\u4F1A\u9A6C\u4E0D\u505C\u8E44\u7684\u6267\u884C\u4EFB\u52A1, \u6267\u884C\u5B8C\u4EFB\u52A1\u4E4B\u540E\u5C31\u4F1A\u5728while\u5FAA\u73AF\u4E2D\u53BB\u53D6\u4EFB\u52A1,\u53D6\u5230\u4EFB\u52A1\u5C31\u7EE7\u7EED\u6267\u884C,\u53D6\u4E0D\u5230\u4EFB\u52A1\u5C31\u8DF3\u51FAwhile\u5FAA\u73AF(\u8FD9\u4E2A\u65F6\u5019worker\u5C31\u4E0D\u80FD\u518D\u6267\u884C\u4EFB\u52A1\u4E86)\u6267\u884C processWorkerExit\u65B9\u6CD5,\u8FD9\u4E2A\u65B9\u6CD5\u5462\u5C31\u662F\u505A\u6E05\u573A\u5904\u7406,\u5C06\u5F53\u524Dwoker\u7EBF\u7A0B\u4ECE\u7EBF\u7A0B\u6C60\u4E2D\u79FB\u9664,\u5E76\u4E14\u5224\u65AD\u662F\u5426\u662F\u5F02\u5E38\u7684\u8FDB\u5165processWorkerExit\u65B9\u6CD5, \u5982\u679C\u662F\u975E\u5F02\u5E38\u60C5\u51B5,\u5C31\u5BF9\u5F53\u524D\u7EBF\u7A0B\u6C60\u72B6\u6001(RUNNING,shutdown)\u548C\u5F53\u524D\u5DE5\u4F5C\u7EBF\u7A0B\u6570\u548C\u5F53\u524D\u4EFB\u52A1\u6570\u505A\u5224\u65AD,\u662F\u5426\u8981\u52A0\u5165\u4E00\u4E2A\u65B0\u7684\u7EBF\u7A0B\u53BB\u5B8C\u6210\u6700\u540E\u7684\u4EFB\u52A1 (\u9632\u6B62\u6CA1\u6709\u7EBF\u7A0B\u53BB\u505A\u5269\u4E0B\u7684\u4EFB\u52A1)\u3002</p><p>\u90A3\u4E48\u4EC0\u4E48\u65F6\u5019\u4F1A\u9000\u51FAwhile\u5FAA\u73AF\u5462?\u53D6\u4E0D\u5230\u4EFB\u52A1\u7684\u65F6\u5019(getTask() == null).\u4E0B\u9762\u770B\u4E00\u4E0BgetTask\u65B9\u6CD5</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Runnable</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> timedOut<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Did the last poll() time out?</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> c<span class="token operator">=</span>ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rs<span class="token operator">=</span><span class="token function">runStateOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//(rs == SHUTDOWN &amp;&amp; workQueue.isEmpty()) || rs &gt;=STOP</span>
        <span class="token comment">//\u82E5\u7EBF\u7A0B\u6C60\u72B6\u6001\u662FSHUTDOWN \u5E76\u4E14 \u4EFB\u52A1\u961F\u5217\u4E3A\u7A7A,\u610F\u5473\u7740\u5DF2\u7ECF\u4E0D\u9700\u8981\u5DE5\u4F5C\u7EBF\u7A0B\u6267\u884C\u4EFB\u52A1\u4E86,\u7EBF\u7A0B\u6C60\u5373\u5C06\u5173\u95ED</span>
        <span class="token comment">//\u82E5\u7EBF\u7A0B\u6C60\u7684\u72B6\u6001\u662F STOP TIDYING TERMINATED,\u5219\u610F\u5473\u7740\u7EBF\u7A0B\u6C60\u5DF2\u7ECF\u505C\u6B62\u5904\u7406\u4EFB\u4F55\u4EFB\u52A1\u4E86,\u4E0D\u5728\u9700\u8981\u7EBF\u7A0B</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token operator">&gt;=</span>SHUTDOWN<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>rs<span class="token operator">&gt;=</span>STOP<span class="token operator">||</span>workQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u628A\u6B64\u5DE5\u4F5C\u7EBF\u7A0B\u4ECE\u7EBF\u7A0B\u6C60\u4E2D\u5220\u9664</span>
        <span class="token function">decrementWorkerCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> wc<span class="token operator">=</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//allowCoreThreadTimeOut:\u5F53\u6CA1\u6709\u4EFB\u52A1\u7684\u65F6\u5019,\u6838\u5FC3\u7EBF\u7A0B\u6570\u4E5F\u4F1A\u88AB\u5254\u9664,\u9ED8\u8BA4\u53C2\u6570\u662Ffalse,\u5B98\u65B9\u63A8\u8350\u5728\u521B\u5EFA\u7EBF\u7A0B\u6C60\u5E76\u4E14\u8FD8\u672A\u4F7F\u7528\u7684\u65F6\u5019,\u8BBE\u7F6E\u6B64\u503C</span>
        <span class="token comment">//\u5982\u679C\u5F53\u524D\u5DE5\u4F5C\u7EBF\u7A0B\u6570 \u5927\u4E8E \u6838\u5FC3\u7EBF\u7A0B\u6570,timed\u4E3Atrue</span>
        <span class="token keyword">boolean</span> timed<span class="token operator">=</span>allowCoreThreadTimeOut<span class="token operator">||</span>wc<span class="token operator">&gt;</span>corePoolSize<span class="token punctuation">;</span>

        <span class="token comment">//(wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut)):\u5F53\u5DE5\u4F5C\u7EBF\u7A0B\u8D85\u8FC7\u6700\u5927\u7EBF\u7A0B\u6570,\u6216\u8005 \u5141\u8BB8\u8D85\u65F6\u5E76\u4E14\u8D85\u65F6\u8FC7\u4E00\u6B21\u4E86</span>
        <span class="token comment">//(wc &gt; 1 || workQueue.isEmpty()):\u5DE5\u4F5C\u7EBF\u7A0B\u6570\u81F3\u5C11\u4E3A1\u4E2A \u6216\u8005 \u6CA1\u6709\u4EFB\u52A1\u4E86</span>
        <span class="token comment">//\u603B\u7684\u6765\u8BF4\u5224\u65AD\u5F53\u524D\u5DE5\u4F5C\u7EBF\u7A0B\u8FD8\u6709\u6CA1\u6709\u5FC5\u8981\u7B49\u7740\u62FF\u4EFB\u52A1\u53BB\u6267\u884C</span>
        <span class="token comment">//wc &gt; maximumPoolSize &amp;&amp; wc&gt;1 : \u5C31\u662F\u5224\u65AD\u5F53\u524D\u5DE5\u4F5C\u7EBF\u7A0B\u662F\u5426\u8D85\u8FC7\u6700\u5927\u503C</span>
        <span class="token comment">//\u6216\u8005 wc &gt; maximumPoolSize &amp;&amp; workQueue.isEmpty():\u5DE5\u4F5C\u7EBF\u7A0B\u8D85\u8FC7\u6700\u5927,\u57FA\u672C\u4E0A\u4E0D\u4F1A\u8D70\u5230\u8FD9,</span>
        <span class="token comment">//		\u5982\u679C\u8D70\u5230\u8FD9,\u5219\u610F\u5473\u7740wc=1 ,\u53EA\u67091\u4E2A\u5DE5\u4F5C\u7EBF\u7A0B\u4E86,\u5982\u679C\u6B64\u65F6\u4EFB\u52A1\u961F\u5217\u662F\u7A7A\u7684,\u5219\u628A\u6700\u540E\u7684\u7EBF\u7A0B\u5220\u9664</span>
        <span class="token comment">//\u6216\u8005(timed &amp;&amp; timedOut) &amp;&amp; wc&gt;1:\u5982\u679C\u5141\u8BB8\u8D85\u65F6\u5E76\u4E14\u8D85\u65F6\u8FC7\u4E00\u6B21,\u5E76\u4E14\u81F3\u5C11\u67091\u4E2A\u7EBF\u7A0B,\u5219\u5220\u9664\u7EBF\u7A0B</span>
        <span class="token comment">//\u6216\u8005 (timed &amp;&amp; timedOut) &amp;&amp; workQueue.isEmpty():\u5982\u679C\u5141\u8BB8\u8D85\u65F6\u5E76\u4E14\u8D85\u65F6\u8FC7\u4E00\u6B21,\u5E76\u4E14\u6B64\u65F6\u5DE5\u4F5C					\u961F\u5217\u4E3A\u7A7A\uFF0C\u90A3\u4E48\u59A5\u59A5\u53EF\u4EE5\u628A\u6700\u540E\u4E00\u4E2A\u7EBF\u7A0B\uFF08\u56E0\u4E3A\u4E0A\u9762\u7684wc&gt;1\u4E0D\u6EE1\u8DB3\uFF0C\u5219\u53EF\u4EE5\u5F97\u51FA\u6765wc=1\uFF09\u5220\u9664</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>wc<span class="token operator">&gt;</span>maximumPoolSize<span class="token operator">||</span><span class="token punctuation">(</span>timed<span class="token operator">&amp;&amp;</span>timedOut<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>wc<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">||</span>workQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">compareAndDecrementWorkerCount</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">//\u5982\u679C\u51CF\u53BB\u5DE5\u4F5C\u7EBF\u7A0B\u6570\u6210\u529F,\u5219\u8FD4\u56DEnull\u51FA\u53BB,\u4E5F\u5C31\u662F\u8BF4 \u8BA9\u5DE5\u4F5C\u7EBF\u7A0B\u505C\u6B62while\u8F6E\u8BAD,\u8FDB\u884C\u6536\u5C3E</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token comment">//\u5224\u65AD\u662F\u5426\u8981\u963B\u585E\u83B7\u53D6\u4EFB\u52A1</span>
        <span class="token class-name">Runnable</span> r<span class="token operator">=</span>timed<span class="token operator">?</span>
        workQueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span>keepAliveTime<span class="token punctuation">,</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS<span class="token punctuation">)</span><span class="token operator">:</span>
        workQueue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> r<span class="token punctuation">;</span>
        timedOut<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> retry<span class="token punctuation">)</span><span class="token punctuation">{</span>
        timedOut<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

<span class="token comment">//\u7EFC\u4E0A\u6240\u8FF0,\u5982\u679CallowCoreThreadTimeOut\u4E3Atrue,\u5E76\u4E14\u5728\u7B2C1\u6B21\u963B\u585E\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\u4E86,\u90A3\u4E48\u5F53\u524DgetTask\u4F1A\u8FD4\u56DEnull,\u4E0D\u7BA1\u662F\u4E0D\u662F\u6838\u5FC3\u7EBF\u7A0B;\u90A3\u4E48runWorker\u4E2D\u5C06\u63A8\u51FAwhile\u5FAA\u73AF,\u4E5F\u5C31\u610F\u5473\u7740\u5F53\u524D\u5DE5\u4F5C\u7EBF\u7A0B\u88AB\u9500\u6BC1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u4E0A\u9762\u8FD9\u4E2A\u95EE\u9898\u53EF\u4EE5\u5F97\u51FA\u4E00\u4E2A\u7ED3\u8BBA\uFF1A\u5F53\u4F60\u7684\u7EBF\u7A0B\u6C60\u53C2\u6570\u914D\u7F6E\u5408\u7406\u7684\u65F6\u5019\uFF0C\u6267\u884C\u5B8C\u4EFB\u52A1\u7684\u7EBF\u7A0B\u662F\u4E0D\u4F1A\u88AB\u9500\u6BC1\u7684\uFF0C\u800C\u662F\u4F1A\u4ECE\u4EFB\u52A1\u961F\u5217\u4E2D\u53D6\u51FA\u4EFB\u52A1\u7EE7\u7EED\u6267\u884C\uFF01</p><h2 id="\u5982\u4F55\u9884\u9632\u6B7B\u9501" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u9884\u9632\u6B7B\u9501" aria-hidden="true">#</a> \u5982\u4F55\u9884\u9632\u6B7B\u9501\uFF1F</h2><ol><li>\u9996\u5148\u9700\u8981\u5C06\u6B7B\u9501\u53D1\u751F\u7684\u662F\u4E2A\u5FC5\u8981\u6761\u4EF6\u8BB2\u51FA\u6765:</li></ol><ul><li>\u4E92\u65A5\u6761\u4EF6 \u540C\u4E00\u65F6\u95F4\u53EA\u80FD\u6709\u4E00\u4E2A\u7EBF\u7A0B\u83B7\u53D6\u8D44\u6E90\u3002</li><li>\u4E0D\u53EF\u5265\u593A\u6761\u4EF6 \u4E00\u4E2A\u7EBF\u7A0B\u5DF2\u7ECF\u5360\u6709\u7684\u8D44\u6E90\uFF0C\u5728\u91CA\u653E\u4E4B\u524D\u4E0D\u4F1A\u88AB\u5176\u5B83\u7EBF\u7A0B\u62A2\u5360</li><li>\u8BF7\u6C42\u548C\u4FDD\u6301\u6761\u4EF6 \u7EBF\u7A0B\u7B49\u5F85\u8FC7\u7A0B\u4E2D\u4E0D\u4F1A\u91CA\u653E\u5DF2\u5360\u6709\u7684\u8D44\u6E90</li><li>\u5FAA\u73AF\u7B49\u5F85\u6761\u4EF6 \u591A\u4E2A\u7EBF\u7A0B\u4E92\u76F8\u7B49\u5F85\u5BF9\u65B9\u91CA\u653E\u8D44\u6E90</li></ul><ol start="2"><li>\u6B7B\u9501\u9884\u9632\uFF0C\u90A3\u4E48\u5C31\u662F\u9700\u8981\u7834\u574F\u8FD9\u56DB\u4E2A\u5FC5\u8981\u6761\u4EF6</li></ol><ul><li>\u7531\u4E8E\u8D44\u6E90\u4E92\u65A5\u662F\u8D44\u6E90\u4F7F\u7528\u7684\u56FA\u6709\u7279\u6027\uFF0C\u65E0\u6CD5\u6539\u53D8\uFF0C\u6211\u4EEC\u4E0D\u8BA8\u8BBA</li><li>\u7834\u574F\u4E0D\u53EF\u5265\u593A\u6761\u4EF6</li><li><ul><li>\u4E00\u4E2A\u8FDB\u7A0B\u4E0D\u80FD\u83B7\u5F97\u6240\u9700\u8981\u7684\u5168\u90E8\u8D44\u6E90\u65F6\u4FBF\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\uFF0C\u7B49\u5F85\u671F\u95F4\u4ED6\u5360\u6709\u7684\u8D44\u6E90\u5C06\u88AB\u9690\u5F0F\u7684\u91CA\u653E\u91CD\u65B0\u52A0\u5165\u5230\u7CFB\u7EDF\u7684\u8D44\u6E90\u5217\u8868\u4E2D\uFF0C\u53EF\u4EE5\u88AB\u5176\u4ED6\u7684\u8FDB\u7A0B\u4F7F\u7528\uFF0C\u800C\u7B49\u5F85\u7684\u8FDB\u7A0B\u53EA\u6709\u91CD\u65B0\u83B7\u5F97\u81EA\u5DF1\u539F\u6709\u7684\u8D44\u6E90\u4EE5\u53CA\u65B0\u7533\u8BF7\u7684\u8D44\u6E90\u624D\u53EF\u4EE5\u91CD\u65B0\u542F\u52A8\uFF0C\u6267\u884C</li></ul></li></ul><ol start="3"><li>\u7834\u574F\u8BF7\u6C42\u4E0E\u4FDD\u6301\u6761\u4EF6</li></ol><ul><li>\u7B2C\u4E00\u79CD\u65B9\u6CD5\u9759\u6001\u5206\u914D\u5373\u6BCF\u4E2A\u8FDB\u7A0B\u5728\u5F00\u59CB\u6267\u884C\u65F6\u5C31\u7533\u8BF7\u4ED6\u6240\u9700\u8981\u7684\u5168\u90E8\u8D44\u6E90</li><li>\u7B2C\u4E8C\u79CD\u662F\u52A8\u6001\u5206\u914D\u5373\u6BCF\u4E2A\u8FDB\u7A0B\u5728\u7533\u8BF7\u6240\u9700\u8981\u7684\u8D44\u6E90\u65F6\u4ED6\u672C\u8EAB\u4E0D\u5360\u7528\u7CFB\u7EDF\u8D44\u6E90</li></ul><ol start="4"><li>\u7834\u574F\u5FAA\u73AF\u7B49\u5F85\u6761\u4EF6</li></ol><ul><li>\u91C7\u7528\u8D44\u6E90\u6709\u5E8F\u5206\u914D\u5176\u57FA\u672C\u601D\u60F3\u662F\u5C06\u7CFB\u7EDF\u4E2D\u7684\u6240\u6709\u8D44\u6E90\u987A\u5E8F\u7F16\u53F7\uFF0C\u5C06\u7D27\u7F3A\u7684\uFF0C\u7A00\u5C11\u7684\u91C7\u7528\u8F83\u5927\u7684\u7F16\u53F7\uFF0C\u5728\u7533\u8BF7\u8D44\u6E90\u65F6\u5FC5\u987B\u6309\u7167\u7F16\u53F7\u7684\u987A\u5E8F\u8FDB\u884C\uFF0C\u4E00\u4E2A\u8FDB\u7A0B\u53EA\u6709\u83B7\u5F97\u8F83\u5C0F\u7F16\u53F7\u7684\u8FDB\u7A0B\u624D\u80FD\u7533\u8BF7\u8F83\u5927\u7F16\u53F7\u7684\u8FDB\u7A0B\u3002</li></ul><h2 id="\u63CF\u8FF0\u4E00\u4E0B\u7EBF\u7A0B\u5B89\u5168\u6D3B\u8DC3\u6001\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u63CF\u8FF0\u4E00\u4E0B\u7EBF\u7A0B\u5B89\u5168\u6D3B\u8DC3\u6001\u95EE\u9898" aria-hidden="true">#</a> \u63CF\u8FF0\u4E00\u4E0B\u7EBF\u7A0B\u5B89\u5168\u6D3B\u8DC3\u6001\u95EE\u9898\uFF1F</h2><p>\u7EBF\u7A0B\u5B89\u5168\u7684\u6D3B\u8DC3\u6027\u95EE\u9898\u53EF\u4EE5\u5206\u4E3A \u6B7B\u9501\u3001\u6D3B\u9501\u3001\u9965\u997F</p><ol><li>\u6D3B\u9501 \u5C31\u662F\u6709\u65F6\u7EBF\u7A0B\u867D\u7136\u6CA1\u6709\u53D1\u751F\u963B\u585E\uFF0C\u4F46\u662F\u4ECD\u7136\u4F1A\u5B58\u5728\u6267\u884C\u4E0D\u4E0B\u53BB\u7684\u60C5\u51B5\uFF0C\u6D3B\u9501\u4E0D\u4F1A\u963B\u585E\u7EBF\u7A0B\uFF0C\u7EBF\u7A0B\u4F1A\u4E00\u76F4\u91CD\u590D\u6267\u884C\u67D0\u4E2A\u76F8\u540C\u7684\u64CD\u4F5C\uFF0C\u5E76\u4E14\u4E00\u76F4\u5931\u8D25\u91CD\u8BD5</li></ol><ul><li></li></ul><p>\u6211\u4EEC\u5F00\u53D1\u4E2D\u4F7F\u7528\u7684\u5F02\u6B65\u6D88\u606F\u961F\u5217\u5C31\u6709\u53EF\u80FD\u9020\u6210\u6D3B\u9501\u7684\u95EE\u9898\uFF0C\u5728\u6D88\u606F\u961F\u5217\u7684\u6D88\u8D39\u7AEF\u5982\u679C\u6CA1\u6709\u6B63\u786E\u7684ack\u6D88\u606F\uFF0C\u5E76\u4E14\u6267\u884C\u8FC7\u7A0B\u4E2D\u62A5\u9519\u4E86\uFF0C\u5C31\u4F1A\u518D\u6B21\u653E\u56DE\u6D88\u606F\u5934\uFF0C\u7136\u540E\u518D\u62FF\u51FA\u6765\u6267\u884C\uFF0C\u4E00\u76F4\u5FAA\u73AF\u5F80\u590D\u7684\u5931\u8D25\u3002\u8FD9\u4E2A\u95EE\u9898\u9664\u4E86\u6B63\u786E\u7684ack\u4E4B\u5916\uFF0C\u5F80\u5F80\u662F\u901A\u8FC7\u5C06\u5931\u8D25\u7684\u6D88\u606F\u653E\u5165\u5230\u5EF6\u65F6\u961F\u5217\u4E2D\uFF0C\u7B49\u5230\u4E00\u5B9A\u7684\u5EF6\u65F6\u518D\u8FDB\u884C\u91CD\u8BD5\u6765\u89E3\u51B3\u3002</p><ul><li>\u89E3\u51B3\u6D3B\u9501\u7684\u65B9\u6848\u5F88\u7B80\u5355\uFF0C\u5C1D\u8BD5\u7B49\u5F85\u4E00\u4E2A\u968F\u673A\u7684\u65F6\u95F4\u5C31\u53EF\u4EE5\uFF0C\u4F1A\u6309\u65F6\u95F4\u8F6E\u53BB\u91CD\u8BD5</li></ul><ol start="2"><li>\u9965\u997F \u5C31\u662F \u7EBF\u7A0B\u56E0\u65E0\u6CD5\u8BBF\u95EE\u6240\u9700\u8D44\u6E90\u800C\u65E0\u6CD5\u6267\u884C\u4E0B\u53BB\u7684\u60C5\u51B5</li></ol><ul><li>\u9965\u997F \u5206\u4E3A\u4E24\u79CD\u60C5\u51B5\uFF1A <ul><li>\u4E00\u79CD\u662F\u5176\u4ED6\u7684\u7EBF\u7A0B\u5728\u4E34\u754C\u533A\u505A\u4E86\u65E0\u9650\u5FAA\u73AF\u6216\u65E0\u9650\u5236\u7B49\u5F85\u8D44\u6E90\u7684\u64CD\u4F5C\uFF0C\u8BA9\u5176\u4ED6\u7684\u7EBF\u7A0B\u4E00\u76F4\u4E0D\u80FD\u62FF\u5230\u9501\u8FDB\u5165\u4E34\u754C\u533A\uFF0C\u5BF9\u5176\u4ED6\u7EBF\u7A0B\u6765\u8BF4\uFF0C\u5C31\u8FDB\u5165\u4E86\u9965\u997F\u72B6\u6001</li><li>\u53E6\u4E00\u79CD\u662F\u56E0\u4E3A\u7EBF\u7A0B\u4F18\u5148\u7EA7\u4E0D\u5408\u7406\u7684\u5206\u914D\uFF0C\u5BFC\u81F4\u90E8\u5206\u7EBF\u7A0B\u59CB\u7EC8\u65E0\u6CD5\u83B7\u53D6\u5230CPU\u8D44\u6E90\u800C\u4E00\u76F4\u65E0\u6CD5\u6267\u884C</li></ul></li><li>\u89E3\u51B3\u9965\u997F\u7684\u95EE\u9898\u6709\u51E0\u79CD\u65B9\u6848: <ul><li>\u4FDD\u8BC1\u8D44\u6E90\u5145\u8DB3\uFF0C\u5F88\u591A\u573A\u666F\u4E0B\uFF0C\u8D44\u6E90\u7684\u7A00\u7F3A\u6027\u65E0\u6CD5\u89E3\u51B3</li><li>\u516C\u5E73\u5206\u914D\u8D44\u6E90\uFF0C\u5728\u5E76\u53D1\u7F16\u7A0B\u91CC\u4F7F\u7528\u516C\u5E73\u9501\uFF0C\u4F8B\u5982FIFO\u7B56\u7565\uFF0C\u7EBF\u7A0B\u7B49\u5F85\u662F\u6709\u987A\u5E8F\u7684\uFF0C\u6392\u5728\u7B49\u5F85\u961F\u5217\u524D\u9762\u7684\u7EBF\u7A0B\u4F1A\u4F18\u5148\u83B7\u5F97\u8D44\u6E90</li><li>\u907F\u514D\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u957F\u65F6\u95F4\u6267\u884C\uFF0C\u5F88\u591A\u573A\u666F\u4E0B\uFF0C\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u7684\u6267\u884C\u65F6\u95F4\u4E5F\u5F88\u96BE\u7F29\u77ED</li></ul></li></ul><ol start="3"><li>\u6B7B\u9501 \u7EBF\u7A0B\u5728\u5BF9\u540C\u4E00\u628A\u9501\u8FDB\u884C\u7ADE\u4E89\u7684\u65F6\u5019\uFF0C\u672A\u62A2\u5360\u5230\u9501\u7684\u7EBF\u7A0B\u4F1A\u7B49\u5F85\u6301\u6709\u9501\u7684\u7EBF\u7A0B\u91CA\u653E\u9501\u540E\u7EE7\u7EED\u62A2\u5360\uFF0C\u5982\u679C\u4E24\u4E2A\u6216\u4E24\u4E2A\u4EE5\u4E0A\u7684\u7EBF\u7A0B\u4E92\u76F8\u6301\u6709\u5BF9\u65B9\u5C06\u8981\u62A2\u5360\u7684\u9501\uFF0C\u4E92\u76F8\u7B49\u5F85\u5BF9\u65B9\u5148\u884C\u91CA\u653E\u9501\u5C31\u4F1A\u8FDB\u5165\u5230\u4E00\u4E2A\u5FAA\u73AF\u7B49\u5F85\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u5C31\u53EB\u505A\u6B7B\u9501</li></ol><h2 id="\u7EBF\u7A0B\u5B89\u5168\u7684\u7ADE\u6001\u6761\u4EF6\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u5B89\u5168\u7684\u7ADE\u6001\u6761\u4EF6\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u7EBF\u7A0B\u5B89\u5168\u7684\u7ADE\u6001\u6761\u4EF6\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>\u540C\u4E00\u4E2A\u7A0B\u5E8F\u591A\u7EBF\u7A0B\u8BBF\u95EE\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u5982\u679C\u5BF9\u8D44\u6E90\u7684\u8BBF\u95EE\u987A\u5E8F\u654F\u611F\uFF0C\u5C31\u79F0\u5B58\u5728\u7ADE\u6001\u6761\u4EF6\uFF0C\u4EE3\u7801\u533A\u6210\u4E3A\u4E34\u754C\u533A\u3002 \u5927\u591A\u6570\u5E76\u53D1\u9519\u8BEF\u4E00\u6837\uFF0C\u7ADE\u6001\u6761\u4EF6\u4E0D\u603B\u662F\u4F1A\u4EA7\u751F\u95EE\u9898\uFF0C\u8FD8\u9700\u8981\u4E0D\u6070\u5F53\u7684\u6267\u884C\u65F6\u5E8F</li><li>\u6700\u5E38\u89C1\u7684\u7ADE\u6001\u6761\u4EF6\u4E3A</li></ol><ul><li>\u5148\u68C0\u6D4B\u540E\u6267\u884C\u6267\u884C\u4F9D\u8D56\u4E8E\u68C0\u6D4B\u7684\u7ED3\u679C\uFF0C\u800C\u68C0\u6D4B\u7ED3\u679C\u4F9D\u8D56\u4E8E\u591A\u4E2A\u7EBF\u7A0B\u7684\u6267\u884C\u65F6\u5E8F\uFF0C\u800C\u591A\u4E2A\u7EBF\u7A0B\u7684\u6267\u884C\u65F6\u5E8F\u901A\u5E38\u60C5\u51B5\u4E0B\u662F\u4E0D\u56FA\u5B9A\u4E0D\u53EF\u5224\u65AD\u7684\uFF0C\u4ECE\u800C\u5BFC\u81F4\u6267\u884C\u7ED3\u679C\u51FA\u73B0\u5404\u79CD\u95EE\u9898\uFF0C\u89C1\u4E00\u79CD\u53EF\u80FD \u7684\u89E3\u51B3\u529E\u6CD5\u5C31\u662F\uFF1A\u5728\u4E00\u4E2A\u7EBF\u7A0B\u4FEE\u6539\u8BBF\u95EE\u4E00\u4E2A\u72B6\u6001\u65F6\uFF0C\u8981\u9632\u6B62\u5176\u4ED6\u7EBF\u7A0B\u8BBF\u95EE\u4FEE\u6539\uFF0C\u4E5F\u5C31\u662F\u52A0\u9501\u673A\u5236\uFF0C\u4FDD\u8BC1\u539F\u5B50\u6027</li><li>\u5EF6\u8FDF\u521D\u59CB\u5316\uFF08\u5178\u578B\u4E3A\u5355\u4F8B\uFF09</li></ul><h2 id="\u7A0B\u5E8F\u5F00\u591A\u5C11\u7EBF\u7A0B\u5408\u9002" tabindex="-1"><a class="header-anchor" href="#\u7A0B\u5E8F\u5F00\u591A\u5C11\u7EBF\u7A0B\u5408\u9002" aria-hidden="true">#</a> \u7A0B\u5E8F\u5F00\u591A\u5C11\u7EBF\u7A0B\u5408\u9002\uFF1F</h2><ol><li>CPU \u5BC6\u96C6\u578B\u7A0B\u5E8F\uFF0C\u4E00\u4E2A\u5B8C\u6574\u8BF7\u6C42\uFF0CI/O\u64CD\u4F5C\u53EF\u4EE5\u5728\u5F88\u77ED\u65F6\u95F4\u5185\u5B8C\u6210\uFF0CCPU\u8FD8\u6709\u5F88\u591A\u8FD0\u7B97\u8981\u5904\u7406\uFF0C\u4E5F\u5C31\u662F\u8BF4 CPU \u8BA1\u7B97\u7684\u6BD4\u4F8B\u5360\u5F88\u5927\u4E00\u90E8\u5206\uFF0C\u7EBF\u7A0B\u7B49\u5F85\u65F6\u95F4\u63A5\u8FD10</li></ol><ul><li>\u5355\u6838CPU\uFF1A \u4E00\u4E2A\u5B8C\u6574\u8BF7\u6C42\uFF0CI/O\u64CD\u4F5C\u53EF\u4EE5\u5728\u5F88\u77ED\u65F6\u95F4\u5185\u5B8C\u6210\uFF0C CPU\u8FD8\u6709\u5F88\u591A\u8FD0\u7B97\u8981\u5904\u7406\uFF0C\u4E5F\u5C31\u662F\u8BF4 CPU \u8BA1\u7B97\u7684\u6BD4\u4F8B\u5360\u5F88\u5927\u4E00\u90E8\u5206\uFF0C\u7EBF\u7A0B\u7B49\u5F85\u65F6\u95F4\u63A5\u8FD10\u3002\u5355\u6838CPU\u5904\u7406CPU\u5BC6\u96C6\u578B\u7A0B\u5E8F\uFF0C\u8FD9\u79CD\u60C5\u51B5\u5E76\u4E0D\u592A\u9002\u5408\u4F7F\u7528\u591A\u7EBF\u7A0B\u3002</li><li>\u591A\u6838 \uFF1A \u5982\u679C\u662F\u591A\u6838CPU \u5904\u7406 CPU \u5BC6\u96C6\u578B\u7A0B\u5E8F\uFF0C\u6211\u4EEC\u5B8C\u5168\u53EF\u4EE5\u6700\u5927\u5316\u7684\u5229\u7528 CPU \u6838\u5FC3\u6570\uFF0C\u5E94\u7528\u5E76\u53D1\u7F16\u7A0B\u6765\u63D0\u9AD8\u6548\u7387\u3002CPU \u5BC6\u96C6\u578B\u7A0B\u5E8F\u7684\u6700\u4F73\u7EBF\u7A0B\u6570\u5C31\u662F\uFF1A\u7406\u8BBA\u4E0A\u7EBF\u7A0B\u6570\u91CF = CPU \u6838\u6570\uFF08\u903B\u8F91\uFF09\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\uFF0C\u6570\u91CF\u4E00\u822C\u4F1A\u8BBE\u7F6E\u4E3A CPU \u6838\u6570\uFF08\u903B\u8F91\uFF09+ 1\uFF08\u7ECF\u9A8C\u503C\uFF09,\u8BA1\u7B97(CPU)\u5BC6\u96C6\u578B\u7684\u7EBF\u7A0B\u6070\u597D\u5728\u67D0\u65F6\u56E0\u4E3A\u53D1\u751F\u4E00\u4E2A\u9875\u9519\u8BEF\u6216\u8005\u56E0\u5176\u4ED6\u539F\u56E0\u800C\u6682\u505C\uFF0C\u521A\u597D\u6709\u4E00\u4E2A\u201C\u989D\u5916\u201D\u7684\u7EBF\u7A0B\uFF0C\u53EF\u4EE5\u786E\u4FDD\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0BCPU\u5468\u671F\u4E0D\u4F1A\u4E2D\u65AD\u5DE5\u4F5C</li></ul><ol start="2"><li>I/O \u5BC6\u96C6\u578B\u7A0B\u5E8F\uFF0C\u4E0E CPU \u5BC6\u96C6\u578B\u7A0B\u5E8F\u76F8\u5BF9\uFF0C\u4E00\u4E2A\u5B8C\u6574\u8BF7\u6C42\uFF0CCPU\u8FD0\u7B97\u64CD\u4F5C\u5B8C\u6210\u4E4B\u540E\u8FD8\u6709\u5F88\u591A I/O \u64CD\u4F5C\u8981\u505A\uFF0C\u4E5F\u5C31\u662F\u8BF4 I/O \u64CD\u4F5C\u5360\u6BD4\u5F88\u5927\u90E8\u5206\uFF0C\u7B49\u5F85\u65F6\u95F4\u8F83\u957F\uFF0C\u7EBF\u7A0B\u7B49\u5F85\u65F6\u95F4\u6240\u5360\u6BD4\u4F8B\u8D8A\u9AD8\uFF0C\u9700\u8981\u8D8A\u591A\u7EBF\u7A0B\uFF1B\u7EBF\u7A0BCPU\u65F6\u95F4\u6240\u5360\u6BD4\u4F8B\u8D8A\u9AD8\uFF0C\u9700\u8981\u8D8A\u5C11\u7EBF\u7A0B</li></ol><ul><li>I/O \u5BC6\u96C6\u578B\u7A0B\u5E8F\u7684\u6700\u4F73\u7EBF\u7A0B\u6570\u5C31\u662F\uFF1A \u6700\u4F73\u7EBF\u7A0B\u6570 = CPU\u6838\u5FC3\u6570 <em>(1/CPU\u5229\u7528\u7387) = CPU\u6838\u5FC3\u6570</em> (1 + (I/O\u8017\u65F6/CPU\u8017\u65F6))</li><li>\u5982\u679C\u51E0\u4E4E\u5168\u662F I/O\u8017\u65F6\uFF0C\u90A3\u4E48CPU\u8017\u65F6\u5C31\u65E0\u9650\u8D8B\u8FD1\u4E8E0\uFF0C\u6240\u4EE5\u7EAF\u7406\u8BBA\u4F60\u5C31\u53EF\u4EE5\u8BF4\u662F 2N\uFF08N=CPU\u6838\u6570\uFF09\uFF0C\u5F53\u7136\u4E5F\u6709\u8BF4 2N + 1\u7684\uFF0C1\u5E94\u8BE5\u662Fbackup</li><li>\u4E00\u822C\u6211\u4EEC\u8BF4 2N + 1 \u5C31\u5373\u53EF</li></ul><h2 id="synchronized\u548Clock\u6709\u54EA\u4E9B\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#synchronized\u548Clock\u6709\u54EA\u4E9B\u533A\u522B" aria-hidden="true">#</a> synchronized\u548Clock\u6709\u54EA\u4E9B\u533A\u522B\uFF1F</h2><table><thead><tr><th>\u533A\u522B\u7C7B\u578B</th><th>synchronized</th><th>Lock</th></tr></thead><tbody><tr><td>\u5B58\u5728\u5C42\u6B21</td><td>Java\u7684\u5173\u952E\u5B57\uFF0C\u5728jvm\u5C42\u9762\u4E0A</td><td>\u662FJVM\u7684\u4E00\u4E2A\u63A5\u53E3</td></tr><tr><td>\u9501\u7684\u83B7\u53D6</td><td>\u5047\u8BBEA\u7EBF\u7A0B\u83B7\u5F97\u9501\uFF0CB\u7EBF\u7A0B\u7B49\u5F85\u3002\u5982\u679CA\u7EBF\u7A0B\u963B\u585E\uFF0CB\u7EBF\u7A0B\u4F1A\u4E00\u76F4\u7B49\u5F85</td><td>\u60C5\u51B5\u800C\u5B9A\uFF0CLock\u6709\u591A\u4E2A\u9501\u83B7\u53D6\u7684\u65B9\u5F0F\uFF0C\u5927\u81F4\u5C31\u662F\u53EF\u4EE5\u5C1D\u8BD5\u83B7\u5F97\u9501\uFF0C\u7EBF\u7A0B\u53EF\u4EE5\u4E0D\u7528\u4E00\u76F4\u7B49\u5F85(\u53EF\u4EE5\u901A\u8FC7tryLock\u5224\u65AD\u6709\u6CA1\u6709\u9501)</td></tr><tr><td>\u9501\u7684\u91CA\u653E</td><td>1\u3001\u4EE5\u83B7\u53D6\u9501\u7684\u7EBF\u7A0B\u6267\u884C\u5B8C\u540C\u6B65\u4EE3\u7801\uFF0C\u91CA\u653E\u95012\u3001\u7EBF\u7A0B\u6267\u884C\u53D1\u751F\u5F02\u5E38\uFF0Cjvm\u4F1A\u8BA9\u7EBF\u7A0B\u91CA\u653E</td><td>\u5728finally\u4E2D\u5FC5\u987B\u91CA\u653E\u9501\uFF0C\u4E0D\u7136\u5BB9\u6613\u9020\u6210\u7EBF\u7A0B\u6B7B\u9501</td></tr><tr><td>\u9501\u7C7B\u578B</td><td>\u9501\u53EF\u91CD\u5165\u3001\u4E0D\u53EF\u4E2D\u65AD\u3001\u975E\u516C\u5E73</td><td>\u53EF\u91CD\u5165\u3001\u53EF\u5224\u65AD \u53EF\u516C\u5E73\uFF08\u4E24\u8005\u7686\u53EF\uFF09</td></tr><tr><td>\u6027\u80FD</td><td>\u5C11\u91CF\u540C\u6B65</td><td>\u9002\u7528\u4E8E\u5927\u91CF\u540C\u6B65</td></tr><tr><td>\u652F\u6301\u9501\u7684\u573A\u666F</td><td>1. \u72EC\u5360\u9501</td><td>1. \u516C\u5E73\u9501\u4E0E\u975E\u516C\u5E73\u9501</td></tr></tbody></table><h2 id="aba\u95EE\u9898\u9047\u5230\u8FC7\u5417-\u8BE6\u7EC6\u8BF4\u4E00\u4E0B" tabindex="-1"><a class="header-anchor" href="#aba\u95EE\u9898\u9047\u5230\u8FC7\u5417-\u8BE6\u7EC6\u8BF4\u4E00\u4E0B" aria-hidden="true">#</a> ABA\u95EE\u9898\u9047\u5230\u8FC7\u5417\uFF0C\u8BE6\u7EC6\u8BF4\u4E00\u4E0B\uFF1F</h2><ol><li>\u6709\u4E24\u4E2A\u7EBF\u7A0B\u540C\u65F6\u53BB\u4FEE\u6539\u4E00\u4E2A\u53D8\u91CF\u7684\u503C\uFF0C\u6BD4\u5982\u7EBF\u7A0B1\u3001\u7EBF\u7A0B2\uFF0C\u90FD\u66F4\u65B0\u53D8\u91CF\u503C\uFF0C\u5C06\u53D8\u91CF\u503C\u4ECEA\u66F4\u65B0\u6210B\u3002</li><li>\u9996\u5148\u7EBF\u7A0B1\u83B7\u53D6\u5230CPU\u7684\u65F6\u95F4\u7247\uFF0C\u7EBF\u7A0B2\u7531\u4E8E\u67D0\u4E9B\u539F\u56E0\u53D1\u751F\u963B\u585E\u8FDB\u884C\u7B49\u5F85\uFF0C\u6B64\u65F6\u7EBF\u7A0B1\u8FDB\u884C\u6BD4\u8F83\u66F4\u65B0\uFF08CompareAndSwap\uFF09\uFF0C\u6210\u529F\u5C06\u53D8\u91CF\u7684\u503C\u4ECEA\u66F4\u65B0\u6210B\u3002</li><li>\u66F4\u65B0\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u6070\u597D\u53C8\u6709\u7EBF\u7A0B3\u8FDB\u6765\u60F3\u8981\u628A\u53D8\u91CF\u7684\u503C\u4ECEB\u66F4\u65B0\u6210A\uFF0C\u7EBF\u7A0B3\u8FDB\u884C\u6BD4\u8F83\u66F4\u65B0\uFF0C\u6210\u529F\u5C06\u53D8\u91CF\u7684\u503C\u4ECEB\u66F4\u65B0\u6210A\u3002</li><li>\u7EBF\u7A0B2\u83B7\u53D6\u5230CPU\u7684\u65F6\u95F4\u7247\uFF0C\u7136\u540E\u8FDB\u884C\u6BD4\u8F83\u66F4\u65B0\uFF0C\u53D1\u73B0\u503C\u662F\u9884\u671F\u7684A\uFF0C\u7136\u540E\u6709\u66F4\u65B0\u6210\u4E86B\u3002\u4F46\u662F\u7EBF\u7A0B1\u5E76\u4E0D\u77E5\u9053\uFF0C\u8BE5\u503C\u5DF2\u7ECF\u6709\u4E86A-&gt;B-&gt;A\u8FD9\u4E2A\u8FC7\u7A0B\uFF0C\u8FD9\u4E5F\u5C31\u662F\u6211\u4EEC\u5E38\u8BF4\u7684ABA\u95EE\u9898\u3002</li></ol><h2 id="volatile\u7684\u53EF\u89C1\u6027\u548C\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F\u600E\u4E48\u5B9E\u73B0\u7684" tabindex="-1"><a class="header-anchor" href="#volatile\u7684\u53EF\u89C1\u6027\u548C\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F\u600E\u4E48\u5B9E\u73B0\u7684" aria-hidden="true">#</a> volatile\u7684\u53EF\u89C1\u6027\u548C\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F\u600E\u4E48\u5B9E\u73B0\u7684\uFF1F</h2><ul><li><p>\u53EF\u89C1\u6027\uFF1A</p><p>volatile\u7684\u529F\u80FD\u5C31\u662F\u88AB\u4FEE\u9970\u7684\u53D8\u91CF\u5728\u88AB\u4FEE\u6539\u540E\u53EF\u4EE5\u7ACB\u5373\u540C\u6B65\u5230\u4E3B\u5185\u5B58\uFF0C\u88AB\u4FEE\u9970\u7684\u53D8\u91CF\u5728\u6BCF\u6B21\u662F\u7528\u4E4B\u524D\u90FD\u4ECE\u4E3B\u5185\u5B58\u5237\u65B0\u3002\u672C\u8D28\u4E5F\u662F\u901A\u8FC7\u5185\u5B58\u5C4F\u969C\u6765\u5B9E\u73B0\u53EF\u89C1\u6027</p><p>\u5199\u5185\u5B58\u5C4F\u969C\uFF08Store Memory Barrier\uFF09\u53EF\u4EE5\u4FC3\u4F7F\u5904\u7406\u5668\u5C06\u5F53\u524Dstore buffer\uFF08\u5B58\u50A8\u7F13\u5B58\uFF09\u7684\u503C\u5199\u56DE\u4E3B\u5B58\u3002\u8BFB\u5185\u5B58\u5C4F\u969C\uFF08Load Memory Barrier\uFF09\u53EF\u4EE5\u4FC3\u4F7F\u5904\u7406\u5668\u5904\u7406invalidate queue\uFF08\u5931\u6548\u961F\u5217\uFF09\u3002\u8FDB\u800C\u907F\u514D\u7531\u4E8EStore Buffer\u548CInvalidate Queue\u7684\u975E\u5B9E\u65F6\u6027\u5E26\u6765\u7684\u95EE\u9898\u3002</p></li><li><p>\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F\uFF1A volatile\u662F\u901A\u8FC7<strong>\u5185\u5B58\u5C4F\u969C</strong>\u6765\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F</p><p>JMM\u5185\u5B58\u5C4F\u969C\u7684\u7B56\u7565</p><ul><li>\u5728\u6BCF\u4E2A volatile \u5199\u64CD\u4F5C\u7684\u524D\u9762\u63D2\u5165\u4E00\u4E2A StoreStore \u5C4F\u969C\u3002</li><li>\u5728\u6BCF\u4E2A volatile \u5199\u64CD\u4F5C\u7684\u540E\u9762\u63D2\u5165\u4E00\u4E2A StoreLoad \u5C4F\u969C\u3002</li><li>\u5728\u6BCF\u4E2A volatile \u8BFB\u64CD\u4F5C\u7684\u540E\u9762\u63D2\u5165\u4E00\u4E2A LoadLoad \u5C4F\u969C\u3002</li><li>\u5728\u6BCF\u4E2A volatile \u8BFB\u64CD\u4F5C\u7684\u540E\u9762\u63D2\u5165\u4E00\u4E2A LoadStore \u5C4F\u969C\u3002</li></ul></li></ul><h2 id="concurrenthashmap\u5E95\u5C42\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap\u5E95\u5C42\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> ConcurrentHashMap\u5E95\u5C42\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>1.7</p><p>\u6570\u636E\u7ED3\u6784\uFF1A</p><p>\u5185\u90E8\u4E3B\u8981\u662F\u4E00\u4E2ASegment\u6570\u7EC4\uFF0C\u800C\u6570\u7EC4\u7684\u6BCF\u4E00\u9879\u53C8\u662F\u4E00\u4E2AHashEntry\u6570\u7EC4\uFF0C\u5143\u7D20\u90FD\u5B58\u5728HashEntry\u6570\u7EC4\u91CC\u3002\u56E0\u4E3A\u6BCF\u6B21\u9501\u5B9A\u7684\u662FSegment\u5BF9\u8C61\uFF0C\u4E5F\u5C31\u662F\u6574\u4E2AHashEntry\u6570\u7EC4\uFF0C\u6240\u4EE5\u53C8\u53EB\u5206\u6BB5\u9501\u3002</p><p>1.8</p><p>\u6570\u636E\u7ED3\u6784\uFF1A</p><p>\u4E0EHashMap\u4E00\u6837\u91C7\u7528\uFF1A\u6570\u7EC4+\u94FE\u8868+\u7EA2\u9ED1\u6811</p><p>\u5E95\u5C42\u539F\u7406\u5219\u662F\u91C7\u7528\u9501\u94FE\u8868\u6216\u8005\u7EA2\u9ED1\u6811\u5934\u7ED3\u70B9\uFF0C\u76F8\u6BD4\u4E8EHashTable\u7684\u65B9\u6CD5\u9501\uFF0C\u529B\u5EA6\u66F4\u7EC6\uFF0C\u662F\u5BF9\u6570\u7EC4\uFF08table\uFF09\u4E2D\u7684\u6876\uFF08\u94FE\u8868\u6216\u8005\u7EA2\u9ED1\u6811\uFF09\u7684\u5934\u7ED3\u70B9\u8FDB\u884C\u9501\u5B9A\uFF0C\u8FD9\u6837\u9501\u5B9A\uFF0C\u53EA\u4F1A\u5F71\u54CD\u6570\u7EC4\uFF08table\uFF09\u5F53\u524D\u4E0B\u6807\u7684\u6570\u636E\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u5176\u4ED6\u4E0B\u6807\u8282\u70B9\u7684\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u63D0\u9AD8\u8BFB\u5199\u6548\u7387\u3002 putVal\u6267\u884C\u6D41\u7A0B\uFF1A</p><ol><li>\u5224\u65AD\u5B58\u50A8\u7684key\u3001value\u662F\u5426\u4E3A\u7A7A\uFF0C\u82E5\u4E3A\u7A7A\uFF0C\u5219\u629B\u51FA\u5F02\u5E38</li><li>\u8BA1\u7B97key\u7684hash\u503C\uFF0C\u968F\u540E\u6B7B\u5FAA\u73AF\uFF08\u8BE5\u5FAA\u73AF\u53EF\u4EE5\u786E\u4FDD\u6210\u529F\u63D2\u5165\uFF0C\u5F53\u6EE1\u8DB3\u9002\u5F53\u6761\u4EF6\u65F6\uFF0C\u4F1A\u4E3B\u52A8\u7EC8\u6B62\uFF09\uFF0C\u5224\u65ADtable\u8868\u4E3A\u7A7A\u6216\u8005\u957F\u5EA6\u4E3A0\uFF0C\u5219\u521D\u59CB\u5316table\u8868</li><li>\u6839\u636Ehash\u503C\u83B7\u53D6table\u4E2D\u8BE5\u4E0B\u6807\u5BF9\u5E94\u7684\u8282\u70B9\uFF0C\u5982\u679C\u8BE5\u8282\u70B9\u4E3A\u7A7A\uFF0C\u5219\u6839\u636E\u53C2\u6570\u751F\u6210\u65B0\u7684\u8282\u70B9\uFF0C\u5E76\u4EE5CAS\u7684\u65B9\u5F0F\u8FDB\u884C\u66F4\u65B0\uFF0C\u5E76\u7EC8\u6B62\u6B7B\u5FAA\u73AF\u3002</li><li>\u5982\u679C\u8BE5\u8282\u70B9\u7684hash\u503C\u662FMOVED(-1)\uFF0C\u8868\u793A\u6B63\u5728\u6269\u5BB9\uFF0C\u5219\u8F85\u52A9\u5BF9\u8BE5\u8282\u70B9\u8FDB\u884C\u8F6C\u79FB\u3002</li><li></li></ol><p>\u5BF9\u6570\u7EC4\uFF08table\uFF09\u4E2D\u7684\u8282\u70B9\uFF0C\u5373\u6876\u7684\u5934\u7ED3\u70B9\u8FDB\u884C\u9501\u5B9A\uFF0C\u5982\u679C\u8BE5\u8282\u70B9\u7684hash\u5927\u4E8E\u7B49\u4E8E0\uFF0C\u8868\u793A\u6B64\u6876\u662F\u94FE\u8868\uFF0C\u7136\u540E\u5BF9\u8BE5\u6876\u8FDB\u884C\u904D\u5386\uFF08\u6B7B\u5FAA\u73AF\uFF09\uFF0C\u5BFB\u627E\u94FE\u8868\u4E2D\u4E0Eput\u7684key\u7684hash\u503C\u76F8\u7B49\uFF0C\u5E76\u4E14key\u76F8\u7B49\u7684\u5143\u7D20\uFF0C\u7136\u540E\u8FDB\u884C\u503C\u7684\u66FF\u6362\uFF0C\u5982\u679C\u5230\u94FE\u8868\u5C3E\u90E8\u90FD\u6CA1\u6709\u7B26\u5408\u6761\u4EF6\u7684\uFF0C\u5C31\u65B0\u5EFA\u4E00\u4E2Anode\uFF0C\u7136\u540E\u63D2\u5165\u5230\u8BE5\u6876\u7684\u5C3E\u90E8\uFF0C\u5E76\u7EC8\u6B62\u8BE5\u5FAA\u73AF\u904D\u5386\u3002</p><ol start="6"><li>\u5982\u679C\u8BE5\u8282\u70B9\u7684hash\u5C0F\u4E8E0\uFF0C\u5E76\u4E14\u8282\u70B9\u7C7B\u578B\u662FTreeBin\uFF0C\u5219\u8D70\u7EA2\u9ED1\u6811\u7684\u63D2\u5165\u65B9\u5F0F\u3002</li><li>\u5224\u65AD\u662F\u5426\u8FBE\u5230\u8F6C\u5316\u7EA2\u9ED1\u6811\u7684\u9608\u503C\uFF0C\u5982\u679C\u8FBE\u5230\u9608\u503C\uFF0C\u5219\u94FE\u8868\u8F6C\u5316\u4E3A\u7EA2\u9ED1\u6811\u3002</li></ol><h2 id="\u5206\u5E03\u5F0Fid\u751F\u6210\u65B9\u6848\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0Fid\u751F\u6210\u65B9\u6848\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u5206\u5E03\u5F0Fid\u751F\u6210\u65B9\u6848\u6709\u54EA\u4E9B\uFF1F</h2><p>UUID,\u6570\u636E\u5E93\u4E3B\u952E\u81EA\u589E\uFF0CRedis\u81EA\u589EID\uFF0C\u96EA\u82B1\u7B97\u6CD5\u3002</p><table><thead><tr><th></th><th>\u63CF\u8FF0</th><th>\u4F18\u70B9</th><th>\u7F3A\u70B9</th></tr></thead><tbody><tr><td>UUID</td><td>UUID\u662F\u901A\u7528\u552F\u4E00\u6807\u8BC6\u7801\u7684\u7F29\u5199\uFF0C\u5176\u76EE\u7684\u662F\u8BA9\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u6240\u6709\u5143\u7D20\u90FD\u6709\u552F\u4E00\u7684\u8FA8\u8BC6\u4FE1\u606F\uFF0C\u800C\u4E0D\u9700\u8981\u901A\u8FC7\u4E2D\u592E\u63A7\u5236\u5668\u6765\u6307\u5B9A\u552F\u4E00\u6807\u8BC6\u3002</td><td>1. \u964D\u4F4E\u5168\u5C40\u8282\u70B9\u7684\u538B\u529B\uFF0C\u4F7F\u5F97\u4E3B\u952E\u751F\u6210\u901F\u5EA6\u66F4\u5FEB\uFF1B<br>2. \u751F\u6210\u7684\u4E3B\u952E\u5168\u5C40\u552F\u4E00\uFF1B<br>3. \u8DE8\u670D\u52A1\u5668\u5408\u5E76\u6570\u636E\u65B9\u4FBF\u3002</td><td>1. UUID\u5360\u752816\u4E2A\u5B57\u7B26\uFF0C\u7A7A\u95F4\u5360\u7528\u8F83\u591A\uFF1B<br>2. \u4E0D\u662F\u9012\u589E\u6709\u5E8F\u7684\u6570\u5B57\uFF0C\u6570\u636E\u5199\u5165IO\u968F\u673A\u6027\u5F88\u5927\uFF0C\u4E14\u7D22\u5F15\u6548\u7387\u4E0B\u964D</td></tr><tr><td>\u6570\u636E\u5E93\u4E3B\u952E\u81EA\u589E</td><td>MySQL\u6570\u636E\u5E93\u8BBE\u7F6E\u4E3B\u952E\u4E14\u4E3B\u952E\u81EA\u52A8\u589E\u957F</td><td>1. INT\u548CBIGINT\u7C7B\u578B\u5360\u7528\u7A7A\u95F4\u8F83\u5C0F\uFF1B<br>2. \u4E3B\u952E\u81EA\u52A8\u589E\u957F\uFF0CIO\u5199\u5165\u8FDE\u7EED\u6027\u597D\uFF1B<br>3. \u6570\u5B57\u7C7B\u578B\u67E5\u8BE2\u901F\u5EA6\u4F18\u4E8E\u5B57\u7B26\u4E32</td><td>1. \u5E76\u53D1\u6027\u80FD\u4E0D\u9AD8\uFF0C\u53D7\u9650\u4E8E\u6570\u636E\u5E93\u6027\u80FD\uFF1B<br>2. \u5206\u5E93\u5206\u8868\uFF0C\u9700\u8981\u6539\u9020\uFF0C\u590D\u6742\uFF1B<br>3. \u81EA\u589E\uFF1A\u6570\u636E\u548C\u6570\u636E\u91CF\u6CC4\u9732</td></tr><tr><td>Redis\u81EA\u589E</td><td>Redis\u8BA1\u6570\u5668\uFF0C\u539F\u5B50\u6027\u81EA\u589E</td><td>\u4F7F\u7528\u5185\u5B58\uFF0C\u5E76\u53D1\u6027\u80FD\u597D</td><td>1. \u6570\u636E\u4E22\u5931\uFF1B<br>2. \u81EA\u589E\uFF1A\u6570\u636E\u91CF\u6CC4\u9732</td></tr><tr><td>\u96EA\u82B1\u7B97\u6CD5\uFF08snowflake\uFF09</td><td>\u5927\u540D\u9F0E\u9F0E\u7684\u96EA\u82B1\u7B97\u6CD5\uFF0C\u5206\u5E03\u5F0FID\u7684\u7ECF\u5178\u89E3\u51B3\u65B9\u6848</td><td>1. \u4E0D\u4F9D\u8D56\u5916\u90E8\u7EC4\u4EF6\uFF1B<br>2. \u6027\u80FD\u597D</td><td>\u65F6\u949F\u56DE\u62E8</td></tr></tbody></table><h2 id="\u96EA\u82B1\u7B97\u6CD5\u751F\u6210\u7684id\u7531\u54EA\u4E9B\u90E8\u5206\u7EC4\u6210" tabindex="-1"><a class="header-anchor" href="#\u96EA\u82B1\u7B97\u6CD5\u751F\u6210\u7684id\u7531\u54EA\u4E9B\u90E8\u5206\u7EC4\u6210" aria-hidden="true">#</a> \u96EA\u82B1\u7B97\u6CD5\u751F\u6210\u7684ID\u7531\u54EA\u4E9B\u90E8\u5206\u7EC4\u6210?</h2><ol><li>\u7B26\u53F7\u4F4D\uFF0C\u5360\u75281\u4F4D\u3002</li><li>\u65F6\u95F4\u6233\uFF0C\u5360\u752841\u4F4D\uFF0C\u53EF\u4EE5\u652F\u630169\u5E74\u7684\u65F6\u95F4\u8DE8\u5EA6\u3002</li><li>\u673A\u5668ID\uFF0C\u5360\u752810\u4F4D\u3002</li><li>\u5E8F\u5217\u53F7\uFF0C\u5360\u752812\u4F4D\u3002\u4E00\u6BEB\u79D2\u53EF\u4EE5\u751F\u62104095\u4E2AID\u3002</li></ol><h2 id="\u5206\u5E03\u5F0F\u9501\u5728\u9879\u76EE\u4E2D\u6709\u54EA\u4E9B\u5E94\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u9501\u5728\u9879\u76EE\u4E2D\u6709\u54EA\u4E9B\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u9501\u5728\u9879\u76EE\u4E2D\u6709\u54EA\u4E9B\u5E94\u7528\u573A\u666F\uFF1F</h2><p>\u4F7F\u7528\u5206\u5E03\u5F0F\u9501\u7684\u573A\u666F\u4E00\u822C\u9700\u8981\u6EE1\u8DB3\u4EE5\u4E0B\u573A\u666F\uFF1A</p><ol><li>\u7CFB\u7EDF\u662F\u4E00\u4E2A\u5206\u5E03\u5F0F\u7CFB\u7EDF,\u96C6\u7FA4\u96C6\u7FA4\uFF0Cjava\u7684\u9501\u5DF2\u7ECF\u9501\u4E0D\u4F4F\u4E86\u3002</li><li>\u64CD\u4F5C\u5171\u4EAB\u8D44\u6E90\uFF0C\u6BD4\u5982\u5E93\u91CC\u552F\u4E00\u7684\u7528\u6237\u6570\u636E\u3002</li><li>\u540C\u6B65\u8BBF\u95EE\uFF0C\u5373\u591A\u4E2A\u8FDB\u7A0B\u540C\u65F6\u64CD\u4F5C\u5171\u4EAB\u8D44\u6E90\u3002</li></ol><h2 id="\u5206\u5E03\u9501\u6709\u54EA\u4E9B\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u9501\u6709\u54EA\u4E9B\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> \u5206\u5E03\u9501\u6709\u54EA\u4E9B\u89E3\u51B3\u65B9\u6848\uFF1F</h2><ol><li>Reids\u7684\u5206\u5E03\u5F0F\u9501\uFF0C\u5F88\u591A\u5927\u516C\u53F8\u4F1A\u57FA\u4E8EReidis\u505A\u6269\u5C55\u5F00\u53D1\u3002setnx key value ex 10s\uFF0CRedisson\u3002 watch dog.</li><li>\u57FA\u4E8EZookeeper\u3002\u4E34\u65F6\u8282\u70B9\uFF0C\u987A\u5E8F\u8282\u70B9\u3002</li><li>\u57FA\u4E8E\u6570\u636E\u5E93\uFF0C\u6BD4\u5982Mysql\u3002\u4E3B\u952E\u6216\u552F\u4E00\u7D22\u5F15\u7684\u552F\u4E00\u6027\u3002</li></ol><h2 id="redis\u505A\u5206\u5E03\u5F0F\u9501\u7528\u4EC0\u4E48\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#redis\u505A\u5206\u5E03\u5F0F\u9501\u7528\u4EC0\u4E48\u547D\u4EE4" aria-hidden="true">#</a> Redis\u505A\u5206\u5E03\u5F0F\u9501\u7528\u4EC0\u4E48\u547D\u4EE4\uFF1F</h2><p>SETNX</p><p>\u683C\u5F0F\uFF1Asetnx key value \u5C06 key \u7684\u503C\u8BBE\u4E3A value \uFF0C\u5F53\u4E14\u4EC5\u5F53 key \u4E0D\u5B58\u5728\u3002</p><p>\u82E5\u7ED9\u5B9A\u7684 key \u5DF2\u7ECF\u5B58\u5728\uFF0C\u5219 SETNX \u4E0D\u505A\u4EFB\u4F55\u52A8\u4F5C,\u64CD\u4F5C\u5931\u8D25\u3002</p><p>SETNX \u662F\u300ESET if Not eXists\u300F(\u5982\u679C\u4E0D\u5B58\u5728\uFF0C\u5219 SET)\u7684\u7B80\u5199\u3002</p><p>\u52A0\u9501\uFF1Aset key value nx ex 10s</p><p>\u91CA\u653E\u9501\uFF1Adelete key</p><h2 id="redis\u505A\u5206\u5E03\u5F0F\u9501\u6B7B\u9501\u6709\u54EA\u4E9B\u60C5\u51B5-\u5982\u4F55\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#redis\u505A\u5206\u5E03\u5F0F\u9501\u6B7B\u9501\u6709\u54EA\u4E9B\u60C5\u51B5-\u5982\u4F55\u89E3\u51B3" aria-hidden="true">#</a> Redis\u505A\u5206\u5E03\u5F0F\u9501\u6B7B\u9501\u6709\u54EA\u4E9B\u60C5\u51B5\uFF0C\u5982\u4F55\u89E3\u51B3\uFF1F</h2><p>\u60C5\u51B51\uFF1A\u52A0\u9501\uFF0C\u6CA1\u6709\u91CA\u653E\u9501\u3002\u9700\u8981\u52A0\u91CA\u653E\u9501\u7684\u64CD\u4F5C\u3002\u6BD4\u5982delete key\u3002</p><p>\u60C5\u51B52\uFF1A\u52A0\u9501\u540E\uFF0C\u7A0B\u5E8F\u8FD8\u6CA1\u6709\u6267\u884C\u91CA\u653E\u9501\uFF0C\u7A0B\u5E8F\u6302\u4E86\u3002\u9700\u8981\u7528\u7684key\u7684\u8FC7\u671F\u673A\u5236\u3002</p><h2 id="redis\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501" tabindex="-1"><a class="header-anchor" href="#redis\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501" aria-hidden="true">#</a> Redis\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501\uFF1F</h2><p>\u5047\u8BBE\u6709\u4E24\u4E2A\u670D\u52A1A\u3001B\u90FD\u5E0C\u671B\u83B7\u5F97\u9501\uFF0C\u6267\u884C\u8FC7\u7A0B\u5927\u81F4\u5982\u4E0B:</p><p><em>Step1</em>\uFF1A \u670D\u52A1A\u4E3A\u4E86\u83B7\u5F97\u9501\uFF0C\u5411Redis\u53D1\u8D77\u5982\u4E0B\u547D\u4EE4: SET productId:lock 0xx9p03001 NX EX 30000 \u5176\u4E2D\uFF0C&quot;productId&quot;\u7531\u81EA\u5DF1\u5B9A\u4E49\uFF0C\u53EF\u4EE5\u662F\u4E0E\u672C\u6B21\u4E1A\u52A1\u6709\u5173\u7684id\uFF0C&quot;0xx9p03001&quot; \u662F\u4E00\u4E32\u968F\u673A\u503C\uFF0C\u5FC5\u987B\u4FDD\u8BC1\u5168\u5C40\u552F\u4E00\uFF0C\u201CNX&quot;\u6307\u7684\u662F\u5F53\u4E14\u4EC5\u5F53key(\u4E5F\u5C31\u662F\u6848\u4F8B\u4E2D\u7684&quot;productId:lock\u201D)\u5728Redis\u4E2D\u4E0D\u5B58\u5728\u65F6\uFF0C\u8FD4\u56DE\u6267\u884C\u6210\u529F\uFF0C\u5426\u5219\u6267\u884C\u5931\u8D25\u3002&quot;EX 30000&quot; \u6307\u7684\u662F\u572830\u79D2\u540E\uFF0Ckey\u5C06\u88AB\u81EA\u52A8\u5220\u9664\u3002\u6267\u884C\u547D\u4EE4\u540E\u8FD4\u56DE\u6210\u529F\uFF0C\u8868\u660E\u670D\u52A1\u6210\u529F\u7684\u83B7\u5F97\u4E86\u9501\u3002</p><p><em>Step2</em>: \u670D\u52A1B\u4E3A\u4E86\u83B7\u5F97\u9501\uFF0C\u5411Redis\u53D1\u8D77\u540C\u6837\u7684\u547D\u4EE4: SET productId:lock 0000111 NX EX 30000 \u7531\u4E8ERedis\u5185\u5DF2\u7ECF\u5B58\u5728\u540C\u540Dkey\uFF0C\u4E14\u5E76\u672A\u8FC7\u671F\uFF0C\u56E0\u6B64\u547D\u4EE4\u6267\u884C\u5931\u8D25\uFF0C\u670D\u52A1B\u672A\u80FD\u83B7\u5F97\u9501\u3002\u670D\u52A1B\u8FDB\u5165\u5FAA\u73AF\u8BF7\u6C42\u72B6\u6001\uFF0C\u6BD4\u5982\u6BCF\u96941\u79D2\u949F(\u81EA\u884C\u8BBE\u7F6E)\u5411Redis\u53D1\u9001\u8BF7\u6C42\uFF0C\u76F4\u5230\u6267\u884C\u6210\u529F\u5E76\u83B7\u5F97\u9501\u3002</p><p><em>Step3</em>: \u670D\u52A1A\u7684\u4E1A\u52A1\u4EE3\u7801\u6267\u884C\u65F6\u957F\u8D85\u8FC7\u4E8630\u79D2\uFF0C\u5BFC\u81F4key\u8D85\u65F6\uFF0C\u56E0\u6B64Redis\u81EA\u52A8\u5220\u9664\u4E86key\u3002\u6B64\u65F6\u670D\u52A1B\u518D\u6B21\u53D1\u9001\u547D\u4EE4\u6267\u884C\u6210\u529F\uFF0C\u5047\u8BBE\u672C\u6B21\u8BF7\u6C42\u4E2D\u8BBE\u7F6E\u7684value\u503C\u4E3A0000222\u3002\u6B64\u65F6\u9700\u8981\u5728\u670D\u52A1A\u4E2D\u5BF9key\u8FDB\u884C\u7EED\u671F\uFF0Cwatch dog\u3002</p><p><em>Step4</em>: \u670D\u52A1A\u6267\u884C\u5B8C\u6BD5\uFF0C\u4E3A\u4E86\u91CA\u653E\u9501\uFF0C\u670D\u52A1A\u4F1A\u4E3B\u52A8\u5411Redis\u53D1\u8D77\u5220\u9664key\u7684\u8BF7\u6C42\u3002\u6CE8\u610F: \u5728\u5220\u9664key\u4E4B\u524D\uFF0C\u4E00\u5B9A\u8981\u5224\u65AD\u670D\u52A1A\u6301\u6709\u7684value\u4E0ERedis\u5185\u5B58\u50A8\u7684value\u662F\u5426\u4E00\u81F4\u3002\u6BD4\u5982\u5F53\u524D\u573A\u666F\u4E0B\uFF0CRedis\u4E2D\u7684\u9501\u65E9\u5C31\u4E0D\u662F\u670D\u52A1A\u6301\u6709\u7684\u90A3\u4E00\u628A\u4E86\uFF0C\u800C\u662F\u7531\u670D\u52A12\u521B\u5EFA\uFF0C\u5982\u679C\u8D38\u7136\u4F7F\u7528\u670D\u52A1A\u6301\u6709\u7684key\u6765\u5220\u9664\u9501\uFF0C\u5219\u4F1A\u8BEF\u5C06\u670D\u52A12\u7684\u9501\u91CA\u653E\u6389\u3002\u6B64\u5916\uFF0C\u7531\u4E8E\u5220\u9664\u9501\u65F6\u6D89\u53CA\u5230\u4E00\u7CFB\u5217\u5224\u65AD\u903B\u8F91\uFF0C\u56E0\u6B64\u4E00\u822C\u4F7F\u7528lua\u811A\u672C\uFF0C\u5177\u4F53\u5982\u4E0B:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">if</span> redis<span class="token punctuation">.</span><span class="token keyword">call</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">KEYS</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">=</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">then</span>
	<span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token keyword">call</span><span class="token punctuation">(</span><span class="token string">&quot;del&quot;</span><span class="token punctuation">,</span> <span class="token keyword">KEYS</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
	<span class="token keyword">return</span> <span class="token number">0</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u57FA\u4E8E-zookeeper-\u7684\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u57FA\u4E8E-zookeeper-\u7684\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u57FA\u4E8E ZooKeeper \u7684\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48?</h2><p>\u987A\u5E8F\u8282\u70B9\u7279\u6027\uFF1A</p><p>\u4F7F\u7528 ZooKeeper \u7684\u987A\u5E8F\u8282\u70B9\u7279\u6027\uFF0C\u5047\u5982\u6211\u4EEC\u5728/lock/\u76EE\u5F55\u4E0B\u521B\u5EFA3\u4E2A\u8282\u70B9\uFF0CZK\u96C6\u7FA4\u4F1A\u6309\u7167\u53D1\u8D77\u521B\u5EFA\u7684\u987A\u5E8F\u6765\u521B\u5EFA\u8282\u70B9\uFF0C\u8282\u70B9\u5206\u522B\u4E3A/lock/0000000001\u3001/lock/0000000002\u3001/lock/0000000003\uFF0C\u6700\u540E\u4E00\u4F4D\u6570\u662F\u4F9D\u6B21\u9012\u589E\u7684\uFF0C\u8282\u70B9\u540D\u7531zk\u6765\u5B8C\u6210\u3002</p><p>\u4E34\u65F6\u8282\u70B9\u7279\u6027\uFF1A</p><p>ZK\u4E2D\u8FD8\u6709\u4E00\u79CD\u540D\u4E3A\u4E34\u65F6\u8282\u70B9\u7684\u8282\u70B9\uFF0C\u4E34\u65F6\u8282\u70B9\u7531\u67D0\u4E2A\u5BA2\u6237\u7AEF\u521B\u5EFA\uFF0C\u5F53\u5BA2\u6237\u7AEF\u4E0EZK\u96C6\u7FA4\u65AD\u5F00\u8FDE\u63A5\uFF0C\u5219\u8BE5\u8282\u70B9\u81EA\u52A8\u88AB\u5220\u9664\u3002EPHEMERAL_SEQUENTIAL\u4E3A\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\u3002</p><p>\u6839\u636EZK\u4E2D\u8282\u70B9\u662F\u5426\u5B58\u5728\uFF0C\u53EF\u4EE5\u4F5C\u4E3A\u5206\u5E03\u5F0F\u9501\u7684\u9501\u72B6\u6001\uFF0C\u4EE5\u6B64\u6765\u5B9E\u73B0\u4E00\u4E2A\u5206\u5E03\u5F0F\u9501\uFF0C\u4E0B\u9762\u662F\u5206\u5E03\u5F0F\u9501\u7684\u57FA\u672C\u903B\u8F91\uFF1A</p><ol><li>\u5BA2\u6237\u7AEF1\u8C03\u7528create()\u65B9\u6CD5\u521B\u5EFA\u540D\u4E3A\u201C/\u4E1A\u52A1ID/lock-\u201D\u7684\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\u3002</li><li>\u5BA2\u6237\u7AEF1\u8C03\u7528getChildren(\u201C\u4E1A\u52A1ID\u201D)\u65B9\u6CD5\u6765\u83B7\u53D6\u6240\u6709\u5DF2\u7ECF\u521B\u5EFA\u7684\u5B50\u8282\u70B9\u3002</li><li>\u5BA2\u6237\u7AEF\u83B7\u53D6\u5230\u6240\u6709\u5B50\u8282\u70B9path\u4E4B\u540E\uFF0C\u5982\u679C\u53D1\u73B0\u81EA\u5DF1\u5728\u6B65\u9AA41\u4E2D\u521B\u5EFA\u7684\u8282\u70B9\u662F\u6240\u6709\u8282\u70B9\u4E2D\u5E8F\u53F7\u6700\u5C0F\u7684\uFF0C\u5C31\u662F\u770B\u81EA\u5DF1\u521B\u5EFA\u7684\u5E8F\u5217\u53F7\u662F\u5426\u6392\u7B2C\u4E00\uFF0C\u5982\u679C\u662F\u7B2C\u4E00\uFF0C\u90A3\u4E48\u5C31\u8BA4\u4E3A\u8FD9\u4E2A\u5BA2\u6237\u7AEF1\u83B7\u5F97\u4E86\u9501\uFF0C\u5728\u5B83\u524D\u9762\u6CA1\u6709\u522B\u7684\u5BA2\u6237\u7AEF\u62FF\u5230\u9501\u3002</li><li>\u5982\u679C\u521B\u5EFA\u7684\u8282\u70B9\u4E0D\u662F\u6240\u6709\u8282\u70B9\u4E2D\u9700\u8981\u6700\u5C0F\u7684\uFF0C\u90A3\u4E48\u5219\u76D1\u89C6\u6BD4\u81EA\u5DF1\u521B\u5EFA\u8282\u70B9\u7684\u5E8F\u5217\u53F7\u5C0F\u7684\u6700\u5927\u7684\u8282\u70B9\uFF0C\u8FDB\u5165\u7B49\u5F85\u3002\u76F4\u5230\u4E0B\u6B21\u76D1\u89C6\u7684\u5B50\u8282\u70B9\u53D8\u66F4\u7684\u65F6\u5019\uFF0C\u518D\u8FDB\u884C\u5B50\u8282\u70B9\u7684\u83B7\u53D6\uFF0C\u5224\u65AD\u662F\u5426\u83B7\u53D6\u9501\u3002</li></ol><h2 id="zookeeper\u548Creids\u505A\u5206\u5E03\u5F0F\u9501\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#zookeeper\u548Creids\u505A\u5206\u5E03\u5F0F\u9501\u7684\u533A\u522B" aria-hidden="true">#</a> ZooKeeper\u548CReids\u505A\u5206\u5E03\u5F0F\u9501\u7684\u533A\u522B\uFF1F</h2><p>Reids\uFF1A</p><ol><li>Redis\u53EA\u4FDD\u8BC1\u6700\u7EC8\u4E00\u81F4\u6027\uFF0C\u526F\u672C\u95F4\u7684\u6570\u636E\u590D\u5236\u662F\u5F02\u6B65\u8FDB\u884C\uFF08Set\u662F\u5199\uFF0CGet\u662F\u8BFB\uFF0CReids\u96C6\u7FA4\u4E00\u822C\u662F\u8BFB\u5199\u5206\u79BB\u67B6\u6784\uFF0C\u5B58\u5728\u4E3B\u4ECE\u540C\u6B65\u5EF6\u8FDF\u60C5\u51B5\uFF09\uFF0C\u4E3B\u4ECE\u5207\u6362\u4E4B\u540E\u53EF\u80FD\u6709\u90E8\u5206\u6570\u636E\u6CA1\u6709\u590D\u5236\u8FC7\u53BB\u53EF\u80FD\u4F1A <strong>\u300C\u4E22\u5931\u9501\u300D</strong> \u60C5\u51B5\uFF0C\u6545\u5F3A\u4E00\u81F4\u6027\u8981\u6C42\u7684\u4E1A\u52A1\u4E0D\u63A8\u8350\u4F7F\u7528Reids\uFF0C\u63A8\u8350\u4F7F\u7528zk\u3002</li><li>Redis\u96C6\u7FA4\u5404\u65B9\u6CD5\u7684\u54CD\u5E94\u65F6\u95F4\u5747\u4E3A\u6700\u4F4E\u3002\u968F\u7740\u5E76\u53D1\u91CF\u548C\u4E1A\u52A1\u6570\u91CF\u7684\u63D0\u5347\u5176\u54CD\u5E94\u65F6\u95F4\u4F1A\u6709\u660E\u663E\u4E0A\u5347\uFF08\u516C\u7F51\u96C6\u7FA4\u5F71\u54CD\u56E0\u7D20\u504F\u5927\uFF09\uFF0C\u4F46\u662F\u6781\u9650qps\u53EF\u4EE5\u8FBE\u5230\u6700\u5927\u4E14\u57FA\u672C\u65E0\u5F02\u5E38</li></ol><p>ZooKeeper\uFF1A</p><ol><li></li></ol><p>\u4F7F\u7528ZooKeeper\u96C6\u7FA4\uFF0C\u9501\u539F\u7406\u662F\u4F7F\u7528ZooKeeper\u7684\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\uFF0C\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\u7684\u751F\u547D\u5468\u671F\u5728Client\u4E0E\u96C6\u7FA4\u7684Session\u7ED3\u675F\u65F6\u7ED3\u675F\u3002\u56E0\u6B64\u5982\u679C\u67D0\u4E2AClient\u8282\u70B9\u5B58\u5728\u7F51\u7EDC\u95EE\u9898\uFF0C\u4E0EZooKeeper\u96C6\u7FA4\u65AD\u5F00\u8FDE\u63A5\uFF0CSession\u8D85\u65F6\u540C\u6837\u4F1A\u5BFC\u81F4\u9501\u88AB\u9519\u8BEF\u7684\u91CA\u653E\uFF08\u5BFC\u81F4\u88AB\u5176\u4ED6\u7EBF\u7A0B\u9519\u8BEF\u5730\u6301\u6709\uFF09\uFF0C\u56E0\u6B64ZooKeeper\u4E5F\u65E0\u6CD5\u4FDD\u8BC1\u5B8C\u5168\u4E00\u81F4\u3002</p><ol start="2"><li>ZK\u5177\u6709\u8F83\u597D\u7684\u7A33\u5B9A\u6027\uFF1B\u54CD\u5E94\u65F6\u95F4\u6296\u52A8\u5F88\u5C0F\uFF0C\u6CA1\u6709\u51FA\u73B0\u5F02\u5E38\u3002\u4F46\u662F\u968F\u7740\u5E76\u53D1\u91CF\u548C\u4E1A\u52A1\u6570\u91CF\u7684\u63D0\u5347\u5176\u54CD\u5E94\u65F6\u95F4\u548Cqps\u4F1A\u660E\u663E\u4E0B\u964D\u3002</li></ol><p>\u603B\u7ED3\uFF1A</p><ol><li>Zookeeper\u6BCF\u6B21\u8FDB\u884C\u9501\u64CD\u4F5C\u524D\u90FD\u8981\u521B\u5EFA\u82E5\u5E72\u8282\u70B9\uFF0C\u5B8C\u6210\u540E\u8981\u91CA\u653E\u8282\u70B9\uFF0C\u4F1A\u6D6A\u8D39\u5F88\u591A\u65F6\u95F4\uFF1B</li><li>\u800CRedis\u53EA\u662F\u7B80\u5355\u7684\u6570\u636E\u64CD\u4F5C\uFF0C\u6CA1\u6709\u8FD9\u4E2A\u95EE\u9898\u3002</li></ol><h2 id="mysql\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501" tabindex="-1"><a class="header-anchor" href="#mysql\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501" aria-hidden="true">#</a> MySQL\u5982\u4F55\u505A\u5206\u5E03\u5F0F\u9501\uFF1F</h2><p>\u5728Mysql\u4E2D\u521B\u5EFA\u4E00\u5F20\u8868\uFF0C\u8BBE\u7F6E\u4E00\u4E2A \u4E3B\u952E\u6216\u8005UNIQUE KEY \u8FD9\u4E2A KEY \u5C31\u662F\u8981\u9501\u7684 KEY\uFF08\u5546\u54C1ID\uFF09\uFF0C\u6240\u4EE5\u540C\u4E00\u4E2A KEY \u5728mysql\u8868\u91CC\u53EA\u80FD\u63D2\u5165\u4E00\u6B21\u4E86\uFF0C\u8FD9\u6837\u5BF9\u9501\u7684\u7ADE\u4E89\u5C31\u4EA4\u7ED9\u4E86\u6570\u636E\u5E93\uFF0C\u5904\u7406\u540C\u4E00\u4E2A KEY \u6570\u636E\u5E93\u4FDD\u8BC1\u4E86\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\u80FD\u63D2\u5165\u6210\u529F\uFF0C\u5176\u4ED6\u8282\u70B9\u90FD\u4F1A\u63D2\u5165\u5931\u8D25\u3002</p><p>DB\u5206\u5E03\u5F0F\u9501\u7684\u5B9E\u73B0\uFF1A\u901A\u8FC7\u4E3B\u952Eid \u6216\u8005 \u552F\u4E00\u7D22\u6027 \u7684\u552F\u4E00\u6027\u8FDB\u884C\u52A0\u9501\uFF0C\u8BF4\u767D\u4E86\u5C31\u662F\u52A0\u9501\u7684\u5F62\u5F0F\u662F\u5411\u4E00\u5F20\u8868\u4E2D\u63D2\u5165\u4E00\u6761\u6570\u636E\uFF0C\u8BE5\u6761\u6570\u636E\u7684id\u5C31\u662F\u4E00\u628A\u5206\u5E03\u5F0F\u9501\uFF0C\u4F8B\u5982\u5F53\u4E00\u6B21\u8BF7\u6C42\u63D2\u5165\u4E86\u4E00\u6761id\u4E3A1\u7684\u6570\u636E\uFF0C\u5176\u4ED6\u60F3\u8981\u8FDB\u884C\u63D2\u5165\u6570\u636E\u7684\u5E76\u53D1\u8BF7\u6C42\u5FC5\u987B\u7B49\u7B2C\u4E00\u6B21\u8BF7\u6C42\u6267\u884C\u5B8C\u6210\u540E\u5220\u9664\u8FD9\u6761id\u4E3A1\u7684\u6570\u636E\u624D\u80FD\u7EE7\u7EED\u63D2\u5165\uFF0C\u5B9E\u73B0\u4E86\u5206\u5E03\u5F0F\u9501\u7684\u529F\u80FD\u3002</p><p>\u8FD9\u6837 lock \u548C unlock \u7684\u601D\u8DEF\u5C31\u5F88\u7B80\u5355\u4E86\uFF0C\u4F2A\u4EE3\u7801\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>def lock \uFF1A
    exec sql: insert into locked\u2014table (xxx) values (xxx)
    if result == true :
        return true
    else :
        return false

def unlock \uFF1A
    exec sql: delete from lockedOrder where order_id=&#39;order_id&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u8BA1\u6570\u5668\u7B97\u6CD5\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u8BA1\u6570\u5668\u7B97\u6CD5\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u8BA1\u6570\u5668\u7B97\u6CD5\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B \u8BA1\u6570\u5668\u7B97\u6CD5\uFF0C\u662F\u6307\u5728\u6307\u5B9A\u7684\u65F6\u95F4\u5468\u671F\u5185\u7D2F\u52A0\u8BBF\u95EE\u6B21\u6570\uFF0C\u8FBE\u5230\u8BBE\u5B9A\u7684\u9608\u503C\u65F6\uFF0C\u89E6\u53D1\u9650\u6D41\u7B56\u7565\u3002\u4E0B\u4E00\u4E2A\u65F6\u95F4\u5468\u671F\u8FDB\u884C\u8BBF\u95EE\u65F6\uFF0C\u8BBF\u95EE\u6B21\u6570\u6E05\u96F6\u3002\u6B64\u7B97\u6CD5\u65E0\u8BBA\u5728\u5355\u673A\u8FD8\u662F\u5206\u5E03\u5F0F\u73AF\u5883\u4E0B\u5B9E\u73B0\u90FD\u975E\u5E38\u7B80\u5355\uFF0C\u4F7F\u7528redis\u7684incr\u539F\u5B50\u81EA\u589E\u6027\uFF0C\u518D\u7ED3\u5408key\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5373\u53EF\u8F7B\u677E\u5B9E\u73B0\u3002</p><p>\u200B \u4ECE\u4E0A\u56FE\u6211\u4EEC\u6765\u770B\uFF0C\u6211\u4EEC\u8BBE\u7F6E\u4E00\u5206\u949F\u7684\u9608\u503C\u662F100\uFF0C\u57280:00\u52301:00\u5185\u8BF7\u6C42\u6570\u662F60\uFF0C\u5F53\u52301:00\u65F6\uFF0C\u8BF7\u6C42\u6570\u6E05\u96F6\uFF0C\u4ECE0\u5F00\u59CB\u8BA1\u7B97\uFF0C\u8FD9\u65F6\u57281:00\u52302:00\u4E4B\u95F4\u6211\u4EEC\u80FD\u5904\u7406\u7684\u6700\u5927\u7684\u8BF7\u6C42\u4E3A100\uFF0C\u8D85\u8FC7100\u4E2A\u7684\u8BF7\u6C42\uFF0C\u7CFB\u7EDF\u90FD\u62D2\u7EDD\u3002</p><p>\u200B \u8FD9\u4E2A\u7B97\u6CD5\u6709\u4E00\u4E2A\u4E34\u754C\u95EE\u9898\uFF0C\u6BD4\u5982\u5728\u4E0A\u56FE\u4E2D\uFF0C\u57280:00\u52301:00\u5185\uFF0C\u53EA\u57280:50\u670960\u4E2A\u8BF7\u6C42\uFF0C\u800C\u57281:00\u52302:00\u4E4B\u95F4\uFF0C\u53EA\u57281:10\u670960\u4E2A\u8BF7\u6C42\uFF0C\u867D\u7136\u5728\u4E24\u4E2A\u4E00\u5206\u949F\u7684\u65F6\u95F4\u5185\uFF0C\u90FD\u6CA1\u6709\u8D85\u8FC7100\u4E2A\u8BF7\u6C42\uFF0C\u4F46\u662F\u57280:50\u52301: 10\u8FD920\u79D2\u5185\uFF0C\u786E\u6709120\u4E2A\u8BF7\u6C42\uFF0C\u867D\u7136\u5728\u6BCF\u4E2A\u5468\u671F\u5185\uFF0C\u90FD\u6CA1\u8D85\u8FC7\u9608\u503C\uFF0C\u4F46\u662F\u5728\u8FD920\u79D2\u5185\uFF0C\u5DF2\u7ECF\u8FDC\u8FDC\u8D85\u8FC7\u4E86\u6211\u4EEC\u539F\u6765\u8BBE\u7F6E\u76841\u5206\u949F\u5185100\u4E2A\u8BF7\u6C42\u7684\u9608\u503C\u3002</p><h2 id="\u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u7B97\u6CD5\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u7B97\u6CD5\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u7B97\u6CD5\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B \u4E3A\u4E86\u89E3\u51B3\u8BA1\u6570\u5668\u7B97\u6CD5\u7684\u4E34\u754C\u503C\u7684\u95EE\u9898\uFF0C\u53D1\u660E\u4E86\u6ED1\u52A8\u7A97\u53E3\u7B97\u6CD5\u3002\u5728TCP\u7F51\u7EDC\u901A\u4FE1\u534F\u8BAE\u4E2D\uFF0C\u5C31\u91C7\u7528\u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u7B97\u6CD5\u6765\u89E3\u51B3\u7F51\u7EDC\u62E5\u5835\u95EE\u9898\u3002</p><p>\u200B \u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u662F\u5C06\u8BA1\u6570\u5668\u7B97\u6CD5\u4E2D\u7684\u5B9E\u9645\u5468\u671F\u5207\u5206\u6210\u591A\u4E2A\u5C0F\u7684\u65F6\u95F4\u7A97\u53E3\uFF0C\u5206\u522B\u5728\u6BCF\u4E2A\u5C0F\u7684\u65F6\u95F4\u7A97\u53E3\u4E2D\u8BB0\u5F55\u8BBF\u95EE\u6B21\u6570\uFF0C\u7136\u540E\u6839\u636E\u65F6\u95F4\u5C06\u7A97\u53E3\u5F80\u524D\u6ED1\u52A8\u5E76\u5220\u9664\u8FC7\u671F\u7684\u5C0F\u65F6\u95F4\u7A97\u53E3\u3002\u6700\u7EC8\u53EA\u9700\u8981\u7EDF\u8BA1\u6ED1\u52A8\u7A97\u53E3\u8303\u56F4\u5185\u7684\u5C0F\u65F6\u95F4\u7A97\u53E3\u7684\u603B\u7684\u8BF7\u6C42\u6570\u5373\u53EF\u3002</p><p>\u200B \u5728\u4E0A\u56FE\u4E2D\uFF0C\u5047\u8BBE\u6211\u4EEC\u8BBE\u7F6E\u4E00\u5206\u949F\u7684\u8BF7\u6C42\u9608\u503C\u662F100\uFF0C\u6211\u4EEC\u5C06\u4E00\u5206\u949F\u62C6\u5206\u62104\u4E2A\u5C0F\u65F6\u95F4\u7A97\u53E3\uFF0C\u8FD9\u6837\uFF0C\u6BCF\u4E2A\u5C0F\u7684\u65F6\u95F4\u7A97\u53E3\u53EA\u80FD\u5904\u740625\u4E2A\u8BF7\u6C42\uFF0C\u6211\u4EEC\u7528\u865A\u7EBF\u65B9\u6846\u8868\u793A\u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\uFF0C\u5F53\u524D\u7A97\u53E3\u7684\u5927\u5C0F\u662F2\uFF0C\u4E5F\u5C31\u662F\u5728\u7A97\u53E3\u5185\u6700\u591A\u80FD\u5904\u740650\u4E2A\u8BF7\u6C42\u3002\u968F\u7740\u65F6\u95F4\u7684\u63A8\u79FB\uFF0C\u6ED1\u52A8\u7A97\u53E3\u4E5F\u968F\u7740\u65F6\u95F4\u5F80\u524D\u79FB\u52A8\uFF0C\u6BD4\u5982\u4E0A\u56FE\u5F00\u59CB\u65F6\uFF0C\u7A97\u53E3\u662F0: 00\u52300:30\u7684\u8FD9\u4E2A\u8303\u56F4\uFF0C\u8FC7\u4E8615\u79D2\u540E\uFF0C\u7A97\u53E3\u662F0:15\u52300:45\u7684\u8FD9\u4E2A\u8303\u56F4\uFF0C\u7A97\u53E3\u4E2D\u7684\u8BF7\u6C42\u91CD\u65B0\u6E05\u96F6\uFF0C\u8FD9\u6837\u5C31\u5F88\u597D\u7684\u89E3\u51B3\u4E86\u8BA1\u6570\u5668\u7B97\u6CD5\u7684\u4E34\u754C\u503C\u95EE\u9898\u3002</p><p>\u200B \u5728\u6ED1\u52A8\u65F6\u95F4\u7A97\u53E3\u7B97\u6CD5\u4E2D\uFF0C\u6211\u4EEC\u7684\u5C0F\u7A97\u53E3\u5212\u5206\u7684\u8D8A\u591A\uFF0C\u6ED1\u52A8\u7A97\u53E3\u7684\u6EDA\u52A8\u5C31\u8D8A\u5E73\u6ED1\uFF0C\u9650\u6D41\u7684\u7EDF\u8BA1\u5C31\u4F1A\u8D8A\u7CBE\u786E\u3002</p><h2 id="\u6F0F\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u6F0F\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u6F0F\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B \u6F0F\u6876\u7B97\u6CD5\u7684\u539F\u7406\u5C31\u50CF\u5B83\u7684\u540D\u5B57\u4E00\u6837\uFF0C\u6211\u4EEC\u7EF4\u6301\u4E00\u4E2A\u6F0F\u6597\uFF0C\u5B83\u6709\u6052\u5B9A\u7684\u6D41\u51FA\u901F\u5EA6\uFF0C\u4E0D\u7BA1\u6C34\u6D41\u6D41\u5165\u7684\u901F\u5EA6\u6709\u591A\u5FEB\uFF0C\u6F0F\u6597\u51FA\u6C34\u7684\u901F\u5EA6\u59CB\u7EC8\u4FDD\u6301\u4E0D\u53D8\uFF0C\u7C7B\u4F3C\u4E8E\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u4E0D\u7BA1\u6D88\u606F\u7684\u751F\u4EA7\u8005\u8BF7\u6C42\u91CF\u6709\u591A\u5927\uFF0C\u6D88\u606F\u7684\u5904\u7406\u80FD\u529B\u53D6\u51B3\u4E8E\u6D88\u8D39\u8005\u3002</p><p>\u200B \u6F0F\u6876\u7684\u5BB9\u91CF=\u6F0F\u6876\u7684\u6D41\u51FA\u901F\u5EA6*\u53EF\u63A5\u53D7\u7684\u7B49\u5F85\u65F6\u957F\u3002\u5728\u8FD9\u4E2A\u5BB9\u91CF\u8303\u56F4\u5185\u7684\u8BF7\u6C42\u53EF\u4EE5\u6392\u961F\u7B49\u5F85\u7CFB\u7EDF\u7684\u5904\u7406\uFF0C\u8D85\u8FC7\u8FD9\u4E2A\u5BB9\u91CF\u7684\u8BF7\u6C42\uFF0C\u624D\u4F1A\u88AB\u629B\u5F03\u3002</p><p>\u200B \u5728\u6F0F\u6876\u9650\u6D41\u7B97\u6CD5\u4E2D\uFF0C\u5B58\u5728\u4E0B\u9762\u51E0\u79CD\u60C5\u51B5\uFF1A</p><ol><li><p>\u5F53\u8BF7\u6C42\u901F\u5EA6\u5927\u4E8E\u6F0F\u6876\u7684\u6D41\u51FA\u901F\u5EA6\u65F6\uFF0C\u4E5F\u5C31\u662F\u8BF7\u6C42\u91CF\u5927\u4E8E\u5F53\u524D\u670D\u52A1\u6240\u80FD\u5904\u7406\u7684\u6700\u5927\u6781\u9650\u503C\u65F6\uFF0C\u89E6\u53D1\u9650\u6D41\u7B56\u7565\u3002</p></li><li><p>\u8BF7\u6C42\u901F\u5EA6\u5C0F\u4E8E\u6216\u7B49\u4E8E\u6F0F\u6876\u7684\u6D41\u51FA\u901F\u5EA6\u65F6\uFF0C\u4E5F\u5C31\u662F\u670D\u52A1\u7684\u5904\u7406\u80FD\u529B\u5927\u4E8E\u6216\u7B49\u4E8E\u8BF7\u6C42\u91CF\u65F6\uFF0C\u6B63\u5E38\u6267\u884C\u3002</p><p>\u6F0F\u6876\u7B97\u6CD5\u6709\u4E00\u4E2A\u7F3A\u70B9\uFF1A\u5F53\u7CFB\u7EDF\u5728\u77ED\u65F6\u95F4\u5185\u6709\u7A81\u53D1\u7684\u5927\u6D41\u91CF\u65F6\uFF0C\u6F0F\u6876\u7B97\u6CD5\u5904\u7406\u4E0D\u4E86\u3002</p></li></ol><h2 id="\u4EE4\u724C\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u4EE4\u724C\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u4EE4\u724C\u6876\u9650\u6D41\u7B97\u6CD5\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B \u4EE4\u724C\u6876\u7B97\u6CD5\uFF0C\u662F\u589E\u52A0\u4E00\u4E2A\u5927\u5C0F\u56FA\u5B9A\u7684\u5BB9\u5668\uFF0C\u4E5F\u5C31\u662F\u4EE4\u724C\u6876\uFF0C\u7CFB\u7EDF\u4EE5\u6052\u5B9A\u7684\u901F\u7387\u5411\u4EE4\u724C\u6876\u4E2D\u653E\u5165\u4EE4\u724C\uFF0C\u5982\u679C\u6709\u5BA2\u6237\u7AEF\u6765\u8BF7\u6C42\uFF0C\u5148\u9700\u8981\u4ECE\u4EE4\u724C\u6876\u4E2D\u62FF\u4E00\u4E2A\u4EE4\u724C\uFF0C\u62FF\u5230\u4EE4\u724C\uFF0C\u624D\u6709\u8D44\u683C\u8BBF\u95EE\u7CFB\u7EDF\uFF0C\u8FD9\u65F6\u4EE4\u724C\u6876\u4E2D\u5C11\u4E00\u4E2A\u4EE4\u724C\u3002\u5F53\u4EE4\u724C\u6876\u6EE1\u7684\u65F6\u5019\uFF0C\u518D\u5411\u4EE4\u724C\u6876\u751F\u6210\u4EE4\u724C\u65F6\uFF0C\u4EE4\u724C\u4F1A\u88AB\u629B\u5F03\u3002</p><p>\u200B \u5728\u4EE4\u724C\u6876\u7B97\u6CD5\u4E2D\uFF0C\u5B58\u5728\u4EE5\u4E0B\u51E0\u79CD\u60C5\u51B5\uFF1A</p><ol><li><p>\u8BF7\u6C42\u901F\u5EA6\u5927\u4E8E\u4EE4\u724C\u7684\u751F\u6210\u901F\u5EA6\uFF1A\u90A3\u4E48\u4EE4\u724C\u6876\u4E2D\u7684\u4EE4\u724C\u4F1A\u88AB\u53D6\u5B8C\uFF0C\u540E\u7EED\u518D\u8FDB\u6765\u7684\u8BF7\u6C42\uFF0C\u7531\u4E8E\u62FF\u4E0D\u5230\u4EE4\u724C\uFF0C\u4F1A\u88AB\u9650\u6D41\u3002</p></li><li><p>\u8BF7\u6C42\u901F\u5EA6\u7B49\u4E8E\u4EE4\u724C\u7684\u751F\u6210\u901F\u5EA6\uFF1A\u90A3\u4E48\u6B64\u65F6\u7CFB\u7EDF\u5904\u4E8E\u5E73\u7A33\u72B6\u6001\u3002</p></li><li><p>\u8BF7\u6C42\u901F\u5EA6\u5C0F\u4E8E\u4EE4\u724C\u7684\u751F\u6210\u901F\u5EA6\uFF1A\u90A3\u4E48\u6B64\u65F6\u7CFB\u7EDF\u7684\u8BBF\u95EE\u91CF\u8FDC\u8FDC\u4F4E\u4E8E\u7CFB\u7EDF\u7684\u5E76\u53D1\u80FD\u529B\uFF0C\u8BF7\u6C42\u53EF\u4EE5\u88AB\u6B63\u5E38\u5904\u7406\u3002</p><p>\u4EE4\u724C\u6876\u7B97\u6CD5\uFF0C\u7531\u4E8E\u6709\u4E00\u4E2A\u6876\u7684\u5B58\u5728\uFF0C\u53EF\u4EE5\u5904\u7406\u77ED\u65F6\u95F4\u5927\u6D41\u91CF\u7684\u573A\u666F\u3002\u8FD9\u662F\u4EE4\u724C\u6876\u548C\u6F0F\u6876\u7684\u4E00\u4E2A\u533A\u522B\u3002</p></li></ol><h2 id="\u4F60\u8BBE\u8BA1\u5FAE\u670D\u52A1\u65F6\u9075\u5FAA\u4EC0\u4E48\u539F\u5219" tabindex="-1"><a class="header-anchor" href="#\u4F60\u8BBE\u8BA1\u5FAE\u670D\u52A1\u65F6\u9075\u5FAA\u4EC0\u4E48\u539F\u5219" aria-hidden="true">#</a> \u4F60\u8BBE\u8BA1\u5FAE\u670D\u52A1\u65F6\u9075\u5FAA\u4EC0\u4E48\u539F\u5219\uFF1F</h2><ol><li>\u5355\u4E00\u804C\u8D23\u539F\u5219\uFF1A\u8BA9\u6BCF\u4E2A\u670D\u52A1\u80FD\u72EC\u7ACB\uFF0C\u6709\u754C\u9650\u7684\u5DE5\u4F5C\uFF0C\u6BCF\u4E2A\u670D\u52A1\u53EA\u5173\u6CE8\u81EA\u5DF1\u7684\u4E1A\u52A1\u3002\u505A\u5230\u9AD8\u5185\u805A\u3002</li><li>\u670D\u52A1\u81EA\u6CBB\u539F\u5219\uFF1A\u6BCF\u4E2A\u670D\u52A1\u8981\u80FD\u505A\u5230\u72EC\u7ACB\u5F00\u53D1\u3001\u72EC\u7ACB\u6D4B\u8BD5\u3001\u72EC\u7ACB\u6784\u5EFA\u3001\u72EC\u7ACB\u90E8\u7F72\uFF0C\u72EC\u7ACB\u8FD0\u884C\u3002\u4E0E\u5176\u4ED6\u670D\u52A1\u8FDB\u884C\u89E3\u8026\u3002</li><li>\u8F7B\u91CF\u7EA7\u901A\u4FE1\u539F\u5219\uFF1A\u8BA9\u6BCF\u4E2A\u670D\u52A1\u4E4B\u95F4\u7684\u8C03\u7528\u662F\u8F7B\u91CF\u7EA7\uFF0C\u5E76\u4E14\u80FD\u591F\u8DE8\u5E73\u53F0\u3001\u8DE8\u8BED\u8A00\u3002\u6BD4\u5982\u91C7\u7528RESTful\u98CE\u683C\uFF0C\u5229\u7528\u6D88\u606F\u961F\u5217\u8FDB\u884C\u901A\u4FE1\u7B49\u3002</li><li>\u7C92\u5EA6\u8FDB\u5316\u539F\u5219\uFF1A\u5BF9\u6BCF\u4E2A\u670D\u52A1\u7684\u7C92\u5EA6\u628A\u63A7\uFF0C\u5176\u5B9E\u6CA1\u6709\u7EDF\u4E00\u7684\u6807\u51C6\uFF0C\u8FD9\u4E2A\u5F97\u7ED3\u5408\u6211\u4EEC\u89E3\u51B3\u7684\u5177\u4F53\u4E1A\u52A1\u95EE\u9898\u3002\u4E0D\u8981\u8FC7\u5EA6\u8BBE\u8BA1\u3002\u670D\u52A1\u7684\u7C92\u5EA6\u968F\u7740\u4E1A\u52A1\u548C\u7528\u6237\u7684\u53D1\u5C55\u800C\u53D1\u5C55\u3002</li></ol><p>\u200B \u603B\u7ED3\u4E00\u53E5\u8BDD\uFF0C\u8F6F\u4EF6\u662F\u4E3A\u4E1A\u52A1\u670D\u52A1\u7684\uFF0C\u597D\u7684\u7CFB\u7EDF\u4E0D\u662F\u8BBE\u8BA1\u51FA\u6765\u7684\uFF0C\u800C\u662F\u8FDB\u5316\u51FA\u6765\u7684\u3002</p><h2 id="cap\u5B9A\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#cap\u5B9A\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> CAP\u5B9A\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B CAP\u5B9A\u7406\uFF0C\u53C8\u53EB\u5E03\u9C81\u5C14\u5B9A\u7406\u3002\u6307\u7684\u662F\uFF1A\u5728\u4E00\u4E2A\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\uFF0C\u6700\u591A\u53EA\u80FD\u540C\u65F6\u6EE1\u8DB3\u4E00\u81F4\u6027\uFF08Consistency\uFF09\u3001\u53EF\u7528\u6027\uFF08Availability\uFF09\u548C\u5206\u533A\u5BB9\u9519\u6027\uFF08Partition tolerance\uFF09\u8FD9\u4E09\u9879\u4E2D\u7684\u4E24\u9879\u3002</p><ul><li><p>C\uFF1A\u4E00\u81F4\u6027\uFF08Consistency\uFF09\uFF0C\u6570\u636E\u5728\u591A\u4E2A\u526F\u672C\u4E2D\u4FDD\u6301\u4E00\u81F4\uFF0C\u53EF\u4EE5\u7406\u89E3\u6210\u4E24\u4E2A\u7528\u6237\u8BBF\u95EE\u4E24\u4E2A\u7CFB\u7EDFA\u548CB\uFF0C\u5F53A\u7CFB\u7EDF\u6570\u636E\u6709\u53D8\u5316\u65F6\uFF0C\u53CA\u65F6\u540C\u6B65\u7ED9B\u7CFB\u7EDF\uFF0C\u8BA9\u4E24\u4E2A\u7528\u6237\u770B\u5230\u7684\u6570\u636E\u662F\u4E00\u81F4\u7684\u3002</p></li><li><p>A\uFF1A\u53EF\u7528\u6027\uFF08Availability\uFF09\uFF0C\u7CFB\u7EDF\u5BF9\u5916\u63D0\u4F9B\u670D\u52A1\u5FC5\u987B\u4E00\u76F4\u5904\u4E8E\u53EF\u7528\u72B6\u6001\uFF0C\u5728\u4EFB\u4F55\u6545\u969C\u4E0B\uFF0C\u5BA2\u6237\u7AEF\u90FD\u80FD\u5728\u5408\u7406\u65F6\u95F4\u5185\u83B7\u5F97\u670D\u52A1\u7AEF\u975E\u9519\u8BEF\u7684\u54CD\u5E94\u3002</p></li><li><p>P\uFF1A\u5206\u533A\u5BB9\u9519\u6027\uFF08Partition tolerance\uFF09\uFF0C\u5728\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u9047\u5230\u4EFB\u4F55\u7F51\u7EDC\u5206\u533A\u6545\u969C\uFF0C\u7CFB\u7EDF\u4ECD\u7136\u80FD\u5BF9\u5916\u63D0\u4F9B\u670D\u52A1\u3002\u7F51\u7EDC\u5206\u533A\uFF0C\u53EF\u4EE5\u8FD9\u6837\u7406\u89E3\uFF0C\u5728\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\uFF0C\u4E0D\u540C\u7684\u8282\u70B9\u5206\u5E03\u5728\u4E0D\u540C\u7684\u5B50\u7F51\u7EDC\u4E2D\uFF0C\u6709\u53EF\u80FD\u5B50\u7F51\u7EDC\u4E2D\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\uFF0C\u5728\u6240\u6709\u7F51\u7EDC\u6B63\u5E38\u7684\u60C5\u51B5\u4E0B\uFF0C\u7531\u4E8E\u67D0\u4E9B\u539F\u56E0\u5BFC\u81F4\u8FD9\u4E9B\u5B50\u8282\u70B9\u4E4B\u95F4\u7684\u7F51\u7EDC\u51FA\u73B0\u6545\u969C\uFF0C\u5BFC\u81F4\u6574\u4E2A\u8282\u70B9\u73AF\u5883\u88AB\u5207\u5206\u6210\u4E86\u4E0D\u540C\u7684\u72EC\u7ACB\u533A\u57DF\uFF0C\u8FD9\u5C31\u662F\u7F51\u7EDC\u5206\u533A\u3002</p><p>\u6211\u4EEC\u6765\u8BE6\u7EC6\u5206\u6790\u4E00\u4E0BCAP\uFF0C\u4E3A\u4EC0\u4E48\u53EA\u80FD\u6EE1\u8DB3\u4E24\u4E2A\u3002\u770B\u4E0B\u56FE\u6240\u793A\uFF1A</p></li></ul><p>\u200B \u7528\u62371\u548C\u7528\u62372\u5206\u522B\u8BBF\u95EE\u7CFB\u7EDFA\u548C\u7CFB\u7EDFB\uFF0C\u7CFB\u7EDFA\u548C\u7CFB\u7EDFB\u901A\u8FC7\u7F51\u7EDC\u8FDB\u884C\u540C\u6B65\u6570\u636E\u3002\u7406\u60F3\u60C5\u51B5\u662F\uFF1A\u7528\u62371\u8BBF\u95EE\u7CFB\u7EDFA\u5BF9\u6570\u636E\u8FDB\u884C\u4FEE\u6539\uFF0C\u5C06data1\u6539\u6210\u4E86data2\uFF0C\u540C\u65F6\u7528\u62372\u8BBF\u95EE\u7CFB\u7EDFB\uFF0C\u62FF\u5230\u7684\u662Fdata2\u6570\u636E\u3002</p><p>\u200B \u4F46\u662F\u5B9E\u9645\u4E2D\uFF0C\u7531\u4E8E\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5177\u6709\u516B\u5927\u8C2C\u8BBA\uFF1A</p><ul><li><p>\u7F51\u7EDC\u76F8\u5F53\u53EF\u9760</p></li><li><p>\u5EF6\u8FDF\u4E3A\u96F6</p></li><li><p>\u4F20\u8F93\u5E26\u5BBD\u662F\u65E0\u9650\u7684</p></li><li><p>\u7F51\u7EDC\u76F8\u5F53\u5B89\u5168</p></li><li><p>\u62D3\u6251\u7ED3\u6784\u4E0D\u4F1A\u6539\u53D8</p></li><li><p>\u5FC5\u987B\u8981\u6709\u4E00\u540D\u7BA1\u7406\u5458</p></li><li><p>\u4F20\u8F93\u6210\u672C\u4E3A\u96F6</p></li><li><p>\u7F51\u7EDC\u540C\u8D28\u5316</p></li></ul><p>\u6211\u4EEC\u77E5\u9053\uFF0C\u53EA\u8981\u6709\u7F51\u7EDC\u8C03\u7528\uFF0C\u7F51\u7EDC\u603B\u662F\u4E0D\u53EF\u9760\u7684\u3002\u6211\u4EEC\u6765\u4E00\u4E00\u5206\u6790\u3002</p><ol><li>\u5F53\u7F51\u7EDC\u53D1\u751F\u6545\u969C\u65F6\uFF0C\u7CFB\u7EDFA\u548C\u7CFB\u7EDFB\u6CA1\u6CD5\u8FDB\u884C\u6570\u636E\u540C\u6B65\uFF0C\u4E5F\u5C31\u662F\u6211\u4EEC\u4E0D\u6EE1\u8DB3P\uFF0C\u540C\u65F6\u4E24\u4E2A\u7CFB\u7EDF\u4F9D\u7136\u53EF\u4EE5\u8BBF\u95EE\uFF0C\u90A3\u4E48\u6B64\u65F6\u5176\u5B9E\u76F8\u5F53\u4E8E\u662F\u5355\u673A\u7CFB\u7EDF\uFF0C\u5C31\u4E0D\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E86\uFF0C\u6240\u4EE5\u65E2\u7136\u6211\u4EEC\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\uFF0CP\u5FC5\u987B\u6EE1\u8DB3\u3002</li><li></li></ol><p>\u5F53P\u6EE1\u8DB3\u65F6\uFF0C\u5982\u679C\u7528\u62371\u901A\u8FC7\u7CFB\u7EDFA\u5BF9\u6570\u636E\u8FDB\u884C\u4E86\u4FEE\u6539\u5C06data1\u6539\u6210\u4E86data2\uFF0C\u4E5F\u8981\u8BA9\u7528\u62372\u901A\u8FC7\u7CFB\u7EDFB\u6B63\u786E\u7684\u62FF\u5230data2\uFF0C\u90A3\u4E48\u6B64\u65F6\u662F\u6EE1\u8DB3C\uFF0C\u5C31\u5FC5\u987B\u7B49\u5F85\u7F51\u7EDC\u5C06\u7CFB\u7EDFA\u548C\u7CFB\u7EDFB\u7684\u6570\u636E\u540C\u6B65\u597D\uFF0C\u5E76\u4E14\u5728\u540C\u6B65\u671F\u95F4\uFF0C\u4EFB\u4F55\u4EBA\u4E0D\u80FD\u8BBF\u95EE\u7CFB\u7EDFB\uFF08\u8BA9\u7CFB\u7EDF\u4E0D\u53EF\u7528\uFF09\uFF0C\u5426\u5219\u6570\u636E\u5C31\u4E0D\u662F\u4E00\u81F4\u7684\u3002\u6B64\u65F6\u6EE1\u8DB3\u7684\u662FCP\u3002</p><ol start="3"><li>\u5F53P\u6EE1\u8DB3\u65F6\uFF0C\u5982\u679C\u7528\u62371\u901A\u8FC7\u7CFB\u7EDFA\u5BF9\u6570\u636E\u8FDB\u884C\u4E86\u4FEE\u6539\u5C06data1\u6539\u6210\u4E86data2\uFF0C\u4E5F\u8981\u8BA9\u7CFB\u7EDFB\u80FD\u7EE7\u7EED\u63D0\u4F9B\u670D\u52A1\uFF0C\u90A3\u4E48\u6B64\u65F6\uFF0C\u53EA\u80FD\u63A5\u53D7\u7CFB\u7EDFA\u6CA1\u6709\u5C06data2\u540C\u6B65\u7ED9\u7CFB\u7EDFB\uFF08\u727A\u7272\u4E86\u4E00\u81F4\u6027\uFF09\u3002\u6B64\u65F6\u6EE1\u8DB3\u7684\u5C31\u662FAP\u3002</li></ol><p>\u200B \u6211\u4EEC\u5728\u524D\u9762\u5B66\u8FC7\u7684\u6CE8\u518C\u4E2D\u5FC3Eureka\u5C31\u662F\u6EE1\u8DB3 \u7684AP\uFF0C\u5B83\u5E76\u4E0D\u4FDD\u8BC1C\u3002\u800CZookeeper\u662F\u4FDD\u8BC1CP\uFF0C\u5B83\u4E0D\u4FDD\u8BC1A\u3002\u5728\u751F\u4EA7\u4E2D\uFF0CA\u548CC\u7684\u9009\u62E9\uFF0C\u6CA1\u6709\u6B63\u786E\u7684\u7B54\u6848\uFF0C\u662F\u53D6\u51B3\u4E8E\u81EA\u5DF1\u7684\u4E1A\u52A1\u7684\u3002\u6BD4\u598212306\uFF0C\u662F\u6EE1\u8DB3CP\uFF0C\u56E0\u4E3A\u4E70\u7968\u5FC5\u987B\u6EE1\u8DB3\u6570\u636E\u7684\u4E00\u81F4\u6027\uFF0C\u4E0D\u7136\u4E00\u4E2A\u5EA7\u4F4D\u591A\u5356\u4E86\uFF0C\u5BF9\u94C1\u8DEF\u8FD0\u8F93\u90FD\u662F\u4E0D\u53EF\u4EE5\u63A5\u53D7\u7684\u3002</p><h2 id="base\u7406\u8BBA\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#base\u7406\u8BBA\u662F\u4EC0\u4E48" aria-hidden="true">#</a> BASE\u7406\u8BBA\u662F\u4EC0\u4E48\uFF1F</h2><p>\u7531\u4E8ECAP\u4E2D\u4E00\u81F4\u6027C\u548C\u53EF\u7528\u6027A\u65E0\u6CD5\u517C\u5F97\uFF0CeBay\u7684\u67B6\u6784\u5E08\uFF0C\u63D0\u51FA\u4E86BASE\u7406\u8BBA\uFF0C\u5B83\u662F\u901A\u8FC7\u727A\u7272\u6570\u636E\u7684\u5F3A\u4E00\u81F4\u6027\uFF0C\u6765\u83B7\u5F97\u53EF\u7528\u6027\u3002\u5B83\u7531\u4E8E\u5982\u4E0B3\u79CD\u7279\u5F81\uFF1A</p><ul><li><p><strong>Basically Available</strong>\uFF08\u57FA\u672C\u53EF\u7528\uFF09\uFF1A\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5728\u51FA\u73B0\u4E0D\u53EF\u9884\u77E5\u6545\u969C\u7684\u65F6\u5019\uFF0C\u5141\u8BB8\u635F\u5931\u90E8\u5206\u53EF\u7528\u6027\uFF0C\u4FDD\u8BC1\u6838\u5FC3\u529F\u80FD\u7684\u53EF\u7528\u3002</p></li><li><p><strong>Soft state</strong>\uFF08\u8F6F\u72B6\u6001\uFF09\uFF1A\u8F6F\u72B6\u6001\u4E5F\u79F0\u4E3A\u5F31\u72B6\u6001\uFF0C\u548C\u786C\u72B6\u6001\u76F8\u5BF9\uFF0C\u662F\u6307\u5141\u8BB8\u7CFB\u7EDF\u4E2D\u7684\u6570\u636E\u5B58\u5728\u4E2D\u95F4\u72B6\u6001\uFF0C\u5E76\u8BA4\u4E3A\u8BE5\u4E2D\u95F4\u72B6\u6001\u7684\u5B58\u5728\u4E0D\u4F1A\u5F71\u54CD\u7CFB\u7EDF\u7684\u6574\u4F53\u53EF\u7528\u6027\uFF0C\u5373\u5141\u8BB8\u7CFB\u7EDF\u5728\u4E0D\u540C\u8282\u70B9\u7684\u6570\u636E\u526F\u672C\u4E4B\u95F4\u8FDB\u884C\u6570\u636E\u540C\u6B65\u7684\u8FC7\u7A0B\u5B58\u5728\u5EF6\u65F6\u3002\u3001</p></li><li><p><strong>Eventually consistent</strong> \uFF08\u6700\u7EC8\u4E00\u81F4\u6027\uFF09\uFF1A\u6700\u7EC8\u4E00\u81F4\u6027\u5F3A\u8C03\u7684\u662F\u7CFB\u7EDF\u4E2D\u6240\u6709\u7684\u6570\u636E\u526F\u672C\uFF0C\u5728\u7ECF\u8FC7\u4E00\u6BB5\u65F6\u95F4\u7684\u540C\u6B65\u540E\uFF0C\u6700\u7EC8\u80FD\u591F\u8FBE\u5230\u4E00\u4E2A\u4E00\u81F4\u7684\u72B6\u6001\u3002\u56E0\u6B64\uFF0C\u6700\u7EC8\u4E00\u81F4\u6027\u7684\u672C\u8D28\u662F\u9700\u8981\u7CFB\u7EDF\u4FDD\u8BC1\u6700\u7EC8\u6570\u636E\u80FD\u591F\u8FBE\u5230\u4E00\u81F4\uFF0C\u800C\u4E0D\u9700\u8981\u5B9E\u65F6\u4FDD\u8BC1\u7CFB\u7EDF\u6570\u636E\u7684\u5F3A\u4E00\u81F4\u6027\u3002</p></li></ul><p>\u200B BASE\u7406\u8BBA\u5E76\u6CA1\u6709\u8981\u6C42\u6570\u636E\u7684\u5F3A\u4E00\u81F4\u6027\uFF0C\u800C\u662F\u5141\u8BB8\u6570\u636E\u5728\u4E00\u5B9A\u7684\u65F6\u95F4\u6BB5\u5185\u662F\u4E0D\u4E00\u81F4\u7684\uFF0C\u4F46\u5728\u6700\u7EC8\u67D0\u4E2A\u72B6\u6001\u4F1A\u8FBE\u5230\u4E00\u81F4\u3002\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u5F88\u591A\u516C\u53F8\uFF0C\u4F1A\u91C7\u7528BASE\u7406\u8BBA\u6765\u5B9E\u73B0\u6570\u636E\u7684\u4E00\u81F4\uFF0C\u56E0\u4E3A\u4EA7\u54C1\u7684\u53EF\u7528\u6027\u76F8\u6BD4\u5F3A\u4E00\u81F4\u6027\u6765\u8BF4\uFF0C\u66F4\u52A0\u91CD\u8981\u3002\u6BD4\u5982\u5728\u7535\u5546\u5E73\u53F0\u4E2D\uFF0C\u5F53\u7528\u6237\u5BF9\u4E00\u4E2A\u8BA2\u5355\u53D1\u8D77\u652F\u4ED8\u65F6\uFF0C\u5F80\u5F80\u4F1A\u8C03\u7528\u7B2C\u4E09\u65B9\u652F\u4ED8\u5E73\u53F0\uFF0C\u6BD4\u5982\u652F\u4ED8\u5B9D\u652F\u4ED8\u6216\u8005\u5FAE\u4FE1\u652F\u4ED8\uFF0C\u8C03\u7528\u7B2C\u4E09\u65B9\u6210\u529F\u540E\uFF0C\u7B2C\u4E09\u65B9\u5E76\u4E0D\u80FD\u53CA\u65F6\u901A\u77E5\u6211\u65B9\u7CFB\u7EDF\uFF0C\u5728\u7B2C\u4E09\u65B9\u6CA1\u6709\u901A\u77E5\u6211\u65B9\u7CFB\u7EDF\u7684\u8FD9\u6BB5\u65F6\u95F4\u5185\uFF0C\u6211\u4EEC\u7ED9\u7528\u6237\u7684\u8BA2\u5355\u72B6\u6001\u663E\u793A\u652F\u4ED8\u4E2D\uFF0C\u7B49\u5230\u7B2C\u4E09\u65B9\u56DE\u8C03\u4E4B\u540E\uFF0C\u6211\u4EEC\u518D\u5C06\u72B6\u6001\u6539\u6210\u5DF2\u652F\u4ED8\u3002\u867D\u7136\u8BA2\u5355\u72B6\u6001\u5728\u77ED\u671F\u5185\u5B58\u5728\u4E0D\u4E00\u81F4\uFF0C\u4F46\u662F\u7528\u6237\u5374\u83B7\u5F97\u4E86\u66F4\u597D\u7684\u4EA7\u54C1\u4F53\u9A8C\u3002</p><h2 id="_2pc\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_2pc\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 2PC\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48\uFF1F</h2><p>\u4E8C\u9636\u6BB5\u63D0\u4EA4(Two-phaseCommit)\u662F\u6307\uFF0C\u5728\u8BA1\u7B97\u673A\u7F51\u7EDC\u4EE5\u53CA\u6570\u636E\u5E93\u9886\u57DF\u5185\uFF0C\u4E3A\u4E86\u4F7F\u57FA\u4E8E\u5206\u5E03\u5F0F\u7CFB\u7EDF\u67B6\u6784\u4E0B\u7684\u6240\u6709\u8282\u70B9\u5728\u8FDB\u884C\u4E8B\u52A1\u63D0\u4EA4\u65F6\u4FDD\u6301\u4E00\u81F4\u6027\u800C\u8BBE\u8BA1\u7684\u4E00\u79CD\u7B97\u6CD5(Algorithm)\u3002\u901A\u5E38\uFF0C\u4E8C\u9636\u6BB5\u63D0\u4EA4\u4E5F\u88AB\u79F0\u4E3A\u662F\u4E00\u79CD\u534F\u8BAE(Protocol)) \u3002\u5728\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\uFF0C\u6BCF\u4E2A\u8282\u70B9\u867D\u7136\u53EF\u4EE5\u77E5\u6653\u81EA\u5DF1\u7684\u64CD\u4F5C\u65F6\u6210\u529F\u6216\u8005\u5931\u8D25\uFF0C\u5374\u65E0\u6CD5\u77E5\u9053\u5176\u4ED6\u8282\u70B9\u7684\u64CD\u4F5C\u7684\u6210\u529F\u6216\u5931\u8D25\u3002\u5F53\u4E00\u4E2A\u4E8B\u52A1\u8DE8\u8D8A\u591A\u4E2A\u8282\u70B9\u65F6\uFF0C\u4E3A\u4E86\u4FDD\u6301\u4E8B\u52A1\u7684ACID\u7279\u6027\uFF0C\u9700\u8981\u5F15\u5165\u4E00\u4E2A\u4F5C\u4E3A\u534F\u8C03\u8005\u7684\u7EC4\u4EF6\u6765\u7EDF\u4E00\u638C\u63A7\u6240\u6709\u8282\u70B9(\u79F0\u4F5C\u53C2\u4E0E\u8005) \u7684\u64CD\u4F5C\u7ED3\u679C\u5E76\u6700\u7EC8\u6307\u793A\u8FD9\u4E9B\u8282\u70B9\u662F\u5426\u8981\u628A\u64CD\u4F5C\u7ED3\u679C\u8FDB\u884C\u771F\u6B63\u7684\u63D0\u4EA4(\u6BD4\u5982\u5C06\u66F4\u65B0\u540E\u7684\u6570\u636E\u5199\u5165\u78C1\u76D8\u7B49\u7B49)\u3002\u56E0\u6B64\uFF0C** \u4E8C\u9636\u6BB5\u63D0\u4EA4\u7684\u7B97\u6CD5\u601D\u8DEF\u53EF\u4EE5\u6982\u62EC\u4E3A\uFF1A\u53C2\u4E0E\u8005\u5C06\u64CD\u4F5C\u6210\u8D25\u901A\u77E5\u534F\u8C03\u8005\uFF0C\u518D\u7531\u534F\u8C03\u8005\u6839\u636E\u6240\u6709\u53C2\u4E0E\u8005\u7684\u53CD\u9988\u60C5\u62A5\u51B3\u5B9A\u5404\u53C2\u4E0E\u8005\u662F\u5426\u8981\u63D0\u4EA4\u64CD\u4F5C\u8FD8\u662F\u4E2D\u6B62\u64CD\u4F5C\u3002**</p><p>\u6240\u8C13\u7684\u4E24\u4E2A\u9636\u6BB5\u662F\u6307\uFF1A\u7B2C\u4E00\u9636\u6BB5\uFF1A**\u51C6\u5907\u9636\u6BB5(\u6295\u7968\u9636\u6BB5)**\u548C\u7B2C\u4E8C\u9636\u6BB5\uFF1A<strong>\u63D0\u4EA4\u9636\u6BB5\uFF08\u6267\u884C\u9636\u6BB5\uFF09</strong>\u3002</p><p>\u51C6\u5907\u9636\u6BB5</p><p>\u4E8B\u52A1\u534F\u8C03\u8005(\u4E8B\u52A1\u7BA1\u7406\u5668)\u7ED9\u6BCF\u4E2A\u53C2\u4E0E\u8005(\u8D44\u6E90\u7BA1\u7406\u5668)\u53D1\u9001Prepare\u6D88\u606F\uFF0C\u6BCF\u4E2A\u53C2\u4E0E\u8005\u8981\u4E48\u76F4\u63A5\u8FD4\u56DE\u5931\u8D25(\u5982\u6743\u9650\u9A8C\u8BC1\u5931\u8D25)\uFF0C\u8981\u4E48\u5728\u672C\u5730\u6267\u884C\u4E8B\u52A1\uFF0C\u5199\u672C\u5730\u7684redo\u548Cundo\u65E5\u5FD7\uFF0C\u4F46\u4E0D\u63D0\u4EA4\uFF0C\u5230\u8FBE\u4E00\u79CD\u201C\u4E07\u4E8B\u4FF1\u5907\uFF0C\u53EA\u6B20\u4E1C\u98CE\u201D\u7684\u72B6\u6001\u3002</p><p>\u53EF\u4EE5\u8FDB\u4E00\u6B65\u5C06\u51C6\u5907\u9636\u6BB5\u5206\u4E3A\u4EE5\u4E0B\u4E09\u4E2A\u6B65\u9AA4\uFF1A</p><blockquote><p>1\uFF09\u534F\u8C03\u8005\u8282\u70B9\u5411\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u8BE2\u95EE\u662F\u5426\u53EF\u4EE5\u6267\u884C\u63D0\u4EA4\u64CD\u4F5C(vote)\uFF0C\u5E76\u5F00\u59CB\u7B49\u5F85\u5404\u53C2\u4E0E\u8005\u8282\u70B9\u7684\u54CD\u5E94\u3002</p><p>2\uFF09\u53C2\u4E0E\u8005\u8282\u70B9\u6267\u884C\u8BE2\u95EE\u53D1\u8D77\u4E3A\u6B62\u7684\u6240\u6709\u4E8B\u52A1\u64CD\u4F5C\uFF0C\u5E76\u5C06Undo\u4FE1\u606F\u548CRedo\u4FE1\u606F\u5199\u5165\u65E5\u5FD7\u3002\uFF08\u6CE8\u610F\uFF1A\u82E5\u6210\u529F\u8FD9\u91CC\u5176\u5B9E\u6BCF\u4E2A\u53C2\u4E0E\u8005\u5DF2\u7ECF\u6267\u884C\u4E86\u4E8B\u52A1\u64CD\u4F5C\uFF09</p><p>3\uFF09\u5404\u53C2\u4E0E\u8005\u8282\u70B9\u54CD\u5E94\u534F\u8C03\u8005\u8282\u70B9\u53D1\u8D77\u7684\u8BE2\u95EE\u3002\u5982\u679C\u53C2\u4E0E\u8005\u8282\u70B9\u7684\u4E8B\u52A1\u64CD\u4F5C\u5B9E\u9645\u6267\u884C\u6210\u529F\uFF0C\u5219\u5B83\u8FD4\u56DE\u4E00\u4E2A\u201D\u540C\u610F\u201D\u6D88\u606F\uFF1B\u5982\u679C\u53C2\u4E0E\u8005\u8282\u70B9\u7684\u4E8B\u52A1\u64CD\u4F5C\u5B9E\u9645\u6267\u884C\u5931\u8D25\uFF0C\u5219\u5B83\u8FD4\u56DE\u4E00\u4E2A\u201D\u4E2D\u6B62\u201D\u6D88\u606F\u3002</p></blockquote><p>\u63D0\u4EA4\u9636\u6BB5</p>`,267),$=n("p",null,"\u5982\u679C\u534F\u8C03\u8005\u6536\u5230\u4E86\u53C2\u4E0E\u8005\u7684\u5931\u8D25\u6D88\u606F\u6216\u8005\u8D85\u65F6\uFF0C\u76F4\u63A5\u7ED9\u6BCF\u4E2A\u53C2\u4E0E\u8005\u53D1\u9001\u56DE\u6EDA(Rollback)\u6D88\u606F\uFF1B\u5426\u5219\uFF0C\u53D1\u9001\u63D0\u4EA4(Commit)\u6D88\u606F\uFF1B\u53C2\u4E0E\u8005\u6839\u636E\u534F\u8C03\u8005\u7684\u6307\u4EE4\u6267\u884C\u63D0\u4EA4\u6216\u8005\u56DE\u6EDA\u64CD\u4F5C\uFF0C\u91CA\u653E\u6240\u6709\u4E8B\u52A1\u5904\u7406\u8FC7\u7A0B\u4E2D\u4F7F\u7528\u7684\u9501\u8D44\u6E90\u3002(\u6CE8\u610F: \u5FC5\u987B\u5728\u6700\u540E\u9636\u6BB5\u91CA\u653E\u9501\u8D44\u6E90)",-1),nn=n("p",null,"\u63A5\u4E0B\u6765\u5206\u4E24\u79CD\u60C5\u51B5\u5206\u522B\u8BA8\u8BBA\u63D0\u4EA4\u9636\u6BB5\u7684\u8FC7\u7A0B\u3002",-1),sn=n("p",null,"\u5F53\u534F\u8C03\u8005\u8282\u70B9\u4ECE\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u83B7\u5F97\u7684\u76F8\u5E94\u6D88\u606F\u90FD\u4E3A\u201D\u540C\u610F\u201D\u65F6:",-1),an={href:"http://www.hollischuang.com/wp-content/uploads/2015/12/success.png",target:"_blank",rel:"noopener noreferrer"},tn=s("success.png"),en=n("blockquote",null,[n("p",null,"1\uFF09\u534F\u8C03\u8005\u8282\u70B9\u5411\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u53D1\u51FA\u201D\u6B63\u5F0F\u63D0\u4EA4(commit)\u201D\u7684\u8BF7\u6C42\u3002"),n("p",null,"2\uFF09\u53C2\u4E0E\u8005\u8282\u70B9\u6B63\u5F0F\u5B8C\u6210\u64CD\u4F5C\uFF0C\u5E76\u91CA\u653E\u5728\u6574\u4E2A\u4E8B\u52A1\u671F\u95F4\u5185\u5360\u7528\u7684\u8D44\u6E90\u3002"),n("p",null,"3\uFF09\u53C2\u4E0E\u8005\u8282\u70B9\u5411\u534F\u8C03\u8005\u8282\u70B9\u53D1\u9001\u201D\u5B8C\u6210\u201D\u6D88\u606F\u3002"),n("p",null,"4\uFF09\u534F\u8C03\u8005\u8282\u70B9\u53D7\u5230\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u53CD\u9988\u7684\u201D\u5B8C\u6210\u201D\u6D88\u606F\u540E\uFF0C\u5B8C\u6210\u4E8B\u52A1\u3002")],-1),pn=n("p",null,"\u5982\u679C\u4EFB\u4E00\u53C2\u4E0E\u8005\u8282\u70B9\u5728\u7B2C\u4E00\u9636\u6BB5\u8FD4\u56DE\u7684\u54CD\u5E94\u6D88\u606F\u4E3A\u201D\u4E2D\u6B62\u201D\uFF0C\u6216\u8005 \u534F\u8C03\u8005\u8282\u70B9\u5728\u7B2C\u4E00\u9636\u6BB5\u7684\u8BE2\u95EE\u8D85\u65F6\u4E4B\u524D\u65E0\u6CD5\u83B7\u53D6\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u7684\u54CD\u5E94\u6D88\u606F\u65F6\uFF1A",-1),on={href:"http://www.hollischuang.com/wp-content/uploads/2015/12/fail.png",target:"_blank",rel:"noopener noreferrer"},cn=s("fail.png"),ln=e('<blockquote><p>1\uFF09\u534F\u8C03\u8005\u8282\u70B9\u5411\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u53D1\u51FA\u201D\u56DE\u6EDA\u64CD\u4F5C(rollback)\u201D\u7684\u8BF7\u6C42\u3002</p><p>2\uFF09\u53C2\u4E0E\u8005\u8282\u70B9\u5229\u7528\u4E4B\u524D\u5199\u5165\u7684Undo\u4FE1\u606F\u6267\u884C\u56DE\u6EDA\uFF0C\u5E76\u91CA\u653E\u5728\u6574\u4E2A\u4E8B\u52A1\u671F\u95F4\u5185\u5360\u7528\u7684\u8D44\u6E90\u3002</p><p>3\uFF09\u53C2\u4E0E\u8005\u8282\u70B9\u5411\u534F\u8C03\u8005\u8282\u70B9\u53D1\u9001\u201D\u56DE\u6EDA\u5B8C\u6210\u201D\u6D88\u606F\u3002</p><p>4\uFF09\u534F\u8C03\u8005\u8282\u70B9\u53D7\u5230\u6240\u6709\u53C2\u4E0E\u8005\u8282\u70B9\u53CD\u9988\u7684\u201D\u56DE\u6EDA\u5B8C\u6210\u201D\u6D88\u606F\u540E\uFF0C\u53D6\u6D88\u4E8B\u52A1\u3002</p></blockquote><p>\u4E0D\u7BA1\u6700\u540E\u7ED3\u679C\u5982\u4F55\uFF0C\u7B2C\u4E8C\u9636\u6BB5\u90FD\u4F1A\u7ED3\u675F\u5F53\u524D\u4E8B\u52A1\u3002</p><h2 id="_2pc\u63D0\u4EA4\u534F\u8BAE\u6709\u4EC0\u4E48\u7F3A\u70B9" tabindex="-1"><a class="header-anchor" href="#_2pc\u63D0\u4EA4\u534F\u8BAE\u6709\u4EC0\u4E48\u7F3A\u70B9" aria-hidden="true">#</a> 2PC\u63D0\u4EA4\u534F\u8BAE\u6709\u4EC0\u4E48\u7F3A\u70B9\uFF1F</h2><ol><li><p><strong>\u540C\u6B65\u963B\u585E\u95EE\u9898</strong>\u3002\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u6240\u6709\u53C2\u4E0E\u8282\u70B9\u90FD\u662F\u4E8B\u52A1\u963B\u585E\u578B\u7684\u3002\u5F53\u53C2\u4E0E\u8005\u5360\u6709\u516C\u5171\u8D44\u6E90\u65F6\uFF0C\u5176\u4ED6\u7B2C\u4E09\u65B9\u8282\u70B9\u8BBF\u95EE\u516C\u5171\u8D44\u6E90\u4E0D\u5F97\u4E0D\u5904\u4E8E\u963B\u585E\u72B6\u6001\u3002</p></li><li><p><strong>\u5355\u70B9\u6545\u969C</strong> \u3002\u7531\u4E8E\u534F\u8C03\u8005\u7684\u91CD\u8981\u6027\uFF0C\u4E00\u65E6\u534F\u8C03\u8005\u53D1\u751F\u6545\u969C\u3002\u53C2\u4E0E\u8005\u4F1A\u4E00\u76F4\u963B\u585E\u4E0B\u53BB\u3002\u5C24\u5176\u5728\u7B2C\u4E8C\u9636\u6BB5\uFF0C\u534F\u8C03\u8005\u53D1\u751F\u6545\u969C\uFF0C\u90A3\u4E48\u6240\u6709\u7684\u53C2\u4E0E\u8005\u8FD8\u90FD\u5904\u4E8E\u9501\u5B9A\u4E8B\u52A1\u8D44\u6E90\u7684\u72B6\u6001\u4E2D\uFF0C\u800C\u65E0\u6CD5\u7EE7\u7EED\u5B8C\u6210\u4E8B\u52A1\u64CD\u4F5C\u3002\uFF08\u5982\u679C\u662F\u534F\u8C03\u8005\u6302\u6389\uFF0C\u53EF\u4EE5\u91CD\u65B0\u9009\u4E3E\u4E00\u4E2A\u534F\u8C03\u8005\uFF0C\u4F46\u662F\u65E0\u6CD5\u89E3\u51B3\u56E0\u4E3A\u534F\u8C03\u8005\u5B95\u673A\u5BFC\u81F4\u7684\u53C2\u4E0E\u8005\u5904\u4E8E\u963B\u585E\u72B6\u6001\u7684\u95EE\u9898\uFF09</p></li><li><p><strong>\u6570\u636E\u4E0D\u4E00\u81F4</strong> \u3002\u5728\u4E8C\u9636\u6BB5\u63D0\u4EA4\u7684\u9636\u6BB5\u4E8C\u4E2D\uFF0C\u5F53\u534F\u8C03\u8005\u5411\u53C2\u4E0E\u8005\u53D1\u9001commit\u8BF7\u6C42\u4E4B\u540E\uFF0C\u53D1\u751F\u4E86\u5C40\u90E8\u7F51\u7EDC\u5F02\u5E38\u6216\u8005\u5728\u53D1\u9001commit\u8BF7\u6C42\u8FC7\u7A0B\u4E2D\u534F\u8C03\u8005\u53D1\u751F\u4E86\u6545\u969C\uFF0C\u8FD9\u56DE\u5BFC\u81F4\u53EA\u6709\u4E00\u90E8\u5206\u53C2\u4E0E\u8005\u63A5\u53D7\u5230\u4E86commit\u8BF7\u6C42\u3002\u800C\u5728\u8FD9\u90E8\u5206\u53C2\u4E0E\u8005\u63A5\u5230commit\u8BF7\u6C42\u4E4B\u540E\u5C31\u4F1A\u6267\u884Ccommit\u64CD\u4F5C\u3002\u4F46\u662F\u5176\u4ED6\u90E8\u5206\u672A\u63A5\u5230commit\u8BF7\u6C42\u7684\u673A\u5668\u5219\u65E0\u6CD5\u6267\u884C\u4E8B\u52A1\u63D0\u4EA4\u3002\u4E8E\u662F\u6574\u4E2A\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4FBF\u51FA\u73B0\u4E86\u6570\u636E\u90E8\u4E00\u81F4\u6027\u7684\u73B0\u8C61\u3002</p></li><li><p>\u4E8C\u9636\u6BB5\u65E0\u6CD5\u89E3\u51B3\u7684\u95EE\u9898\uFF1A\u534F\u8C03\u8005\u518D\u53D1\u51FAcommit\u6D88\u606F\u4E4B\u540E\u5B95\u673A\uFF0C\u800C\u552F\u4E00\u63A5\u6536\u5230\u8FD9\u6761\u6D88\u606F\u7684\u53C2\u4E0E\u8005\u540C\u65F6\u4E5F\u5B95\u673A\u4E86\u3002\u90A3\u4E48\u5373\u4F7F\u534F\u8C03\u8005\u901A\u8FC7\u9009\u4E3E\u534F\u8BAE\u4EA7\u751F\u4E86\u65B0\u7684\u534F\u8C03\u8005\uFF0C\u8FD9\u6761\u4E8B\u52A1\u7684\u72B6\u6001\u4E5F\u662F\u4E0D\u786E\u5B9A\u7684\uFF0C\u6CA1\u4EBA\u77E5\u9053\u4E8B\u52A1\u662F\u5426\u88AB\u5DF2\u7ECF\u63D0\u4EA4\u3002</p></li></ol><h2 id="_3pc\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_3pc\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 3PC\u63D0\u4EA4\u534F\u8BAE\u662F\u4EC0\u4E48\uFF1F</h2><p>CanCommit\u9636\u6BB5</p><p>3PC\u7684CanCommit\u9636\u6BB5\u5176\u5B9E\u548C2PC\u7684\u51C6\u5907\u9636\u6BB5\u5F88\u50CF\u3002\u534F\u8C03\u8005\u5411\u53C2\u4E0E\u8005\u53D1\u9001commit\u8BF7\u6C42\uFF0C\u53C2\u4E0E\u8005\u5982\u679C\u53EF\u4EE5\u63D0\u4EA4\u5C31\u8FD4\u56DEYes\u54CD\u5E94\uFF0C\u5426\u5219\u8FD4\u56DENo\u54CD\u5E94\u3002</p><blockquote><p><strong>1.\u4E8B\u52A1\u8BE2\u95EE</strong> \u534F\u8C03\u8005\u5411\u53C2\u4E0E\u8005\u53D1\u9001CanCommit\u8BF7\u6C42\u3002\u8BE2\u95EE\u662F\u5426\u53EF\u4EE5\u6267\u884C\u4E8B\u52A1\u63D0\u4EA4\u64CD\u4F5C\u3002\u7136\u540E\u5F00\u59CB\u7B49\u5F85\u53C2\u4E0E\u8005\u7684\u54CD\u5E94\u3002</p><p><strong>2.\u54CD\u5E94\u53CD\u9988</strong> \u53C2\u4E0E\u8005\u63A5\u5230CanCommit\u8BF7\u6C42\u4E4B\u540E\uFF0C\u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u5982\u679C\u5176\u81EA\u8EAB\u8BA4\u4E3A\u53EF\u4EE5\u987A\u5229\u6267\u884C\u4E8B\u52A1\uFF0C\u5219\u8FD4\u56DEYes\u54CD\u5E94\uFF0C\u5E76\u8FDB\u5165\u9884\u5907\u72B6\u6001\u3002\u5426\u5219\u53CD\u9988No</p></blockquote><p>PreCommit\u9636\u6BB5</p><p>\u534F\u8C03\u8005\u6839\u636E\u53C2\u4E0E\u8005\u7684\u53CD\u5E94\u60C5\u51B5\u6765\u51B3\u5B9A\u662F\u5426\u53EF\u4EE5\u8FDB\u884C\u4E8B\u52A1\u7684PreCommit\u64CD\u4F5C\u3002\u6839\u636E\u54CD\u5E94\u60C5\u51B5\uFF0C\u6709\u4EE5\u4E0B\u4E24\u79CD\u53EF\u80FD\u3002</p><p><strong>\u5047\u5982\u534F\u8C03\u8005\u4ECE\u6240\u6709\u7684\u53C2\u4E0E\u8005\u83B7\u5F97\u7684\u53CD\u9988\u90FD\u662FYes\u54CD\u5E94\uFF0C\u90A3\u4E48\u5C31\u4F1A\u6267\u884C\u4E8B\u52A1\u7684\u9884\u6267\u884C\u3002</strong></p><blockquote><p><strong>1.\u53D1\u9001\u9884\u63D0\u4EA4\u8BF7\u6C42</strong> \u534F\u8C03\u8005\u5411\u53C2\u4E0E\u8005\u53D1\u9001PreCommit\u8BF7\u6C42\uFF0C\u5E76\u8FDB\u5165Prepared\u9636\u6BB5\u3002</p><p><strong>2.\u4E8B\u52A1\u9884\u63D0\u4EA4</strong> \u53C2\u4E0E\u8005\u63A5\u6536\u5230PreCommit\u8BF7\u6C42\u540E\uFF0C\u4F1A\u6267\u884C\u4E8B\u52A1\u64CD\u4F5C\uFF0C\u5E76\u5C06undo\u548Credo\u4FE1\u606F\u8BB0\u5F55\u5230\u4E8B\u52A1\u65E5\u5FD7\u4E2D\u3002</p><p><strong>3.\u54CD\u5E94\u53CD\u9988</strong> \u5982\u679C\u53C2\u4E0E\u8005\u6210\u529F\u7684\u6267\u884C\u4E86\u4E8B\u52A1\u64CD\u4F5C\uFF0C\u5219\u8FD4\u56DEACK\u54CD\u5E94\uFF0C\u540C\u65F6\u5F00\u59CB\u7B49\u5F85\u6700\u7EC8\u6307\u4EE4\u3002</p></blockquote><p><strong>\u5047\u5982\u6709\u4EFB\u4F55\u4E00\u4E2A\u53C2\u4E0E\u8005\u5411\u534F\u8C03\u8005\u53D1\u9001\u4E86No\u54CD\u5E94\uFF0C\u6216\u8005\u7B49\u5F85\u8D85\u65F6\u4E4B\u540E\uFF0C\u534F\u8C03\u8005\u90FD\u6CA1\u6709\u63A5\u5230\u53C2\u4E0E\u8005\u7684\u54CD\u5E94\uFF0C\u90A3\u4E48\u5C31\u6267\u884C\u4E8B\u52A1\u7684\u4E2D\u65AD\u3002</strong></p><blockquote><p><strong>1.\u53D1\u9001\u4E2D\u65AD\u8BF7\u6C42</strong> \u534F\u8C03\u8005\u5411\u6240\u6709\u53C2\u4E0E\u8005\u53D1\u9001abort\u8BF7\u6C42\u3002</p><p><strong>2.\u4E2D\u65AD\u4E8B\u52A1</strong> \u53C2\u4E0E\u8005\u6536\u5230\u6765\u81EA\u534F\u8C03\u8005\u7684abort\u8BF7\u6C42\u4E4B\u540E\uFF08\u6216\u8D85\u65F6\u4E4B\u540E\uFF0C\u4ECD\u672A\u6536\u5230\u534F\u8C03\u8005\u7684\u8BF7\u6C42\uFF09\uFF0C\u6267\u884C\u4E8B\u52A1\u7684\u4E2D\u65AD\u3002</p></blockquote><p>pre\u9636\u6BB5\u53C2\u4E0E\u8005\u6CA1\u6536\u5230\u8BF7\u6C42\uFF0Crollback\u3002</p><p>doCommit\u9636\u6BB5</p><p>\u8BE5\u9636\u6BB5\u8FDB\u884C\u771F\u6B63\u7684\u4E8B\u52A1\u63D0\u4EA4\uFF0C\u4E5F\u53EF\u4EE5\u5206\u4E3A\u4EE5\u4E0B\u4E24\u79CD\u60C5\u51B5\u3002</p><p><strong>\u6267\u884C\u63D0\u4EA4</strong></p><blockquote><p><strong>1.\u53D1\u9001\u63D0\u4EA4\u8BF7\u6C42</strong> \u534F\u8C03\u63A5\u6536\u5230\u53C2\u4E0E\u8005\u53D1\u9001\u7684ACK\u54CD\u5E94\uFF0C\u90A3\u4E48\u4ED6\u5C06\u4ECE\u9884\u63D0\u4EA4\u72B6\u6001\u8FDB\u5165\u5230\u63D0\u4EA4\u72B6\u6001\u3002\u5E76\u5411\u6240\u6709\u53C2\u4E0E\u8005\u53D1\u9001doCommit\u8BF7\u6C42\u3002</p><p><strong>2.\u4E8B\u52A1\u63D0\u4EA4</strong> \u53C2\u4E0E\u8005\u63A5\u6536\u5230doCommit\u8BF7\u6C42\u4E4B\u540E\uFF0C\u6267\u884C\u6B63\u5F0F\u7684\u4E8B\u52A1\u63D0\u4EA4\u3002\u5E76\u5728\u5B8C\u6210\u4E8B\u52A1\u63D0\u4EA4\u4E4B\u540E\u91CA\u653E\u6240\u6709\u4E8B\u52A1\u8D44\u6E90\u3002</p><p><strong>3.\u54CD\u5E94\u53CD\u9988</strong> \u4E8B\u52A1\u63D0\u4EA4\u5B8C\u4E4B\u540E\uFF0C\u5411\u534F\u8C03\u8005\u53D1\u9001Ack\u54CD\u5E94\u3002</p><p><strong>4.\u5B8C\u6210\u4E8B\u52A1</strong> \u534F\u8C03\u8005\u63A5\u6536\u5230\u6240\u6709\u53C2\u4E0E\u8005\u7684ack\u54CD\u5E94\u4E4B\u540E\uFF0C\u5B8C\u6210\u4E8B\u52A1\u3002</p></blockquote><p><strong>\u4E2D\u65AD\u4E8B\u52A1</strong> \u534F\u8C03\u8005\u6CA1\u6709\u63A5\u6536\u5230\u53C2\u4E0E\u8005\u53D1\u9001\u7684ACK\u54CD\u5E94\uFF08\u53EF\u80FD\u662F\u63A5\u53D7\u8005\u53D1\u9001\u7684\u4E0D\u662FACK\u54CD\u5E94\uFF0C\u4E5F\u53EF\u80FD\u54CD\u5E94\u8D85\u65F6\uFF09\uFF0C\u90A3\u4E48\u5C31\u4F1A\u6267\u884C\u4E2D\u65AD\u4E8B\u52A1\u3002</p><blockquote><p><strong>1.\u53D1\u9001\u4E2D\u65AD\u8BF7\u6C42</strong> \u534F\u8C03\u8005\u5411\u6240\u6709\u53C2\u4E0E\u8005\u53D1\u9001abort\u8BF7\u6C42</p><p><strong>2.\u4E8B\u52A1\u56DE\u6EDA</strong> \u53C2\u4E0E\u8005\u63A5\u6536\u5230abort\u8BF7\u6C42\u4E4B\u540E\uFF0C\u5229\u7528\u5176\u5728\u9636\u6BB5\u4E8C\u8BB0\u5F55\u7684undo\u4FE1\u606F\u6765\u6267\u884C\u4E8B\u52A1\u7684\u56DE\u6EDA\u64CD\u4F5C\uFF0C\u5E76\u5728\u5B8C\u6210\u56DE\u6EDA\u4E4B\u540E\u91CA\u653E\u6240\u6709\u7684\u4E8B\u52A1\u8D44\u6E90\u3002</p><p><strong>3.\u53CD\u9988\u7ED3\u679C</strong> \u53C2\u4E0E\u8005\u5B8C\u6210\u4E8B\u52A1\u56DE\u6EDA\u4E4B\u540E\uFF0C\u5411\u534F\u8C03\u8005\u53D1\u9001ACK\u6D88\u606F</p><p><strong>4.\u4E2D\u65AD\u4E8B\u52A1</strong> \u534F\u8C03\u8005\u63A5\u6536\u5230\u53C2\u4E0E\u8005\u53CD\u9988\u7684ACK\u6D88\u606F\u4E4B\u540E\uFF0C\u6267\u884C\u4E8B\u52A1\u7684\u4E2D\u65AD\u3002</p></blockquote><h2 id="_2pc\u548C3pc\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_2pc\u548C3pc\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 2PC\u548C3PC\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><p>1\u3001\u5F15\u5165\u8D85\u65F6\u673A\u5236\u3002\u540C\u65F6\u5728\u534F\u8C03\u8005\u548C\u53C2\u4E0E\u8005\u4E2D\u90FD\u5F15\u5165\u8D85\u65F6\u673A\u5236\u3002</p><p>2\u3001\u4E09\u9636\u6BB5\u57282PC\u7684\u7B2C\u4E00\u9636\u6BB5\u548C\u7B2C\u4E8C\u9636\u6BB5\u4E2D\u63D2\u5165\u4E00\u4E2A\u51C6\u5907\u9636\u6BB5\u3002\u4FDD\u8BC1\u4E86\u5728\u6700\u540E\u63D0\u4EA4\u9636\u6BB5\u4E4B\u524D\u5404\u53C2\u4E0E\u8282\u70B9\u7684\u72B6\u6001\u662F\u4E00\u81F4\u7684\u3002</p><ul><li><h2 id="tcc\u89E3\u51B3\u65B9\u6848\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#tcc\u89E3\u51B3\u65B9\u6848\u662F\u4EC0\u4E48" aria-hidden="true">#</a> TCC\u89E3\u51B3\u65B9\u6848\u662F\u4EC0\u4E48?</h2><p>\u200B TCC\uFF08Try-Confirm-Cancel\uFF09\u662F\u4E00\u79CD\u5E38\u7528\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1\u89E3\u51B3\u65B9\u6848\uFF0C\u5B83\u5C06\u4E00\u4E2A\u4E8B\u52A1\u62C6\u5206\u6210\u4E09\u4E2A\u6B65\u9AA4\uFF1A</p><ul><li><p>T\uFF08Try\uFF09\uFF1A\u4E1A\u52A1\u68C0\u67E5\u9636\u6BB5\uFF0C\u8FD9\u9636\u6BB5\u4E3B\u8981\u8FDB\u884C\u4E1A\u52A1\u6821\u9A8C\u548C\u68C0\u67E5\u6216\u8005\u8D44\u6E90\u9884\u7559\uFF1B\u4E5F\u53EF\u80FD\u662F\u76F4\u63A5\u8FDB\u884C\u4E1A\u52A1\u64CD\u4F5C\u3002</p></li><li><p>C\uFF08Confirm\uFF09\uFF1A\u4E1A\u52A1\u786E\u8BA4\u9636\u6BB5\uFF0C\u8FD9\u9636\u6BB5\u5BF9Try\u9636\u6BB5\u6821\u9A8C\u8FC7\u7684\u4E1A\u52A1\u6216\u8005\u9884\u7559\u7684\u8D44\u6E90\u8FDB\u884C\u786E\u8BA4\u3002</p></li><li><p>C\uFF08Cancel\uFF09\uFF1A\u4E1A\u52A1\u56DE\u6EDA\u9636\u6BB5\uFF0C\u8FD9\u9636\u6BB5\u548C\u4E0A\u9762\u7684C\uFF08Confirm\uFF09\u662F\u4E92\u65A5\u7684\uFF0C\u7528\u4E8E\u91CA\u653ETry\u9636\u6BB5\u9884\u7559\u7684\u8D44\u6E90\u6216\u8005\u4E1A\u52A1\u3002</p></li></ul></li></ul><h2 id="tcc\u7A7A\u56DE\u6EDA\u662F\u89E3\u51B3\u4EC0\u4E48\u95EE\u9898\u7684" tabindex="-1"><a class="header-anchor" href="#tcc\u7A7A\u56DE\u6EDA\u662F\u89E3\u51B3\u4EC0\u4E48\u95EE\u9898\u7684" aria-hidden="true">#</a> TCC\u7A7A\u56DE\u6EDA\u662F\u89E3\u51B3\u4EC0\u4E48\u95EE\u9898\u7684\uFF1F</h2><p>\u200B \u5728\u6CA1\u6709\u8C03\u7528TCC\u8D44\u6E90Try\u65B9\u6CD5\u7684\u60C5\u51B5\u4E0B\uFF0C\u8C03\u7528\u4E86\u4E8C\u9636\u6BB5\u7684Cancel\u65B9\u6CD5\u3002\u6BD4\u5982\u5F53Try\u8BF7\u6C42\u7531\u4E8E\u7F51\u7EDC\u5EF6\u8FDF\u6216\u6545\u969C\u7B49\u539F\u56E0\uFF0C\u6CA1\u6709\u6267\u884C\uFF0C\u7ED3\u679C\u8FD4\u56DE\u4E86\u5F02\u5E38\uFF0C\u90A3\u4E48\u6B64\u65F6Cancel\u5C31\u4E0D\u80FD\u6B63\u5E38\u6267\u884C\uFF0C\u56E0\u4E3ATry\u6CA1\u6709\u5BF9\u6570\u636E\u8FDB\u884C\u4FEE\u6539\uFF0C\u5982\u679CCancel\u8FDB\u884C\u4E86\u5BF9\u6570\u636E\u7684\u4FEE\u6539\uFF0C\u90A3\u5C31\u4F1A\u5BFC\u81F4\u6570\u636E\u4E0D\u4E00\u81F4\u3002 \u200B \u89E3\u51B3\u601D\u8DEF\u662F\u5173\u952E\u5C31\u662F\u8981\u8BC6\u522B\u51FA\u8FD9\u4E2A\u7A7A\u56DE\u6EDA\u3002\u601D\u8DEF\u5F88\u7B80\u5355\u5C31\u662F\u9700\u8981\u77E5\u9053Try\u9636\u6BB5\u662F\u5426\u6267\u884C\uFF0C\u5982\u679C\u6267\u884C\u4E86\uFF0C\u90A3\u5C31\u662F\u6B63\u5E38\u56DE\u6EDA\uFF1B\u5982\u679C\u6CA1\u6267\u884C\uFF0C\u90A3\u5C31\u662F\u7A7A\u56DE\u6EDA\u3002\u5EFA\u8BAETM\u5728\u53D1\u8D77\u5168\u5C40\u4E8B\u52A1\u65F6\u751F\u6210\u5168\u5C40\u4E8B\u52A1\u8BB0\u5F55\uFF0C\u5168\u5C40\u4E8B\u52A1ID\u8D2F\u7A7F\u6574\u4E2A\u5206\u5E03\u5F0F\u4E8B\u52A1\u8C03\u7528\u94FE\u6761\u3002\u518D\u989D\u5916\u589E\u52A0\u4E00\u5F20** \u5206\u652F\u4E8B\u52A1\u8BB0\u5F55\u8868**\uFF0C\u5176\u4E2D\u6709\u5168\u5C40\u4E8B\u52A1ID\u548C\u5206\u652F\u4E8B\u52A1ID\uFF0C\u7B2C\u4E00\u9636\u6BB5Try\u65B9\u6CD5\u91CC\u4F1A\u63D2\u5165\u4E00\u6761\u8BB0\u5F55\uFF0C\u8868\u793ATry\u9636\u6BB5\u6267\u884C\u4E86\u3002Cancel\u63A5\u53E3\u91CC\u8BFB\u53D6\u8BE5\u8BB0\u5F55\uFF0C\u5982\u679C\u8BE5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u6B63\u5E38\u56DE\u6EDA\uFF1B\u5982\u679C\u8BE5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u662F\u7A7A\u56DE\u6EDA\u3002</p><h2 id="\u5982\u4F55\u89E3\u51B3tcc\u5E42\u7B49\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u89E3\u51B3tcc\u5E42\u7B49\u95EE\u9898" aria-hidden="true">#</a> \u5982\u4F55\u89E3\u51B3TCC\u5E42\u7B49\u95EE\u9898\uFF1F</h2><p>\u4E3A\u4E86\u4FDD\u8BC1TCC\u4E8C\u9636\u6BB5\u63D0\u4EA4\u91CD\u8BD5\u673A\u5236\u4E0D\u4F1A\u5F15\u53D1\u6570\u636E\u4E0D\u4E00\u81F4\uFF0C\u8981\u6C42TCC\u7684\u4E8C\u9636\u6BB5Confirm\u548CCancel\u63A5\u53E3\u4FDD\u8BC1\u5E42\u7B49\uFF0C\u8FD9\u6837\u4E0D\u4F1A\u91CD\u590D\u4F7F\u7528\u6216\u8005\u91CA\u653E\u8D44\u6E90\u3002\u5982\u679C\u5E42\u7B49\u63A7\u5236\u6CA1\u6709\u505A\u597D\uFF0C\u5F88\u6709\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u4E0D\u4E00\u81F4\u7B49\u4E25\u91CD\u95EE\u9898\u3002 \u89E3\u51B3\u601D\u8DEF\u5728\u4E0A\u8FF0 <strong>\u5206\u652F\u4E8B\u52A1\u8BB0\u5F55</strong>\u4E2D\u589E\u52A0\u6267\u884C\u72B6\u6001\uFF0C\u6BCF\u6B21\u6267\u884C\u524D\u90FD\u67E5\u8BE2\u8BE5\u72B6\u6001\u3002</p><p>\u5206\u5E03\u5F0F\u9501\u3002</p><h2 id="\u5982\u4F55\u89E3\u51B3tcc\u4E2D\u60AC\u6302\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u89E3\u51B3tcc\u4E2D\u60AC\u6302\u95EE\u9898" aria-hidden="true">#</a> \u5982\u4F55\u89E3\u51B3TCC\u4E2D\u60AC\u6302\u95EE\u9898\uFF1F</h2><p>\u60AC\u6302\u5C31\u662F\u5BF9\u4E8E\u4E00\u4E2A\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF0C\u5176\u4E8C\u9636\u6BB5Cancel\u63A5\u53E3\u6BD4Try\u63A5\u53E3\u5148\u6267\u884C\u3002 \u51FA\u73B0\u539F\u56E0\u662F\u5728\u8C03\u7528\u5206\u652F\u4E8B\u52A1Try\u65F6\uFF0C\u7531\u4E8E\u7F51\u7EDC\u53D1\u751F\u62E5\u5835\uFF0C\u9020\u6210\u4E86\u8D85\u65F6\uFF0CTM\u5C31\u4F1A\u901A\u77E5RM\u56DE\u6EDA\u8BE5\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF0C\u53EF\u80FD\u56DE\u6EDA\u5B8C\u6210\u540E\uFF0CTry\u8BF7\u6C42\u624D\u5230\u8FBE\u53C2\u4E0E\u8005\u771F\u6B63\u6267\u884C\uFF0C\u800C\u4E00\u4E2ATry\u65B9\u6CD5\u9884\u7559\u7684\u4E1A\u52A1\u8D44\u6E90\uFF0C\u53EA\u6709\u8BE5\u5206\u5E03\u5F0F\u4E8B\u52A1\u624D\u80FD\u4F7F\u7528\uFF0C\u8BE5\u5206\u5E03\u5F0F\u4E8B\u52A1\u7B2C\u4E00\u9636\u6BB5\u9884\u7559\u7684\u4E1A\u52A1\u8D44\u6E90\u5C31\u518D\u4E5F\u6CA1\u6709\u4EBA\u80FD\u591F\u5904\u7406\u4E86\uFF0C\u5BF9\u4E8E\u8FD9\u79CD\u60C5\u51B5\uFF0C\u6211\u4EEC\u5C31\u79F0\u4E3A\u60AC\u6302\uFF0C\u5373\u4E1A\u52A1\u8D44\u6E90\u9884\u7559\u540E\u65E0\u6CD5\u7EE7\u7EED\u5904\u7406\u3002 \u89E3\u51B3\u601D\u8DEF\u662F\u5982\u679C\u4E8C\u9636\u6BB5\u6267\u884C\u5B8C\u6210\uFF0C\u90A3\u4E00\u9636\u6BB5\u5C31\u4E0D\u80FD\u518D\u7EE7\u7EED\u6267\u884C\u3002\u5728\u6267\u884C\u4E00\u9636\u6BB5\u4E8B\u52A1\u65F6\u5224\u65AD\u5728\u8BE5\u5168\u5C40\u4E8B\u52A1\u4E0B\uFF0C\u5224\u65AD<strong>\u5206\u652F\u4E8B\u52A1\u8BB0\u5F55\u8868</strong>\u4E2D\u662F\u5426\u5DF2\u7ECF\u6709\u4E8C\u9636\u6BB5\u4E8B\u52A1\u8BB0\u5F55\uFF0C\u5982\u679C\u6709\u5219\u4E0D\u6267\u884CTry\u3002</p><h2 id="\u53EF\u9760\u6D88\u606F\u670D\u52A1\u65B9\u6848\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u53EF\u9760\u6D88\u606F\u670D\u52A1\u65B9\u6848\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u53EF\u9760\u6D88\u606F\u670D\u52A1\u65B9\u6848\u662F\u4EC0\u4E48\uFF1F</h2><p>\u200B \u53EF\u9760\u6D88\u606F\u6700\u7EC8\u4E00\u81F4\u6027\u65B9\u6848\u6307\u7684\u662F\uFF1A\u5F53\u4E8B\u52A1\u7684\u53D1\u8D77\u65B9\uFF08\u4E8B\u52A1\u53C2\u4E0E\u8005\uFF0C\u6D88\u606F\u53D1\u9001\u8005\uFF09\u6267\u884C\u5B8C\u672C\u5730\u4E8B\u52A1\u540E\uFF0C\u540C\u65F6\u53D1\u51FA\u4E00\u6761\u6D88\u606F\uFF0C\u4E8B\u52A1\u53C2\u4E0E\u65B9\uFF08\u4E8B\u52A1\u53C2\u4E0E\u8005\uFF0C\u6D88\u606F\u7684\u6D88\u8D39\u8005\uFF09\u4E00\u5B9A\u80FD\u591F\u63A5\u53D7\u6D88\u606F\u5E76\u53EF\u4EE5\u6210\u529F\u5904\u7406\u81EA\u5DF1\u7684\u4E8B\u52A1\u3002</p><p>\u200B \u8FD9\u91CC\u9762\u5F3A\u8C03\u4E24\u70B9\uFF1A</p><ol><li>\u53EF\u9760\u6D88\u606F\uFF1A\u53D1\u8D77\u65B9\u4E00\u5B9A\u5F97\u628A\u6D88\u606F\u4F20\u9012\u5230\u6D88\u8D39\u8005\u3002</li><li>\u6700\u7EC8\u4E00\u81F4\u6027\uFF1A\u6700\u7EC8\u53D1\u8D77\u65B9\u7684\u4E1A\u52A1\u5904\u7406\u548C\u6D88\u8D39\u65B9\u7684\u4E1A\u52A1\u5904\u7406\u5F97\u5B8C\u6210\uFF0C\u8FBE\u6210\u6700\u7EC8\u4E00\u81F4\u3002</li></ol><h2 id="\u6700\u5927\u52AA\u529B\u901A\u77E5\u65B9\u6848\u7684\u5173\u952E\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u6700\u5927\u52AA\u529B\u901A\u77E5\u65B9\u6848\u7684\u5173\u952E\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u6700\u5927\u52AA\u529B\u901A\u77E5\u65B9\u6848\u7684\u5173\u952E\u662F\u4EC0\u4E48\uFF1F</h2><ol><li>\u6709\u4E00\u5B9A\u7684\u6D88\u606F\u91CD\u590D\u901A\u77E5\u673A\u5236\u3002\u56E0\u4E3A\u63A5\u6536\u901A\u77E5\u65B9\uFF08\u4E0A\u56FE\u4E2D\u7684\u6211\u65B9\u652F\u4ED8\u7CFB\u7EDF\uFF09\u53EF\u80FD\u6CA1\u6709\u63A5\u6536\u5230\u901A\u77E5\uFF0C\u6B64\u65F6\u8981\u6709\u4E00\u5B9A\u7684\u673A\u5236\u5BF9\u6D88\u606F\u91CD\u590D\u901A\u77E5\u3002</li><li>\u6D88\u606F\u6821\u5BF9\u673A\u5236\u3002\u5982\u679C\u5C3D\u6700\u5927\u52AA\u529B\u4E5F\u6CA1\u6709\u901A\u77E5\u5230\u63A5\u6536\u65B9\uFF0C\u6216\u8005\u63A5\u6536\u65B9\u6D88\u8D39\u6D88\u606F\u540E\u8981\u518D\u6B21\u6D88\u8D39\uFF0C\u6B64\u65F6\u53EF\u7531\u63A5\u6536\u65B9\u4E3B\u52A8\u5411\u901A\u77E5\u65B9\u67E5\u8BE2\u6D88\u606F\u4FE1\u606F\u6765\u6EE1\u8DB3\u9700\u6C42\u3002</li></ol><h2 id="\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u5E42\u7B49" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u5E42\u7B49" aria-hidden="true">#</a> \u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u5E42\u7B49\uFF1F</h2><p>\u5E42\u7B49\uFF08idempotent\u3001idempotence\uFF09\u662F\u4E00\u4E2A\u6570\u5B66\u4E0E\u8BA1\u7B97\u673A\u5B66\u6982\u5FF5\uFF0C\u5E38\u89C1\u4E8E\u62BD\u8C61\u4EE3\u6570\u4E2D\u3002</p><p>\u5728\u7F16\u7A0B\u4E2D\uFF0C\u4E00\u4E2A\u5E42\u7B49\u64CD\u4F5C\u7684\u7279\u70B9\u662F\u5176\u4EFB\u610F\u591A\u6B21\u6267\u884C\u6240\u4EA7\u751F\u7684\u5F71\u54CD\u5747\u4E0E\u4E00\u6B21\u6267\u884C\u7684\u5F71\u54CD\u76F8\u540C\u3002\u5E42\u7B49\u51FD\u6570\uFF0C\u6216\u5E42\u7B49\u65B9\u6CD5\uFF0C\u662F\u6307\u53EF\u4EE5\u4F7F\u7528\u76F8\u540C\u53C2\u6570\u91CD\u590D\u6267\u884C\uFF0C\u5E76\u80FD\u83B7\u5F97\u76F8\u540C\u7ED3\u679C\u7684\u51FD\u6570\u3002\u8FD9\u4E9B\u51FD\u6570\u4E0D\u4F1A\u5F71\u54CD\u7CFB\u7EDF\u72B6\u6001\uFF0C\u4E5F\u4E0D\u7528\u62C5\u5FC3\u91CD\u590D\u6267\u884C\u4F1A\u5BF9\u7CFB\u7EDF\u9020\u6210\u6539\u53D8\u3002</p><p>\u4F8B\u5982\uFF0C\u201CgetUsername()\u548C setTrue()\u201D\u51FD\u6570\u5C31\u662F\u4E00\u4E2A\u5E42\u7B49\u51FD\u6570. \u66F4\u590D\u6742\u7684\u64CD\u4F5C\u5E42\u7B49\u4FDD\u8BC1\u662F\u5229\u7528\u552F\u4E00\u4EA4\u6613\u53F7(\u6D41\u6C34\u53F7)\u5B9E\u73B0. \u6211\u7684\u7406\u89E3\uFF1A\u5E42\u7B49\u5C31\u662F\u4E00\u4E2A\u64CD\u4F5C\uFF0C\u4E0D\u8BBA\u6267\u884C\u591A\u5C11\u6B21\uFF0C\u4EA7\u751F\u7684\u6548\u679C\u548C\u8FD4\u56DE\u7684\u7ED3\u679C\u90FD\u662F\u4E00\u6837\u7684\u3002</p><p>\u64CD\u4F5C\uFF1A\u67E5\u8BE2\uFF0Cset\u56FA\u5B9A\u503C\u3002\u903B\u8F91\u5220\u9664\u3002set \u56FA\u5B9A\u503C\u3002</p><p>\u6D41\u7A0B\uFF1A\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\uFF0C\u7F51\u7EDC\u8C03\u7528\uFF0C\u91CD\u8BD5\u673A\u5236\u3002</p><h2 id="\u5E42\u7B49\u6709\u54EA\u4E9B\u6280\u672F\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u5E42\u7B49\u6709\u54EA\u4E9B\u6280\u672F\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> \u5E42\u7B49\u6709\u54EA\u4E9B\u6280\u672F\u89E3\u51B3\u65B9\u6848\uFF1F</h2><p>1.\u67E5\u8BE2\u64CD\u4F5C</p><p>\u67E5\u8BE2\u4E00\u6B21\u548C\u67E5\u8BE2\u591A\u6B21\uFF0C\u5728\u6570\u636E\u4E0D\u53D8\u7684\u60C5\u51B5\u4E0B\uFF0C\u67E5\u8BE2\u7ED3\u679C\u662F\u4E00\u6837\u7684\u3002select \u662F\u5929\u7136\u7684\u5E42\u7B49\u64CD\u4F5C\uFF1B</p><p>2.\u5220\u9664\u64CD\u4F5C</p><p>\u5220\u9664\u64CD\u4F5C\u4E5F\u662F\u5E42\u7B49\u7684\uFF0C\u5220\u9664\u4E00\u6B21\u548C\u591A\u6B21\u5220\u9664\u90FD\u662F\u628A\u6570\u636E\u5220\u9664\u3002(\u6CE8\u610F\u53EF\u80FD\u8FD4\u56DE\u7ED3\u679C\u4E0D\u4E00\u6837\uFF0C\u5220\u9664\u7684\u6570\u636E\u4E0D\u5B58\u5728\uFF0C\u8FD4\u56DE 0\uFF0C\u5220\u9664\u7684\u6570\u636E\u591A\u6761\uFF0C\u8FD4\u56DE\u7ED3\u679C\u591A\u4E2A\u3002</p><p>3.\u552F\u4E00\u7D22\u5F15</p><p>\u9632\u6B62\u65B0\u589E\u810F\u6570\u636E\u3002\u6BD4\u5982\uFF1A\u652F\u4ED8\u5B9D\u7684\u8D44\u91D1\u8D26\u6237\uFF0C\u652F\u4ED8\u5B9D\u4E5F\u6709\u7528\u6237\u8D26\u6237\uFF0C\u6BCF\u4E2A\u7528\u6237\u53EA\u80FD\u6709\u4E00\u4E2A\u8D44\u91D1\u8D26\u6237\uFF0C\u600E\u4E48\u9632\u6B62\u7ED9\u7528\u6237\u521B\u5EFA\u591A\u4E2A\u8D44\u91D1\u8D26\u6237\uFF0C\u90A3\u4E48\u7ED9\u8D44\u91D1\u8D26\u6237\u8868\u4E2D\u7684\u7528\u6237 ID \u52A0\u552F\u4E00\u7D22\u5F15\uFF0C\u6240\u4EE5\u4E00\u4E2A\u7528\u6237\u65B0\u589E\u6210\u529F\u4E00\u4E2A\u8D44\u91D1\u8D26\u6237\u8BB0\u5F55\u3002\u8981\u70B9\uFF1A\u552F\u4E00\u7D22\u5F15\u6216\u552F\u4E00\u7EC4\u5408\u7D22\u5F15\u6765\u9632\u6B62\u65B0\u589E\u6570\u636E\u5B58\u5728\u810F\u6570\u636E\uFF08\u5F53\u8868\u5B58\u5728\u552F\u4E00\u7D22\u5F15\uFF0C\u5E76\u53D1\u65F6\u65B0\u589E\u62A5\u9519\u65F6\uFF0C\u518D\u67E5\u8BE2\u4E00\u6B21\u5C31\u53EF\u4EE5\u4E86\uFF0C\u6570\u636E\u5E94\u8BE5\u5DF2\u7ECF\u5B58\u5728\u4E86\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5373\u53EF\u3002</p><p>4.token \u673A\u5236</p><p>\u9632\u6B62\u9875\u9762\u91CD\u590D\u63D0\u4EA4\u3002</p><p>**\u4E1A\u52A1\u8981\u6C42\uFF1A**\u9875\u9762\u7684\u6570\u636E\u53EA\u80FD\u88AB\u70B9\u51FB\u63D0\u4EA4\u4E00\u6B21\uFF1B</p><p>**\u53D1\u751F\u539F\u56E0\uFF1A**\u7531\u4E8E\u91CD\u590D\u70B9\u51FB\u6216\u8005\u7F51\u7EDC\u91CD\u53D1\uFF0C\u6216\u8005 nginx \u91CD\u53D1\u7B49\u60C5\u51B5\u4F1A\u5BFC\u81F4\u6570\u636E\u88AB\u91CD\u590D\u63D0\u4EA4\uFF1B</p><p>**\u89E3\u51B3\u529E\u6CD5\uFF1A**\u96C6\u7FA4\u73AF\u5883\u91C7\u7528 token \u52A0 redis(redis \u5355\u7EBF\u7A0B\u7684\uFF0C\u5904\u7406\u9700\u8981\u6392\u961F)\uFF1B\u5355 JVM \u73AF\u5883\uFF1A\u91C7\u7528 token \u52A0 redis \u6216 token \u52A0 jvm \u9501\u3002</p><p><strong>\u5904\u7406\u6D41\u7A0B\uFF1A</strong></p><ol><li>\u6570\u636E\u63D0\u4EA4\u524D\u8981\u5411\u670D\u52A1\u7684\u7533\u8BF7 token\uFF0Ctoken \u653E\u5230 redis \u6216 jvm \u5185\u5B58\uFF0Ctoken \u6709\u6548\u65F6\u95F4\uFF1B</li><li>\u63D0\u4EA4\u540E\u540E\u53F0\u6821\u9A8C token\uFF0C\u540C\u65F6\u5220\u9664 token\uFF0C\u751F\u6210\u65B0\u7684 token \u8FD4\u56DE\u3002</li></ol><p>**token \u7279\u70B9\uFF1A**\u8981\u7533\u8BF7\uFF0C\u4E00\u6B21\u6709\u6548\u6027\uFF0C\u53EF\u4EE5\u9650\u6D41\u3002</p><p>\u6CE8\u610F\uFF1Aredis \u8981\u7528\u5220\u9664\u64CD\u4F5C\u6765\u5224\u65AD token\uFF0C\u5220\u9664\u6210\u529F\u4EE3\u8868 token \u6821\u9A8C\u901A\u8FC7\u3002</p><ol start="5"><li><p>traceId</p><p>\u64CD\u4F5C\u65F6\u552F\u4E00\u7684\u3002</p></li></ol><h2 id="\u5BF9\u5916\u63D0\u4F9B\u7684api\u5982\u4F55\u4FDD\u8BC1\u5E42\u7B49" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u5916\u63D0\u4F9B\u7684api\u5982\u4F55\u4FDD\u8BC1\u5E42\u7B49" aria-hidden="true">#</a> \u5BF9\u5916\u63D0\u4F9B\u7684API\u5982\u4F55\u4FDD\u8BC1\u5E42\u7B49\uFF1F</h2><p>\u4E3E\u4F8B\u8BF4\u660E\uFF1A \u94F6\u8054\u63D0\u4F9B\u7684\u4ED8\u6B3E\u63A5\u53E3\uFF1A\u9700\u8981\u63A5\u5165\u5546\u6237\u63D0\u4EA4\u4ED8\u6B3E\u8BF7\u6C42\u65F6\u9644\u5E26\uFF1Asource \u6765\u6E90\uFF0Cseq \u5E8F\u5217\u53F7\u3002</p><p>source+seq \u5728\u6570\u636E\u5E93\u91CC\u9762\u505A\u552F\u4E00\u7D22\u5F15\uFF0C\u9632\u6B62\u591A\u6B21\u4ED8\u6B3E(\u5E76\u53D1\u65F6\uFF0C\u53EA\u80FD\u5904\u7406\u4E00\u4E2A\u8BF7\u6C42) \u3002\u91CD\u70B9\uFF1A\u5BF9\u5916\u63D0\u4F9B\u63A5\u53E3\u4E3A\u4E86\u652F\u6301\u5E42\u7B49\u8C03\u7528\uFF0C\u63A5\u53E3\u6709\u4E24\u4E2A\u5B57\u6BB5\u5FC5\u987B\u4F20\uFF0C\u4E00\u4E2A\u662F\u6765\u6E90 source\uFF0C\u4E00\u4E2A\u662F\u6765\u6E90\u65B9\u5E8F\u5217\u53F7 seq\uFF0C\u8FD9\u4E2A\u4E24\u4E2A\u5B57\u6BB5\u5728\u63D0\u4F9B\u65B9\u7CFB\u7EDF\u91CC\u9762\u505A\u8054\u5408\u552F\u4E00\u7D22\u5F15\uFF0C\u8FD9\u6837\u5F53\u7B2C\u4E09\u65B9\u8C03\u7528\u65F6\uFF0C\u5148\u5728\u672C\u65B9\u7CFB\u7EDF\u91CC\u9762\u67E5\u8BE2\u4E00\u4E0B\uFF0C\u662F\u5426\u5DF2\u7ECF\u5904\u7406\u8FC7\uFF0C\u8FD4\u56DE\u76F8\u5E94\u5904\u7406\u7ED3\u679C\uFF1B\u6CA1\u6709\u5904\u7406\u8FC7\uFF0C\u8FDB\u884C\u76F8\u5E94\u5904\u7406\uFF0C\u8FD4\u56DE\u7ED3\u679C\u3002</p><p>\u6CE8\u610F\uFF0C\u4E3A\u4E86\u5E42\u7B49\u53CB\u597D\uFF0C\u4E00\u5B9A\u8981\u5148\u67E5\u8BE2\u4E00\u4E0B\uFF0C\u662F\u5426\u5904\u7406\u8FC7\u8BE5\u7B14\u4E1A\u52A1\uFF0C\u4E0D\u67E5\u8BE2\u76F4\u63A5\u63D2\u5165\u4E1A\u52A1\u7CFB\u7EDF\uFF0C\u4F1A\u62A5\u9519\uFF0C\u4F46\u5B9E\u9645\u5DF2\u7ECF\u5904\u7406\u3002</p><h2 id="\u53CC\u5199\u4E00\u81F4\u6027\u95EE\u9898\u5982\u4F55\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#\u53CC\u5199\u4E00\u81F4\u6027\u95EE\u9898\u5982\u4F55\u89E3\u51B3" aria-hidden="true">#</a> \u53CC\u5199\u4E00\u81F4\u6027\u95EE\u9898\u5982\u4F55\u89E3\u51B3\uFF1F</h2><p>\u5148\u505A\u4E00\u4E2A\u8BF4\u660E\uFF0C\u4ECE\u7406\u8BBA\u4E0A\u6765\u8BF4\uFF0C\u7ED9\u7F13\u5B58\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF0C\u662F\u4FDD\u8BC1\u6700\u7EC8\u4E00\u81F4\u6027\u7684\u89E3\u51B3\u65B9\u6848\u3002\u8FD9\u79CD\u65B9\u6848\u4E0B\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5BF9\u5B58\u5165\u7F13\u5B58\u7684\u6570\u636E\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF0C\u6240\u6709\u7684\u5199\u64CD\u4F5C\u4EE5\u6570\u636E\u5E93\u4E3A\u51C6\uFF0C\u5BF9\u7F13\u5B58\u64CD\u4F5C\u53EA\u662F\u5C3D\u6700\u5927\u52AA\u529B\u66F4\u65B0\u5373\u53EF\u3002\u4E5F\u5C31\u662F\u8BF4\u5982\u679C\u6570\u636E\u5E93\u5199\u6210\u529F\uFF0C\u7F13\u5B58\u66F4\u65B0\u5931\u8D25\uFF0C\u90A3\u4E48\u53EA\u8981\u5230\u8FBE\u8FC7\u671F\u65F6\u95F4\uFF0C\u5219\u540E\u9762\u7684\u8BFB\u8BF7\u6C42\u81EA\u7136\u4F1A\u4ECE\u6570\u636E\u5E93\u4E2D\u8BFB\u53D6\u65B0\u503C\u7136\u540E\u56DE\u586B\u7F13\u5B58\u3002\u56E0\u6B64\uFF0C\u63A5\u4E0B\u6765\u8BA8\u8BBA\u7684\u601D\u8DEF\u4E0D\u4F9D\u8D56\u4E8E\u7ED9\u7F13\u5B58\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u8FD9\u4E2A\u65B9\u6848\u3002 \u5728\u8FD9\u91CC\uFF0C\u6211\u4EEC\u8BA8\u8BBA<strong>\u4E09\u79CD</strong>\u66F4\u65B0\u7B56\u7565\uFF1A</p><ol><li>\u5148\u66F4\u65B0\u7F13\u5B58\uFF0C\u518D\u66F4\u65B0\u6570\u636E\u5E93\u3002\uFF08\u4E0D\u53EF\u53D6\uFF09</li><li>\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u66F4\u65B0\u7F13\u5B58\u3002\uFF08\u4E0D\u53EF\u53D6\uFF09</li><li>\u5148\u5220\u9664\u7F13\u5B58\uFF0C\u518D\u66F4\u65B0\u6570\u636E\u5E93\u3002\uFF08\u4E0D\u53EF\u53D6\uFF09</li><li>\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u5220\u9664\u7F13\u5B58\u3002\uFF08\u53EF\u53D6\uFF0C\u6709\u95EE\u9898\u5F85\u89E3\u51B3\uFF09</li></ol><h4 id="\u5927\u524D\u63D0" tabindex="-1"><a class="header-anchor" href="#\u5927\u524D\u63D0" aria-hidden="true">#</a> \u5927\u524D\u63D0\uFF1A</h4><p>\u5148\u8BFB\u7F13\u5B58\uFF0C\u5982\u679C\u7F13\u5B58\u6CA1\u6709\uFF0C\u624D\u4ECE\u6570\u636E\u5E93\u8BFB\u53D6\u3002</p><h4 id="_1-\u5148\u66F4\u65B0\u6570\u636E\u5E93-\u518D\u66F4\u65B0\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-\u5148\u66F4\u65B0\u6570\u636E\u5E93-\u518D\u66F4\u65B0\u7F13\u5B58" aria-hidden="true">#</a> (1)\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u66F4\u65B0\u7F13\u5B58</h4><p>\u8FD9\u5957\u65B9\u6848\uFF0C\u5927\u5BB6\u662F\u666E\u904D\u53CD\u5BF9\u7684\u3002\u4E3A\u4EC0\u4E48\u5462\uFF1F\u6709\u5982\u4E0B\u4E24\u70B9\u539F\u56E0\u3002</p><p><strong>\u539F\u56E0\u4E00\uFF08\u7EBF\u7A0B\u5B89\u5168\u89D2\u5EA6\uFF09</strong></p><p>\u540C\u65F6\u6709\u8BF7\u6C42A\u548C\u8BF7\u6C42B\u8FDB\u884C\u66F4\u65B0\u64CD\u4F5C\uFF0C\u90A3\u4E48\u4F1A\u51FA\u73B0</p><ol><li>\u7EBF\u7A0BA\u66F4\u65B0\u4E86\u6570\u636E\u5E93</li><li>\u7EBF\u7A0BB\u66F4\u65B0\u4E86\u6570\u636E\u5E93</li><li>\u7EBF\u7A0BB\u66F4\u65B0\u4E86\u7F13\u5B58</li><li>\u7EBF\u7A0BA\u66F4\u65B0\u4E86\u7F13\u5B58</li></ol><p>\u8FD9\u5C31\u51FA\u73B0\u8BF7\u6C42A\u66F4\u65B0\u7F13\u5B58\u5E94\u8BE5\u6BD4\u8BF7\u6C42B\u66F4\u65B0\u7F13\u5B58\u65E9\u624D\u5BF9\uFF0C\u4F46\u662F\u56E0\u4E3A\u7F51\u7EDC\u7B49\u539F\u56E0\uFF0CB\u5374\u6BD4A\u66F4\u65E9\u66F4\u65B0\u4E86\u7F13\u5B58\u3002\u8FD9\u5C31\u5BFC\u81F4\u4E86\u810F\u6570\u636E\uFF0C\u56E0\u6B64\u4E0D\u8003\u8651\u3002</p><p><strong>\u539F\u56E0\u4E8C\uFF08\u4E1A\u52A1\u573A\u666F\u89D2\u5EA6\uFF09</strong></p><p>\u6709\u5982\u4E0B\u4E24\u70B9\uFF1A</p><ol><li>\u5982\u679C\u4F60\u662F\u4E00\u4E2A\u5199\u6570\u636E\u5E93\u573A\u666F\u6BD4\u8F83\u591A\uFF0C\u800C\u8BFB\u6570\u636E\u573A\u666F\u6BD4\u8F83\u5C11\u7684\u4E1A\u52A1\u9700\u6C42\uFF0C\u91C7\u7528\u8FD9\u79CD\u65B9\u6848\u5C31\u4F1A\u5BFC\u81F4\uFF0C\u6570\u636E\u538B\u6839\u8FD8\u6CA1\u8BFB\u5230\uFF0C\u7F13\u5B58\u5C31\u88AB\u9891\u7E41\u7684\u66F4\u65B0\uFF0C\u6D6A\u8D39\u6027\u80FD\u3002</li><li>\u5982\u679C\u4F60\u5199\u5165\u6570\u636E\u5E93\u7684\u503C\uFF0C\u5E76\u4E0D\u662F\u76F4\u63A5\u5199\u5165\u7F13\u5B58\u7684\uFF0C\u800C\u662F\u8981\u7ECF\u8FC7\u4E00\u7CFB\u5217\u590D\u6742\u7684\u8BA1\u7B97\u518D\u5199\u5165\u7F13\u5B58\u3002\u90A3\u4E48\uFF0C\u6BCF\u6B21\u5199\u5165\u6570\u636E\u5E93\u540E\uFF0C\u90FD\u518D\u6B21\u8BA1\u7B97\u5199\u5165\u7F13\u5B58\u7684\u503C\uFF0C\u65E0\u7591\u662F\u6D6A\u8D39\u6027\u80FD\u7684\u3002\u663E\u7136\uFF0C\u5220\u9664\u7F13\u5B58\u66F4\u4E3A\u9002\u5408\u3002</li></ol><p>\u63A5\u4E0B\u6765\u8BA8\u8BBA\u7684\u5C31\u662F\u4E89\u8BAE\u6700\u5927\u7684\uFF0C\u5148\u5220\u7F13\u5B58\uFF0C\u518D\u66F4\u65B0\u6570\u636E\u5E93\u3002\u8FD8\u662F\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u5220\u7F13\u5B58\u7684\u95EE\u9898\u3002</p><h4 id="_2-\u5148\u5220\u7F13\u5B58-\u518D\u66F4\u65B0\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_2-\u5148\u5220\u7F13\u5B58-\u518D\u66F4\u65B0\u6570\u636E\u5E93" aria-hidden="true">#</a> (2)\u5148\u5220\u7F13\u5B58\uFF0C\u518D\u66F4\u65B0\u6570\u636E\u5E93</h4><p>\u8BE5\u65B9\u6848\u4F1A\u5BFC\u81F4\u4E0D\u4E00\u81F4\u7684\u539F\u56E0\u662F\u3002\u540C\u65F6\u6709\u4E00\u4E2A\u8BF7\u6C42A\u8FDB\u884C\u66F4\u65B0\u64CD\u4F5C\uFF0C\u53E6\u4E00\u4E2A\u8BF7\u6C42B\u8FDB\u884C\u67E5\u8BE2\u64CD\u4F5C\u3002\u90A3\u4E48\u4F1A\u51FA\u73B0\u5982\u4E0B\u60C5\u5F62:</p><ol><li>\u8BF7\u6C42A\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u5220\u9664\u7F13\u5B58</li><li>\u8BF7\u6C42B\u67E5\u8BE2\u53D1\u73B0\u7F13\u5B58\u4E0D\u5B58\u5728</li><li>\u8BF7\u6C42B\u53BB\u6570\u636E\u5E93\u67E5\u8BE2\u5F97\u5230\u65E7\u503C</li><li>\u8BF7\u6C42B\u5C06\u65E7\u503C\u5199\u5165\u7F13\u5B58</li><li>\u8BF7\u6C42A\u5C06\u65B0\u503C\u5199\u5165\u6570\u636E\u5E93</li></ol><p>\u4E0A\u8FF0\u60C5\u51B5\u5C31\u4F1A\u5BFC\u81F4\u4E0D\u4E00\u81F4\u7684\u60C5\u5F62\u51FA\u73B0\u3002\u800C\u4E14\uFF0C\u5982\u679C\u4E0D\u91C7\u7528\u7ED9\u7F13\u5B58\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u7B56\u7565\uFF0C\u8BE5\u6570\u636E\u6C38\u8FDC\u90FD\u662F\u810F\u6570\u636E\u3002 \u90A3\u4E48\uFF0C<strong>\u5982\u4F55\u89E3\u51B3\u5462\uFF1F\u91C7\u7528\u5EF6\u65F6\u53CC\u5220\u7B56\u7565</strong></p><ol><li>\u5148\u6DD8\u6C70\u7F13\u5B58</li><li>\u518D\u5199\u6570\u636E\u5E93\uFF08\u8FD9\u4E24\u6B65\u548C\u539F\u6765\u4E00\u6837\uFF09</li><li>\u4F11\u77201\u79D2\uFF0C\u518D\u6B21\u6DD8\u6C70\u7F13\u5B58</li></ol><p>\u8FD9\u4E48\u505A\uFF0C\u53EF\u4EE5\u5C061\u79D2\u5185\u6240\u9020\u6210\u7684\u7F13\u5B58\u810F\u6570\u636E\uFF0C\u518D\u6B21\u5220\u9664\u3002</p><p><strong>\u90A3\u4E48\uFF0C\u8FD9\u4E2A1\u79D2\u600E\u4E48\u786E\u5B9A\u7684\uFF0C\u5177\u4F53\u8BE5\u4F11\u7720\u591A\u4E45\u5462\uFF1F</strong></p><p>\u9488\u5BF9\u4E0A\u9762\u7684\u60C5\u5F62\uFF0C\u8BFB\u8005\u5E94\u8BE5\u81EA\u884C\u8BC4\u4F30\u81EA\u5DF1\u7684\u9879\u76EE\u7684\u8BFB\u6570\u636E\u4E1A\u52A1\u903B\u8F91\u7684\u8017\u65F6\u3002\u7136\u540E\u5199\u6570\u636E\u7684\u4F11\u7720\u65F6\u95F4\u5219\u5728\u8BFB\u6570\u636E\u4E1A\u52A1\u903B\u8F91\u7684\u8017\u65F6\u57FA\u7840\u4E0A\uFF0C\u52A0\u51E0\u767Ems\u5373\u53EF\u3002\u8FD9\u4E48\u505A\u7684\u76EE\u7684\uFF0C\u5C31\u662F\u786E\u4FDD\u8BFB\u8BF7\u6C42\u7ED3\u675F\uFF0C\u5199\u8BF7\u6C42\u53EF\u4EE5\u5220\u9664\u8BFB\u8BF7\u6C42\u9020\u6210\u7684\u7F13\u5B58\u810F\u6570\u636E\u3002</p><p><strong>\u5982\u679C\u4F60\u7528\u4E86mysql\u7684\u8BFB\u5199\u5206\u79BB\u67B6\u6784\u600E\u4E48\u529E\uFF1F</strong></p><p>ok\uFF0C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u9020\u6210\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u539F\u56E0\u5982\u4E0B\uFF0C\u8FD8\u662F\u4E24\u4E2A\u8BF7\u6C42\uFF0C\u4E00\u4E2A\u8BF7\u6C42A\u8FDB\u884C\u66F4\u65B0\u64CD\u4F5C\uFF0C\u53E6\u4E00\u4E2A\u8BF7\u6C42B\u8FDB\u884C\u67E5\u8BE2\u64CD\u4F5C\u3002</p><ol><li>\u8BF7\u6C42A\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u5220\u9664\u7F13\u5B58</li><li>\u8BF7\u6C42A\u5C06\u6570\u636E\u5199\u5165\u6570\u636E\u5E93\u4E86\uFF0C</li><li>\u8BF7\u6C42B\u67E5\u8BE2\u7F13\u5B58\u53D1\u73B0\uFF0C\u7F13\u5B58\u6CA1\u6709\u503C</li><li>\u8BF7\u6C42B\u53BB\u4ECE\u5E93\u67E5\u8BE2\uFF0C\u8FD9\u65F6\uFF0C\u8FD8\u6CA1\u6709\u5B8C\u6210\u4E3B\u4ECE\u540C\u6B65\uFF0C\u56E0\u6B64\u67E5\u8BE2\u5230\u7684\u662F\u65E7\u503C</li><li>\u8BF7\u6C42B\u5C06\u65E7\u503C\u5199\u5165\u7F13\u5B58</li><li>\u6570\u636E\u5E93\u5B8C\u6210\u4E3B\u4ECE\u540C\u6B65\uFF0C\u4ECE\u5E93\u53D8\u4E3A\u65B0\u503C</li></ol><p>\u4E0A\u8FF0\u60C5\u5F62\uFF0C\u5C31\u662F\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u539F\u56E0\u3002\u8FD8\u662F\u4F7F\u7528\u53CC\u5220\u5EF6\u65F6\u7B56\u7565\u3002\u53EA\u662F\uFF0C\u7761\u7720\u65F6\u95F4\u4FEE\u6539\u4E3A\u5728\u4E3B\u4ECE\u540C\u6B65\u7684\u5EF6\u65F6\u65F6\u95F4\u57FA\u7840\u4E0A\uFF0C\u52A0\u51E0\u767Ems\u3002</p><p><strong>\u91C7\u7528\u8FD9\u79CD\u540C\u6B65\u6DD8\u6C70\u7B56\u7565\uFF0C\u541E\u5410\u91CF\u964D\u4F4E\u600E\u4E48\u529E\uFF1F</strong></p><p>ok\uFF0C\u90A3\u5C31\u5C06\u7B2C\u4E8C\u6B21\u5220\u9664\u4F5C\u4E3A\u5F02\u6B65\u7684\u3002\u81EA\u5DF1\u8D77\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u5F02\u6B65\u5220\u9664\u3002\u8FD9\u6837\uFF0C\u5199\u7684\u8BF7\u6C42\u5C31\u4E0D\u7528\u6C89\u7761\u4E00\u6BB5\u65F6\u95F4\u540E\u4E86\uFF0C\u518D\u8FD4\u56DE\u3002\u8FD9\u4E48\u505A\uFF0C\u52A0\u5927\u541E\u5410\u91CF\u3002</p><p><strong>\u7B2C\u4E8C\u6B21\u5220\u9664,\u5982\u679C\u5220\u9664\u5931\u8D25\u600E\u4E48\u529E\uFF1F</strong></p><p>\u8FD9\u662F\u4E2A\u975E\u5E38\u597D\u7684\u95EE\u9898\uFF0C\u56E0\u4E3A\u7B2C\u4E8C\u6B21\u5220\u9664\u5931\u8D25\uFF0C\u5C31\u4F1A\u51FA\u73B0\u5982\u4E0B\u60C5\u5F62\u3002\u8FD8\u662F\u6709\u4E24\u4E2A\u8BF7\u6C42\uFF0C\u4E00\u4E2A\u8BF7\u6C42A\u8FDB\u884C\u66F4\u65B0\u64CD\u4F5C\uFF0C\u53E6\u4E00\u4E2A\u8BF7\u6C42B\u8FDB\u884C\u67E5\u8BE2\u64CD\u4F5C\uFF0C\u4E3A\u4E86\u65B9\u4FBF\uFF0C\u5047\u8BBE\u662F\u5355\u5E93\uFF1A</p><ol><li>\u8BF7\u6C42A\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u5220\u9664\u7F13\u5B58</li><li>\u8BF7\u6C42B\u67E5\u8BE2\u53D1\u73B0\u7F13\u5B58\u4E0D\u5B58\u5728</li><li>\u8BF7\u6C42B\u53BB\u6570\u636E\u5E93\u67E5\u8BE2\u5F97\u5230\u65E7\u503C</li><li>\u8BF7\u6C42B\u5C06\u65E7\u503C\u5199\u5165\u7F13\u5B58</li><li>\u8BF7\u6C42A\u5C06\u65B0\u503C\u5199\u5165\u6570\u636E\u5E93</li><li>\u8BF7\u6C42A\u8BD5\u56FE\u53BB\u5220\u9664\uFF0C\u8BF7\u6C42B\u5199\u5165\u5BF9\u7684\u7F13\u5B58\u503C\uFF0C\u7ED3\u679C\u5931\u8D25\u4E86\u3002</li></ol><p>ok,\u8FD9\u4E5F\u5C31\u662F\u8BF4\u3002\u5982\u679C\u7B2C\u4E8C\u6B21\u5220\u9664\u7F13\u5B58\u5931\u8D25\uFF0C\u4F1A\u518D\u6B21\u51FA\u73B0\u7F13\u5B58\u548C\u6570\u636E\u5E93\u4E0D\u4E00\u81F4\u7684\u95EE\u9898\u3002</p><p><strong>\u5982\u4F55\u89E3\u51B3\u5462\uFF1F</strong></p><h4 id="_3-\u5148\u66F4\u65B0\u6570\u636E\u5E93-\u518D\u5220\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_3-\u5148\u66F4\u65B0\u6570\u636E\u5E93-\u518D\u5220\u7F13\u5B58" aria-hidden="true">#</a> (3)\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u5220\u7F13\u5B58</h4>',100),un=s("\u9996\u5148\uFF0C\u5148\u8BF4\u4E00\u4E0B\u3002\u8001\u5916\u63D0\u51FA\u4E86\u4E00\u4E2A\u7F13\u5B58\u66F4\u65B0\u5957\u8DEF\uFF0C\u540D\u4E3A"),rn={href:"https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside",target:"_blank",rel:"noopener noreferrer"},dn=s("\u300ACache-Aside pattern\u300B"),kn=s(" \u3002\u5176\u4E2D\u5C31\u6307\u51FA"),mn=n("ul",null,[n("li",null,[n("strong",null,"\u5931\u6548"),s("\uFF1A\u5E94\u7528\u7A0B\u5E8F\u5148\u4ECEcache\u53D6\u6570\u636E\uFF0C\u6CA1\u6709\u5F97\u5230\uFF0C\u5219\u4ECE\u6570\u636E\u5E93\u4E2D\u53D6\u6570\u636E\uFF0C\u6210\u529F\u540E\uFF0C\u653E\u5230\u7F13\u5B58\u4E2D\u3002")]),n("li",null,[n("strong",null,"\u547D\u4E2D"),s("\uFF1A\u5E94\u7528\u7A0B\u5E8F\u4ECEcache\u4E2D\u53D6\u6570\u636E\uFF0C\u53D6\u5230\u540E\u8FD4\u56DE\u3002")]),n("li",null,[n("strong",null,"\u66F4\u65B0"),s("\uFF1A\u5148\u628A\u6570\u636E\u5B58\u5230\u6570\u636E\u5E93\u4E2D\uFF0C\u6210\u529F\u540E\uFF0C\u518D\u8BA9\u7F13\u5B58\u5931\u6548\u3002")])],-1),vn=s("\u53E6\u5916\uFF0C\u77E5\u540D\u793E\u4EA4\u7F51\u7AD9facebook\u4E5F\u5728\u8BBA\u6587"),bn={href:"https://www.usenix.org/system/files/conference/nsdi13/nsdi13-final170_update.pdf",target:"_blank",rel:"noopener noreferrer"},hn=s("\u300AScaling Memcache at Facebook\u300B"),gn=s(" \u4E2D\u63D0\u51FA\uFF0C\u4ED6\u4EEC\u7528\u7684\u4E5F\u662F\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u5220\u7F13\u5B58\u7684\u7B56\u7565\u3002 "),fn=n("strong",null,"\u8FD9\u79CD\u60C5\u51B5\u4E0D\u5B58\u5728\u5E76\u53D1\u95EE\u9898\u4E48\uFF1F",-1),yn=s(" \u4E0D\u662F\u7684\u3002\u5047\u8BBE\u8FD9\u4F1A\u6709\u4E24\u4E2A\u8BF7\u6C42\uFF0C\u4E00\u4E2A\u8BF7\u6C42A\u505A\u67E5\u8BE2\u64CD\u4F5C\uFF0C\u4E00\u4E2A\u8BF7\u6C42B\u505A\u66F4\u65B0\u64CD\u4F5C\uFF0C\u90A3\u4E48\u4F1A\u6709\u5982\u4E0B\u60C5\u5F62\u4EA7\u751F"),wn=e('<ol><li>\u7F13\u5B58\u521A\u597D\u5931\u6548</li><li>\u8BF7\u6C42A\u67E5\u8BE2\u6570\u636E\u5E93\uFF0C\u5F97\u4E00\u4E2A\u65E7\u503C</li><li>\u8BF7\u6C42B\u5C06\u65B0\u503C\u5199\u5165\u6570\u636E\u5E93</li><li>\u8BF7\u6C42B\u5220\u9664\u7F13\u5B58</li><li>\u8BF7\u6C42A\u5C06\u67E5\u5230\u7684\u65E7\u503C\u5199\u5165\u7F13\u5B58</li></ol><p>ok\uFF0C\u5982\u679C\u53D1\u751F\u4E0A\u8FF0\u60C5\u51B5\uFF0C\u786E\u5B9E\u662F\u4F1A\u53D1\u751F\u810F\u6570\u636E\u3002</p><p><strong>\u7136\u800C\uFF0C\u53D1\u751F\u8FD9\u79CD\u60C5\u51B5\u7684\u6982\u7387\u53C8\u6709\u591A\u5C11\u5462\uFF1F</strong></p><p>\u53D1\u751F\u4E0A\u8FF0\u60C5\u51B5\u6709\u4E00\u4E2A\u5148\u5929\u6027\u6761\u4EF6\uFF0C\u5C31\u662F\u6B65\u9AA4\uFF083\uFF09\u7684\u5199\u6570\u636E\u5E93\u64CD\u4F5C\u6BD4\u6B65\u9AA4\uFF082\uFF09\u7684\u8BFB\u6570\u636E\u5E93\u64CD\u4F5C\u8017\u65F6\u66F4\u77ED\uFF0C\u624D\u6709\u53EF\u80FD\u4F7F\u5F97\u6B65\u9AA4\uFF084\uFF09\u5148\u4E8E\u6B65\u9AA4\uFF085\uFF09\u3002\u53EF\u662F\uFF0C\u5927\u5BB6\u60F3\u60F3\uFF0C\u6570\u636E\u5E93\u7684\u8BFB\u64CD\u4F5C\u7684\u901F\u5EA6\u8FDC\u5FEB\u4E8E\u5199\u64CD\u4F5C\u7684\uFF08\u4E0D\u7136\u505A\u8BFB\u5199\u5206\u79BB\u5E72\u561B\uFF0C\u505A\u8BFB\u5199\u5206\u79BB\u7684\u610F\u4E49\u5C31\u662F\u56E0\u4E3A\u8BFB\u64CD\u4F5C\u6BD4\u8F83\u5FEB\uFF0C\u8017\u8D44\u6E90\u5C11\uFF09\uFF0C\u56E0\u6B64\u6B65\u9AA4\uFF083\uFF09\u8017\u65F6\u6BD4\u6B65\u9AA4\uFF082\uFF09\u66F4\u77ED\uFF0C\u8FD9\u4E00\u60C5\u5F62\u5F88\u96BE\u51FA\u73B0\u3002 \u5047\u8BBE\uFF0C\u6709\u4EBA\u975E\u8981\u62AC\u6760\uFF0C\u6709\u5F3A\u8FEB\u75C7\uFF0C\u4E00\u5B9A\u8981\u89E3\u51B3\u600E\u4E48\u529E\uFF1F</p><p><strong>\u5982\u4F55\u89E3\u51B3\u4E0A\u8FF0\u5E76\u53D1\u95EE\u9898\uFF1F</strong></p><p>\u9996\u5148\uFF0C\u7ED9\u7F13\u5B58\u8BBE\u6709\u6548\u65F6\u95F4\u662F\u4E00\u79CD\u65B9\u6848\u3002\u5176\u6B21\uFF0C\u91C7\u7528\u7B56\u7565\uFF082\uFF09\u91CC\u7ED9\u51FA\u7684\u5F02\u6B65\u5EF6\u65F6\u5220\u9664\u7B56\u7565\uFF0C\u4FDD\u8BC1\u8BFB\u8BF7\u6C42\u5B8C\u6210\u4EE5\u540E\uFF0C\u518D\u8FDB\u884C\u5220\u9664\u64CD\u4F5C\u3002</p><p><strong>\u8FD8\u6709\u5176\u4ED6\u9020\u6210\u4E0D\u4E00\u81F4\u7684\u539F\u56E0\u4E48\uFF1F</strong></p><p>\u6709\u7684\uFF0C\u8FD9\u4E5F\u662F\u7F13\u5B58\u66F4\u65B0\u7B56\u7565\uFF082\uFF09\u548C\u7F13\u5B58\u66F4\u65B0\u7B56\u7565\uFF083\uFF09\u90FD\u5B58\u5728\u7684\u4E00\u4E2A\u95EE\u9898\uFF0C\u5982\u679C\u5220\u7F13\u5B58\u5931\u8D25\u4E86\u600E\u4E48\u529E\uFF0C\u90A3\u4E0D\u662F\u4F1A\u6709\u4E0D\u4E00\u81F4\u7684\u60C5\u51B5\u51FA\u73B0\u4E48\u3002\u6BD4\u5982\u4E00\u4E2A\u5199\u6570\u636E\u8BF7\u6C42\uFF0C\u7136\u540E\u5199\u5165\u6570\u636E\u5E93\u4E86\uFF0C\u5220\u7F13\u5B58\u5931\u8D25\u4E86\uFF0C\u8FD9\u4F1A\u5C31\u51FA\u73B0\u4E0D\u4E00\u81F4\u7684\u60C5\u51B5\u4E86\u3002\u8FD9\u4E5F\u662F\u7F13\u5B58\u66F4\u65B0\u7B56\u7565\uFF082\uFF09\u91CC\u7559\u4E0B\u7684\u6700\u540E\u4E00\u4E2A\u7591\u95EE\u3002</p><p><strong>\u5982\u4F55\u89E3\u51B3\uFF1F</strong></p><p>\u63D0\u4F9B\u4E00\u4E2A\u4FDD\u969C\u7684\u91CD\u8BD5\u673A\u5236\u5373\u53EF\uFF0C\u8FD9\u91CC\u7ED9\u51FA\u4E24\u5957\u65B9\u6848\u3002</p><p><strong>\u65B9\u6848\u4E00</strong>\uFF1A</p><p>\u5982\u4E0B\u56FE\u6240\u793A</p><p>\u6D41\u7A0B\u5982\u4E0B\u6240\u793A</p><ol><li>\u66F4\u65B0\u6570\u636E\u5E93\u6570\u636E\uFF1B</li><li>\u7F13\u5B58\u56E0\u4E3A\u79CD\u79CD\u95EE\u9898\u5220\u9664\u5931\u8D25</li><li>\u5C06\u9700\u8981\u5220\u9664\u7684key\u53D1\u9001\u81F3\u6D88\u606F\u961F\u5217</li><li>\u81EA\u5DF1\u6D88\u8D39\u6D88\u606F\uFF0C\u83B7\u5F97\u9700\u8981\u5220\u9664\u7684key</li><li>\u7EE7\u7EED\u91CD\u8BD5\u5220\u9664\u64CD\u4F5C\uFF0C\u76F4\u5230\u6210\u529F</li></ol><p>\u7136\u800C\uFF0C\u8BE5\u65B9\u6848\u6709\u4E00\u4E2A\u7F3A\u70B9\uFF0C\u5BF9\u4E1A\u52A1\u7EBF\u4EE3\u7801\u9020\u6210\u5927\u91CF\u7684\u4FB5\u5165\u3002\u4E8E\u662F\u6709\u4E86\u65B9\u6848\u4E8C\uFF0C\u5728\u65B9\u6848\u4E8C\u4E2D\uFF0C\u542F\u52A8\u4E00\u4E2A\u8BA2\u9605\u7A0B\u5E8F\u53BB\u8BA2\u9605\u6570\u636E\u5E93\u7684binlog\uFF0C\u83B7\u5F97\u9700\u8981\u64CD\u4F5C\u7684\u6570\u636E\u3002\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\uFF0C\u53E6\u8D77\u4E00\u6BB5\u7A0B\u5E8F\uFF0C\u83B7\u5F97\u8FD9\u4E2A\u8BA2\u9605\u7A0B\u5E8F\u4F20\u6765\u7684\u4FE1\u606F\uFF0C\u8FDB\u884C\u5220\u9664\u7F13\u5B58\u64CD\u4F5C\u3002</p><p><strong>\u65B9\u6848\u4E8C</strong>\uFF1A</p><p>\u6D41\u7A0B\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><ol><li>\u66F4\u65B0\u6570\u636E\u5E93\u6570\u636E</li><li>\u6570\u636E\u5E93\u4F1A\u5C06\u64CD\u4F5C\u4FE1\u606F\u5199\u5165binlog\u65E5\u5FD7\u5F53\u4E2D</li><li>\u8BA2\u9605\u7A0B\u5E8F\u63D0\u53D6\u51FA\u6240\u9700\u8981\u7684\u6570\u636E\u4EE5\u53CAkey</li><li>\u53E6\u8D77\u4E00\u6BB5\u975E\u4E1A\u52A1\u4EE3\u7801\uFF0C\u83B7\u5F97\u8BE5\u4FE1\u606F</li><li>\u5C1D\u8BD5\u5220\u9664\u7F13\u5B58\u64CD\u4F5C\uFF0C\u53D1\u73B0\u5220\u9664\u5931\u8D25</li><li>\u5C06\u8FD9\u4E9B\u4FE1\u606F\u53D1\u9001\u81F3\u6D88\u606F\u961F\u5217</li><li>\u91CD\u65B0\u4ECE\u6D88\u606F\u961F\u5217\u4E2D\u83B7\u5F97\u8BE5\u6570\u636E\uFF0C\u91CD\u8BD5\u64CD\u4F5C\u3002</li></ol><p><strong>\u5907\u6CE8\u8BF4\u660E\uFF1A</strong> \u4E0A\u8FF0\u7684\u8BA2\u9605binlog\u7A0B\u5E8F\u5728mysql\u4E2D\u6709\u73B0\u6210\u7684\u4E2D\u95F4\u4EF6\u53EBcanal\uFF0C\u53EF\u4EE5\u5B8C\u6210\u8BA2\u9605binlog\u65E5\u5FD7\u7684\u529F\u80FD\u3002\u81F3\u4E8Eoracle\u4E2D\uFF0C\u535A\u4E3B\u76EE\u524D\u4E0D\u77E5\u9053\u6709\u6CA1\u6709\u73B0\u6210\u4E2D\u95F4\u4EF6\u53EF\u4EE5\u4F7F\u7528\u3002\u53E6\u5916\uFF0C\u91CD\u8BD5\u673A\u5236\uFF0C\u535A\u4E3B\u662F\u91C7\u7528\u7684\u662F\u6D88\u606F\u961F\u5217\u7684\u65B9\u5F0F\u3002\u5982\u679C\u5BF9\u4E00\u81F4\u6027\u8981\u6C42\u4E0D\u662F\u5F88\u9AD8\uFF0C\u76F4\u63A5\u5728\u7A0B\u5E8F\u4E2D\u53E6\u8D77\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u6BCF\u9694\u4E00\u6BB5\u65F6\u95F4\u53BB\u91CD\u8BD5\u5373\u53EF\uFF0C\u8FD9\u4E9B\u5927\u5BB6\u53EF\u4EE5\u7075\u6D3B\u81EA\u7531\u53D1\u6325\uFF0C\u53EA\u662F\u63D0\u4F9B\u4E00\u4E2A\u601D\u8DEF\u3002</p><h2 id="\u5206\u5E03\u5F0F\u5FAE\u670D\u52A1\u9879\u76EE\u4F60\u662F\u5982\u4F55\u8BBE\u8BA1\u7684" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u5FAE\u670D\u52A1\u9879\u76EE\u4F60\u662F\u5982\u4F55\u8BBE\u8BA1\u7684" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u5FAE\u670D\u52A1\u9879\u76EE\u4F60\u662F\u5982\u4F55\u8BBE\u8BA1\u7684\uFF1F</h2><p>\u6211\u4E00\u822C\u8BBE\u8BA1\u6210\u4E24\u5C42\uFF1A\u4E1A\u52A1\u5C42\u548C\u80FD\u529B\u5C42\uFF08\u4E2D\u53F0\uFF09\uFF0C\u4E1A\u52A1\u5C42\u63A5\u53D7\u7528\u6237\u8BF7\u6C42\uFF0C\u7136\u540E\u901A\u8FC7\u8C03\u7528\u80FD\u529B\u5C42\u6765\u5B8C\u6210\u4E1A\u52A1\u903B\u8F91\u3002</p><h2 id="\u8BA4\u8BC1-authentication-\u548C\u6388\u6743-authorization-\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u8BA4\u8BC1-authentication-\u548C\u6388\u6743-authorization-\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u8BA4\u8BC1 (Authentication) \u548C\u6388\u6743 (Authorization)\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><p>Authentication\uFF08\u8BA4\u8BC1\uFF09 \u662F\u9A8C\u8BC1\u60A8\u7684\u8EAB\u4EFD\u7684\u51ED\u636E\uFF08\u4F8B\u5982\u7528\u6237\u540D/\u7528\u6237ID\u548C\u5BC6\u7801\uFF09\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u51ED\u636E\uFF0C\u7CFB\u7EDF\u5F97\u4EE5\u77E5\u9053\u4F60\u5C31\u662F\u4F60\uFF0C\u4E5F\u5C31\u662F\u8BF4\u7CFB\u7EDF\u5B58\u5728\u4F60\u8FD9\u4E2A\u7528\u6237\u3002\u6240\u4EE5\uFF0CAuthentication \u88AB\u79F0\u4E3A\u8EAB\u4EFD/\u7528\u6237\u9A8C\u8BC1\u3002 Authorization\uFF08\u6388\u6743\uFF09 \u53D1\u751F\u5728 Authentication\uFF08\u8BA4\u8BC1\uFF09 \u4E4B\u540E\u3002\u6388\u6743\uFF0C\u5B83\u4E3B\u8981\u638C\u7BA1\u6211\u4EEC\u8BBF\u95EE\u7CFB\u7EDF\u7684\u6743\u9650\u3002\u6BD4\u5982\u6709\u4E9B\u7279\u5B9A\u8D44\u6E90\u53EA\u80FD\u5177\u6709\u7279\u5B9A\u6743\u9650\u7684\u4EBA\u624D\u80FD\u8BBF\u95EE\u6BD4\u5982admin\uFF0C\u6709\u4E9B\u5BF9\u7CFB\u7EDF\u8D44\u6E90\u64CD\u4F5C\u6BD4\u5982\u5220\u9664\u3001\u6DFB\u52A0\u3001\u66F4\u65B0\u53EA\u80FD\u7279\u5B9A\u4EBA\u624D\u5177\u6709\u3002 \u8FD9\u4E24\u4E2A\u4E00\u822C\u5728\u6211\u4EEC\u7684\u7CFB\u7EDF\u4E2D\u88AB\u7ED3\u5408\u5728\u4E00\u8D77\u4F7F\u7528\uFF0C\u76EE\u7684\u5C31\u662F\u4E3A\u4E86\u4FDD\u62A4\u6211\u4EEC\u7CFB\u7EDF\u7684\u5B89\u5168\u6027\u3002</p><h2 id="cookie-\u548C-session-\u6709\u4EC0\u4E48\u533A\u522B-\u5982\u4F55\u4F7F\u7528session\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#cookie-\u548C-session-\u6709\u4EC0\u4E48\u533A\u522B-\u5982\u4F55\u4F7F\u7528session\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1" aria-hidden="true">#</a> Cookie \u548C Session \u6709\u4EC0\u4E48\u533A\u522B\uFF1F\u5982\u4F55\u4F7F\u7528Session\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\uFF1F</h2><p>Session \u7684\u4E3B\u8981\u4F5C\u7528\u5C31\u662F\u901A\u8FC7\u670D\u52A1\u7AEF\u8BB0\u5F55\u7528\u6237\u7684\u72B6\u6001\u3002 \u5178\u578B\u7684\u573A\u666F\u662F\u8D2D\u7269\u8F66\uFF0C\u5F53\u4F60\u8981\u6DFB\u52A0\u5546\u54C1\u5230\u8D2D\u7269\u8F66\u7684\u65F6\u5019\uFF0C\u7CFB\u7EDF\u4E0D\u77E5\u9053\u662F\u54EA\u4E2A\u7528\u6237\u64CD\u4F5C\u7684\uFF0C\u56E0\u4E3A HTTP \u534F\u8BAE\u662F\u65E0\u72B6\u6001\u7684\u3002\u670D\u52A1\u7AEF\u7ED9\u7279\u5B9A\u7684\u7528\u6237\u521B\u5EFA\u7279\u5B9A\u7684 Session \u4E4B\u540E\u5C31\u53EF\u4EE5\u6807\u8BC6\u8FD9\u4E2A\u7528\u6237\u5E76\u4E14\u8DDF\u8E2A\u8FD9\u4E2A\u7528\u6237\u4E86\u3002</p><p>Cookie \u6570\u636E\u4FDD\u5B58\u5728\u5BA2\u6237\u7AEF(\u6D4F\u89C8\u5668\u7AEF)\uFF0CSession \u6570\u636E\u4FDD\u5B58\u5728\u670D\u52A1\u5668\u7AEF\u3002\u76F8\u5BF9\u6765\u8BF4 Session \u5B89\u5168\u6027\u66F4\u9AD8\u3002\u5982\u679C\u4F7F\u7528 Cookie \u7684\u4E00\u4E9B\u654F\u611F\u4FE1\u606F\u4E0D\u8981\u5199\u5165 Cookie \u4E2D\uFF0C\u6700\u597D\u80FD\u5C06 Cookie \u4FE1\u606F\u52A0\u5BC6\u7136\u540E\u4F7F\u7528\u5230\u7684\u65F6\u5019\u518D\u53BB\u670D\u52A1\u5668\u7AEF\u89E3\u5BC6\u3002</p><p>\u90A3\u4E48\uFF0C\u5982\u4F55\u4F7F\u7528Session\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\uFF1F</p><p>\u5F88\u591A\u65F6\u5019\u6211\u4EEC\u90FD\u662F\u901A\u8FC7 SessionID \u6765\u5B9E\u73B0\u7279\u5B9A\u7684\u7528\u6237\uFF0CSessionID \u4E00\u822C\u4F1A\u9009\u62E9\u5B58\u653E\u5728 Redis \u4E2D\u3002\u4E3E\u4E2A\u4F8B\u5B50\uFF1A\u7528\u6237\u6210\u529F\u767B\u9646\u7CFB\u7EDF\uFF0C\u7136\u540E\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u5177\u6709 SessionID \u7684 Cookie\uFF0C\u5F53\u7528\u6237\u5411\u540E\u7AEF\u53D1\u8D77\u8BF7\u6C42\u7684\u65F6\u5019\u4F1A\u628A SessionID \u5E26\u4E0A\uFF0C\u8FD9\u6837\u540E\u7AEF\u5C31\u77E5\u9053\u4F60\u7684\u8EAB\u4EFD\u72B6\u6001\u4E86\u3002\u5173\u4E8E\u8FD9\u79CD\u8BA4\u8BC1\u65B9\u5F0F\u66F4\u8BE6\u7EC6\u7684\u8FC7\u7A0B\u5982\u4E0B\uFF1A</p><p>\u7528\u6237\u5411\u670D\u52A1\u5668\u53D1\u9001\u7528\u6237\u540D\u548C\u5BC6\u7801\u7528\u4E8E\u767B\u9646\u7CFB\u7EDF\u3002</p><p>\u670D\u52A1\u5668\u9A8C\u8BC1\u901A\u8FC7\u540E\uFF0C\u670D\u52A1\u5668\u4E3A\u7528\u6237\u521B\u5EFA\u4E00\u4E2A Session\uFF0C\u5E76\u5C06 Session\u4FE1\u606F\u5B58\u50A8 \u8D77\u6765\u3002</p><p>\u670D\u52A1\u5668\u5411\u7528\u6237\u8FD4\u56DE\u4E00\u4E2A SessionID\uFF0C\u5199\u5165\u7528\u6237\u7684 Cookie\u3002</p><p>\u5F53\u7528\u6237\u4FDD\u6301\u767B\u5F55\u72B6\u6001\u65F6\uFF0CCookie \u5C06\u4E0E\u6BCF\u4E2A\u540E\u7EED\u8BF7\u6C42\u4E00\u8D77\u88AB\u53D1\u9001\u51FA\u53BB\u3002</p><p>\u670D\u52A1\u5668\u53EF\u4EE5\u5C06\u5B58\u50A8\u5728 Cookie \u4E0A\u7684 Session ID \u4E0E\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\u6216\u8005\u6570\u636E\u5E93\u4E2D\u7684 Session \u4FE1\u606F\u8FDB\u884C\u6BD4\u8F83\uFF0C\u4EE5\u9A8C\u8BC1\u7528\u6237\u7684\u8EAB\u4EFD\uFF0C\u8FD4\u56DE\u7ED9\u7528\u6237\u5BA2\u6237\u7AEF\u54CD\u5E94\u4FE1\u606F\u7684\u65F6\u5019\u4F1A\u9644\u5E26\u7528\u6237\u5F53\u524D\u7684\u72B6\u6001\u3002</p><p>\u4F7F\u7528 Session \u7684\u65F6\u5019\u9700\u8981\u6CE8\u610F\u4E0B\u9762\u51E0\u4E2A\u70B9\uFF1A</p><ul><li>\u4F9D\u8D56Session\u7684\u5173\u952E\u4E1A\u52A1\u4E00\u5B9A\u8981\u786E\u4FDD\u5BA2\u6237\u7AEF\u5F00\u542F\u4E86Cookie\u3002</li><li>\u6CE8\u610FSession\u7684\u8FC7\u671F\u65F6\u95F4</li></ul><h2 id="\u4E3A\u4EC0\u4E48cookie-\u65E0\u6CD5\u9632\u6B62csrf\u653B\u51FB-\u800Ctoken\u53EF\u4EE5" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48cookie-\u65E0\u6CD5\u9632\u6B62csrf\u653B\u51FB-\u800Ctoken\u53EF\u4EE5" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48Cookie \u65E0\u6CD5\u9632\u6B62CSRF\u653B\u51FB\uFF0C\u800Ctoken\u53EF\u4EE5\uFF1F</h2><p><strong>CSRF\uFF08Cross Site Request Forgery\uFF09</strong> \u4E00\u822C\u88AB\u7FFB\u8BD1\u4E3A \u8DE8\u7AD9\u8BF7\u6C42\u4F2A\u9020 \u3002\u90A3\u4E48\u4EC0\u4E48\u662F \u8DE8\u7AD9\u8BF7\u6C42\u4F2A\u9020 \u5462\uFF1F\u8BF4\u7B80\u5355\u7528\u4F60\u7684\u8EAB\u4EFD\u53BB\u53D1\u9001\u4E00\u4E9B\u5BF9\u4F60\u4E0D\u53CB\u597D\u7684\u8BF7\u6C42\u3002\u4E3E\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50\uFF1A</p><p>\u5C0F\u58EE\u767B\u5F55\u4E86\u67D0\u7F51\u4E0A\u94F6\u884C\uFF0C\u4ED6\u6765\u5230\u4E86\u7F51\u4E0A\u94F6\u884C\u7684\u5E16\u5B50\u533A\uFF0C\u770B\u5230\u4E00\u4E2A\u5E16\u5B50\u4E0B\u9762\u6709\u4E00\u4E2A\u94FE\u63A5\u5199\u7740\u201C\u79D1\u5B66\u7406\u8D22\uFF0C\u5E74\u76C8\u5229\u7387\u8FC7\u4E07\u201D\uFF0C\u5C0F\u58EE\u597D\u5947\u7684\u70B9\u5F00\u4E86\u8FD9\u4E2A\u94FE\u63A5\uFF0C\u7ED3\u679C\u53D1\u73B0\u81EA\u5DF1\u7684\u8D26\u6237\u5C11\u4E8610000\u5143\u3002\u8FD9\u662F\u8FD9\u4E48\u56DE\u4E8B\u5462\uFF1F\u539F\u6765\u9ED1\u5BA2\u5728\u94FE\u63A5\u4E2D\u85CF\u4E86\u4E00\u4E2A\u8BF7\u6C42\uFF0C\u8FD9\u4E2A\u8BF7\u6C42\u76F4\u63A5\u5229\u7528\u5C0F\u58EE\u7684\u8EAB\u4EFD\u7ED9\u94F6\u884C\u53D1\u9001\u4E86\u4E00\u4E2A\u8F6C\u8D26\u8BF7\u6C42,\u4E5F\u5C31\u662F\u901A\u8FC7\u4F60\u7684 Cookie \u5411\u94F6\u884C\u53D1\u51FA\u8BF7\u6C42\u3002</p><p>\u8FDB\u884CSession \u8BA4\u8BC1\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u4E00\u822C\u4F7F\u7528 Cookie \u6765\u5B58\u50A8 SessionId,\u5F53\u6211\u4EEC\u767B\u9646\u540E\u540E\u7AEF\u751F\u6210\u4E00\u4E2ASessionId\u653E\u5728Cookie\u4E2D\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u670D\u52A1\u7AEF\u901A\u8FC7Redis\u6216\u8005\u5176\u4ED6\u5B58\u50A8\u5DE5\u5177\u8BB0\u5F55\u4FDD\u5B58\u7740\u8FD9\u4E2ASessionid\uFF0C\u5BA2\u6237\u7AEF\u767B\u5F55\u4EE5\u540E\u6BCF\u6B21\u8BF7\u6C42\u90FD\u4F1A\u5E26\u4E0A\u8FD9\u4E2ASessionId\uFF0C\u670D\u52A1\u7AEF\u901A\u8FC7\u8FD9\u4E2ASessionId\u6765\u6807\u793A\u4F60\u8FD9\u4E2A\u4EBA\u3002\u5982\u679C\u522B\u4EBA\u901A\u8FC7 cookie\u62FF\u5230\u4E86 SessionId \u540E\u5C31\u53EF\u4EE5\u4EE3\u66FF\u4F60\u7684\u8EAB\u4EFD\u8BBF\u95EE\u7CFB\u7EDF\u4E86\u3002</p><p>Session \u8BA4\u8BC1\u4E2D Cookie \u4E2D\u7684 SessionId\u662F\u7531\u6D4F\u89C8\u5668\u53D1\u9001\u5230\u670D\u52A1\u7AEF\u7684\uFF0C\u501F\u52A9\u8FD9\u4E2A\u7279\u6027\uFF0C\u653B\u51FB\u8005\u5C31\u53EF\u4EE5\u901A\u8FC7\u8BA9\u7528\u6237\u8BEF\u70B9\u653B\u51FB\u94FE\u63A5\uFF0C\u8FBE\u5230\u653B\u51FB\u6548\u679C\u3002</p><p>\u4F46\u662F\uFF0C\u6211\u4EEC\u4F7F\u7528 token \u7684\u8BDD\u5C31\u4E0D\u4F1A\u5B58\u5728\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5728\u6211\u4EEC\u767B\u5F55\u6210\u529F\u83B7\u5F97 token \u4E4B\u540E\uFF0C\u4E00\u822C\u4F1A\u9009\u62E9\u5B58\u653E\u5728 local storage \u4E2D\u3002\u7136\u540E\u6211\u4EEC\u5728\u524D\u7AEF\u901A\u8FC7\u67D0\u4E9B\u65B9\u5F0F\u4F1A\u7ED9\u6BCF\u4E2A\u53D1\u5230\u540E\u7AEF\u7684\u8BF7\u6C42\u52A0\u4E0A\u8FD9\u4E2A token,\u8FD9\u6837\u5C31\u4E0D\u4F1A\u51FA\u73B0 CSRF \u6F0F\u6D1E\u7684\u95EE\u9898\u3002\u56E0\u4E3A\uFF0C\u5373\u4F7F\u6709\u4E2A\u4F60\u70B9\u51FB\u4E86\u975E\u6CD5\u94FE\u63A5\u53D1\u9001\u4E86\u8BF7\u6C42\u5230\u670D\u52A1\u7AEF\uFF0C\u8FD9\u4E2A\u975E\u6CD5\u8BF7\u6C42\u662F\u4E0D\u4F1A\u643A\u5E26 token \u7684\uFF0C\u6240\u4EE5\u8FD9\u4E2A\u8BF7\u6C42\u5C06\u662F\u975E\u6CD5\u7684\u3002</p><h2 id="\u4EC0\u4E48\u662F-token-\u4EC0\u4E48\u662F-jwt-\u5982\u4F55\u57FA\u4E8Etoken\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F-token-\u4EC0\u4E48\u662F-jwt-\u5982\u4F55\u57FA\u4E8Etoken\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1" aria-hidden="true">#</a> \u4EC0\u4E48\u662F Token?\u4EC0\u4E48\u662F JWT?\u5982\u4F55\u57FA\u4E8EToken\u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\uFF1F</h2><p>\u6211\u4EEC\u77E5\u9053 Session \u4FE1\u606F\u9700\u8981\u4FDD\u5B58\u4E00\u4EFD\u5728\u670D\u52A1\u5668\u7AEF\u3002\u8FD9\u79CD\u65B9\u5F0F\u4F1A\u5E26\u6765\u4E00\u4E9B\u9EBB\u70E6\uFF0C\u6BD4\u5982\u9700\u8981\u6211\u4EEC\u4FDD\u8BC1\u4FDD\u5B58 Session \u4FE1\u606F\u670D\u52A1\u5668\u7684\u53EF\u7528\u6027\u3001\u4E0D\u9002\u5408\u79FB\u52A8\u7AEF\uFF08\u4F9D\u8D56Cookie\uFF09\u7B49\u7B49\u3002</p><p>\u6709\u6CA1\u6709\u4E00\u79CD\u4E0D\u9700\u8981\u81EA\u5DF1\u5B58\u653E Session \u4FE1\u606F\u5C31\u80FD\u5B9E\u73B0\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u65B9\u5F0F\u5462\uFF1F\u4F7F\u7528 Token \u5373\u53EF\uFF01JWT \uFF08JSON Web Token\uFF09 \u5C31\u662F\u8FD9\u79CD\u65B9\u5F0F\u7684\u5B9E\u73B0\uFF0C\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u670D\u52A1\u5668\u7AEF\u5C31\u4E0D\u9700\u8981\u4FDD\u5B58 Session \u6570\u636E\u4E86\uFF0C\u53EA\u7528\u5728\u5BA2\u6237\u7AEF\u4FDD\u5B58\u670D\u52A1\u7AEF\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7684 Token \u5C31\u53EF\u4EE5\u4E86\uFF0C\u6269\u5C55\u6027\u5F97\u5230\u63D0\u5347\u3002</p><p>JWT \u672C\u8D28\u4E0A\u5C31\u4E00\u6BB5\u7B7E\u540D\u7684 JSON \u683C\u5F0F\u7684\u6570\u636E\u3002\u7531\u4E8E\u5B83\u662F\u5E26\u6709\u7B7E\u540D\u7684\uFF0C\u56E0\u6B64\u63A5\u6536\u8005\u4FBF\u53EF\u4EE5\u9A8C\u8BC1\u5B83\u7684\u771F\u5B9E\u6027\u3002</p><p>\u4E0B\u9762\u662F RFC 7519 \u5BF9 JWT \u505A\u7684\u8F83\u4E3A\u6B63\u5F0F\u7684\u5B9A\u4E49\u3002</p><blockquote><p>JSON Web Token (JWT) is a compact, URL-safe means of representing claims to be transferred between two parties. The claims in a JWT are encoded as a JSON object that is used as the payload of a JSON Web Signature (JWS) structure or as the plaintext of a JSON Web Encryption (JWE) structure, enabling the claims to be digitally signed or integrity protected with a Message Authentication Code (MAC) and/or encrypted. \u2014\u2014JSON Web Token (JWT)</p></blockquote><p>JWT \u7531 3 \u90E8\u5206\u6784\u6210:</p><p>Header :\u63CF\u8FF0 JWT \u7684\u5143\u6570\u636E\u3002\u5B9A\u4E49\u4E86\u751F\u6210\u7B7E\u540D\u7684\u7B97\u6CD5\u4EE5\u53CA Token \u7684\u7C7B\u578B\u3002</p><p>Payload\uFF08\u8D1F\u8F7D\uFF09:\u7528\u6765\u5B58\u653E\u5B9E\u9645\u9700\u8981\u4F20\u9012\u7684\u6570\u636E</p><p>Signature\uFF08\u7B7E\u540D\uFF09\uFF1A\u670D\u52A1\u5668\u901A\u8FC7Payload\u3001Header\u548C\u4E00\u4E2A\u5BC6\u94A5(secret)\u4F7F\u7528 Header \u91CC\u9762\u6307\u5B9A\u7684\u7B7E\u540D\u7B97\u6CD5\uFF08\u9ED8\u8BA4\u662F HMAC SHA256\uFF09\u751F\u6210\u3002</p><p>\u5728\u57FA\u4E8E Token \u8FDB\u884C\u8EAB\u4EFD\u9A8C\u8BC1\u7684\u7684\u5E94\u7528\u7A0B\u5E8F\u4E2D\uFF0C\u670D\u52A1\u5668\u901A\u8FC7Payload\u3001Header\u548C\u4E00\u4E2A\u5BC6\u94A5(secret)\u521B\u5EFA\u4EE4\u724C\uFF08Token\uFF09\u5E76\u5C06 Token \u53D1\u9001\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u5BA2\u6237\u7AEF\u5C06 Token \u4FDD\u5B58\u5728 Cookie \u6216\u8005 localStorage \u91CC\u9762\uFF0C\u4EE5\u540E\u5BA2\u6237\u7AEF\u53D1\u51FA\u7684\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u643A\u5E26\u8FD9\u4E2A\u4EE4\u724C\u3002\u4F60\u53EF\u4EE5\u628A\u5B83\u653E\u5728 Cookie \u91CC\u9762\u81EA\u52A8\u53D1\u9001\uFF0C\u4F46\u662F\u8FD9\u6837\u4E0D\u80FD\u8DE8\u57DF\uFF0C\u6240\u4EE5\u66F4\u597D\u7684\u505A\u6CD5\u662F\u653E\u5728 HTTP Header \u7684 Authorization\u5B57\u6BB5\u4E2D\uFF1AAuthorization: Bearer Token\u3002</p><blockquote><p>\u7528\u6237\u5411\u670D\u52A1\u5668\u53D1\u9001\u7528\u6237\u540D\u548C\u5BC6\u7801\u7528\u4E8E\u767B\u9646\u7CFB\u7EDF\u3002</p><p>\u8EAB\u4EFD\u9A8C\u8BC1\u670D\u52A1\u54CD\u5E94\u5E76\u8FD4\u56DE\u4E86\u7B7E\u540D\u7684 JWT\uFF0C\u4E0A\u9762\u5305\u542B\u4E86\u7528\u6237\u662F\u8C01\u7684\u5185\u5BB9\u3002</p><p>\u7528\u6237\u4EE5\u540E\u6BCF\u6B21\u5411\u540E\u7AEF\u53D1\u8BF7\u6C42\u90FD\u5728Header\u4E2D\u5E26\u4E0A JWT\u3002</p><p>\u670D\u52A1\u7AEF\u68C0\u67E5 JWT \u5E76\u4ECE\u4E2D\u83B7\u53D6\u7528\u6237\u76F8\u5173\u4FE1\u606F\u3002</p></blockquote><h2 id="\u5206\u5E03\u5F0F\u67B6\u6784\u4E0B-session-\u5171\u4EAB\u6709\u4EC0\u4E48\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u67B6\u6784\u4E0B-session-\u5171\u4EAB\u6709\u4EC0\u4E48\u65B9\u6848" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u67B6\u6784\u4E0B\uFF0CSession \u5171\u4EAB\u6709\u4EC0\u4E48\u65B9\u6848?</h2><ol><li>\u4E0D\u8981\u6709session\uFF1A\u4F46\u662F\u786E\u5B9E\u5728\u67D0\u4E9B\u573A\u666F\u4E0B\uFF0C\u662F\u53EF\u4EE5\u6CA1\u6709session\u7684\uFF0C\u5176\u5B9E\u5728\u5F88\u591A\u63A5\u53E3\u7C7B\u7CFB\u7EDF\u5F53\u4E2D\uFF0C\u90FD\u63D0\u5021\u3010API\u65E0\u72B6\u6001\u670D\u52A1\u3011\uFF1B\u4E5F\u5C31\u662F\u6BCF\u4E00\u6B21\u7684\u63A5\u53E3\u8BBF\u95EE\uFF0C\u90FD\u4E0D\u4F9D\u8D56\u4E8Esession\u3001\u4E0D\u4F9D\u8D56\u4E8E\u524D\u4E00\u6B21\u7684\u63A5\u53E3\u8BBF\u95EE\uFF1B</li><li>\u5B58\u5165cookie\u4E2D\uFF1A\u5C06session\u5B58\u50A8\u5230cookie\u4E2D\uFF0C\u4F46\u662F\u7F3A\u70B9\u4E5F\u5F88\u660E\u663E\uFF0C\u4F8B\u5982\u6BCF\u6B21\u8BF7\u6C42\u90FD\u5F97\u5E26\u7740session\uFF0C\u6570\u636E\u5B58\u50A8\u5728\u5BA2\u6237\u7AEF\u672C\u5730\uFF0C\u662F\u6709\u98CE\u9669\u7684\uFF1B</li><li>session\u540C\u6B65\uFF1A\u5BF9\u4E2A\u670D\u52A1\u5668\u4E4B\u95F4\u540C\u6B65session\uFF0C\u8FD9\u6837\u53EF\u4EE5\u4FDD\u8BC1\u6BCF\u4E2A\u670D\u52A1\u5668\u4E0A\u90FD\u6709\u5168\u90E8\u7684session\u4FE1\u606F\uFF0C\u4E0D\u8FC7\u5F53\u670D\u52A1\u5668\u6570\u91CF\u6BD4\u8F83\u591A\u7684\u65F6\u5019\uFF0C\u540C\u6B65\u662F\u4F1A\u6709\u5EF6\u8FDF\u751A\u81F3\u540C\u6B65\u5931\u8D25\uFF1B</li><li>\u4F7F\u7528Nginx\uFF08\u6216\u5176\u4ED6\u590D\u6742\u5747\u8861\u8F6F\u786C\u4EF6\uFF09\u4E2D\u7684ip\u7ED1\u5B9A\u7B56\u7565\uFF0C\u540C\u4E00\u4E2Aip\u53EA\u80FD\u5728\u6307\u5B9A\u7684\u540C\u4E00\u4E2A\u673A\u5668\u8BBF\u95EE\uFF0C\u4F46\u662F\u8FD9\u6837\u505A\u98CE\u9669\u4E5F\u6BD4\u8F83\u5927\uFF0C\u800C\u4E14\u4E5F\u662F\u53BB\u4E86\u8D1F\u8F7D\u5747\u8861\u7684\u610F\u4E49\uFF1B</li><li></li></ol><p>\u6211\u4EEC\u73B0\u5728\u7684\u7CFB\u7EDF\u4F1A\u628Asession\u653E\u5230Redis\u4E2D\u5B58\u50A8\uFF0C\u867D\u7136\u67B6\u6784\u4E0A\u53D8\u5F97\u590D\u6742\uFF0C\u5E76\u4E14\u9700\u8981\u591A\u8BBF\u95EE\u4E00\u6B21Redis\uFF0C\u4F46\u662F\u8FD9\u79CD\u65B9\u6848\u5E26\u6765\u7684\u597D\u5904\u4E5F\u662F\u5F88\u5927\u7684\uFF1A\u5B9E\u73B0session\u5171\u4EAB\uFF0C\u53EF\u4EE5\u6C34\u5E73\u6269\u5C55\uFF08\u589E\u52A0Redis\u670D\u52A1\u5668\uFF09\uFF0C\u670D\u52A1\u5668\u91CD\u542Fsession\u4E0D\u4E22\u5931\uFF08\u4E0D\u8FC7\u4E5F\u8981\u6CE8\u610Fsession\u5728Redis\u4E2D\u7684\u5237\u65B0/\u5931\u6548\u673A\u5236\uFF09\uFF0C\u4E0D\u4EC5\u53EF\u4EE5\u8DE8\u670D\u52A1\u5668session\u5171\u4EAB\uFF0C\u751A\u81F3\u53EF\u4EE5\u8DE8\u5E73\u53F0\uFF08\u4F8B\u5982\u7F51\u9875\u7AEF\u548CAPP\u7AEF\uFF09\u3002</p><h2 id="springcloud\u6838\u5FC3\u7EC4\u4EF6\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#springcloud\u6838\u5FC3\u7EC4\u4EF6\u6709\u54EA\u4E9B" aria-hidden="true">#</a> springcloud\u6838\u5FC3\u7EC4\u4EF6\u6709\u54EA\u4E9B\uFF1F</h2><ol><li>\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5957\u4EF6\u7248\u672C\uFF1ASpring Cloud + Alibaba / Netflix</li><li><strong>\u670D\u52A1\u6CE8\u518C\u4E0E\u53D1\u73B0</strong>\uFF1AEureka / Consul / Nacos / Zookeeper</li><li><strong>\u914D\u7F6E\u4E2D\u5FC3</strong>\uFF1AConfig / Nacos</li><li><strong>\u7F51\u5173\u8DEF\u7531</strong>\uFF1AGateway / Netflix Zull (\u52A8\u6001\u7F51\u5173)</li><li><strong>\u670D\u52A1\u8C03\u7528</strong>\uFF1ANetflix Feign / OpenFeign\uFF08\u63A8\u8350\uFF09 / RestTemplate\uFF08\u4F7F\u7528\u7E41\u7410\u3001\u5197\u4F59\uFF0C\u4E0D\u63A8\u8350\uFF09</li><li><strong>\u8D1F\u8F7D\u5747\u8861</strong>\uFF1ASpringCloud LoadBalancer / Ribbon / Nginx</li><li><strong>\u670D\u52A1\u7194\u65AD\u5668</strong>\uFF1ASentinel / Hystrix (\u9650\u6D41\u3001\u7194\u65AD\u964D\u7EA7\u3001\u8D1F\u8F7D\u4FDD\u62A4) / Resilience4J</li><li><strong>\u5206\u5E03\u5F0F\u4E8B\u52A1</strong>\uFF1ASeata / TX-LCN (\u53EF\u9009\u7EC4\u4EF6)</li><li><strong>\u94FE\u8DEF\u8FFD\u8E2A</strong>\uFF1ASleuth + Zipkin / Skywalking / Pinpoint (\u53EF\u9009\u7EC4\u4EF6)</li><li><strong>\u76D1\u63A7\u4E2D\u5FC3</strong>\uFF1ASpringBoot Admin</li><li>\u5DE5\u4F5C\u6D41\u5F15\u64CE\u6846\u67B6\uFF1AFlowable (\u53EF\u9009\u7EC4\u4EF6)</li><li>\u5206\u5E03\u5F0F\u5B9A\u65F6\u4EFB\u52A1\uFF1Axxl-job (\u53EF\u9009\u7EC4\u4EF6)</li></ol><h2 id="\u5FAE\u670D\u52A1\u67B6\u6784\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u5FAE\u670D\u52A1\u67B6\u6784\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u5FAE\u670D\u52A1\u67B6\u6784\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u4E3B\u8981\u662F\u9762\u5411SOA\u7406\u5FF5\uFF0C\u66F4\u7EC6\u5C0F\u7C92\u5EA6\u670D\u52A1\u7684\u62C6\u5206\uFF0C\u5C06\u529F\u80FD\u5206\u89E3\u5230\u5404\u4E2A\u670D\u52A1\u5F53\u4E2D\uFF0C\u4ECE\u800C\u964D\u4F4E\u7CFB\u7EDF\u7684\u8026\u5408\u6027\uFF0C\u5E76\u63D0\u4F9B\u66F4\u52A0\u7075\u6D3B\u7684\u670D\u52A1\u652F\u6301\u3002</p><h2 id="\u6CE8\u518C\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u518C\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u6CE8\u518C\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u670D\u52A1\u542F\u52A8\u540E\u5411Eureka\u6CE8\u518C\uFF0CEureka Server\u4F1A\u5C06\u6CE8\u518C\u4FE1\u606F\u5411\u5176\u4ED6Eureka Server\u8FDB\u884C\u540C\u6B65\uFF0C\u5F53\u670D\u52A1\u6D88\u8D39\u8005\u8981\u8C03\u7528\u670D\u52A1\u63D0\u4F9B\u8005\uFF0C\u5219\u5411\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u83B7\u53D6\u670D\u52A1\u63D0\u4F9B\u8005\u5730\u5740\uFF0C\u7136\u540E\u4F1A\u5C06\u670D\u52A1\u63D0\u4F9B\u8005\u5730\u5740\u7F13\u5B58\u5728\u672C\u5730\uFF0C\u4E0B\u6B21\u518D\u8C03\u7528\u65F6\uFF0C\u5219\u76F4\u63A5\u4ECE\u672C\u5730\u7F13\u5B58\u4E2D\u53D6\uFF0C\u5B8C\u6210\u4E00\u6B21\u8C03\u7528</p><h2 id="\u914D\u7F6E\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u914D\u7F6E\u4E2D\u5FC3\u7684\u539F\u7406\u662F\u4EC0\u4E48\uFF1F</h2><p>\u5728\u670D\u52A1\u8FD0\u884C\u4E4B\u524D\uFF0C\u5C06\u6240\u9700\u7684\u914D\u7F6E\u4FE1\u606F\u4ECE\u914D\u7F6E\u4ED3\u5E93\u62C9\u53D6\u5230\u672C\u5730\u670D\u52A1\uFF0C\u8FBE\u5230\u7EDF\u4E00\u5316\u914D\u7F6E\u7BA1\u7406\u7684\u76EE\u7684</p><h2 id="\u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u5B9E\u73B0\u81EA\u52A8\u5237\u65B0\u7684" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u5B9E\u73B0\u81EA\u52A8\u5237\u65B0\u7684" aria-hidden="true">#</a> \u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u5B9E\u73B0\u81EA\u52A8\u5237\u65B0\u7684\uFF1F</h2><ol><li><p>\u914D\u7F6E\u4E2D\u5FC3Server\u7AEF\u627F\u62C5\u8D77\u914D\u7F6E\u5237\u65B0\u7684\u804C\u8D23</p></li><li><p>\u63D0\u4EA4\u914D\u7F6E\u89E6\u53D1post\u8BF7\u6C42\u7ED9server\u7AEF\u7684bus/refresh\u63A5\u53E3</p></li><li><p>server\u7AEF\u63A5\u6536\u5230\u8BF7\u6C42\u5E76\u53D1\u9001\u7ED9Spring Cloud Bus\u603B\u7EBF</p></li><li><p>Spring Cloud bus\u63A5\u5230\u6D88\u606F\u5E76\u901A\u77E5\u7ED9\u5176\u5B83\u8FDE\u63A5\u5230\u603B\u7EBF\u7684\u5BA2\u6237\u7AEF</p></li><li><p>\u5176\u5B83\u5BA2\u6237\u7AEF\u63A5\u6536\u5230\u901A\u77E5\uFF0C\u8BF7\u6C42Server\u7AEF\u83B7\u53D6\u6700\u65B0\u914D\u7F6E</p></li><li><p>\u5168\u90E8\u5BA2\u6237\u7AEF\u5747\u83B7\u53D6\u5230\u6700\u65B0\u7684\u914D\u7F6E</p></li></ol><h2 id="\u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u5B89\u5168\u7684" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u5B89\u5168\u7684" aria-hidden="true">#</a> \u914D\u7F6E\u4E2D\u5FC3\u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u5B89\u5168\u7684?</h2><p>1.\u4FDD\u8BC1\u5BB9\u5668\u6587\u4EF6\u8BBF\u95EE\u7684\u5B89\u5168\u6027\uFF0C\u5373\u4FDD\u8BC1\u6240\u6709\u7684\u7F51\u7EDC\u8D44\u6E90\u8BF7\u6C42\u90FD\u9700\u8981\u767B\u5F55</p><p>2.\u5C06\u914D\u7F6E\u4E2D\u5FC3\u91CC\u6240\u6709\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u5BC6\u7801\u8FDB\u884C\u52A0\u5BC6\uFF0C\u4FDD\u8BC1\u5176\u5BC6\u6587\u6027</p><p>3.\u5F00\u53D1\u73AF\u5883\u7981\u6B62\u62C9\u53D6\u751F\u4EA7\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6</p><h2 id="\u7528zookeeper\u548Ceureka\u505A\u6CE8\u518C\u4E2D\u5FC3\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#\u7528zookeeper\u548Ceureka\u505A\u6CE8\u518C\u4E2D\u5FC3\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> \u7528zookeeper\u548Ceureka\u505A\u6CE8\u518C\u4E2D\u5FC3\u6709\u4EC0\u4E48\u533A\u522B?</h2><p>Zookeeper\u4FDD\u8BC1\u7684\u662FCP\uFF08\u4E00\u81F4\u6027\uFF0C\u5BB9\u9519\u6027\uFF09, \u800CEureka\u5219\u662FAP\uFF08\u53EF\u7528\u6027\uFF0C\u5BB9\u9519\u6027\uFF09\u3002</p><h2 id="spring-cloud\u548Cdubbo\u6709\u54EA\u4E9B\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#spring-cloud\u548Cdubbo\u6709\u54EA\u4E9B\u533A\u522B" aria-hidden="true">#</a> Spring Cloud\u548CDubbo\u6709\u54EA\u4E9B\u533A\u522B?</h2><ol><li>dubbo \u662F\u4E8C\u8FDB\u5236\u4F20\u8F93\uFF0C\u5BF9\u8C61\u76F4\u63A5\u8F6C\u6210\u4E8C\u8FDB\u5236\uFF0C\u4F7F\u7528RPC\u901A\u4FE1\u3002</li></ol><p>SpringCloud\u662Fhttp \u4F20\u8F93\uFF0C\u540C\u65F6\u4F7F\u7528http\u534F\u8BAE\u4E00\u822C\u4F1A\u4F7F\u7528JSON\u62A5\u6587\uFF0Cjson\u518D\u8F6C\u4E8C\u8FDB\u5236\uFF0C\u6D88\u8017\u4F1A\u66F4\u5927\u3002</p><ol start="2"><li>Dubbo\u53EA\u662F\u5B9E\u73B0\u4E86\u670D\u52A1\u6CBB\u7406\uFF0C\u800CSpring Cloud\u4E0B\u9762\u6709\u51E0\u5341\u4E2A\u5B50\u9879\u76EE\u5206\u522B\u8986\u76D6\u4E86\u5FAE\u670D\u52A1\u67B6\u6784\u4E0B\u7684\u65B9\u65B9\u9762\u9762\uFF0C\u670D\u52A1\u6CBB\u7406\u53EA\u662F\u5176\u4E2D\u7684\u4E00\u4E2A\u65B9\u9762\uFF0C\u4E00\u5B9A\u7A0B\u5EA6\u6765\u8BF4\uFF0CDubbo\u53EA\u662FSpring Cloud Netflix\u4E2D\u7684\u4E00\u4E2A\u5B50\u96C6\u3002</li></ol><h2 id="ribbon\u8D1F\u8F7D\u5747\u8861\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#ribbon\u8D1F\u8F7D\u5747\u8861\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Ribbon\u8D1F\u8F7D\u5747\u8861\u539F\u7406\u662F\u4EC0\u4E48?</h2><ol><li><p>Ribbon\u901A\u8FC7ILoadBalancer\u63A5\u53E3\u5BF9\u5916\u63D0\u4F9B\u7EDF\u4E00\u7684\u9009\u62E9\u670D\u52A1\u5668(Server)\u7684\u529F\u80FD\uFF0C\u6B64\u63A5\u53E3\u4F1A\u6839\u636E\u4E0D\u540C\u7684\u8D1F\u8F7D\u5747\u8861\u7B56\u7565(IRule)\u9009\u62E9\u5408\u9002\u7684Server\u8FD4\u56DE\u7ED9\u4F7F\u7528\u8005\u3002</p></li><li><p>IRule\u662F\u8D1F\u8F7D\u5747\u8861\u7B56\u7565\u7684\u62BD\u8C61\uFF0CILoadBalancer\u901A\u8FC7\u8C03\u7528IRule\u7684choose()\u65B9\u6CD5\u8FD4\u56DEServer</p></li><li><p>IPing\u7528\u6765\u68C0\u6D4BServer\u662F\u5426\u53EF\u7528\uFF0CILoadBalancer\u7684\u5B9E\u73B0\u7C7B\u7EF4\u62A4\u4E00\u4E2ATimer\u6BCF\u969410s\u68C0\u6D4B\u4E00\u6B21Server\u7684\u53EF\u7528\u72B6\u6001</p></li><li><p>IClientConfig\u4E3B\u8981\u5B9A\u4E49\u4E86\u7528\u4E8E\u521D\u59CB\u5316\u5404\u79CD\u5BA2\u6237\u7AEF\u548C\u8D1F\u8F7D\u5747\u8861\u5668\u7684\u914D\u7F6E\u4FE1\u606F\uFF0C\u5668\u5B9E\u73B0\u7C7B\u4E3ADefaultClientConfigImpl</p></li></ol><h2 id="\u5FAE\u670D\u52A1\u7194\u65AD\u964D\u7EA7\u673A\u5236\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u5FAE\u670D\u52A1\u7194\u65AD\u964D\u7EA7\u673A\u5236\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u5FAE\u670D\u52A1\u7194\u65AD\u964D\u7EA7\u673A\u5236\u662F\u4EC0\u4E48?</h2><p>\u5FAE\u670D\u52A1\u6846\u67B6\u662F\u8BB8\u591A\u670D\u52A1\u4E92\u76F8\u8C03\u7528\u7684\uFF0C\u8981\u662F\u4E0D\u505A\u4EFB\u4F55\u4FDD\u62A4\u7684\u8BDD\uFF0C\u67D0\u4E00\u4E2A\u670D\u52A1\u6302\u4E86\uFF0C\u5C31\u4F1A\u5F15\u8D77\u8FDE\u9501\u53CD\u5E94\uFF0C\u5BFC\u81F4\u522B\u7684\u670D\u52A1\u4E5F\u6302\u3002Hystrix \u662F\u9694\u79BB\u3001\u7194\u65AD\u4EE5\u53CA\u964D\u7EA7\u7684\u4E00\u4E2A\u6846\u67B6\u3002\u5982\u679C\u8C03\u7528\u67D0\u670D\u52A1\u62A5\u9519\uFF08\u6216\u8005\u6302\u4E86\uFF09\uFF0C\u5C31\u5BF9\u8BE5\u670D\u52A1\u7194\u65AD\uFF0C\u5728 5 \u5206\u949F\u5185\u8BF7\u6C42\u6B64\u670D\u52A1\u76F4\u63A5\u5C31\u8FD4\u56DE\u4E00\u4E2A\u9ED8\u8BA4\u503C\uFF0C\u4E0D\u9700\u8981\u6BCF\u6B21\u90FD\u5361\u51E0\u79D2\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\uFF0C\u5C31\u662F\u6240\u8C13\u7684\u7194\u65AD\u3002\u4F46\u662F\u7194\u65AD\u4E86\u4E4B\u540E\u5C31\u4F1A\u5C11\u8C03\u7528\u4E00\u4E2A\u670D\u52A1\uFF0C\u6B64\u65F6\u9700\u8981\u505A\u4E0B\u6807\u8BB0\uFF0C\u6807\u8BB0\u672C\u6765\u9700\u8981\u505A\u4EC0\u4E48\u4E1A\u52A1\uFF0C\u4F46\u662F\u56E0\u4E3A\u670D\u52A1\u6302\u4E86\uFF0C\u6682\u65F6\u6CA1\u6709\u505A\uFF0C\u7B49\u8BE5\u670D\u52A1\u6062\u590D\u4E86\uFF0C\u5C31\u53EF\u4EE5\u624B\u5DE5\u5904\u7406\u8FD9\u4E9B\u4E1A\u52A1\u3002\u8FD9\u4E2A\u8FC7\u7A0B\uFF0C\u5C31\u662F\u6240\u8C13\u7684\u964D\u7EA7\u3002</p><h2 id="\u4EC0\u4E48\u662Fhystrix-\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fhystrix-\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u4EC0\u4E48\u662FHystrix\uFF1F\u5B9E\u73B0\u539F\u7406\u662F\u4EC0\u4E48?</h2><p>Hystrix\u662F\u4E00\u4E2A\u5EF6\u8FDF\u548C\u5BB9\u9519\u5E93\uFF0C\u65E8\u5728\u9694\u79BB\u5BF9\u8FDC\u7A0B\u7CFB\u7EDF\u3001\u670D\u52A1\u548C\u7B2C\u4E09\u65B9\u5E93\u7684\u8BBF\u95EE\u70B9\uFF0C\u505C\u6B62\u7EA7\u8054\u6545\u969C\uFF0C\u5E76\u5728 \u4E0D\u53EF\u907F\u514D\u53D1\u751F\u6545\u969C\u7684\u590D\u6742\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u5B9E\u73B0\u5FEB\u901F\u6062\u590D\u3002\u4E3B\u8981\u9760Spring\u7684AOP\u5B9E\u73B0</p><p>\u5B9E\u73B0\u539F\u7406</p><p>\u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u65AD\u8DEF\u5668\u5173\u95ED\uFF0C\u670D\u52A1\u6D88\u8D39\u8005\u6B63\u5E38\u8BF7\u6C42\u5FAE\u670D\u52A1</p><p>\u4E00\u6BB5\u4E8B\u4EF6\u5185\uFF0C\u5931\u8D25\u7387\u8FBE\u5230\u4E00\u5B9A\u9608\u503C\uFF0C\u65AD\u8DEF\u5668\u5C06\u65AD\u5F00\uFF0C\u6B64\u65F6\u4E0D\u518D\u8BF7\u6C42\u670D\u52A1\u63D0\u4F9B\u8005\uFF0C\u800C\u662F\u53EA\u662F\u5FEB\u901F\u5931\u8D25\u7684\u65B9\u6CD5\uFF08\u65AD\u8DEF\u65B9\u6CD5\uFF09</p><p>\u65AD\u8DEF\u5668\u6253\u5F00\u4E00\u6BB5\u65F6\u95F4\uFF0C\u81EA\u52A8\u8FDB\u5165\u201C\u534A\u5F00\u201D\u72B6\u6001\uFF0C\u6B64\u65F6\uFF0C\u65AD\u8DEF\u5668\u53EF\u5141\u8BB8\u4E00\u4E2A\u8BF7\u6C42\u65B9\u6CD5\u670D\u52A1\u63D0\u4F9B\u8005\uFF0C\u5982\u679C\u8BF7\u6C42\u8C03\u7528\u6210\u529F\uFF0C\u5219\u5173\u95ED\u65AD\u8DEF\u5668\uFF0C\u5426\u5219\u7EE7\u7EED\u4FDD\u6301\u65AD\u8DEF\u5668\u6253\u5F00\u72B6\u6001\u3002</p><p>\u65AD\u8DEF\u5668hystrix\u662F\u4FDD\u8BC1\u4E86\u5C40\u90E8\u53D1\u751F\u7684\u9519\u8BEF\uFF0C\u4E0D\u4F1A\u6269\u5C55\u5230\u6574\u4E2A\u7CFB\u7EDF\uFF0C\u4ECE\u800C\u4FDD\u8BC1\u7CFB\u7EDF\u7684\u5373\u4F7F\u51FA\u73B0\u5C40\u90E8\u95EE\u9898\u4E5F\u4E0D\u4F1A\u9020\u6210\u7CFB\u7EDF\u96EA\u5D29</p><h2 id="\u6CE8\u518C\u4E2D\u5FC3\u6302\u4E86-\u6216\u8005\u670D\u52A1\u6302\u4E86-\u5E94\u8BE5\u5982\u4F55\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u518C\u4E2D\u5FC3\u6302\u4E86-\u6216\u8005\u670D\u52A1\u6302\u4E86-\u5E94\u8BE5\u5982\u4F55\u5904\u7406" aria-hidden="true">#</a> \u6CE8\u518C\u4E2D\u5FC3\u6302\u4E86\uFF0C\u6216\u8005\u670D\u52A1\u6302\u4E86\uFF0C\u5E94\u8BE5\u5982\u4F55\u5904\u7406?</h2><p>\u6CE8\u518C\u4E2D\u5FC3\u6302\u4E86\uFF0C\u53EF\u4EE5\u8BFB\u53D6\u672C\u5730\u6301\u4E45\u5316\u91CC\u7684\u914D\u7F6E</p><p>\u670D\u52A1\u6302\u4E86 \u5E94\u8BE5\u914D\u6709\u670D\u52A1\u76D1\u63A7\u4E2D\u5FC3 \u611F\u77E5\u5230\u670D\u52A1\u4E0B\u7EBF\u540E\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\u7684\u90AE\u4EF6\u901A\u77E5\u76F8\u5173\u4EBA\u5458\u6392\u67E5\u95EE\u9898\u3002</p><h2 id="\u8BF4\u8BF4\u4F60\u5BF9rpc\u3001rmi\u5982\u4F55\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u8BF4\u8BF4\u4F60\u5BF9rpc\u3001rmi\u5982\u4F55\u7406\u89E3" aria-hidden="true">#</a> \u8BF4\u8BF4\u4F60\u5BF9RPC\u3001RMI\u5982\u4F55\u7406\u89E3?</h2><p>RPC \u8FDC\u7A0B\u8FC7\u7A0B\u8C03\u7528\u534F\u8BAE\uFF0C\u901A\u8FC7\u7F51\u7EDC\u4ECE\u8FDC\u7A0B\u8BA1\u7B97\u673A\u4E0A\u8BF7\u6C42\u8C03\u7528\u67D0\u79CD\u670D\u52A1\u3002</p><p>RMI:\u8FDC\u7A0B\u65B9\u6CD5\u8C03\u7528 \u80FD\u591F\u8BA9\u5728\u5BA2\u6237\u7AEFJava\u865A\u62DF\u673A\u4E0A\u7684\u5BF9\u8C61\u50CF\u8C03\u7528\u672C\u5730\u5BF9\u8C61\u4E00\u6837\u8C03\u7528\u670D\u52A1\u7AEFjava \u865A\u62DF\u673A\u4E2D\u7684\u5BF9\u8C61\u4E0A\u7684\u65B9\u6CD5\u3002</p><h2 id="redis\u6301\u4E45\u5316\u673A\u5236-rdb\u548Caof" tabindex="-1"><a class="header-anchor" href="#redis\u6301\u4E45\u5316\u673A\u5236-rdb\u548Caof" aria-hidden="true">#</a> redis\u6301\u4E45\u5316\u673A\u5236\uFF1ARDB\u548CAOF</h2><h3 id="redis-\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#redis-\u6301\u4E45\u5316" aria-hidden="true">#</a> Redis \u6301\u4E45\u5316</h3><p>Redis \u63D0\u4F9B\u4E86\u4E0D\u540C\u7EA7\u522B\u7684\u6301\u4E45\u5316\u65B9\u5F0F:</p><ul><li><p>RDB\u6301\u4E45\u5316\u65B9\u5F0F\u80FD\u591F\u5728\u6307\u5B9A\u7684\u65F6\u95F4\u95F4\u9694\u80FD\u5BF9\u4F60\u7684\u6570\u636E\u8FDB\u884C\u5FEB\u7167\u5B58\u50A8.</p></li><li><p>AOF\u6301\u4E45\u5316\u65B9\u5F0F\u8BB0\u5F55\u6BCF\u6B21\u5BF9\u670D\u52A1\u5668\u5199\u7684\u64CD\u4F5C,\u5F53\u670D\u52A1\u5668\u91CD\u542F\u7684\u65F6\u5019\u4F1A\u91CD\u65B0\u6267\u884C\u8FD9\u4E9B\u547D\u4EE4\u6765\u6062\u590D\u539F\u59CB\u7684\u6570\u636E,AOF\u547D\u4EE4\u4EE5redis\u534F\u8BAE\u8FFD\u52A0\u4FDD\u5B58\u6BCF\u6B21\u5199\u7684\u64CD\u4F5C\u5230\u6587\u4EF6\u672B\u5C3E.Redis\u8FD8\u80FD\u5BF9AOF\u6587\u4EF6\u8FDB\u884C\u540E\u53F0\u91CD\u5199,\u4F7F\u5F97AOF\u6587\u4EF6\u7684\u4F53\u79EF\u4E0D\u81F3\u4E8E\u8FC7\u5927.</p></li><li><p>\u5982\u679C\u4F60\u53EA\u5E0C\u671B\u4F60\u7684\u6570\u636E\u5728\u670D\u52A1\u5668\u8FD0\u884C\u7684\u65F6\u5019\u5B58\u5728,\u4F60\u4E5F\u53EF\u4EE5\u4E0D\u4F7F\u7528\u4EFB\u4F55\u6301\u4E45\u5316\u65B9\u5F0F.</p></li><li><p>\u4F60\u4E5F\u53EF\u4EE5\u540C\u65F6\u5F00\u542F\u4E24\u79CD\u6301\u4E45\u5316\u65B9\u5F0F, \u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B, \u5F53redis\u91CD\u542F\u7684\u65F6\u5019\u4F1A\u4F18\u5148\u8F7D\u5165AOF\u6587\u4EF6\u6765\u6062\u590D\u539F\u59CB\u7684\u6570\u636E,\u56E0\u4E3A\u5728\u901A\u5E38\u60C5\u51B5\u4E0BAOF\u6587\u4EF6\u4FDD\u5B58\u7684\u6570\u636E\u96C6\u8981\u6BD4RDB\u6587\u4EF6\u4FDD\u5B58\u7684\u6570\u636E\u96C6\u8981\u5B8C\u6574.</p></li><li><p>\u6700\u91CD\u8981\u7684\u4E8B\u60C5\u662F\u4E86\u89E3RDB\u548CAOF\u6301\u4E45\u5316\u65B9\u5F0F\u7684\u4E0D\u540C,\u8BA9\u6211\u4EEC\u4EE5RDB\u6301\u4E45\u5316\u65B9\u5F0F\u5F00\u59CB:</p></li></ul><h3 id="rdb\u7684\u4F18\u70B9" tabindex="-1"><a class="header-anchor" href="#rdb\u7684\u4F18\u70B9" aria-hidden="true">#</a> RDB\u7684\u4F18\u70B9</h3><ul><li><p>RDB\u662F\u4E00\u4E2A\u975E\u5E38\u7D27\u51D1\u7684\u6587\u4EF6,\u5B83\u4FDD\u5B58\u4E86\u67D0\u4E2A\u65F6\u95F4\u70B9\u5F97\u6570\u636E\u96C6,\u975E\u5E38\u9002\u7528\u4E8E\u6570\u636E\u96C6\u7684\u5907\u4EFD,\u6BD4\u5982\u4F60\u53EF\u4EE5\u5728\u6BCF\u4E2A\u5C0F\u65F6\u62A5\u4FDD\u5B58\u4E00\u4E0B\u8FC7\u53BB24\u5C0F\u65F6\u5185\u7684\u6570\u636E,\u540C\u65F6\u6BCF\u5929\u4FDD\u5B58\u8FC7\u53BB30\u5929\u7684\u6570\u636E,\u8FD9\u6837\u5373\u4F7F\u51FA\u4E86\u95EE\u9898\u4F60\u4E5F\u53EF\u4EE5\u6839\u636E\u9700\u6C42\u6062\u590D\u5230\u4E0D\u540C\u7248\u672C\u7684\u6570\u636E\u96C6.</p></li><li><p>RDB\u662F\u4E00\u4E2A\u7D27\u51D1\u7684\u5355\u4E00\u6587\u4EF6,\u5F88\u65B9\u4FBF\u4F20\u9001\u5230\u53E6\u4E00\u4E2A\u8FDC\u7AEF\u6570\u636E\u4E2D\u5FC3\u6216\u8005\u4E9A\u9A6C\u900A\u7684S3\uFF08\u53EF\u80FD\u52A0\u5BC6\uFF09\uFF0C\u975E\u5E38\u9002\u7528\u4E8E\u707E\u96BE\u6062\u590D.</p></li><li><p>RDB\u5728\u4FDD\u5B58RDB\u6587\u4EF6\u65F6\u7236\u8FDB\u7A0B\u552F\u4E00\u9700\u8981\u505A\u7684\u5C31\u662Ffork\u51FA\u4E00\u4E2A\u5B50\u8FDB\u7A0B,\u63A5\u4E0B\u6765\u7684\u5DE5\u4F5C\u5168\u90E8\u7531\u5B50\u8FDB\u7A0B\u6765\u505A\uFF0C\u7236\u8FDB\u7A0B\u4E0D\u9700\u8981\u518D\u505A\u5176\u4ED6IO\u64CD\u4F5C\uFF0C\u6240\u4EE5RDB\u6301\u4E45\u5316\u65B9\u5F0F\u53EF\u4EE5\u6700\u5927\u5316redis\u7684\u6027\u80FD.</p></li><li><p>\u4E0EAOF\u76F8\u6BD4,\u5728\u6062\u590D\u5927\u7684\u6570\u636E\u96C6\u7684\u65F6\u5019\uFF0CRDB\u65B9\u5F0F\u4F1A\u66F4\u5FEB\u4E00\u4E9B.</p></li></ul><h3 id="rdb\u7684\u7F3A\u70B9" tabindex="-1"><a class="header-anchor" href="#rdb\u7684\u7F3A\u70B9" aria-hidden="true">#</a> RDB\u7684\u7F3A\u70B9</h3><ul><li><p>\u5982\u679C\u4F60\u5E0C\u671B\u5728redis\u610F\u5916\u505C\u6B62\u5DE5\u4F5C\uFF08\u4F8B\u5982\u7535\u6E90\u4E2D\u65AD\uFF09\u7684\u60C5\u51B5\u4E0B\u4E22\u5931\u7684\u6570\u636E\u6700\u5C11\u7684\u8BDD\uFF0C\u90A3\u4E48RDB\u4E0D\u9002\u5408\u4F60.\u867D\u7136\u4F60\u53EF\u4EE5\u914D\u7F6E\u4E0D\u540C\u7684save\u65F6\u95F4\u70B9(\u4F8B\u5982\u6BCF\u96945\u5206\u949F\u5E76\u4E14\u5BF9\u6570\u636E\u96C6\u6709100\u4E2A\u5199\u7684\u64CD\u4F5C) ,\u662FRedis\u8981\u5B8C\u6574\u7684\u4FDD\u5B58\u6574\u4E2A\u6570\u636E\u96C6\u662F\u4E00\u4E2A\u6BD4\u8F83\u7E41\u91CD\u7684\u5DE5\u4F5C,\u4F60\u901A\u5E38\u4F1A\u6BCF\u96945\u5206\u949F\u6216\u8005\u66F4\u4E45\u505A\u4E00\u6B21\u5B8C\u6574\u7684\u4FDD\u5B58,\u4E07\u4E00\u5728Redis\u610F\u5916\u5B95\u673A,\u4F60\u53EF\u80FD\u4F1A\u4E22\u5931\u51E0\u5206\u949F\u7684\u6570\u636E.</p></li><li><p>RDB \u9700\u8981\u7ECF\u5E38fork\u5B50\u8FDB\u7A0B\u6765\u4FDD\u5B58\u6570\u636E\u96C6\u5230\u786C\u76D8\u4E0A,\u5F53\u6570\u636E\u96C6\u6BD4\u8F83\u5927\u7684\u65F6\u5019,fork\u7684\u8FC7\u7A0B\u662F\u975E\u5E38\u8017\u65F6\u7684,\u53EF\u80FD\u4F1A\u5BFC\u81F4Redis\u5728\u4E00\u4E9B\u6BEB\u79D2\u7EA7\u5185\u4E0D\u80FD\u54CD\u5E94\u5BA2\u6237\u7AEF\u7684\u8BF7\u6C42.\u5982\u679C\u6570\u636E\u96C6\u5DE8\u5927\u5E76\u4E14CPU\u6027\u80FD\u4E0D\u662F\u5F88\u597D\u7684\u60C5\u51B5\u4E0B,\u8FD9\u79CD\u60C5\u51B5\u4F1A\u6301\u7EED1\u79D2,AOF\u4E5F\u9700\u8981fork,\u4F46\u662F\u4F60\u53EF\u4EE5\u8C03\u8282\u91CD\u5199\u65E5\u5FD7\u6587\u4EF6\u7684\u9891\u7387\u6765\u63D0\u9AD8\u6570\u636E\u96C6\u7684\u8010\u4E45\u5EA6.</p></li></ul><h3 id="aof-\u4F18\u70B9" tabindex="-1"><a class="header-anchor" href="#aof-\u4F18\u70B9" aria-hidden="true">#</a> AOF \u4F18\u70B9</h3><ul><li><p>\u4F7F\u7528AOF \u4F1A\u8BA9\u4F60\u7684Redis\u66F4\u52A0\u8010\u4E45: \u4F60\u53EF\u4EE5\u4F7F\u7528\u4E0D\u540C\u7684fsync\u7B56\u7565\uFF1A\u65E0fsync,\u6BCF\u79D2fsync,\u6BCF\u6B21\u5199\u7684\u65F6\u5019fsync.\u4F7F\u7528\u9ED8\u8BA4\u7684\u6BCF\u79D2fsync\u7B56\u7565,Redis\u7684\u6027\u80FD\u4F9D\u7136\u5F88\u597D( fsync\u662F\u7531\u540E\u53F0\u7EBF\u7A0B\u8FDB\u884C\u5904\u7406\u7684,\u4E3B\u7EBF\u7A0B\u4F1A\u5C3D\u529B\u5904\u7406\u5BA2\u6237\u7AEF\u8BF7\u6C42),\u4E00\u65E6\u51FA\u73B0\u6545\u969C\uFF0C\u4F60\u6700\u591A\u4E22\u59311\u79D2\u7684\u6570\u636E.</p></li><li><p>AOF\u6587\u4EF6\u662F\u4E00\u4E2A\u53EA\u8FDB\u884C\u8FFD\u52A0\u7684\u65E5\u5FD7\u6587\u4EF6,\u6240\u4EE5\u4E0D\u9700\u8981\u5199\u5165seek,\u5373\u4F7F\u7531\u4E8E\u67D0\u4E9B\u539F\u56E0(\u78C1\u76D8\u7A7A\u95F4\u5DF2\u6EE1\uFF0C\u5199\u7684\u8FC7\u7A0B\u4E2D\u5B95\u673A\u7B49\u7B49)\u672A\u6267\u884C\u5B8C\u6574\u7684\u5199\u5165\u547D\u4EE4,\u4F60\u4E5F\u4E5F\u53EF\u4F7F\u7528redis-check-aof\u5DE5\u5177\u4FEE\u590D\u8FD9\u4E9B\u95EE\u9898.</p></li><li><p>Redis \u53EF\u4EE5\u5728 AOF \u6587\u4EF6\u4F53\u79EF\u53D8\u5F97\u8FC7\u5927\u65F6\uFF0C\u81EA\u52A8\u5730\u5728\u540E\u53F0\u5BF9 AOF \u8FDB\u884C\u91CD\u5199\uFF1A \u91CD\u5199\u540E\u7684\u65B0 AOF \u6587\u4EF6\u5305\u542B\u4E86\u6062\u590D\u5F53\u524D\u6570\u636E\u96C6\u6240\u9700\u7684\u6700\u5C0F\u547D\u4EE4\u96C6\u5408\u3002 \u6574\u4E2A\u91CD\u5199\u64CD\u4F5C\u662F\u7EDD\u5BF9\u5B89\u5168\u7684\uFF0C\u56E0\u4E3A Redis \u5728\u521B\u5EFA\u65B0 AOF \u6587\u4EF6\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u7EE7\u7EED\u5C06\u547D\u4EE4\u8FFD\u52A0\u5230\u73B0\u6709\u7684 AOF \u6587\u4EF6\u91CC\u9762\uFF0C\u5373\u4F7F\u91CD\u5199\u8FC7\u7A0B\u4E2D\u53D1\u751F\u505C\u673A\uFF0C\u73B0\u6709\u7684 AOF \u6587\u4EF6\u4E5F\u4E0D\u4F1A\u4E22\u5931\u3002 \u800C\u4E00\u65E6\u65B0 AOF \u6587\u4EF6\u521B\u5EFA\u5B8C\u6BD5\uFF0CRedis \u5C31\u4F1A\u4ECE\u65E7 AOF \u6587\u4EF6\u5207\u6362\u5230\u65B0 AOF \u6587\u4EF6\uFF0C\u5E76\u5F00\u59CB\u5BF9\u65B0 AOF \u6587\u4EF6\u8FDB\u884C\u8FFD\u52A0\u64CD\u4F5C\u3002</p></li><li><p>AOF \u6587\u4EF6\u6709\u5E8F\u5730\u4FDD\u5B58\u4E86\u5BF9\u6570\u636E\u5E93\u6267\u884C\u7684\u6240\u6709\u5199\u5165\u64CD\u4F5C\uFF0C \u8FD9\u4E9B\u5199\u5165\u64CD\u4F5C\u4EE5 Redis \u534F\u8BAE\u7684\u683C\u5F0F\u4FDD\u5B58\uFF0C \u56E0\u6B64 AOF \u6587\u4EF6\u7684\u5185\u5BB9\u975E\u5E38\u5BB9\u6613\u88AB\u4EBA\u8BFB\u61C2\uFF0C \u5BF9\u6587\u4EF6\u8FDB\u884C\u5206\u6790\uFF08parse\uFF09\u4E5F\u5F88\u8F7B\u677E\u3002 \u5BFC\u51FA\uFF08export\uFF09 AOF \u6587\u4EF6\u4E5F\u975E\u5E38\u7B80\u5355\uFF1A \u4E3E\u4E2A\u4F8B\u5B50\uFF0C \u5982\u679C\u4F60\u4E0D\u5C0F\u5FC3\u6267\u884C\u4E86 FLUSHALL \u547D\u4EE4\uFF0C \u4F46\u53EA\u8981 AOF \u6587\u4EF6\u672A\u88AB\u91CD\u5199\uFF0C \u90A3\u4E48\u53EA\u8981\u505C\u6B62\u670D\u52A1\u5668\uFF0C \u79FB\u9664 AOF \u6587\u4EF6\u672B\u5C3E\u7684 FLUSHALL \u547D\u4EE4\uFF0C \u5E76\u91CD\u542F Redis \uFF0C \u5C31\u53EF\u4EE5\u5C06\u6570\u636E\u96C6\u6062\u590D\u5230 FLUSHALL \u6267\u884C\u4E4B\u524D\u7684\u72B6\u6001\u3002</p></li></ul><h3 id="aof-\u7F3A\u70B9" tabindex="-1"><a class="header-anchor" href="#aof-\u7F3A\u70B9" aria-hidden="true">#</a> AOF \u7F3A\u70B9</h3><ul><li><p>\u5BF9\u4E8E\u76F8\u540C\u7684\u6570\u636E\u96C6\u6765\u8BF4\uFF0CAOF \u6587\u4EF6\u7684\u4F53\u79EF\u901A\u5E38\u8981\u5927\u4E8E RDB \u6587\u4EF6\u7684\u4F53\u79EF\u3002</p></li><li><p>\u6839\u636E\u6240\u4F7F\u7528\u7684 fsync \u7B56\u7565\uFF0CAOF \u7684\u901F\u5EA6\u53EF\u80FD\u4F1A\u6162\u4E8E RDB \u3002 \u5728\u4E00\u822C\u60C5\u51B5\u4E0B\uFF0C \u6BCF\u79D2 fsync \u7684\u6027\u80FD\u4F9D\u7136\u975E\u5E38\u9AD8\uFF0C \u800C\u5173\u95ED fsync \u53EF\u4EE5\u8BA9 AOF \u7684\u901F\u5EA6\u548C RDB \u4E00\u6837\u5FEB\uFF0C \u5373\u4F7F\u5728\u9AD8\u8D1F\u8377\u4E4B\u4E0B\u4E5F\u662F\u5982\u6B64\u3002 \u4E0D\u8FC7\u5728\u5904\u7406\u5DE8\u5927\u7684\u5199\u5165\u8F7D\u5165\u65F6\uFF0CRDB \u53EF\u4EE5\u63D0\u4F9B\u66F4\u6709\u4FDD\u8BC1\u7684\u6700\u5927\u5EF6\u8FDF\u65F6\u95F4\uFF08latency\uFF09\u3002</p></li></ul><h3 id="_4-x\u7248\u672C\u7684\u6574\u5408\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#_4-x\u7248\u672C\u7684\u6574\u5408\u7B56\u7565" aria-hidden="true">#</a> 4.X\u7248\u672C\u7684\u6574\u5408\u7B56\u7565</h3><p>\u5728AOF\u91CD\u5199\u7B56\u7565\u4E0A\u505A\u4E86\u4F18\u5316</p><p>\u5728\u91CD\u5199AOF\u6587\u4EF6\u65F6\uFF0C4.x\u7248\u672C\u4EE5\u524D\u662F\u628A\u5185\u5B58\u6570\u636E\u96C6\u7684\u64CD\u4F5C\u6307\u4EE4\u843D\u5730\uFF0C\u800C\u65B0\u7248\u672C\u662F\u628A\u5185\u5B58\u7684\u6570\u636E\u96C6\u4EE5rdb\u7684\u5F62\u5F0F\u843D\u5730</p><p>\u8FD9\u6837\u91CD\u5199\u540E\u7684AOF\u4F9D\u7136\u8FFD\u52A0\u7684\u662F\u65E5\u5FD7\uFF0C\u4F46\u662F\uFF0C\u5728\u6062\u590D\u7684\u65F6\u5019\u662F\u5148rdb\u518D\u589E\u91CF\u7684\u65E5\u5FD7\uFF0C\u6027\u80FD\u66F4\u4F18\u79C0</p><h3 id="\u6269\u5C55\u77E5\u8BC6" tabindex="-1"><a class="header-anchor" href="#\u6269\u5C55\u77E5\u8BC6" aria-hidden="true">#</a> \u6269\u5C55\u77E5\u8BC6</h3><p>\u5F02\u6B65\u7EBF\u7A0B\u77E5\u8BC6\u70B9</p><p>\u8BA1\u7B97\u673A\u7EC4\u6210\u539F\u7406</p><p>fork</p><p>copy on write</p><p>\u7CFB\u7EDFIO</p><p>pagecache</p><p>fsync</p><hr><h2 id="redis\u7684\u8FC7\u671F\u952E\u6709\u54EA\u4E9B\u5220\u9664\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#redis\u7684\u8FC7\u671F\u952E\u6709\u54EA\u4E9B\u5220\u9664\u7B56\u7565" aria-hidden="true">#</a> redis\u7684\u8FC7\u671F\u952E\u6709\u54EA\u4E9B\u5220\u9664\u7B56\u7565</h2><h3 id="\u8FC7\u671F\u7CBE\u5EA6" tabindex="-1"><a class="header-anchor" href="#\u8FC7\u671F\u7CBE\u5EA6" aria-hidden="true">#</a> \u8FC7\u671F\u7CBE\u5EA6</h3><p>\u5728 Redis 2.4 \u53CA\u4EE5\u524D\u7248\u672C\uFF0C\u8FC7\u671F\u671F\u65F6\u95F4\u53EF\u80FD\u4E0D\u662F\u5341\u5206\u51C6\u786E\uFF0C\u67090-1\u79D2\u7684\u8BEF\u5DEE\u3002</p><p>\u4ECE Redis 2.6 \u8D77\uFF0C\u8FC7\u671F\u65F6\u95F4\u8BEF\u5DEE\u7F29\u5C0F\u52300-1\u6BEB\u79D2\u3002</p><h3 id="\u8FC7\u671F\u548C\u6301\u4E45" tabindex="-1"><a class="header-anchor" href="#\u8FC7\u671F\u548C\u6301\u4E45" aria-hidden="true">#</a> \u8FC7\u671F\u548C\u6301\u4E45</h3><p>Keys\u7684\u8FC7\u671F\u65F6\u95F4\u4F7F\u7528Unix\u65F6\u95F4\u6233\u5B58\u50A8(\u4ECERedis 2.6\u5F00\u59CB\u4EE5\u6BEB\u79D2\u4E3A\u5355\u4F4D)\u3002\u8FD9\u610F\u5473\u7740\u5373\u4F7FRedis\u5B9E\u4F8B\u4E0D\u53EF\u7528\uFF0C\u65F6\u95F4\u4E5F\u662F\u4E00\u76F4\u5728\u6D41\u901D\u7684\u3002</p><p>\u8981\u60F3\u8FC7\u671F\u7684\u5DE5\u4F5C\u5904\u7406\u597D\uFF0C\u8BA1\u7B97\u673A\u5FC5\u987B\u91C7\u7528\u7A33\u5B9A\u7684\u65F6\u95F4\u3002 \u5982\u679C\u4F60\u5C06RDB\u6587\u4EF6\u5728\u4E24\u53F0\u65F6\u949F\u4E0D\u540C\u6B65\u7684\u7535\u8111\u95F4\u540C\u6B65\uFF0C\u6709\u8DA3\u7684\u4E8B\u4F1A\u53D1\u751F\uFF08\u6240\u6709\u7684 keys\u88C5\u8F7D\u65F6\u5C31\u4F1A\u8FC7\u671F\uFF09\u3002</p><p>\u5373\u4F7F\u6B63\u5728\u8FD0\u884C\u7684\u5B9E\u4F8B\u4E5F\u4F1A\u68C0\u67E5\u8BA1\u7B97\u673A\u7684\u65F6\u949F\uFF0C\u4F8B\u5982\u5982\u679C\u4F60\u8BBE\u7F6E\u4E86\u4E00\u4E2Akey\u7684\u6709\u6548\u671F\u662F1000\u79D2\uFF0C\u7136\u540E\u8BBE\u7F6E\u4F60\u7684\u8BA1\u7B97\u673A\u65F6\u95F4\u4E3A\u672A\u67652000\u79D2\uFF0C\u8FD9\u65F6key\u4F1A\u7ACB\u5373\u5931\u6548\uFF0C\u800C\u4E0D\u662F\u7B491000\u79D2\u4E4B\u540E\u3002</p><h3 id="redis\u5982\u4F55\u6DD8\u6C70\u8FC7\u671F\u7684keys" tabindex="-1"><a class="header-anchor" href="#redis\u5982\u4F55\u6DD8\u6C70\u8FC7\u671F\u7684keys" aria-hidden="true">#</a> Redis\u5982\u4F55\u6DD8\u6C70\u8FC7\u671F\u7684keys</h3><p>Redis keys\u8FC7\u671F\u6709\u4E24\u79CD\u65B9\u5F0F\uFF1A\u88AB\u52A8\u548C\u4E3B\u52A8\u65B9\u5F0F\u3002</p><p>\u5F53\u4E00\u4E9B\u5BA2\u6237\u7AEF\u5C1D\u8BD5\u8BBF\u95EE\u5B83\u65F6\uFF0Ckey\u4F1A\u88AB\u53D1\u73B0\u5E76\u4E3B\u52A8\u7684\u8FC7\u671F\u3002</p><p>\u5F53\u7136\uFF0C\u8FD9\u6837\u662F\u4E0D\u591F\u7684\uFF0C\u56E0\u4E3A\u6709\u4E9B\u8FC7\u671F\u7684keys\uFF0C\u6C38\u8FDC\u4E0D\u4F1A\u8BBF\u95EE\u4ED6\u4EEC\u3002 \u65E0\u8BBA\u5982\u4F55\uFF0C\u8FD9\u4E9Bkeys\u5E94\u8BE5\u8FC7\u671F\uFF0C\u6240\u4EE5\u5B9A\u65F6\u968F\u673A\u6D4B\u8BD5\u8BBE\u7F6Ekeys\u7684\u8FC7\u671F\u65F6\u95F4\u3002\u6240\u6709\u8FD9\u4E9B\u8FC7\u671F\u7684keys\u5C06\u4F1A\u4ECE\u5BC6\u94A5\u7A7A\u95F4\u5220\u9664\u3002</p><p>\u5177\u4F53\u5C31\u662FRedis\u6BCF\u79D210\u6B21\u505A\u7684\u4E8B\u60C5\uFF1A</p><ol><li>\u6D4B\u8BD5\u968F\u673A\u768420\u4E2Akeys\u8FDB\u884C\u76F8\u5173\u8FC7\u671F\u68C0\u6D4B\u3002</li><li>\u5220\u9664\u6240\u6709\u5DF2\u7ECF\u8FC7\u671F\u7684keys\u3002</li><li>\u5982\u679C\u6709\u591A\u4E8E25%\u7684keys\u8FC7\u671F\uFF0C\u91CD\u590D\u6B65\u594F1.</li></ol><p>\u8FD9\u662F\u4E00\u4E2A\u5E73\u51E1\u7684\u6982\u7387\u7B97\u6CD5\uFF0C\u57FA\u672C\u4E0A\u7684\u5047\u8BBE\u662F\uFF0C\u6211\u4EEC\u7684\u6837\u672C\u662F\u8FD9\u4E2A\u5BC6\u94A5\u63A7\u4EF6\uFF0C\u5E76\u4E14\u6211\u4EEC\u4E0D\u65AD\u91CD\u590D\u8FC7\u671F\u68C0\u6D4B\uFF0C\u76F4\u5230\u8FC7\u671F\u7684keys\u7684\u767E\u5206\u767E\u4F4E\u4E8E25%,\u8FD9\u610F\u5473\u7740\uFF0C\u5728\u4EFB\u4F55\u7ED9\u5B9A\u7684\u65F6\u523B\uFF0C\u6700\u591A\u4F1A\u6E05\u96641/4\u7684\u8FC7\u671Fkeys\u3002</p><h3 id="\u5728\u590D\u5236aof\u6587\u4EF6\u65F6\u5982\u4F55\u5904\u7406\u8FC7\u671F" tabindex="-1"><a class="header-anchor" href="#\u5728\u590D\u5236aof\u6587\u4EF6\u65F6\u5982\u4F55\u5904\u7406\u8FC7\u671F" aria-hidden="true">#</a> \u5728\u590D\u5236AOF\u6587\u4EF6\u65F6\u5982\u4F55\u5904\u7406\u8FC7\u671F</h3><p>\u4E3A\u4E86\u83B7\u5F97\u6B63\u786E\u7684\u884C\u4E3A\u800C\u4E0D\u727A\u7272\u4E00\u81F4\u6027\uFF0C\u5F53\u4E00\u4E2Akey\u8FC7\u671F\uFF0C<code>DEL</code>\u5C06\u4F1A\u968F\u7740AOF\u6587\u5B57\u4E00\u8D77\u5408\u6210\u5230\u6240\u6709\u9644\u52A0\u7684slaves\u3002\u5728master\u5B9E\u4F8B\u4E2D\uFF0C\u8FD9\u79CD\u65B9\u6CD5\u662F\u96C6\u4E2D\u7684\uFF0C\u5E76\u4E14\u4E0D\u5B58\u5728\u4E00\u81F4\u6027\u9519\u8BEF\u7684\u673A\u4F1A\u3002</p><p>\u7136\u800C\uFF0C\u5F53slaves\u8FDE\u63A5\u5230master\u65F6\uFF0C\u4E0D\u4F1A\u72EC\u7ACB\u8FC7\u671Fkeys\uFF08\u4F1A\u7B49\u5230master\u6267\u884CDEL\u547D\u4EE4\uFF09\uFF0C\u4ED6\u4EEC\u4EFB\u7136\u4F1A\u5728\u6570\u636E\u96C6\u91CC\u9762\u5B58\u5728\uFF0C\u6240\u4EE5\u5F53slave\u5F53\u9009\u4E3Amaster\u65F6\u6DD8\u6C70keys\u4F1A\u72EC\u7ACB\u6267\u884C\uFF0C\u7136\u540E\u6210\u4E3Amaster\u3002</p><h3 id="\u6269\u5C55" tabindex="-1"><a class="header-anchor" href="#\u6269\u5C55" aria-hidden="true">#</a> \u6269\u5C55</h3><p>\u7EDD\u5BF9\u65F6\u95F4\u70B9\u8FC7\u671F</p><p>\u76F8\u5BF9\u65F6\u95F4\u70B9\u8FC7\u671F</p><p>\u65F6\u949F\u8F6E\u7B97\u6CD5</p><h2 id="redis\u7EBF\u7A0B\u6A21\u578B\u6709\u54EA\u4E9B-\u5355\u7EBF\u7A0B\u4E3A\u4EC0\u4E48\u5FEB" tabindex="-1"><a class="header-anchor" href="#redis\u7EBF\u7A0B\u6A21\u578B\u6709\u54EA\u4E9B-\u5355\u7EBF\u7A0B\u4E3A\u4EC0\u4E48\u5FEB" aria-hidden="true">#</a> redis\u7EBF\u7A0B\u6A21\u578B\u6709\u54EA\u4E9B\uFF0C\u5355\u7EBF\u7A0B\u4E3A\u4EC0\u4E48\u5FEB</h2><h3 id="io\u6A21\u578B\u7EF4\u5EA6\u7684\u7279\u5F81" tabindex="-1"><a class="header-anchor" href="#io\u6A21\u578B\u7EF4\u5EA6\u7684\u7279\u5F81" aria-hidden="true">#</a> IO\u6A21\u578B\u7EF4\u5EA6\u7684\u7279\u5F81</h3><p>IO\u6A21\u578B\u4F7F\u7528\u4E86\u591A\u8DEF\u590D\u7528\u5668\uFF0C\u5728linux\u7CFB\u7EDF\u4E2D\u4F7F\u7528\u7684\u662FEPOLL</p><p>\u7C7B\u4F3Cnetty\u7684BOSS,WORKER\u4F7F\u7528\u4E00\u4E2AEventLoopGroup(threads=1)</p><p>\u5355\u7EBF\u7A0B\u7684Reactor\u6A21\u578B\uFF0C\u6BCF\u6B21\u5FAA\u73AF\u53D6socket\u4E2D\u7684\u547D\u4EE4\u7136\u540E\u9010\u4E00\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u4FDD\u8BC1socket\u4E2D\u7684\u6307\u4EE4\u662F\u6309\u987A\u5E8F\u7684\uFF0C\u4E0D\u4FDD\u8BC1\u4E0D\u540C\u7684socket\u4E5F\u5C31\u662F\u5BA2\u6237\u7AEF\u7684\u547D\u4EE4\u7684\u987A\u5E8F\u6027</p><p>\u547D\u4EE4\u64CD\u4F5C\u5728\u5355\u7EBF\u7A0B\u4E2D\u987A\u5E8F\u64CD\u4F5C\uFF0C\u6CA1\u6709\u591A\u7EBF\u7A0B\u7684\u56F0\u6270\u4E0D\u9700\u8981\u9501\u7684\u590D\u6742\u5EA6\uFF0C\u5728\u64CD\u4F5C\u6570\u636E\u4E0A\u76F8\u5BF9\u6765\u8BF4\u662F\u539F\u5B50\u6027\u8D28\u7684</p><h3 id="\u67B6\u6784\u8BBE\u8BA1\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#\u67B6\u6784\u8BBE\u8BA1\u6A21\u578B" aria-hidden="true">#</a> \u67B6\u6784\u8BBE\u8BA1\u6A21\u578B</h3><p>\u81EA\u8EAB\u7684\u5185\u5B58\u5B58\u50A8\u6570\u636E\uFF0C\u8BFB\u5199\u64CD\u4F5C\u4E0D\u8BBE\u8BA1\u78C1\u76D8IO</p><p>redis\u9664\u4E86\u63D0\u4F9B\u4E86Value\u5177\u5907\u7C7B\u578B\u8FD8\u4E3A\u6BCF\u79CD\u7C7B\u578B\u5B9E\u73B0\u4E86\u4E00\u4E9B\u64CD\u4F5C\u547D\u4EE4</p><p>\u5B9E\u73B0\u4E86\u8BA1\u7B97\u5411\u6570\u636E\u79FB\u52A8\uFF0C\u800C\u975E\u6570\u636E\u60F3\u8BA1\u7B97\u79FB\u52A8\uFF0C\u8FD9\u6837\u5728IO\u7684\u6210\u672C\u4E0A\u6709\u4E00\u5B9A\u7684\u4F18\u52BF</p><p>\u4E14\u5728\u6570\u636E\u7ED3\u6784\u7C7B\u578B\u4E0A\uFF0C\u4E30\u5BCC\u4E86\u4E00\u4E9B\u7EDF\u8BA1\u7C7B\u5C5E\u6027\uFF0C\u8BFB\u5199\u64CD\u4F5C\u4E2D\uFF0C\u5199\u64CD\u4F5C\u4F1AO(1)\u8D1F\u8F7D\u5EA6\u66F4\u65B0length\u7C7B\u5C5E\u6027\uFF0C\u4F7F\u5F97\u8BFB\u64CD\u4F5C\u4E5F\u662FO(1)\u7684</p><h2 id="\u7F13\u5B58\u96EA\u5D29\u3001\u7F13\u5B58\u7A7F\u900F\u3001\u7F13\u5B58\u51FB\u7A7F\u5728\u5B9E\u9645\u4E2D\u5982\u4F55\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u96EA\u5D29\u3001\u7F13\u5B58\u7A7F\u900F\u3001\u7F13\u5B58\u51FB\u7A7F\u5728\u5B9E\u9645\u4E2D\u5982\u4F55\u5904\u7406" aria-hidden="true">#</a> \u7F13\u5B58\u96EA\u5D29\u3001\u7F13\u5B58\u7A7F\u900F\u3001\u7F13\u5B58\u51FB\u7A7F\u5728\u5B9E\u9645\u4E2D\u5982\u4F55\u5904\u7406</h2><h3 id="\u7F13\u5B58\u7A7F\u900F" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u7A7F\u900F" aria-hidden="true">#</a> \u7F13\u5B58\u7A7F\u900F</h3><p>\u7F13\u5B58\u7A7F\u900F\u662F\u6307\u67E5\u8BE2\u4E00\u4E2A\u4E00\u5B9A\u4E0D\u5B58\u5728\u7684\u6570\u636E\uFF0C\u7531\u4E8E\u7F13\u5B58\u662F\u4E0D\u547D\u4E2D\u65F6\u88AB\u52A8\u5199\u7684\uFF0C\u5E76\u4E14\u51FA\u4E8E\u5BB9\u9519\u8003\u8651\uFF0C\u5982\u679C\u4ECE\u5B58\u50A8\u5C42\u67E5\u4E0D\u5230\u6570\u636E\u5219\u4E0D\u5199\u5165\u7F13\u5B58\uFF0C\u8FD9\u5C06\u5BFC\u81F4\u8FD9\u4E2A\u4E0D\u5B58\u5728\u7684\u6570\u636E\u6BCF\u6B21\u8BF7\u6C42\u90FD\u8981\u5230\u5B58\u50A8\u5C42\u53BB\u67E5\u8BE2\uFF0C \u5931\u53BB\u4E86\u7F13\u5B58\u7684\u610F\u4E49\u3002\u5728\u6D41\u91CF\u5927\u65F6\uFF0C\u53EF\u80FDDB\u5C31\u6302\u6389\u4E86\uFF0C\u8981\u662F\u6709\u4EBA\u5229\u7528\u4E0D\u5B58\u5728\u7684key\u9891\u7E41\u653B\u51FB\u6211\u4EEC\u7684\u5E94\u7528\uFF0C\u8FD9\u5C31\u662F\u6F0F\u6D1E\u3002</p><p><img src="'+r+'" alt="img2.png"></p><blockquote><p>\uFF08[\u7F13\u5B58\u3001DB]\u90FD\u4E0D\u5B58\u5728\u6570\u636E\uFF091000\u4E07\u6761\u5E76\u53D1\u8BF7\u6C42\uFF0C\u7F13\u5B58\u4E3Anull\uFF0C\u5168\u90E8\u8DD1\u5230db\u67E5\u8BE2\uFF0Cdb\u53EF\u80FD\u76F4\u63A5\u5B95\u673A\u3002</p></blockquote><h4 id="\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> \u89E3\u51B3\u65B9\u6848</h4><p>\u6709\u5F88\u591A\u79CD\u65B9\u6CD5\u53EF\u4EE5\u6709\u6548\u5730\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898\uFF0C\u6700\u5E38\u89C1\u7684\u5219\u662F\u91C7\u7528\u5E03\u9686\u8FC7\u6EE4\u5668\uFF0C\u5C06\u6240\u6709\u53EF\u80FD\u5B58\u5728\u7684\u6570\u636E\u54C8\u5E0C\u5230\u4E00\u4E2A\u8DB3\u591F\u5927\u7684bitmap\u4E2D\uFF0C\u4E00\u4E2A\u4E00\u5B9A\u4E0D\u5B58\u5728\u7684\u6570\u636E\u4F1A\u88AB \u8FD9\u4E2Abitmap\u62E6\u622A\u6389\uFF0C \u4ECE\u800C\u907F\u514D\u4E86\u5BF9\u5E95\u5C42\u5B58\u50A8\u7CFB\u7EDF\u7684\u67E5\u8BE2\u538B\u529B\u3002\u53E6\u5916\u4E5F\u6709\u4E00\u4E2A\u66F4\u4E3A\u7B80\u5355\u7C97\u66B4\u7684\u65B9\u6CD5\uFF08\u6211\u4EEC\u91C7\u7528\u7684\u5C31\u662F\u8FD9\u79CD\uFF09\uFF0C\u5982\u679C\u4E00\u4E2A\u67E5\u8BE2\u8FD4\u56DE\u7684\u6570\u636E\u4E3A\u7A7A\uFF08\u4E0D\u7BA1\u662F\u6570 \u636E\u4E0D\u5B58\u5728\uFF0C\u8FD8\u662F\u7CFB\u7EDF\u6545\u969C\uFF09\uFF0C \u6211\u4EEC\u4ECD\u7136\u628A\u8FD9\u4E2A\u7A7A\u7ED3\u679C\u8FDB\u884C\u7F13\u5B58\uFF0C\u4F46\u5B83\u7684\u8FC7\u671F\u65F6\u95F4\u4F1A\u5F88\u77ED\uFF0C\u6700\u957F\u4E0D\u8D85\u8FC7\u4E94\u5206\u949F\u3002</p><blockquote><p>.set(&quot;cataLogJson&quot;, cataLogJsonDB == null ? &quot;1001&quot; : cataLogJsonDB));</p></blockquote><h3 id="\u7F13\u5B58\u96EA\u5D29" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u96EA\u5D29" aria-hidden="true">#</a> \u7F13\u5B58\u96EA\u5D29</h3><p>\u7F13\u5B58\u96EA\u5D29\u662F\u6307\u5728\u6211\u4EEC\u8BBE\u7F6E\u7F13\u5B58\u65F6\u91C7\u7528\u4E86\u76F8\u540C\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5BFC\u81F4\u7F13\u5B58\u5728\u67D0\u4E00\u65F6\u523B\u540C\u65F6\u5931\u6548\uFF0C\u8BF7\u6C42\u5168\u90E8\u8F6C\u53D1\u5230DB\uFF0CDB\u77AC\u65F6\u538B\u529B\u8FC7\u91CD\u96EA\u5D29\u3002</p><p><img src="'+d+'" alt="img3.png"></p><blockquote><p>\u5B58\u5728\u7684\u6570\u636E\uFF0C\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548)\u5DF2\u7ECF\u6709\u5F88\u591A\u6570\u636E\u5B58\u5728\uFF0C\u4F46\u6709\u4E00\u4E9B\u8BBE\u7F6E\u4E86\u540C\u6837\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5BFC\u81F4\u4E86\u5F88\u591A\u6CA1\u547D\u4E2D\u3002</p></blockquote><h4 id="\u89E3\u51B3\u65B9\u6848-1" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848-1" aria-hidden="true">#</a> \u89E3\u51B3\u65B9\u6848</h4><p>\u7F13\u5B58\u5931\u6548\u65F6\u7684\u96EA\u5D29\u6548\u5E94\u5BF9\u5E95\u5C42\u7CFB\u7EDF\u7684\u51B2\u51FB\u975E\u5E38\u53EF\u6015\u3002\u5927\u591A\u6570\u7CFB\u7EDF\u8BBE\u8BA1\u8005\u8003\u8651\u7528\u52A0\u9501\u6216\u8005\u961F\u5217\u7684\u65B9\u5F0F\u4FDD\u8BC1\u7F13\u5B58\u7684\u5355\u7EBF \u7A0B\uFF08\u8FDB\u7A0B\uFF09\u5199\uFF0C\u4ECE\u800C\u907F\u514D\u5931\u6548\u65F6\u5927\u91CF\u7684\u5E76\u53D1\u8BF7\u6C42\u843D\u5230\u5E95\u5C42\u5B58\u50A8\u7CFB\u7EDF\u4E0A\u3002 \u8FD9\u91CC\u5206\u4EAB\u4E00\u4E2A\u7B80\u5355\u65B9\u6848\u5C31\u65F6\u8BB2\u7F13\u5B58\u5931\u6548\u65F6\u95F4\u5206\u6563\u5F00\uFF0C\u6BD4\u5982\u6211\u4EEC\u53EF\u4EE5\u5728\u539F\u6709\u7684\u5931\u6548\u65F6\u95F4\u57FA\u7840\u4E0A\u589E\u52A0\u4E00\u4E2A\u968F\u673A\u503C\uFF0C\u6BD4\u59821-5\u5206\u949F\u968F\u673A\uFF0C\u8FD9\u6837\u6BCF\u4E00\u4E2A\u7F13\u5B58\u7684\u8FC7\u671F\u65F6\u95F4\u7684\u91CD\u590D\u7387\u5C31\u4F1A\u964D\u4F4E\uFF0C\u5C31\u5F88\u96BE\u5F15\u53D1\u96C6\u4F53\u5931\u6548\u7684\u4E8B\u4EF6\u3002</p><p>\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4(\u52A0\u968F\u673A\u503C) \u3002\u5B58\u5728\u7684\u6570\u636E\uFF0C\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548</p><blockquote><p>.set(&quot;cataLogJson&quot;, JSON.toJSONString(cataLogJsonFromDB == null ? &quot;1001&quot; : cataLogJsonFromDB), 1, TimeUnit.DAYS);</p></blockquote><h3 id="\u7F13\u5B58\u51FB\u7A7F" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u51FB\u7A7F" aria-hidden="true">#</a> \u7F13\u5B58\u51FB\u7A7F</h3><p>\u5BF9\u4E8E\u4E00\u4E9B\u8BBE\u7F6E\u4E86\u8FC7\u671F\u65F6\u95F4\u7684key\uFF0C\u5982\u679C\u8FD9\u4E9Bkey\u53EF\u80FD\u4F1A\u5728\u67D0\u4E9B\u65F6\u95F4\u70B9\u88AB\u8D85\u9AD8\u5E76\u53D1\u5730\u8BBF\u95EE\uFF0C\u662F\u4E00\u79CD\u975E\u5E38\u201C\u70ED\u70B9\u201D\u7684\u6570\u636E\u3002\u8FD9\u4E2A\u65F6\u5019\uFF0C\u9700\u8981\u8003\u8651\u4E00\u4E2A\u95EE\u9898\uFF1A\u7F13\u5B58\u88AB\u201C\u51FB\u7A7F\u201D\u7684\u95EE\u9898\uFF0C \u8FD9\u4E2A\u548C\u7F13\u5B58\u96EA\u5D29\u7684\u533A\u522B\u5728\u4E8E\u8FD9\u91CC\u9488\u5BF9\u67D0\u4E00key\u7F13\u5B58\uFF0C\u524D\u8005\u5219\u662F\u5F88\u591Akey\u3002</p><p>\u7F13\u5B58\u5728\u67D0\u4E2A\u65F6\u95F4\u70B9\u8FC7\u671F\u7684\u65F6\u5019\uFF0C\u6070\u597D\u5728\u8FD9\u4E2A\u65F6\u95F4\u70B9\u5BF9\u8FD9\u4E2AKey\u6709\u5927\u91CF\u7684\u5E76\u53D1\u8BF7\u6C42\u8FC7\u6765\uFF0C\u8FD9\u4E9B\u8BF7\u6C42\u53D1\u73B0\u7F13\u5B58\u8FC7\u671F\u4E00\u822C\u90FD\u4F1A\u4ECE\u540E\u7AEFDB\u52A0\u8F7D\u6570\u636E\u5E76\u56DE\u8BBE\u5230\u7F13\u5B58\uFF0C\u8FD9\u4E2A\u65F6\u5019\u5927\u5E76\u53D1\u7684\u8BF7\u6C42\u53EF\u80FD\u4F1A\u77AC\u95F4\u628A\u540E\u7AEFDB\u538B\u57AE\u3002</p><p><img src="'+k+'" alt="img4.png"></p><blockquote><p>\uFF08\u5B58\u5728\u7684\u6570\u636E\uFF0C\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548\uFF091000\u4E07\u6761\u5E76\u53D1\uFF0C\uFF0C\u4F1A\u5168\u90E8\u8DD1\u5230db\u67E5\u8BE2\uFF0Cdb\u53EF\u80FD\u76F4\u63A5\u5B95\u673A</p></blockquote><h4 id="\u89E3\u51B3\u65B9\u6848-2" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848-2" aria-hidden="true">#</a> \u89E3\u51B3\u65B9\u6848</h4><p>\u52A0\u9501\uFF0C\u5B58\u5728\u7684\u6570\u636E\uFF0C\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548</p><blockquote><p>\u901A\u8FC7redis ...</p></blockquote><p>1.\u4F7F\u7528\u4E92\u65A5\u9501(mutex key) \u4E1A\u754C\u6BD4\u8F83\u5E38\u7528\u7684\u505A\u6CD5\uFF0C\u662F\u4F7F\u7528mutex\u3002\u7B80\u5355\u5730\u6765\u8BF4\uFF0C\u5C31\u662F\u5728\u7F13\u5B58\u5931\u6548\u7684\u65F6\u5019\uFF08\u5224\u65AD\u62FF\u51FA\u6765\u7684\u503C\u4E3A\u7A7A\uFF09\uFF0C\u4E0D\u662F\u7ACB\u5373\u53BBload db\uFF0C\u800C\u662F\u5148\u4F7F\u7528\u7F13\u5B58\u5DE5\u5177\u7684\u67D0\u4E9B\u5E26\u6210\u529F\u64CD\u4F5C\u8FD4\u56DE\u503C\u7684\u64CD\u4F5C \uFF08\u6BD4\u5982Redis\u7684SETNX\u6216\u8005Memcache\u7684ADD\uFF09\u53BBset\u4E00\u4E2Amutex key\uFF0C\u5F53\u64CD\u4F5C\u8FD4\u56DE\u6210\u529F\u65F6\uFF0C\u518D\u8FDB\u884Cload db\u7684\u64CD\u4F5C\u5E76\u56DE\u8BBE\u7F13\u5B58\uFF1B\u5426\u5219\uFF0C\u5C31\u91CD\u8BD5\u6574\u4E2Aget\u7F13\u5B58\u7684\u65B9\u6CD5\u3002 SETNX\uFF0C\u662F\u300CSET if Not eXists\u300D\u7684\u7F29\u5199\uFF0C\u4E5F\u5C31\u662F\u53EA\u6709\u4E0D\u5B58\u5728\u7684\u65F6\u5019\u624D\u8BBE\u7F6E\uFF0C\u53EF\u4EE5\u5229\u7528\u5B83\u6765\u5B9E\u73B0\u9501\u7684\u6548\u679C\u3002\u5728redis2.6.1\u4E4B\u524D\u7248\u672C\u672A\u5B9E\u73B0setnx\u7684\u8FC7\u671F\u65F6\u95F4</p><p>2.&quot;\u63D0\u524D&quot;\u4F7F\u7528\u4E92\u65A5\u9501(mutex key)\uFF1A \u5728value\u5185\u90E8\u8BBE\u7F6E1\u4E2A\u8D85\u65F6\u503C(timeout1), timeout1\u6BD4\u5B9E\u9645\u7684memcache timeout(timeout2)\u5C0F\u3002\u5F53\u4ECEcache\u8BFB\u53D6\u5230timeout1\u53D1\u73B0\u5B83\u5DF2\u7ECF\u8FC7\u671F\u65F6\u5019\uFF0C\u9A6C\u4E0A\u5EF6\u957Ftimeout1\u5E76\u91CD\u65B0\u8BBE\u7F6E\u5230cache\u3002 \u7136\u540E\u518D\u4ECE\u6570\u636E\u5E93\u52A0\u8F7D\u6570\u636E\u5E76\u8BBE\u7F6E\u5230cache\u4E2D\u3002</p><p>3.&quot;\u6C38\u8FDC\u4E0D\u8FC7\u671F&quot;\uFF1A<br> \u8FD9\u91CC\u7684\u201C\u6C38\u8FDC\u4E0D\u8FC7\u671F\u201D\u5305\u542B\u4E24\u5C42\u610F\u601D\uFF1A</p><p>(1) \u4ECEredis\u4E0A\u770B\uFF0C\u786E\u5B9E\u6CA1\u6709\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF0C\u8FD9\u5C31\u4FDD\u8BC1\u4E86\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u70ED\u70B9key\u8FC7\u671F\u95EE\u9898\uFF0C\u4E5F\u5C31\u662F\u201C\u7269\u7406\u201D\u4E0D\u8FC7\u671F\u3002</p><p>(2) \u4ECE\u529F\u80FD\u4E0A\u770B\uFF0C\u5982\u679C\u4E0D\u8FC7\u671F\uFF0C\u90A3\u4E0D\u5C31\u6210\u9759\u6001\u7684\u4E86\u5417\uFF1F\u6240\u4EE5\u6211\u4EEC\u628A\u8FC7\u671F\u65F6\u95F4\u5B58\u5728key\u5BF9\u5E94\u7684value\u91CC\uFF0C\u5982\u679C\u53D1\u73B0\u8981\u8FC7\u671F\u4E86\uFF0C\u901A\u8FC7\u4E00\u4E2A\u540E\u53F0\u7684\u5F02\u6B65\u7EBF\u7A0B\u8FDB\u884C\u7F13\u5B58\u7684\u6784\u5EFA\uFF0C\u4E5F\u5C31\u662F\u201C\u903B\u8F91\u201D\u8FC7\u671F</p><p>\u4ECE\u5B9E\u6218\u770B\uFF0C\u8FD9\u79CD\u65B9\u6CD5\u5BF9\u4E8E\u6027\u80FD\u975E\u5E38\u53CB\u597D\uFF0C\u552F\u4E00\u4E0D\u8DB3\u7684\u5C31\u662F\u6784\u5EFA\u7F13\u5B58\u65F6\u5019\uFF0C\u5176\u4F59\u7EBF\u7A0B(\u975E\u6784\u5EFA\u7F13\u5B58\u7684\u7EBF\u7A0B)\u53EF\u80FD\u8BBF\u95EE\u7684\u662F\u8001\u6570\u636E\uFF0C\u4F46\u662F\u5BF9\u4E8E\u4E00\u822C\u7684\u4E92\u8054\u7F51\u529F\u80FD\u6765\u8BF4\u8FD9\u4E2A\u8FD8\u662F\u53EF\u4EE5\u5FCD\u53D7\u3002</p><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><p>1.<strong>\u7A7F\u900F</strong> \u662F\u7F13\u5B58\u4E0D\u547D\u4E2D\uFF0CDB\u4E5F\u6CA1\u6709\u4E0D\u547D\u4E2D</p><p>2.<strong>\u51FB\u7A7F</strong> \u662F\u4E00\u4E2A\u70ED\u70B9key\u5931\u6548</p><p>3.<strong>\u96EA\u5D29</strong> \u662F\u5F88\u591Akey\u96C6\u4F53\u5931\u6548</p><h2 id="redis\u4E8B\u52A1\u662F\u600E\u4E48\u5B9E\u73B0\u7684" tabindex="-1"><a class="header-anchor" href="#redis\u4E8B\u52A1\u662F\u600E\u4E48\u5B9E\u73B0\u7684" aria-hidden="true">#</a> redis\u4E8B\u52A1\u662F\u600E\u4E48\u5B9E\u73B0\u7684</h2><p>MULTI \u3001 EXEC \u3001 DISCARD \u548C WATCH \u662F Redis \u4E8B\u52A1\u76F8\u5173\u7684\u547D\u4EE4\u3002\u4E8B\u52A1\u53EF\u4EE5\u4E00\u6B21\u6267\u884C\u591A\u4E2A\u547D\u4EE4\uFF0C \u5E76\u4E14\u5E26\u6709\u4EE5\u4E0B\u4E24\u4E2A\u91CD\u8981\u7684\u4FDD\u8BC1\uFF1A</p><blockquote><p>\u4E8B\u52A1\u662F\u4E00\u4E2A\u5355\u72EC\u7684\u9694\u79BB\u64CD\u4F5C\uFF1A\u4E8B\u52A1\u4E2D\u7684\u6240\u6709\u547D\u4EE4\u90FD\u4F1A\u5E8F\u5217\u5316\u3001\u6309\u987A\u5E8F\u5730\u6267\u884C\u3002\u4E8B\u52A1\u5728\u6267\u884C\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u4E0D\u4F1A\u88AB\u5176\u4ED6\u5BA2\u6237\u7AEF\u53D1\u9001\u6765\u7684\u547D\u4EE4\u8BF7\u6C42\u6240\u6253\u65AD\u3002</p><p>\u4E8B\u52A1\u662F\u4E00\u4E2A\u539F\u5B50\u64CD\u4F5C\uFF1A\u4E8B\u52A1\u4E2D\u7684\u547D\u4EE4\u8981\u4E48\u5168\u90E8\u88AB\u6267\u884C\uFF0C\u8981\u4E48\u5168\u90E8\u90FD\u4E0D\u6267\u884C\u3002</p></blockquote><p>EXEC \u547D\u4EE4\u8D1F\u8D23\u89E6\u53D1\u5E76\u6267\u884C\u4E8B\u52A1\u4E2D\u7684\u6240\u6709\u547D\u4EE4\uFF1A</p><blockquote><p>\u5982\u679C\u5BA2\u6237\u7AEF\u5728\u4F7F\u7528 MULTI \u5F00\u542F\u4E86\u4E00\u4E2A\u4E8B\u52A1\u4E4B\u540E\uFF0C\u5374\u56E0\u4E3A\u65AD\u7EBF\u800C\u6CA1\u6709\u6210\u529F\u6267\u884C EXEC \uFF0C\u90A3\u4E48\u4E8B\u52A1\u4E2D\u7684\u6240\u6709\u547D\u4EE4\u90FD\u4E0D\u4F1A\u88AB\u6267\u884C\u3002</p><p>\u53E6\u4E00\u65B9\u9762\uFF0C\u5982\u679C\u5BA2\u6237\u7AEF\u6210\u529F\u5728\u5F00\u542F\u4E8B\u52A1\u4E4B\u540E\u6267\u884C EXEC \uFF0C\u90A3\u4E48\u4E8B\u52A1\u4E2D\u7684\u6240\u6709\u547D\u4EE4\u90FD\u4F1A\u88AB\u6267\u884C\u3002</p></blockquote><p>\u5F53\u4F7F\u7528 AOF \u65B9\u5F0F\u505A\u6301\u4E45\u5316\u7684\u65F6\u5019\uFF0C Redis \u4F1A\u4F7F\u7528\u5355\u4E2A write(2) \u547D\u4EE4\u5C06\u4E8B\u52A1\u5199\u5165\u5230\u78C1\u76D8\u4E2D\u3002</p><p>\u7136\u800C\uFF0C\u5982\u679C Redis \u670D\u52A1\u5668\u56E0\u4E3A\u67D0\u4E9B\u539F\u56E0\u88AB\u7BA1\u7406\u5458\u6740\u6B7B\uFF0C\u6216\u8005\u9047\u4E0A\u67D0\u79CD\u786C\u4EF6\u6545\u969C\uFF0C\u90A3\u4E48\u53EF\u80FD\u53EA\u6709\u90E8\u5206\u4E8B\u52A1\u547D\u4EE4\u4F1A\u88AB\u6210\u529F\u5199\u5165\u5230\u78C1\u76D8\u4E2D\u3002</p><p>\u5982\u679C Redis \u5728\u91CD\u65B0\u542F\u52A8\u65F6\u53D1\u73B0 AOF \u6587\u4EF6\u51FA\u4E86\u8FD9\u6837\u7684\u95EE\u9898\uFF0C\u90A3\u4E48\u5B83\u4F1A\u9000\u51FA\uFF0C\u5E76\u6C47\u62A5\u4E00\u4E2A\u9519\u8BEF\u3002</p><p>\u4F7F\u7528redis-check-aof\u7A0B\u5E8F\u53EF\u4EE5\u4FEE\u590D\u8FD9\u4E00\u95EE\u9898\uFF1A\u5B83\u4F1A\u79FB\u9664 AOF \u6587\u4EF6\u4E2D\u4E0D\u5B8C\u6574\u4E8B\u52A1\u7684\u4FE1\u606F\uFF0C\u786E\u4FDD\u670D\u52A1\u5668\u53EF\u4EE5\u987A\u5229\u542F\u52A8\u3002</p><p>\u4ECE 2.2 \u7248\u672C\u5F00\u59CB\uFF0CRedis \u8FD8\u53EF\u4EE5\u901A\u8FC7\u4E50\u89C2\u9501\uFF08optimistic lock\uFF09\u5B9E\u73B0 CAS \uFF08check-and-set\uFF09\u64CD\u4F5C\uFF0C\u5177\u4F53\u4FE1\u606F\u8BF7\u53C2\u8003\u6587\u6863\u7684\u540E\u534A\u90E8\u5206\u3002</p><h3 id="\u4E8B\u52A1\u4E2D\u7684\u9519\u8BEF" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u52A1\u4E2D\u7684\u9519\u8BEF" aria-hidden="true">#</a> \u4E8B\u52A1\u4E2D\u7684\u9519\u8BEF</h3><p>\u4F7F\u7528\u4E8B\u52A1\u65F6\u53EF\u80FD\u4F1A\u9047\u4E0A\u4EE5\u4E0B\u4E24\u79CD\u9519\u8BEF\uFF1A</p><blockquote><p>\u4E8B\u52A1\u5728\u6267\u884C EXEC \u4E4B\u524D\uFF0C\u5165\u961F\u7684\u547D\u4EE4\u53EF\u80FD\u4F1A\u51FA\u9519\u3002\u6BD4\u5982\u8BF4\uFF0C\u547D\u4EE4\u53EF\u80FD\u4F1A\u4EA7\u751F\u8BED\u6CD5\u9519\u8BEF\uFF08\u53C2\u6570\u6570\u91CF\u9519\u8BEF\uFF0C\u53C2\u6570\u540D\u9519\u8BEF\uFF0C\u7B49\u7B49\uFF09\uFF0C\u6216\u8005\u5176\u4ED6\u66F4\u4E25\u91CD\u7684\u9519\u8BEF\uFF0C\u6BD4\u5982\u5185\u5B58\u4E0D\u8DB3\uFF08\u5982\u679C\u670D\u52A1\u5668\u4F7F\u7528 maxmemory \u8BBE\u7F6E\u4E86\u6700\u5927\u5185\u5B58\u9650\u5236\u7684\u8BDD\uFF09\u3002</p><p>\u547D\u4EE4\u53EF\u80FD\u5728 EXEC \u8C03\u7528\u4E4B\u540E\u5931\u8D25\u3002\u4E3E\u4E2A\u4F8B\u5B50\uFF0C\u4E8B\u52A1\u4E2D\u7684\u547D\u4EE4\u53EF\u80FD\u5904\u7406\u4E86\u9519\u8BEF\u7C7B\u578B\u7684\u952E\uFF0C\u6BD4\u5982\u5C06\u5217\u8868\u547D\u4EE4\u7528\u5728\u4E86\u5B57\u7B26\u4E32\u952E\u4E0A\u9762\uFF0C\u8BF8\u5982\u6B64\u7C7B\u3002</p></blockquote><p>\u5BF9\u4E8E\u53D1\u751F\u5728 EXEC \u6267\u884C\u4E4B\u524D\u7684\u9519\u8BEF\uFF0C\u5BA2\u6237\u7AEF\u4EE5\u524D\u7684\u505A\u6CD5\u662F\u68C0\u67E5\u547D\u4EE4\u5165\u961F\u6240\u5F97\u7684\u8FD4\u56DE\u503C\uFF1A\u5982\u679C\u547D\u4EE4\u5165\u961F\u65F6\u8FD4\u56DE QUEUED \uFF0C\u90A3\u4E48\u5165\u961F\u6210\u529F\uFF1B\u5426\u5219\uFF0C\u5C31\u662F\u5165\u961F\u5931\u8D25\u3002\u5982\u679C\u6709\u547D\u4EE4\u5728\u5165\u961F\u65F6\u5931\u8D25\uFF0C\u90A3\u4E48\u5927\u90E8\u5206\u5BA2\u6237\u7AEF\u90FD\u4F1A\u505C\u6B62\u5E76\u53D6\u6D88\u8FD9\u4E2A\u4E8B\u52A1\u3002</p><p>\u4E0D\u8FC7\uFF0C\u4ECE Redis 2.6.5 \u5F00\u59CB\uFF0C\u670D\u52A1\u5668\u4F1A\u5BF9\u547D\u4EE4\u5165\u961F\u5931\u8D25\u7684\u60C5\u51B5\u8FDB\u884C\u8BB0\u5F55\uFF0C\u5E76\u5728\u5BA2\u6237\u7AEF\u8C03\u7528 EXEC \u547D\u4EE4\u65F6\uFF0C\u62D2\u7EDD\u6267\u884C\u5E76\u81EA\u52A8\u653E\u5F03\u8FD9\u4E2A\u4E8B\u52A1\u3002</p><p>\u5728 Redis 2.6.5 \u4EE5\u524D\uFF0C Redis \u53EA\u6267\u884C\u4E8B\u52A1\u4E2D\u90A3\u4E9B\u5165\u961F\u6210\u529F\u7684\u547D\u4EE4\uFF0C\u800C\u5FFD\u7565\u90A3\u4E9B\u5165\u961F\u5931\u8D25\u7684\u547D\u4EE4\u3002 \u800C\u65B0\u7684\u5904\u7406\u65B9\u5F0F\u5219\u4F7F\u5F97\u5728\u6D41\u6C34\u7EBF\uFF08pipeline\uFF09\u4E2D\u5305\u542B\u4E8B\u52A1\u53D8\u5F97\u7B80\u5355\uFF0C\u56E0\u4E3A\u53D1\u9001\u4E8B\u52A1\u548C\u8BFB\u53D6\u4E8B\u52A1\u7684\u56DE\u590D\u90FD\u53EA\u9700\u8981\u548C\u670D\u52A1\u5668\u8FDB\u884C\u4E00\u6B21\u901A\u8BAF\u3002</p><p>\u81F3\u4E8E\u90A3\u4E9B\u5728 EXEC \u547D\u4EE4\u6267\u884C\u4E4B\u540E\u6240\u4EA7\u751F\u7684\u9519\u8BEF\uFF0C \u5E76\u6CA1\u6709\u5BF9\u5B83\u4EEC\u8FDB\u884C\u7279\u522B\u5904\u7406\uFF1A \u5373\u4F7F\u4E8B\u52A1\u4E2D\u6709\u67D0\u4E2A/\u67D0\u4E9B\u547D\u4EE4\u5728\u6267\u884C\u65F6\u4EA7\u751F\u4E86\u9519\u8BEF\uFF0C \u4E8B\u52A1\u4E2D\u7684\u5176\u4ED6\u547D\u4EE4\u4ECD\u7136\u4F1A\u7EE7\u7EED\u6267\u884C\u3002</p><h3 id="\u4E3A\u4EC0\u4E48-redis-\u4E0D\u652F\u6301\u56DE\u6EDA-roll-back" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48-redis-\u4E0D\u652F\u6301\u56DE\u6EDA-roll-back" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48 Redis \u4E0D\u652F\u6301\u56DE\u6EDA\uFF08roll back\uFF09</h3><p>\u5982\u679C\u4F60\u6709\u4F7F\u7528\u5173\u7CFB\u5F0F\u6570\u636E\u5E93\u7684\u7ECF\u9A8C\uFF0C \u90A3\u4E48 \u201CRedis \u5728\u4E8B\u52A1\u5931\u8D25\u65F6\u4E0D\u8FDB\u884C\u56DE\u6EDA\uFF0C\u800C\u662F\u7EE7\u7EED\u6267\u884C\u4F59\u4E0B\u7684\u547D\u4EE4\u201D\u8FD9\u79CD\u505A\u6CD5\u53EF\u80FD\u4F1A\u8BA9\u4F60\u89C9\u5F97\u6709\u70B9\u5947\u602A\u3002</p><p>\u4EE5\u4E0B\u662F\u8FD9\u79CD\u505A\u6CD5\u7684\u4F18\u70B9\uFF1A</p><ul><li>Redis \u547D\u4EE4\u53EA\u4F1A\u56E0\u4E3A\u9519\u8BEF\u7684\u8BED\u6CD5\u800C\u5931\u8D25\uFF08\u5E76\u4E14\u8FD9\u4E9B\u95EE\u9898\u4E0D\u80FD\u5728\u5165\u961F\u65F6\u53D1\u73B0\uFF09\uFF0C\u6216\u662F\u547D\u4EE4\u7528\u5728\u4E86\u9519\u8BEF\u7C7B\u578B\u7684\u952E\u4E0A\u9762\uFF1A\u8FD9\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4ECE\u5B9E\u7528\u6027\u7684\u89D2\u5EA6\u6765\u8BF4\uFF0C\u5931\u8D25\u7684\u547D\u4EE4\u662F\u7531\u7F16\u7A0B\u9519\u8BEF\u9020\u6210\u7684\uFF0C\u800C\u8FD9\u4E9B\u9519\u8BEF\u5E94\u8BE5\u5728\u5F00\u53D1\u7684\u8FC7\u7A0B\u4E2D\u88AB\u53D1\u73B0\uFF0C\u800C\u4E0D\u5E94\u8BE5\u51FA\u73B0\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u3002</li><li>\u56E0\u4E3A\u4E0D\u9700\u8981\u5BF9\u56DE\u6EDA\u8FDB\u884C\u652F\u6301\uFF0C\u6240\u4EE5 Redis \u7684\u5185\u90E8\u53EF\u4EE5\u4FDD\u6301\u7B80\u5355\u4E14\u5FEB\u901F\u3002</li></ul>',206),Cn=s("\u6709\u79CD\u89C2\u70B9\u8BA4\u4E3A Redis \u5904\u7406\u4E8B\u52A1\u7684\u505A\u6CD5\u4F1A\u4EA7\u751F bug \uFF0C \u7136\u800C\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C \u5728\u901A\u5E38\u60C5\u51B5\u4E0B\uFF0C \u56DE\u6EDA\u5E76\u4E0D\u80FD\u89E3\u51B3\u7F16\u7A0B\u9519\u8BEF\u5E26\u6765\u7684\u95EE\u9898\u3002 \u4E3E\u4E2A\u4F8B\u5B50\uFF0C \u5982\u679C\u4F60\u672C\u6765\u60F3\u901A\u8FC7 "),xn={href:"http://redis.cn/commands/incr.html",target:"_blank",rel:"noopener noreferrer"},Sn=s("INCR"),Pn=s(" \u547D\u4EE4\u5C06\u952E\u7684\u503C\u52A0\u4E0A 1 \uFF0C \u5374\u4E0D\u5C0F\u5FC3\u52A0\u4E0A\u4E86 2 \uFF0C \u53C8\u6216\u8005\u5BF9\u9519\u8BEF\u7C7B\u578B\u7684\u952E\u6267\u884C\u4E86 "),An={href:"http://redis.cn/commands/incr.html",target:"_blank",rel:"noopener noreferrer"},Bn=s("INCR"),qn=s(" \uFF0C \u56DE\u6EDA\u662F\u6CA1\u6709\u529E\u6CD5\u5904\u7406\u8FD9\u4E9B\u60C5\u51B5\u7684\u3002"),En=e('<h2 id="redis\u96C6\u7FA4\u65B9\u6848\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#redis\u96C6\u7FA4\u65B9\u6848\u6709\u54EA\u4E9B" aria-hidden="true">#</a> redis\u96C6\u7FA4\u65B9\u6848\u6709\u54EA\u4E9B</h2><h3 id="\u5E38\u89C1\u96C6\u7FA4\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u5E38\u89C1\u96C6\u7FA4\u5206\u7C7B" aria-hidden="true">#</a> \u5E38\u89C1\u96C6\u7FA4\u5206\u7C7B</h3><p>\u4E3B\u4ECE\u590D\u5236\u96C6\u7FA4</p><p>\u5206\u7247\u96C6\u7FA4</p><h3 id="redis\u6709\u90A3\u4E9B" tabindex="-1"><a class="header-anchor" href="#redis\u6709\u90A3\u4E9B" aria-hidden="true">#</a> redis\u6709\u90A3\u4E9B\uFF1A</h3><p>\u4E3B\u4ECE\u590D\u5236\u96C6\u7FA4\uFF0C\u624B\u52A8\u5207\u6362</p><p>\u5E26\u6709\u54E8\u5175\u7684HA\u7684\u4E3B\u4ECE\u590D\u5236\u96C6\u7FA4</p><p>\u5BA2\u6237\u7AEF\u5B9E\u73B0\u8DEF\u7531\u7D22\u5F15\u7684\u5206\u7247\u96C6\u7FA4</p><p>\u4F7F\u7528\u4E2D\u95F4\u4EF6\u4EE3\u7406\u5C42\u7684\u5206\u7247\u96C6\u7FA4</p><p>redis\u81EA\u8EAB\u5B9E\u73B0\u7684cluster\u5206\u7247\u96C6\u7FA4</p><h2 id="redis\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#redis\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> redis\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406\u662F\u4EC0\u4E48</h2><h3 id="\u4E3B\u4ECE\u590D\u5236\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u590D\u5236\u673A\u5236" aria-hidden="true">#</a> \u4E3B\u4ECE\u590D\u5236\u673A\u5236</h3><blockquote><p>\u5F53\u4E00\u4E2A master \u5B9E\u4F8B\u548C\u4E00\u4E2A slave \u5B9E\u4F8B\u8FDE\u63A5\u6B63\u5E38\u65F6\uFF0C master \u4F1A\u53D1\u9001\u4E00\u8FDE\u4E32\u7684\u547D\u4EE4\u6D41\u6765\u4FDD\u6301\u5BF9 slave \u7684\u66F4\u65B0\uFF0C\u4EE5\u4FBF\u4E8E\u5C06\u81EA\u8EAB\u6570\u636E\u96C6\u7684\u6539\u53D8\u590D\u5236\u7ED9 slave \uFF0C \uFF1A\u5305\u62EC\u5BA2\u6237\u7AEF\u7684\u5199\u5165\u3001key \u7684\u8FC7\u671F\u6216\u88AB\u9010\u51FA\u7B49\u7B49\u3002</p><p>\u5F53 master \u548C slave \u4E4B\u95F4\u7684\u8FDE\u63A5\u65AD\u5F00\u4E4B\u540E\uFF0C\u56E0\u4E3A\u7F51\u7EDC\u95EE\u9898\u3001\u6216\u8005\u662F\u4E3B\u4ECE\u610F\u8BC6\u5230\u8FDE\u63A5\u8D85\u65F6\uFF0C slave \u91CD\u65B0\u8FDE\u63A5\u4E0A master \u5E76\u4F1A\u5C1D\u8BD5\u8FDB\u884C\u90E8\u5206\u91CD\u540C\u6B65\uFF1A\u8FD9\u610F\u5473\u7740\u5B83\u4F1A\u5C1D\u8BD5\u53EA\u83B7\u53D6\u5728\u65AD\u5F00\u8FDE\u63A5\u671F\u95F4\u5185\u4E22\u5931\u7684\u547D\u4EE4\u6D41\u3002</p><p>\u5F53\u65E0\u6CD5\u8FDB\u884C\u90E8\u5206\u91CD\u540C\u6B65\u65F6\uFF0C slave \u4F1A\u8BF7\u6C42\u8FDB\u884C\u5168\u91CF\u91CD\u540C\u6B65\u3002\u8FD9\u4F1A\u6D89\u53CA\u5230\u4E00\u4E2A\u66F4\u590D\u6742\u7684\u8FC7\u7A0B\uFF0C\u4F8B\u5982 master \u9700\u8981\u521B\u5EFA\u6240\u6709\u6570\u636E\u7684\u5FEB\u7167\uFF0C\u5C06\u4E4B\u53D1\u9001\u7ED9 slave \uFF0C\u4E4B\u540E\u5728\u6570\u636E\u96C6\u66F4\u6539\u65F6\u6301\u7EED\u53D1\u9001\u547D\u4EE4\u6D41\u5230 slave \u3002</p></blockquote><h3 id="\u4E3B\u4ECE\u590D\u5236\u7684\u5173\u6CE8\u70B9" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u590D\u5236\u7684\u5173\u6CE8\u70B9" aria-hidden="true">#</a> \u4E3B\u4ECE\u590D\u5236\u7684\u5173\u6CE8\u70B9</h3><blockquote><p>Redis \u4F7F\u7528\u5F02\u6B65\u590D\u5236\uFF0Cslave \u548C master \u4E4B\u95F4\u5F02\u6B65\u5730\u786E\u8BA4\u5904\u7406\u7684\u6570\u636E\u91CF</p><p>\u4E00\u4E2A master \u53EF\u4EE5\u62E5\u6709\u591A\u4E2A slave</p><p>slave \u53EF\u4EE5\u63A5\u53D7\u5176\u4ED6 slave \u7684\u8FDE\u63A5\u3002\u9664\u4E86\u591A\u4E2A slave \u53EF\u4EE5\u8FDE\u63A5\u5230\u540C\u4E00\u4E2A master \u4E4B\u5916\uFF0C slave \u4E4B\u95F4\u4E5F\u53EF\u4EE5\u50CF\u5C42\u53E0\u72B6\u7684\u7ED3\u6784\uFF08cascading-like structure\uFF09\u8FDE\u63A5\u5230\u5176\u4ED6 slave \u3002\u81EA Redis 4.0 \u8D77\uFF0C\u6240\u6709\u7684 sub-slave \u5C06\u4F1A\u4ECE master \u6536\u5230\u5B8C\u5168\u4E00\u6837\u7684\u590D\u5236\u6D41\u3002</p><p>Redis \u590D\u5236\u5728 master \u4FA7\u662F\u975E\u963B\u585E\u7684\u3002\u8FD9\u610F\u5473\u7740 master \u5728\u4E00\u4E2A\u6216\u591A\u4E2A slave \u8FDB\u884C\u521D\u6B21\u540C\u6B65\u6216\u8005\u662F\u90E8\u5206\u91CD\u540C\u6B65\u65F6\uFF0C\u53EF\u4EE5\u7EE7\u7EED\u5904\u7406\u67E5\u8BE2\u8BF7\u6C42\u3002</p><p>\u590D\u5236\u5728 slave \u4FA7\u5927\u90E8\u5206\u4E5F\u662F\u975E\u963B\u585E\u7684\u3002\u5F53 slave \u8FDB\u884C\u521D\u6B21\u540C\u6B65\u65F6\uFF0C\u5B83\u53EF\u4EE5\u4F7F\u7528\u65E7\u6570\u636E\u96C6\u5904\u7406\u67E5\u8BE2\u8BF7\u6C42\uFF0C\u5047\u8BBE\u4F60\u5728 redis.conf \u4E2D\u914D\u7F6E\u4E86\u8BA9 Redis \u8FD9\u6837\u505A\u7684\u8BDD\u3002\u5426\u5219\uFF0C\u4F60\u53EF\u4EE5\u914D\u7F6E\u5982\u679C\u590D\u5236\u6D41\u65AD\u5F00\uFF0C Redis slave \u4F1A\u8FD4\u56DE\u4E00\u4E2A error \u7ED9\u5BA2\u6237\u7AEF\u3002\u4F46\u662F\uFF0C\u5728\u521D\u6B21\u540C\u6B65\u4E4B\u540E\uFF0C\u65E7\u6570\u636E\u96C6\u5FC5\u987B\u88AB\u5220\u9664\uFF0C\u540C\u65F6\u52A0\u8F7D\u65B0\u7684\u6570\u636E\u96C6\u3002 slave \u5728\u8FD9\u4E2A\u77ED\u6682\u7684\u65F6\u95F4\u7A97\u53E3\u5185\uFF08\u5982\u679C\u6570\u636E\u96C6\u5F88\u5927\uFF0C\u4F1A\u6301\u7EED\u8F83\u957F\u65F6\u95F4\uFF09\uFF0C\u4F1A\u963B\u585E\u5230\u6765\u7684\u8FDE\u63A5\u8BF7\u6C42\u3002\u81EA Redis 4.0 \u5F00\u59CB\uFF0C\u53EF\u4EE5\u914D\u7F6E Redis \u4F7F\u5220\u9664\u65E7\u6570\u636E\u96C6\u7684\u64CD\u4F5C\u5728\u53E6\u4E00\u4E2A\u4E0D\u540C\u7684\u7EBF\u7A0B\u4E2D\u8FDB\u884C\uFF0C\u4F46\u662F\uFF0C\u52A0\u8F7D\u65B0\u6570\u636E\u96C6\u7684\u64CD\u4F5C\u4F9D\u7136\u9700\u8981\u5728\u4E3B\u7EBF\u7A0B\u4E2D\u8FDB\u884C\u5E76\u4E14\u4F1A\u963B\u585E slave \u3002</p><p>\u590D\u5236\u65E2\u53EF\u4EE5\u88AB\u7528\u5728\u53EF\u4F38\u7F29\u6027\uFF0C\u4EE5\u4FBF\u53EA\u8BFB\u67E5\u8BE2\u53EF\u4EE5\u6709\u591A\u4E2A slave \u8FDB\u884C\uFF08\u4F8B\u5982 O(N) \u590D\u6742\u5EA6\u7684\u6162\u64CD\u4F5C\u53EF\u4EE5\u88AB\u4E0B\u653E\u5230 slave \uFF09\uFF0C\u6216\u8005\u4EC5\u7528\u4E8E\u6570\u636E\u5B89\u5168\u3002</p><p>\u53EF\u4EE5\u4F7F\u7528\u590D\u5236\u6765\u907F\u514D master \u5C06\u5168\u90E8\u6570\u636E\u96C6\u5199\u5165\u78C1\u76D8\u9020\u6210\u7684\u5F00\u9500\uFF1A\u4E00\u79CD\u5178\u578B\u7684\u6280\u672F\u662F\u914D\u7F6E\u4F60\u7684 master Redis.conf \u4EE5\u907F\u514D\u5BF9\u78C1\u76D8\u8FDB\u884C\u6301\u4E45\u5316\uFF0C\u7136\u540E\u8FDE\u63A5\u4E00\u4E2A slave \uFF0C\u5176\u914D\u7F6E\u4E3A\u4E0D\u5B9A\u671F\u4FDD\u5B58\u6216\u662F\u542F\u7528 AOF\u3002\u4F46\u662F\uFF0C\u8FD9\u4E2A\u8BBE\u7F6E\u5FC5\u987B\u5C0F\u5FC3\u5904\u7406\uFF0C\u56E0\u4E3A\u91CD\u65B0\u542F\u52A8\u7684 master \u7A0B\u5E8F\u5C06\u4ECE\u4E00\u4E2A\u7A7A\u6570\u636E\u96C6\u5F00\u59CB\uFF1A\u5982\u679C\u4E00\u4E2A slave \u8BD5\u56FE\u4E0E\u5B83\u540C\u6B65\uFF0C\u90A3\u4E48\u8FD9\u4E2A slave \u4E5F\u4F1A\u88AB\u6E05\u7A7A\u3002</p><p>\u4EFB\u4F55\u65F6\u5019\u6570\u636E\u5B89\u5168\u6027\u90FD\u662F\u5F88\u91CD\u8981\u7684\uFF0C\u6240\u4EE5\u5982\u679C master \u4F7F\u7528\u590D\u5236\u529F\u80FD\u7684\u540C\u65F6\u672A\u914D\u7F6E\u6301\u4E45\u5316\uFF0C\u90A3\u4E48\u81EA\u52A8\u91CD\u542F\u8FDB\u7A0B\u8FD9\u9879\u5E94\u8BE5\u88AB\u7981\u7528\u3002</p></blockquote><h3 id="redis-\u590D\u5236\u529F\u80FD\u662F\u5982\u4F55\u5DE5\u4F5C\u7684" tabindex="-1"><a class="header-anchor" href="#redis-\u590D\u5236\u529F\u80FD\u662F\u5982\u4F55\u5DE5\u4F5C\u7684" aria-hidden="true">#</a> Redis \u590D\u5236\u529F\u80FD\u662F\u5982\u4F55\u5DE5\u4F5C\u7684</h3><p>\u6BCF\u4E00\u4E2A Redis master \u90FD\u6709\u4E00\u4E2A replication ID \uFF1A\u8FD9\u662F\u4E00\u4E2A\u8F83\u5927\u7684\u4F2A\u968F\u673A\u5B57\u7B26\u4E32\uFF0C\u6807\u8BB0\u4E86\u4E00\u4E2A\u7ED9\u5B9A\u7684\u6570\u636E\u96C6\u3002\u6BCF\u4E2A master \u4E5F\u6301\u6709\u4E00\u4E2A\u504F\u79FB\u91CF\uFF0Cmaster \u5C06\u81EA\u5DF1\u4EA7\u751F\u7684\u590D\u5236\u6D41\u53D1\u9001\u7ED9 slave \u65F6\uFF0C\u53D1\u9001\u591A\u5C11\u4E2A\u5B57\u8282\u7684\u6570\u636E\uFF0C\u81EA\u8EAB\u7684\u504F\u79FB\u91CF\u5C31\u4F1A\u589E\u52A0\u591A\u5C11\uFF0C\u76EE\u7684\u662F\u5F53\u6709\u65B0\u7684\u64CD\u4F5C\u4FEE\u6539\u81EA\u5DF1\u7684\u6570\u636E\u96C6\u65F6\uFF0C\u5B83\u53EF\u4EE5\u4EE5\u6B64\u66F4\u65B0 slave \u7684\u72B6\u6001\u3002\u590D\u5236\u504F\u79FB\u91CF\u5373\u4F7F\u5728\u6CA1\u6709\u4E00\u4E2A slave \u8FDE\u63A5\u5230 master \u65F6\uFF0C\u4E5F\u4F1A\u81EA\u589E\uFF0C\u6240\u4EE5\u57FA\u672C\u4E0A\u6BCF\u4E00\u5BF9\u7ED9\u5B9A\u7684</p><blockquote><p>Replication ID, offset</p></blockquote><p>\u90FD\u4F1A\u6807\u8BC6\u4E00\u4E2A master \u6570\u636E\u96C6\u7684\u786E\u5207\u7248\u672C\u3002</p><p>\u5F53 slave \u8FDE\u63A5\u5230 master \u65F6\uFF0C\u5B83\u4EEC\u4F7F\u7528 PSYNC \u547D\u4EE4\u6765\u53D1\u9001\u5B83\u4EEC\u8BB0\u5F55\u7684\u65E7\u7684 master replication ID \u548C\u5B83\u4EEC\u81F3\u4ECA\u4E3A\u6B62\u5904\u7406\u7684\u504F\u79FB\u91CF\u3002\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\uFF0C master \u80FD\u591F\u4EC5\u53D1\u9001 slave \u6240\u9700\u7684\u589E\u91CF\u90E8\u5206\u3002\u4F46\u662F\u5982\u679C master \u7684\u7F13\u51B2\u533A\u4E2D\u6CA1\u6709\u8DB3\u591F\u7684\u547D\u4EE4\u79EF\u538B\u7F13\u51B2\u8BB0\u5F55\uFF0C\u6216\u8005\u5982\u679C slave \u5F15\u7528\u4E86\u4E0D\u518D\u77E5\u9053\u7684\u5386\u53F2\u8BB0\u5F55\uFF08replication ID\uFF09\uFF0C\u5219\u4F1A\u8F6C\u800C\u8FDB\u884C\u4E00\u4E2A\u5168\u91CF\u91CD\u540C\u6B65\uFF1A\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C slave \u4F1A\u5F97\u5230\u4E00\u4E2A\u5B8C\u6574\u7684\u6570\u636E\u96C6\u526F\u672C\uFF0C\u4ECE\u5934\u5F00\u59CB\u3002</p><p>\u4E0B\u9762\u662F\u4E00\u4E2A\u5168\u91CF\u540C\u6B65\u7684\u5DE5\u4F5C\u7EC6\u8282\uFF1A</p><p>master \u5F00\u542F\u4E00\u4E2A\u540E\u53F0\u4FDD\u5B58\u8FDB\u7A0B\uFF0C\u4EE5\u4FBF\u4E8E\u751F\u4EA7\u4E00\u4E2A RDB \u6587\u4EF6\u3002\u540C\u65F6\u5B83\u5F00\u59CB\u7F13\u51B2\u6240\u6709\u4ECE\u5BA2\u6237\u7AEF\u63A5\u6536\u5230\u7684\u65B0\u7684\u5199\u5165\u547D\u4EE4\u3002\u5F53\u540E\u53F0\u4FDD\u5B58\u5B8C\u6210\u65F6\uFF0C master \u5C06\u6570\u636E\u96C6\u6587\u4EF6\u4F20\u8F93\u7ED9 slave\uFF0C slave\u5C06\u4E4B\u4FDD\u5B58\u5728\u78C1\u76D8\u4E0A\uFF0C\u7136\u540E\u52A0\u8F7D\u6587\u4EF6\u5230\u5185\u5B58\u3002\u518D\u7136\u540E master \u4F1A\u53D1\u9001\u6240\u6709\u7F13\u51B2\u7684\u547D\u4EE4\u53D1\u7ED9 slave\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u4EE5\u6307\u4EE4\u6D41\u7684\u5F62\u5F0F\u5B8C\u6210\u5E76\u4E14\u548C Redis \u534F\u8BAE\u672C\u8EAB\u7684\u683C\u5F0F\u76F8\u540C\u3002</p>',22),Rn=s("\u4F60\u53EF\u4EE5\u7528 telnet \u81EA\u5DF1\u8FDB\u884C\u5C1D\u8BD5\u3002\u5728\u670D\u52A1\u5668\u6B63\u5728\u505A\u4E00\u4E9B\u5DE5\u4F5C\u7684\u540C\u65F6\u8FDE\u63A5\u5230 Redis \u7AEF\u53E3\u5E76\u53D1\u51FA "),Mn={href:"https://redis.io/commands/sync",target:"_blank",rel:"noopener noreferrer"},Dn=s("SYNC"),Tn=s(" \u547D\u4EE4\u3002\u4F60\u5C06\u4F1A\u770B\u5230\u4E00\u4E2A\u6279\u91CF\u4F20\u8F93\uFF0C\u5E76\u4E14\u4E4B\u540E\u6BCF\u4E00\u4E2A master \u63A5\u6536\u5230\u7684\u547D\u4EE4\u90FD\u5C06\u5728 telnet \u56DE\u8BDD\u4E2D\u88AB\u91CD\u65B0\u53D1\u51FA\u3002\u4E8B\u5B9E\u4E0A SYNC \u662F\u4E00\u4E2A\u65E7\u534F\u8BAE\uFF0C\u5728\u65B0\u7684 Redis \u5B9E\u4F8B\u4E2D\u5DF2\u7ECF\u4E0D\u518D\u88AB\u4F7F\u7528\uFF0C\u4F46\u662F\u5176\u4ECD\u7136\u5411\u540E\u517C\u5BB9\uFF1A\u4F46\u5B83\u4E0D\u5141\u8BB8\u90E8\u5206\u91CD\u540C\u6B65\uFF0C\u6240\u4EE5\u73B0\u5728 "),jn=n("strong",null,"PSYNC",-1),In=s(" \u88AB\u7528\u6765\u66FF\u4EE3 SYNC\u3002"),On=e(`<p>\u4E4B\u524D\u8BF4\u8FC7\uFF0C\u5F53\u4E3B\u4ECE\u4E4B\u95F4\u7684\u8FDE\u63A5\u56E0\u4E3A\u4E00\u4E9B\u539F\u56E0\u5D29\u6E83\u4E4B\u540E\uFF0C slave \u80FD\u591F\u81EA\u52A8\u91CD\u8FDE\u3002\u5982\u679C master \u6536\u5230\u4E86\u591A\u4E2A slave \u8981\u6C42\u540C\u6B65\u7684\u8BF7\u6C42\uFF0C\u5B83\u4F1A\u6267\u884C\u4E00\u4E2A\u5355\u72EC\u7684\u540E\u53F0\u4FDD\u5B58\uFF0C\u4EE5\u4FBF\u4E8E\u4E3A\u591A\u4E2A slave \u670D\u52A1\u3002</p><h3 id="\u65E0\u9700\u78C1\u76D8\u53C2\u4E0E\u7684\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u65E0\u9700\u78C1\u76D8\u53C2\u4E0E\u7684\u590D\u5236" aria-hidden="true">#</a> \u65E0\u9700\u78C1\u76D8\u53C2\u4E0E\u7684\u590D\u5236</h3><p>\u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u4E00\u4E2A\u5168\u91CF\u91CD\u540C\u6B65\u8981\u6C42\u5728\u78C1\u76D8\u4E0A\u521B\u5EFA\u4E00\u4E2A RDB \u6587\u4EF6\uFF0C\u7136\u540E\u5C06\u5B83\u4ECE\u78C1\u76D8\u52A0\u8F7D\u8FDB\u5185\u5B58\uFF0C\u7136\u540E slave\u4EE5\u6B64\u8FDB\u884C\u6570\u636E\u540C\u6B65\u3002</p><p>\u5982\u679C\u78C1\u76D8\u6027\u80FD\u5F88\u4F4E\u7684\u8BDD\uFF0C\u8FD9\u5BF9 master \u662F\u4E00\u4E2A\u538B\u529B\u5F88\u5927\u7684\u64CD\u4F5C\u3002Redis 2.8.18 \u662F\u7B2C\u4E00\u4E2A\u652F\u6301\u65E0\u78C1\u76D8\u590D\u5236\u7684\u7248\u672C\u3002\u5728\u6B64\u8BBE\u7F6E\u4E2D\uFF0C\u5B50\u8FDB\u7A0B\u76F4\u63A5\u53D1\u9001 RDB \u6587\u4EF6\u7ED9 slave\uFF0C\u65E0\u9700\u4F7F\u7528\u78C1\u76D8\u4F5C\u4E3A\u4E2D\u95F4\u50A8\u5B58\u4ECB\u8D28\u3002</p><h2 id="redis\u7F13\u5B58\u5982\u4F55\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#redis\u7F13\u5B58\u5982\u4F55\u56DE\u6536" aria-hidden="true">#</a> redis\u7F13\u5B58\u5982\u4F55\u56DE\u6536</h2><h3 id="\u56DE\u6536\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u56DE\u6536\u7B56\u7565" aria-hidden="true">#</a> \u56DE\u6536\u7B56\u7565</h3><blockquote><p>noeviction:\u8FD4\u56DE\u9519\u8BEF\u5F53\u5185\u5B58\u9650\u5236\u8FBE\u5230\u5E76\u4E14\u5BA2\u6237\u7AEF\u5C1D\u8BD5\u6267\u884C\u4F1A\u8BA9\u66F4\u591A\u5185\u5B58\u88AB\u4F7F\u7528\u7684\u547D\u4EE4\uFF08\u5927\u90E8\u5206\u7684\u5199\u5165\u6307\u4EE4\uFF0C\u4F46DEL\u548C\u51E0\u4E2A\u4F8B\u5916\uFF09</p><p>allkeys-lru: \u5C1D\u8BD5\u56DE\u6536\u6700\u5C11\u4F7F\u7528\u7684\u952E\uFF08LRU\uFF09\uFF0C\u4F7F\u5F97\u65B0\u6DFB\u52A0\u7684\u6570\u636E\u6709\u7A7A\u95F4\u5B58\u653E\u3002</p><p>volatile-lru: \u5C1D\u8BD5\u56DE\u6536\u6700\u5C11\u4F7F\u7528\u7684\u952E\uFF08LRU\uFF09\uFF0C\u4F46\u4EC5\u9650\u4E8E\u5728\u8FC7\u671F\u96C6\u5408\u7684\u952E,\u4F7F\u5F97\u65B0\u6DFB\u52A0\u7684\u6570\u636E\u6709\u7A7A\u95F4\u5B58\u653E\u3002</p><p>allkeys-random: \u56DE\u6536\u968F\u673A\u7684\u952E\u4F7F\u5F97\u65B0\u6DFB\u52A0\u7684\u6570\u636E\u6709\u7A7A\u95F4\u5B58\u653E\u3002</p><p>volatile-random: \u56DE\u6536\u968F\u673A\u7684\u952E\u4F7F\u5F97\u65B0\u6DFB\u52A0\u7684\u6570\u636E\u6709\u7A7A\u95F4\u5B58\u653E\uFF0C\u4F46\u4EC5\u9650\u4E8E\u5728\u8FC7\u671F\u96C6\u5408\u7684\u952E\u3002</p><p>volatile-ttl: \u56DE\u6536\u5728\u8FC7\u671F\u96C6\u5408\u7684\u952E\uFF0C\u5E76\u4E14\u4F18\u5148\u56DE\u6536\u5B58\u6D3B\u65F6\u95F4\uFF08TTL\uFF09\u8F83\u77ED\u7684\u952E,\u4F7F\u5F97\u65B0\u6DFB\u52A0\u7684\u6570\u636E\u6709\u7A7A\u95F4\u5B58\u653E\u3002</p><p>volatile-lfu\uFF1A\u4ECE\u6240\u6709\u914D\u7F6E\u4E86\u8FC7\u671F\u65F6\u95F4\u7684\u952E\u4E2D\u9A71\u9010\u4F7F\u7528\u9891\u7387\u6700\u5C11\u7684\u952E</p><p>allkeys-lfu\uFF1A\u4ECE\u6240\u6709\u952E\u4E2D\u9A71\u9010\u4F7F\u7528\u9891\u7387\u6700\u5C11\u7684\u952E</p></blockquote><p>\u5982\u679C\u6CA1\u6709\u952E\u6EE1\u8DB3\u56DE\u6536\u7684\u524D\u63D0\u6761\u4EF6\u7684\u8BDD\uFF0C\u7B56\u7565<strong>volatile-lru</strong>, <strong>volatile-random</strong>\u4EE5\u53CA<strong>volatile-ttl</strong>\u5C31\u548Cnoeviction \u5DEE\u4E0D\u591A\u4E86\u3002</p><p>\u9009\u62E9\u6B63\u786E\u7684\u56DE\u6536\u7B56\u7565\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u8FD9\u53D6\u51B3\u4E8E\u4F60\u7684\u5E94\u7528\u7684\u8BBF\u95EE\u6A21\u5F0F\uFF0C\u4E0D\u8FC7\u4F60\u53EF\u4EE5\u5728\u8FD0\u884C\u65F6\u8FDB\u884C\u76F8\u5173\u7684\u7B56\u7565\u8C03\u6574\uFF0C\u5E76\u4E14\u76D1\u63A7\u7F13\u5B58\u547D\u4E2D\u7387\u548C\u6CA1\u547D\u4E2D\u7684\u6B21\u6570\uFF0C\u901A\u8FC7RedisINFO\u547D\u4EE4\u8F93\u51FA\u4EE5\u4FBF\u8C03\u4F18\u3002</p><p>\u4E00\u822C\u7684\u7ECF\u9A8C\u89C4\u5219:</p><ul><li>\u4F7F\u7528<strong>allkeys-lru</strong>\u7B56\u7565\uFF1A\u5F53\u4F60\u5E0C\u671B\u4F60\u7684\u8BF7\u6C42\u7B26\u5408\u4E00\u4E2A\u5E42\u5B9A\u5F8B\u5206\u5E03\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4F60\u5E0C\u671B\u90E8\u5206\u7684\u5B50\u96C6\u5143\u7D20\u5C06\u6BD4\u5176\u5B83\u5176\u5B83\u5143\u7D20\u88AB\u8BBF\u95EE\u7684\u66F4\u591A\u3002\u5982\u679C\u4F60\u4E0D\u786E\u5B9A\u9009\u62E9\u4EC0\u4E48\uFF0C\u8FD9\u662F\u4E2A\u5F88\u597D\u7684\u9009\u62E9\u3002.</li><li>\u4F7F\u7528<strong>allkeys-random</strong>\uFF1A\u5982\u679C\u4F60\u662F\u5FAA\u73AF\u8BBF\u95EE\uFF0C\u6240\u6709\u7684\u952E\u88AB\u8FDE\u7EED\u7684\u626B\u63CF\uFF0C\u6216\u8005\u4F60\u5E0C\u671B\u8BF7\u6C42\u5206\u5E03\u6B63\u5E38\uFF08\u6240\u6709\u5143\u7D20\u88AB\u8BBF\u95EE\u7684\u6982\u7387\u90FD\u5DEE\u4E0D\u591A\uFF09\u3002</li><li>\u4F7F\u7528<strong>volatile-ttl</strong>\uFF1A\u5982\u679C\u4F60\u60F3\u8981\u901A\u8FC7\u521B\u5EFA\u7F13\u5B58\u5BF9\u8C61\u65F6\u8BBE\u7F6ETTL\u503C\uFF0C\u6765\u51B3\u5B9A\u54EA\u4E9B\u5BF9\u8C61\u5E94\u8BE5\u88AB\u8FC7\u671F\u3002</li></ul><p><strong>allkeys-lru</strong> \u548C <strong>volatile-random</strong>\u7B56\u7565\u5BF9\u4E8E\u5F53\u4F60\u60F3\u8981\u5355\u4E00\u7684\u5B9E\u4F8B\u5B9E\u73B0\u7F13\u5B58\u53CA\u6301\u4E45\u5316\u4E00\u4E9B\u952E\u65F6\u5F88\u6709\u7528\u3002\u4E0D\u8FC7\u4E00\u822C\u8FD0\u884C\u4E24\u4E2A\u5B9E\u4F8B\u662F\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u7684\u66F4\u597D\u65B9\u6CD5\u3002</p><p>\u4E3A\u4E86\u952E\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u4E5F\u662F\u9700\u8981\u6D88\u8017\u5185\u5B58\u7684\uFF0C\u6240\u4EE5\u4F7F\u7528<strong>allkeys-lru</strong>\u8FD9\u79CD\u7B56\u7565\u66F4\u52A0\u9AD8\u6548\uFF0C\u56E0\u4E3A\u6CA1\u6709\u5FC5\u8981\u4E3A\u952E\u53D6\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u5F53\u5185\u5B58\u6709\u538B\u529B\u65F6\u3002</p><h3 id="\u56DE\u6536\u8FDB\u7A0B\u5982\u4F55\u5DE5\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u56DE\u6536\u8FDB\u7A0B\u5982\u4F55\u5DE5\u4F5C" aria-hidden="true">#</a> <strong>\u56DE\u6536\u8FDB\u7A0B\u5982\u4F55\u5DE5\u4F5C</strong></h3><p>\u7406\u89E3\u56DE\u6536\u8FDB\u7A0B\u5982\u4F55\u5DE5\u4F5C\u662F\u975E\u5E38\u91CD\u8981\u7684:</p><ul><li>\u4E00\u4E2A\u5BA2\u6237\u7AEF\u8FD0\u884C\u4E86\u65B0\u7684\u547D\u4EE4\uFF0C\u6DFB\u52A0\u4E86\u65B0\u7684\u6570\u636E\u3002</li><li>Redi\u68C0\u67E5\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\uFF0C\u5982\u679C\u5927\u4E8Emaxmemory\u7684\u9650\u5236, \u5219\u6839\u636E\u8BBE\u5B9A\u597D\u7684\u7B56\u7565\u8FDB\u884C\u56DE\u6536\u3002</li><li>\u4E00\u4E2A\u65B0\u7684\u547D\u4EE4\u88AB\u6267\u884C\uFF0C\u7B49\u7B49\u3002</li><li>\u6240\u4EE5\u6211\u4EEC\u4E0D\u65AD\u5730\u7A7F\u8D8A\u5185\u5B58\u9650\u5236\u7684\u8FB9\u754C\uFF0C\u901A\u8FC7\u4E0D\u65AD\u8FBE\u5230\u8FB9\u754C\u7136\u540E\u4E0D\u65AD\u5730\u56DE\u6536\u56DE\u5230\u8FB9\u754C\u4EE5\u4E0B\u3002</li></ul><p>\u5982\u679C\u4E00\u4E2A\u547D\u4EE4\u7684\u7ED3\u679C\u5BFC\u81F4\u5927\u91CF\u5185\u5B58\u88AB\u4F7F\u7528\uFF08\u4F8B\u5982\u5F88\u5927\u7684\u96C6\u5408\u7684\u4EA4\u96C6\u4FDD\u5B58\u5230\u4E00\u4E2A\u65B0\u7684\u952E\uFF09\uFF0C\u4E0D\u7528\u591A\u4E45\u5185\u5B58\u9650\u5236\u5C31\u4F1A\u88AB\u8FD9\u4E2A\u5185\u5B58\u4F7F\u7528\u91CF\u8D85\u8D8A\u3002</p><h2 id="rabbitmq\u7684\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837\u7684" tabindex="-1"><a class="header-anchor" href="#rabbitmq\u7684\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837\u7684" aria-hidden="true">#</a> RabbitMQ\u7684\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837\u7684</h2><h3 id="\u662Famqp\u7684\u5B9E\u73B0-\u76F8\u5173\u6982\u5FF5\u8BED\u4E49" tabindex="-1"><a class="header-anchor" href="#\u662Famqp\u7684\u5B9E\u73B0-\u76F8\u5173\u6982\u5FF5\u8BED\u4E49" aria-hidden="true">#</a> \u662FAMQP\u7684\u5B9E\u73B0\uFF0C\u76F8\u5173\u6982\u5FF5\u8BED\u4E49</h3><ol><li>Broker:\u5B83\u63D0\u4F9B\u4E00\u79CD\u4F20\u8F93\u670D\u52A1,\u5B83\u7684\u89D2\u8272\u5C31\u662F\u7EF4\u62A4\u4E00\u6761\u4ECE\u751F\u4EA7\u8005\u5230\u6D88\u8D39\u8005\u7684\u8DEF\u7EBF\uFF0C\u4FDD\u8BC1\u6570\u636E\u80FD\u6309\u7167\u6307\u5B9A\u7684\u65B9\u5F0F\u8FDB\u884C\u4F20\u8F93</li><li>Exchange\uFF1A\u6D88\u606F\u4EA4\u6362\u673A,\u5B83\u6307\u5B9A\u6D88\u606F\u6309\u4EC0\u4E48\u89C4\u5219,\u8DEF\u7531\u5230\u54EA\u4E2A\u961F\u5217\u3002</li><li>Queue:\u6D88\u606F\u7684\u8F7D\u4F53,\u6BCF\u4E2A\u6D88\u606F\u90FD\u4F1A\u88AB\u6295\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u961F\u5217\u3002</li><li>Binding:\u7ED1\u5B9A\uFF0C\u5B83\u7684\u4F5C\u7528\u5C31\u662F\u628Aexchange\u548Cqueue\u6309\u7167\u8DEF\u7531\u89C4\u5219\u7ED1\u5B9A\u8D77\u6765.</li><li>Routing Key:\u8DEF\u7531\u5173\u952E\u5B57,exchange\u6839\u636E\u8FD9\u4E2A\u5173\u952E\u5B57\u8FDB\u884C\u6D88\u606F\u6295\u9012\u3002</li><li>vhost:\u865A\u62DF\u4E3B\u673A,\u4E00\u4E2Abroker\u91CC\u53EF\u4EE5\u6709\u591A\u4E2Avhost\uFF0C\u7528\u4F5C\u4E0D\u540C\u7528\u6237\u7684\u6743\u9650\u5206\u79BB\u3002</li><li>Producer:\u6D88\u606F\u751F\u4EA7\u8005,\u5C31\u662F\u6295\u9012\u6D88\u606F\u7684\u7A0B\u5E8F.</li><li>Consumer:\u6D88\u606F\u6D88\u8D39\u8005,\u5C31\u662F\u63A5\u53D7\u6D88\u606F\u7684\u7A0B\u5E8F.</li><li>Channel:\u6D88\u606F\u901A\u9053,\u5728\u5BA2\u6237\u7AEF\u7684\u6BCF\u4E2A\u8FDE\u63A5\u91CC,\u53EF\u5EFA\u7ACB\u591A\u4E2Achannel.</li></ol><h4 id="\u6838\u5FC3\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#\u6838\u5FC3\u6982\u5FF5" aria-hidden="true">#</a> \u6838\u5FC3\u6982\u5FF5</h4><p>\u5728mq\u9886\u57DF\u4E2D\uFF0Cproducer\u5C06msg\u53D1\u9001\u5230queue\uFF0C\u7136\u540Econsumer\u901A\u8FC7\u6D88\u8D39queue\u5B8C\u6210P.C\u89E3\u8026</p><p>kafka\u662F\u7531producer\u51B3\u5B9Amsg\u53D1\u9001\u5230\u90A3\u4E2Aqueue</p><p>rabbitmq\u662F\u7531Exchange\u51B3\u5B9Amsg\u5E94\u8BE5\u600E\u4E48\u6837\u53D1\u9001\u5230\u76EE\u6807queue\uFF0C\u8FD9\u5C31\u662Fbinding\u53CA\u5BF9\u5E94\u7684\u7B56\u7565</p><h4 id="exchange" tabindex="-1"><a class="header-anchor" href="#exchange" aria-hidden="true">#</a> Exchange</h4><p>Direct Exchange:\u76F4\u63A5\u5339\u914D,\u901A\u8FC7Exchange\u540D\u79F0+RountingKey\u6765\u53D1\u9001\u4E0E\u63A5\u6536\u6D88\u606F. Fanout Exchange:\u5E7F\u64AD\u8BA2\u9605,\u5411\u6240\u6709\u7684\u6D88\u8D39\u8005\u53D1\u5E03\u6D88\u606F,\u4F46\u662F\u53EA\u6709\u6D88\u8D39\u8005\u5C06\u961F\u5217\u7ED1\u5B9A\u5230\u8BE5\u8DEF\u7531\u5668\u624D\u80FD\u6536\u5230\u6D88\u606F,\u5FFD\u7565Routing Key. Topic Exchange\uFF1A\u4E3B\u9898\u5339\u914D\u8BA2\u9605,\u8FD9\u91CC\u7684\u4E3B\u9898\u6307\u7684\u662FRoutingKey,RoutingKey\u53EF\u4EE5\u91C7\u7528\u901A\u914D\u7B26,\u5982:* \u6216#\uFF0CRoutingKey\u547D\u540D\u91C7\u7528.\u6765\u5206\u9694\u591A\u4E2A\u8BCD,\u53EA\u6709\u6D88\u606F\u8FD9\u5C06\u961F\u5217\u7ED1\u5B9A\u5230\u8BE5\u8DEF\u7531\u5668\u4E14\u6307\u5B9ARoutingKey\u7B26\u5408\u5339\u914D\u89C4\u5219\u65F6\u624D\u80FD\u6536\u5230\u6D88\u606F; Headers Exchange:\u6D88\u606F\u5934\u8BA2\u9605,\u6D88\u606F\u53D1\u5E03\u524D,\u4E3A\u6D88\u606F\u5B9A\u4E49\u4E00\u4E2A\u6216\u591A\u4E2A\u952E\u503C\u5BF9\u7684\u6D88\u606F\u5934,\u7136\u540E\u6D88\u8D39\u8005\u63A5\u6536\u6D88\u606F\u540C\u65F6\u9700\u8981\u5B9A\u4E49\u7C7B\u4F3C\u7684\u952E\u503C\u5BF9\u8BF7\u6C42\u5934:(\u5982:x-mactch=all\u6216\u8005x_match=any) \uFF0C\u53EA\u6709\u8BF7\u6C42\u5934\u4E0E\u6D88\u606F\u5934\u5339\u914D,\u624D\u80FD\u63A5\u6536\u6D88\u606F,\u5FFD\u7565RoutingKey. \u9ED8\u8BA4\u7684exchange: \u5982\u679C\u7528\u7A7A\u5B57\u7B26\u4E32\u53BB\u58F0\u660E\u4E00\u4E2Aexchange\uFF0C\u90A3\u4E48\u7CFB\u7EDF\u5C31\u4F1A\u4F7F\u7528\u201Damq.direct\u201D\u8FD9\u4E2Aexchange\uFF0C\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2Aqueue\u65F6,\u9ED8\u8BA4\u7684\u90FD\u4F1A\u6709\u4E00\u4E2A\u548C\u65B0\u5EFAqueue\u540C\u540D\u7684routingKey\u7ED1\u5B9A\u5230\u8FD9\u4E2A\u9ED8\u8BA4\u7684exchange\u4E0A\u53BB</p><h3 id="\u590D\u6742\u4E0E\u7CBE\u7B80" tabindex="-1"><a class="header-anchor" href="#\u590D\u6742\u4E0E\u7CBE\u7B80" aria-hidden="true">#</a> \u590D\u6742\u4E0E\u7CBE\u7B80</h3><p>\u5728\u4F17\u591A\u7684MQ\u4E2D\u95F4\u4EF6\u4E2D\uFF0C\u9996\u5148\u5B66\u4E60Rabbitmq\u7684\u65F6\u5019\uFF0C\u5C31\u7406\u89E3\u4ED6\u662F\u4E00\u4E2A\u5355\u673A\u7684mq\u7EC4\u4EF6\uFF0C\u4E3A\u4E86\u7CFB\u7EDF\u7684\u89E3\u8026\uFF0C\u53EF\u4EE5\u81EA\u5DF1\u5728\u4E1A\u52A1\u5C42\u9762\u505AAKF</p><p>\u5176\u5728\u5185\u5377\u80FD\u529B\u505A\u7684\u975E\u5E38\u51FA\u8272\uFF0C\u8FD9\u5F97\u76CA\u4E8EAMQP\uFF0C\u4E5F\u5C31\u662F\u6D88\u606F\u7684\u4F20\u9012\u5F62\u5F0F\u3001\u590D\u6742\u5EA6\u6709exchange\u548Cqueue\u7684binding\u5B9E\u73B0\uFF0C\u8FD9\uFF0C\u5BF9\u4E8EP.C\u6709\u5F88\u5927\u7684\u5E2E\u52A9</p><hr><h2 id="rabbitmq\u5982\u4F55\u786E\u4FDD\u6D88\u606F\u53D1\u9001\u548C\u6D88\u606F\u63A5\u6536" tabindex="-1"><a class="header-anchor" href="#rabbitmq\u5982\u4F55\u786E\u4FDD\u6D88\u606F\u53D1\u9001\u548C\u6D88\u606F\u63A5\u6536" aria-hidden="true">#</a> RabbitMQ\u5982\u4F55\u786E\u4FDD\u6D88\u606F\u53D1\u9001\u548C\u6D88\u606F\u63A5\u6536</h2><h3 id="\u6D88\u606F\u53D1\u9001\u786E\u8BA4" tabindex="-1"><a class="header-anchor" href="#\u6D88\u606F\u53D1\u9001\u786E\u8BA4" aria-hidden="true">#</a> \u6D88\u606F\u53D1\u9001\u786E\u8BA4</h3><h4 id="_1-confirmcallback\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_1-confirmcallback\u65B9\u6CD5" aria-hidden="true">#</a> 1 ConfirmCallback\u65B9\u6CD5</h4><p>ConfirmCallback \u662F\u4E00\u4E2A\u56DE\u8C03\u63A5\u53E3\uFF0C\u6D88\u606F\u53D1\u9001\u5230 Broker \u540E\u89E6\u53D1\u56DE\u8C03\uFF0C\u786E\u8BA4\u6D88\u606F\u662F\u5426\u5230\u8FBE Broker \u670D\u52A1\u5668\uFF0C<strong>\u4E5F\u5C31\u662F\u53EA\u786E\u8BA4\u662F\u5426\u6B63\u786E\u5230\u8FBE Exchange \u4E2D\u3002</strong></p><h4 id="_2-returncallback\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_2-returncallback\u65B9\u6CD5" aria-hidden="true">#</a> 2 ReturnCallback\u65B9\u6CD5</h4><p>\u901A\u8FC7\u5B9E\u73B0 ReturnCallback \u63A5\u53E3\uFF0C\u542F\u52A8\u6D88\u606F\u5931\u8D25\u8FD4\u56DE\uFF0C\u6B64\u63A5\u53E3\u662F\u5728\u4EA4\u6362\u5668\u8DEF\u7531\u4E0D\u5230\u961F\u5217\u65F6\u89E6\u53D1\u56DE\u8C03\uFF0C\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u4E0D\u4F7F\u7528\uFF0C\u56E0\u4E3A\u4EA4\u6362\u5668\u548C\u961F\u5217\u662F\u5728\u4EE3\u7801\u91CC\u7ED1\u5B9A\u7684\uFF0C\u5982\u679C\u6D88\u606F\u6210\u529F\u6295\u9012\u5230 Broker \u540E\u51E0\u4E4E\u4E0D\u5B58\u5728\u7ED1\u5B9A\u961F\u5217\u5931\u8D25\uFF0C\u9664\u975E\u4F60\u4EE3\u7801\u5199\u9519\u4E86\u3002</p><h3 id="\u6D88\u606F\u63A5\u6536\u786E\u8BA4" tabindex="-1"><a class="header-anchor" href="#\u6D88\u606F\u63A5\u6536\u786E\u8BA4" aria-hidden="true">#</a> \u6D88\u606F\u63A5\u6536\u786E\u8BA4</h3><p>RabbitMQ \u6D88\u606F\u786E\u8BA4\u673A\u5236\uFF08ACK\uFF09\u9ED8\u8BA4\u662F\u81EA\u52A8\u786E\u8BA4\u7684\uFF0C\u81EA\u52A8\u786E\u8BA4\u4F1A\u5728\u6D88\u606F\u53D1\u9001\u7ED9\u6D88\u8D39\u8005\u540E\u7ACB\u5373\u786E\u8BA4\uFF0C\u4F46\u5B58\u5728\u4E22\u5931\u6D88\u606F\u7684\u53EF\u80FD\uFF0C\u5982\u679C\u6D88\u8D39\u7AEF\u6D88\u8D39\u903B\u8F91\u629B\u51FA\u5F02\u5E38\uFF0C\u5047\u5982\u4F60\u7528\u56DE\u6EDA\u4E86\u4E5F\u53EA\u662F\u4FDD\u8BC1\u4E86\u6570\u636E\u7684\u4E00\u81F4\u6027\uFF0C\u4F46\u662F\u6D88\u606F\u8FD8\u662F\u4E22\u4E86\uFF0C\u4E5F\u5C31\u662F\u6D88\u8D39\u7AEF\u6CA1\u6709\u5904\u7406\u6210\u529F\u8FD9\u6761\u6D88\u606F\uFF0C\u90A3\u4E48\u5C31\u76F8\u5F53\u4E8E\u4E22\u5931\u4E86\u6D88\u606F\u3002</p><p>\u6D88\u606F\u786E\u8BA4\u6A21\u5F0F\u6709\uFF1A</p><ol><li>AcknowledgeMode.NONE\uFF1A\u81EA\u52A8\u786E\u8BA4\u3002</li><li>AcknowledgeMode.AUTO\uFF1A\u6839\u636E\u60C5\u51B5\u786E\u8BA4\u3002</li><li>AcknowledgeMode.MANUAL\uFF1A\u624B\u52A8\u786E\u8BA4\u3002</li></ol><p>\u6D88\u8D39\u8005\u6536\u5230\u6D88\u606F\u540E\uFF0C\u624B\u52A8\u8C03\u7528 Basic.Ack \u6216 Basic.Nack \u6216 Basic.Reject \u540E\uFF0CRabbitMQ \u6536\u5230\u8FD9\u4E9B\u6D88\u606F\u540E\uFF0C\u624D\u8BA4\u4E3A\u672C\u6B21\u6295\u9012\u5B8C\u6210\u3002</p><ol start="4"><li>Basic.Ack \u547D\u4EE4\uFF1A\u7528\u4E8E\u786E\u8BA4\u5F53\u524D\u6D88\u606F\u3002</li><li>Basic.Nack \u547D\u4EE4\uFF1A\u7528\u4E8E\u5426\u5B9A\u5F53\u524D\u6D88\u606F\uFF08\u6CE8\u610F\uFF1A\u8FD9\u662FAMQP 0-9-1\u7684RabbitMQ\u6269\u5C55\uFF09 \u3002</li><li>Basic.Reject \u547D\u4EE4\uFF1A\u7528\u4E8E\u62D2\u7EDD\u5F53\u524D\u6D88\u606F\u3002</li></ol><p>Nack,Reject\u540E\u90FD\u6709\u80FD\u529B\u8981\u6C42\u662F\u5426requeue\u6D88\u606F\u6216\u8005\u8FDB\u5165\u6B7B\u4FE1\u961F\u5217</p><h2 id="rabbitmq\u4E8B\u52A1\u6D88\u606F\u539F\u7406\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#rabbitmq\u4E8B\u52A1\u6D88\u606F\u539F\u7406\u662F\u4EC0\u4E48" aria-hidden="true">#</a> RabbitMQ\u4E8B\u52A1\u6D88\u606F\u539F\u7406\u662F\u4EC0\u4E48</h2><h3 id="\u4E8B\u52A1v-s\u786E\u8BA4" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u52A1v-s\u786E\u8BA4" aria-hidden="true">#</a> \u4E8B\u52A1V.S\u786E\u8BA4</h3><p>\u786E\u8BA4\u662F\u5BF9\u4E00\u4EF6\u4E8B\u7684\u786E\u8BA4</p><p>\u4E8B\u52A1\u662F\u5BF9\u6279\u91CF\u7684\u786E\u8BA4</p><p>\u589E\u5220\u6539\u67E5\u4E2D\uFF0C\u4E8B\u52A1\u662F\u5BF9\u4E8E\u589E\u5220\u6539\u7684\u4FDD\u8BC1</p><h3 id="\u53D1\u9001\u65B9\u4E8B\u52A1" tabindex="-1"><a class="header-anchor" href="#\u53D1\u9001\u65B9\u4E8B\u52A1" aria-hidden="true">#</a> \u53D1\u9001\u65B9\u4E8B\u52A1</h3><p>\u5F00\u542F\u4E8B\u52A1\uFF0C\u53D1\u9001\u591A\u6761\u6570\u636E\uFF0C\u4E8B\u52A1\u63D0\u4EA4\u6216\u56DE\u6EDA\u662F\u539F\u5B50\u7684\uFF0C\u8981\u4E48\u90FD\u63D0\u4EA4\uFF0C\u8981\u4E48\u90FD\u56DE\u6EDA</p><h3 id="\u6D88\u8D39\u65B9\u4E8B\u52A1" tabindex="-1"><a class="header-anchor" href="#\u6D88\u8D39\u65B9\u4E8B\u52A1" aria-hidden="true">#</a> \u6D88\u8D39\u65B9\u4E8B\u52A1</h3><p>\u6D88\u8D39\u65B9\u662F\u8BFB\u53D6\u884C\u4E3A\uFF0C\u90A3\u4E48\u4E8B\u52A1\u4F53\u73B0\u5728\u54EA\u91CC\u5462</p><p>rabbitmq\u7684\u6D88\u8D39\u884C\u4E3A\u4F1A\u89E6\u53D1queue\u4E2Dmsg\u7684\u662F\u5426\u5220\u9664\u3001\u662F\u5426\u91CD\u65B0\u653E\u56DE\u961F\u5217\u7B49\u884C\u4E3A\uFF0C\u7C7B\u589E\u5220\u6539</p><p>\u6240\u4EE5\uFF0C\u6D88\u8D39\u65B9\u7684ack\u662F\u8981\u624B\u52A8\u63D0\u4EA4\u7684\uFF0C\u4E14\u6700\u7EC8\u786E\u5B9A\u4EE5\u4E8B\u52A1\u7684\u63D0\u4EA4\u548C\u56DE\u6EDA\u51B3\u5B9A</p><h2 id="rabbitmq\u6B7B\u4FE1\u961F\u5217\u3001\u5EF6\u65F6\u961F\u5217\u5206\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#rabbitmq\u6B7B\u4FE1\u961F\u5217\u3001\u5EF6\u65F6\u961F\u5217\u5206\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> RabbitMQ\u6B7B\u4FE1\u961F\u5217\u3001\u5EF6\u65F6\u961F\u5217\u5206\u522B\u662F\u4EC0\u4E48</h2><h3 id="\u6B7B\u4FE1\u961F\u5217" tabindex="-1"><a class="header-anchor" href="#\u6B7B\u4FE1\u961F\u5217" aria-hidden="true">#</a> \u6B7B\u4FE1\u961F\u5217</h3><p>DLX\uFF08Dead Letter Exchange\uFF09\uFF0C<strong>\u6B7B\u4FE1\u4EA4\u6362\u5668</strong>\u3002</p><p>\u5F53\u961F\u5217\u4E2D\u7684\u6D88\u606F\u88AB\u62D2\u7EDD\u3001\u6216\u8005\u8FC7\u671F\u4F1A\u53D8\u6210\u6B7B\u4FE1\uFF0C\u6B7B\u4FE1\u53EF\u4EE5\u88AB\u91CD\u65B0\u53D1\u5E03\u5230\u53E6\u4E00\u4E2A\u4EA4\u6362\u5668\uFF0C\u8FD9\u4E2A\u4EA4\u6362\u5668\u5C31\u662FDLX\uFF0C\u4E0EDLX\u7ED1\u5B9A\u7684\u961F\u5217\u79F0\u4E3A\u6B7B\u4FE1\u961F\u5217\u3002 \u9020\u6210\u6B7B\u4FE1\u7684\u539F\u56E0\uFF1A</p><ul><li>\u4FE1\u606F\u88AB\u62D2\u7EDD</li><li>\u4FE1\u606F\u8D85\u65F6</li><li>\u8D85\u8FC7\u4E86\u961F\u5217\u7684\u6700\u5927\u957F\u5EA6</li></ul><h4 id="\u8FC7\u671F\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u8FC7\u671F\u6D88\u606F" aria-hidden="true">#</a> \u8FC7\u671F\u6D88\u606F\uFF1A</h4><pre><code>\u5728 rabbitmq \u4E2D\u5B58\u57282\u79CD\u65B9\u53EF\u8BBE\u7F6E\u6D88\u606F\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u7B2C\u4E00\u79CD\u901A\u8FC7\u5BF9\u961F\u5217\u8FDB\u884C\u8BBE\u7F6E\uFF0C\u8FD9\u79CD\u8BBE\u7F6E\u540E\uFF0C\u8BE5\u961F\u5217\u4E2D\u6240\u6709\u7684\u6D88\u606F\u90FD\u5B58\u5728\u76F8\u540C\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u7B2C\u4E8C\u79CD\u901A\u8FC7\u5BF9\u6D88\u606F\u672C\u8EAB\u8FDB\u884C\u8BBE\u7F6E\uFF0C\u90A3\u4E48\u6BCF\u6761\u6D88\u606F\u7684\u8FC7\u671F\u65F6\u95F4\u90FD\u4E0D\u4E00\u6837\u3002\u5982\u679C\u540C\u65F6\u4F7F\u7528\u8FD92\u79CD\u65B9\u6CD5\uFF0C\u90A3\u4E48\u4EE5\u8FC7\u671F\u65F6\u95F4\u5C0F\u7684\u90A3\u4E2A\u6570\u503C\u4E3A\u51C6\u3002\u5F53\u6D88\u606F\u8FBE\u5230\u8FC7\u671F\u65F6\u95F4\u8FD8\u6CA1\u6709\u88AB\u6D88\u8D39\uFF0C\u90A3\u4E48\u90A3\u4E2A\u6D88\u606F\u5C31\u6210\u4E3A\u4E86\u4E00\u4E2A \u6B7B\u4FE1 \u6D88\u606F\u3002

\u961F\u5217\u8BBE\u7F6E\uFF1A\u5728\u961F\u5217\u7533\u660E\u7684\u65F6\u5019\u4F7F\u7528 x-message-ttl \u53C2\u6570\uFF0C\u5355\u4F4D\u4E3A \u6BEB\u79D2

\u5355\u4E2A\u6D88\u606F\u8BBE\u7F6E\uFF1A\u662F\u8BBE\u7F6E\u6D88\u606F\u5C5E\u6027\u7684 expiration \u53C2\u6570\u7684\u503C\uFF0C\u5355\u4F4D\u4E3A \u6BEB\u79D2
</code></pre><h3 id="\u5EF6\u8FDF\u961F\u5217" tabindex="-1"><a class="header-anchor" href="#\u5EF6\u8FDF\u961F\u5217" aria-hidden="true">#</a> \u5EF6\u8FDF\u961F\u5217</h3><p>\u5EF6\u8FDF\u961F\u5217\u5B58\u50A8\u7684\u662F\u5EF6\u8FDF\u6D88\u606F</p><p>\u5EF6\u8FDF\u6D88\u606F\u6307\u7684\u662F\uFF0C\u5F53\u6D88\u606F\u88AB\u53D1\u53D1\u5E03\u51FA\u53BB\u4E4B\u540E\uFF0C\u5E76\u4E0D\u7ACB\u5373\u6295\u9012\u7ED9\u6D88\u8D39\u8005\uFF0C\u800C\u662F\u5728\u6307\u5B9A\u65F6\u95F4\u4E4B\u540E\u6295\u9012\u3002\u5982\uFF1A</p><p>\u5728\u8BA2\u5355\u7CFB\u7EDF\u4E2D\uFF0C\u8BA2\u5355\u670930\u79D2\u7684\u4ED8\u6B3E\u65F6\u95F4\uFF0C\u5728\u8BA2\u5355\u8D85\u65F6\u4E4B\u540E\u5728\u6295\u9012\u7ED9\u6D88\u8D39\u8005\u5904\u7406\u8D85\u65F6\u8BA2\u5355\u3002</p><p>rabbitMq\u6CA1\u6709\u76F4\u63A5\u652F\u6301\u5EF6\u8FDF\u961F\u5217\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6B7B\u4FE1\u961F\u5217\u5B9E\u73B0\u3002</p><p>\u5728\u6B7B\u4FE1\u961F\u5217\u4E2D\uFF0C\u53EF\u4EE5\u4E3A\u666E\u901A\u4EA4\u6362\u5668\u7ED1\u5B9A\u591A\u4E2A\u6D88\u606F\u961F\u5217\uFF0C\u5047\u8BBE\u7ED1\u5B9A\u8FC7\u671F\u65F6\u95F4\u4E3A5\u5206\u949F\uFF0C10\u5206\u949F\u548C30\u5206\u949F\uFF0C3\u4E2A\u6D88\u606F\u961F\u5217\uFF0C\u7136\u540E\u4E3A\u6BCF\u4E2A\u6D88\u606F\u961F\u5217\u8BBE\u7F6EDLX\uFF0C\u4E3A\u6BCF\u4E2ADLX\u5173\u8054\u4E00\u4E2A\u6B7B\u4FE1\u961F\u5217\u3002</p><p>\u5F53\u6D88\u606F\u8FC7\u671F\u4E4B\u540E\uFF0C\u88AB\u8F6C\u5B58\u5230\u5BF9\u5E94\u7684\u6B7B\u4FE1\u961F\u5217\u4E2D\uFF0C\u7136\u540E\u6295\u9012\u7ED9\u6307\u5B9A\u7684\u6D88\u8D39\u8005\u6D88\u8D39\u3002</p><h2 id="\u7B80\u8FF0kafka\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837" tabindex="-1"><a class="header-anchor" href="#\u7B80\u8FF0kafka\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837" aria-hidden="true">#</a> \u7B80\u8FF0kafka\u67B6\u6784\u8BBE\u8BA1\u662F\u4EC0\u4E48\u6837</h2><p>\u8BED\u4E49\u6982\u5FF5</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1 broker
Kafka \u96C6\u7FA4\u5305\u542B\u4E00\u4E2A\u6216\u591A\u4E2A\u670D\u52A1\u5668\uFF0C\u670D\u52A1\u5668\u8282\u70B9\u79F0\u4E3Abroker\u3002

broker\u5B58\u50A8topic\u7684\u6570\u636E\u3002\u5982\u679C\u67D0topic\u6709N\u4E2Apartition\uFF0C\u96C6\u7FA4\u6709N\u4E2Abroker\uFF0C\u90A3\u4E48\u6BCF\u4E2Abroker\u5B58\u50A8\u8BE5topic\u7684\u4E00\u4E2Apartition\u3002

\u5982\u679C\u67D0topic\u6709N\u4E2Apartition\uFF0C\u96C6\u7FA4\u6709(N+M)\u4E2Abroker\uFF0C\u90A3\u4E48\u5176\u4E2D\u6709N\u4E2Abroker\u5B58\u50A8\u8BE5topic\u7684\u4E00\u4E2Apartition\uFF0C\u5269\u4E0B\u7684M\u4E2Abroker\u4E0D\u5B58\u50A8\u8BE5topic\u7684partition\u6570\u636E\u3002

\u5982\u679C\u67D0topic\u6709N\u4E2Apartition\uFF0C\u96C6\u7FA4\u4E2Dbroker\u6570\u76EE\u5C11\u4E8EN\u4E2A\uFF0C\u90A3\u4E48\u4E00\u4E2Abroker\u5B58\u50A8\u8BE5topic\u7684\u4E00\u4E2A\u6216\u591A\u4E2Apartition\u3002\u5728\u5B9E\u9645\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u5C3D\u91CF\u907F\u514D\u8FD9\u79CD\u60C5\u51B5\u7684\u53D1\u751F\uFF0C\u8FD9\u79CD\u60C5\u51B5\u5BB9\u6613\u5BFC\u81F4Kafka\u96C6\u7FA4\u6570\u636E\u4E0D\u5747\u8861\u3002

2 Topic
\u6BCF\u6761\u53D1\u5E03\u5230Kafka\u96C6\u7FA4\u7684\u6D88\u606F\u90FD\u6709\u4E00\u4E2A\u7C7B\u522B\uFF0C\u8FD9\u4E2A\u7C7B\u522B\u88AB\u79F0\u4E3ATopic\u3002\uFF08\u7269\u7406\u4E0A\u4E0D\u540CTopic\u7684\u6D88\u606F\u5206\u5F00\u5B58\u50A8\uFF0C\u903B\u8F91\u4E0A\u4E00\u4E2ATopic\u7684\u6D88\u606F\u867D\u7136\u4FDD\u5B58\u4E8E\u4E00\u4E2A\u6216\u591A\u4E2Abroker\u4E0A\u4F46\u7528\u6237\u53EA\u9700\u6307\u5B9A\u6D88\u606F\u7684Topic\u5373\u53EF\u751F\u4EA7\u6216\u6D88\u8D39\u6570\u636E\u800C\u4E0D\u5FC5\u5173\u5FC3\u6570\u636E\u5B58\u4E8E\u4F55\u5904\uFF09

\u7C7B\u4F3C\u4E8E\u6570\u636E\u5E93\u7684\u8868\u540D

3 Partition
topic\u4E2D\u7684\u6570\u636E\u5206\u5272\u4E3A\u4E00\u4E2A\u6216\u591A\u4E2Apartition\u3002\u6BCF\u4E2Atopic\u81F3\u5C11\u6709\u4E00\u4E2Apartition\u3002\u6BCF\u4E2Apartition\u4E2D\u7684\u6570\u636E\u4F7F\u7528\u591A\u4E2Asegment\u6587\u4EF6\u5B58\u50A8\u3002partition\u4E2D\u7684\u6570\u636E\u662F\u6709\u5E8F\u7684\uFF0C\u4E0D\u540Cpartition\u95F4\u7684\u6570\u636E\u4E22\u5931\u4E86\u6570\u636E\u7684\u987A\u5E8F\u3002\u5982\u679Ctopic\u6709\u591A\u4E2Apartition\uFF0C\u6D88\u8D39\u6570\u636E\u65F6\u5C31\u4E0D\u80FD\u4FDD\u8BC1\u6570\u636E\u7684\u987A\u5E8F\u3002\u5728\u9700\u8981\u4E25\u683C\u4FDD\u8BC1\u6D88\u606F\u7684\u6D88\u8D39\u987A\u5E8F\u7684\u573A\u666F\u4E0B\uFF0C\u9700\u8981\u5C06partition\u6570\u76EE\u8BBE\u4E3A1\u3002

4 Producer
\u751F\u4EA7\u8005\u5373\u6570\u636E\u7684\u53D1\u5E03\u8005\uFF0C\u8BE5\u89D2\u8272\u5C06\u6D88\u606F\u53D1\u5E03\u5230Kafka\u7684topic\u4E2D\u3002broker\u63A5\u6536\u5230\u751F\u4EA7\u8005\u53D1\u9001\u7684\u6D88\u606F\u540E\uFF0Cbroker\u5C06\u8BE5\u6D88\u606F\u8FFD\u52A0\u5230\u5F53\u524D\u7528\u4E8E\u8FFD\u52A0\u6570\u636E\u7684segment\u6587\u4EF6\u4E2D\u3002\u751F\u4EA7\u8005\u53D1\u9001\u7684\u6D88\u606F\uFF0C\u5B58\u50A8\u5230\u4E00\u4E2Apartition\u4E2D\uFF0C\u751F\u4EA7\u8005\u4E5F\u53EF\u4EE5\u6307\u5B9A\u6570\u636E\u5B58\u50A8\u7684partition\u3002

5 Consumer
\u6D88\u8D39\u8005\u53EF\u4EE5\u4ECEbroker\u4E2D\u8BFB\u53D6\u6570\u636E\u3002\u6D88\u8D39\u8005\u53EF\u4EE5\u6D88\u8D39\u591A\u4E2Atopic\u4E2D\u7684\u6570\u636E\u3002

6 Consumer Group
\u6BCF\u4E2AConsumer\u5C5E\u4E8E\u4E00\u4E2A\u7279\u5B9A\u7684Consumer Group\uFF08\u53EF\u4E3A\u6BCF\u4E2AConsumer\u6307\u5B9Agroup name\uFF0C\u82E5\u4E0D\u6307\u5B9Agroup name\u5219\u5C5E\u4E8E\u9ED8\u8BA4\u7684group\uFF09\u3002\u8FD9\u662Fkafka\u7528\u6765\u5B9E\u73B0\u4E00\u4E2Atopic\u6D88\u606F\u7684\u5E7F\u64AD\uFF08\u53D1\u7ED9\u6240\u6709\u7684consumer\uFF09\u548C\u5355\u64AD\uFF08\u53D1\u7ED9\u4EFB\u610F\u4E00\u4E2Aconsumer\uFF09\u7684\u624B\u6BB5\u3002\u4E00\u4E2Atopic\u53EF\u4EE5\u6709\u591A\u4E2ACG\u3002topic\u7684\u6D88\u606F\u4F1A\u590D\u5236-\u7ED9consumer\u3002\u5982\u679C\u9700\u8981\u5B9E\u73B0\u5E7F\u64AD\uFF0C\u53EA\u8981\u6BCF\u4E2Aconsumer\u6709\u4E00\u4E2A\u72EC\u7ACB\u7684CG\u5C31\u53EF\u4EE5\u4E86\u3002\u8981\u5B9E\u73B0\u5355\u64AD\u53EA\u8981\u6240\u6709\u7684consumer\u5728\u540C\u4E00\u4E2ACG\u3002\u7528CG\u8FD8\u53EF\u4EE5\u5C06consumer\u8FDB\u884C\u81EA\u7531\u7684\u5206\u7EC4\u800C\u4E0D\u9700\u8981\u591A\u6B21\u53D1\u9001\u6D88\u606F\u5230\u4E0D\u540C\u7684topic\u3002

7 Leader
\u6BCF\u4E2Apartition\u6709\u591A\u4E2A\u526F\u672C\uFF0C\u5176\u4E2D\u6709\u4E14\u4EC5\u6709\u4E00\u4E2A\u4F5C\u4E3ALeader\uFF0CLeader\u662F\u5F53\u524D\u8D1F\u8D23\u6570\u636E\u7684\u8BFB\u5199\u7684partition\u3002

8 Follower
Follower\u8DDF\u968FLeader\uFF0C\u6240\u6709\u5199\u8BF7\u6C42\u90FD\u901A\u8FC7Leader\u8DEF\u7531\uFF0C\u6570\u636E\u53D8\u66F4\u4F1A\u5E7F\u64AD\u7ED9\u6240\u6709Follower\uFF0CFollower\u4E0ELeader\u4FDD\u6301\u6570\u636E\u540C\u6B65\u3002\u5982\u679CLeader\u5931\u6548\uFF0C\u5219\u4ECEFollower\u4E2D\u9009\u4E3E\u51FA\u4E00\u4E2A\u65B0\u7684Leader\u3002\u5F53Follower\u4E0ELeader\u6302\u6389\u3001\u5361\u4F4F\u6216\u8005\u540C\u6B65\u592A\u6162\uFF0Cleader\u4F1A\u628A\u8FD9\u4E2Afollower\u4ECE\u201Cin sync replicas\u201D\uFF08ISR\uFF09\u5217\u8868\u4E2D\u5220\u9664\uFF0C\u91CD\u65B0\u521B\u5EFA\u4E00\u4E2AFollower\u3002

9 Offset
kafka\u7684\u5B58\u50A8\u6587\u4EF6\u90FD\u662F\u6309\u7167offset.kafka\u6765\u547D\u540D\uFF0C\u7528offset\u505A\u540D\u5B57\u7684\u597D\u5904\u662F\u65B9\u4FBF\u67E5\u627E\u3002\u4F8B\u5982\u4F60\u60F3\u627E\u4F4D\u4E8E2049\u7684\u4F4D\u7F6E\uFF0C\u53EA\u8981\u627E\u52302048.kafka\u7684\u6587\u4EF6\u5373\u53EF\u3002\u5F53\u7136the first offset\u5C31\u662F00000000000.kafka
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>KAFKA\u5929\u751F\u662F\u5206\u5E03\u5F0F\u7684\uFF0C\u6EE1\u8DB3AKF\u7684XYZ\u8F74\u7279\u70B9\uFF0C\u6269\u5C55\u6027\uFF0C\u53EF\u9760\u6027\uFF0C\u9AD8\u6027\u80FD\u662F\u6CA1\u5F97\u8BF4</p><p>\u800C\u4E14\uFF0Ckafka\u5177\u5907\u81EA\u5DF1\u7684\u7279\u8272\uFF0C\u6BD4\u5982\u52A8\u6001ISR\u96C6\u5408\uFF0C\u662F\u5728\u5F3A\u4E00\u81F4\u6027\uFF0C\u8FC7\u534A\u4E00\u81F4\u6027\u4E4B\u5916\u7684\u53E6\u4E00\u4E2A\u5B9E\u73B0\u624B\u6BB5</p><h2 id="kafka\u6D88\u606F\u4E22\u5931\u7684\u573A\u666F\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#kafka\u6D88\u606F\u4E22\u5931\u7684\u573A\u666F\u6709\u54EA\u4E9B" aria-hidden="true">#</a> Kafka\u6D88\u606F\u4E22\u5931\u7684\u573A\u666F\u6709\u54EA\u4E9B</h2><p>\u751F\u4EA7\u8005\u5728\u751F\u4EA7\u8FC7\u7A0B\u4E2D\u7684\u6D88\u606F\u4E22\u5931</p><p>broker\u5728\u6545\u969C\u540E\u7684\u6D88\u606F\u4E22\u5931</p><p>\u6D88\u8D39\u8005\u5728\u6D88\u8D39\u8FC7\u7A0B\u4E2D\u7684\u6D88\u606F\u4E22\u5931</p><h3 id="ack\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#ack\u673A\u5236" aria-hidden="true">#</a> ACK\u673A\u5236</h3><p>ack\u67093\u4E2A\u53EF\u9009\u503C\uFF0C\u5206\u522B\u662F1\uFF0C0\uFF0C-1\u3002</p><h3 id="ack-0-\u751F\u4EA7\u8005\u5728\u751F\u4EA7\u8FC7\u7A0B\u4E2D\u7684\u6D88\u606F\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#ack-0-\u751F\u4EA7\u8005\u5728\u751F\u4EA7\u8FC7\u7A0B\u4E2D\u7684\u6D88\u606F\u4E22\u5931" aria-hidden="true">#</a> ack=0\uFF1A\u751F\u4EA7\u8005\u5728\u751F\u4EA7\u8FC7\u7A0B\u4E2D\u7684\u6D88\u606F\u4E22\u5931</h3><p>\u7B80\u5355\u6765\u8BF4\u5C31\u662F\uFF0Cproducer\u53D1\u9001\u4E00\u6B21\u5C31\u4E0D\u518D\u53D1\u9001\u4E86\uFF0C\u4E0D\u7BA1\u662F\u5426\u53D1\u9001\u6210\u529F\u3002</p><h3 id="ack-1-broker\u5728\u6545\u969C\u540E\u7684\u6D88\u606F\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#ack-1-broker\u5728\u6545\u969C\u540E\u7684\u6D88\u606F\u4E22\u5931" aria-hidden="true">#</a> ack=1\uFF1Abroker\u5728\u6545\u969C\u540E\u7684\u6D88\u606F\u4E22\u5931</h3><p>\u7B80\u5355\u6765\u8BF4\u5C31\u662F\uFF0Cproducer\u53EA\u8981\u6536\u5230\u4E00\u4E2A\u5206\u533A\u526F\u672C\u6210\u529F\u5199\u5165\u7684\u901A\u77E5\u5C31\u8BA4\u4E3A\u63A8\u9001\u6D88\u606F\u6210\u529F\u4E86\u3002\u8FD9\u91CC\u6709\u4E00\u4E2A\u5730\u65B9\u9700\u8981\u6CE8\u610F\uFF0C\u8FD9\u4E2A\u526F\u672C\u5FC5\u987B\u662Fleader\u526F\u672C\u3002\u53EA\u6709leader\u526F\u672C\u6210\u529F\u5199\u5165\u4E86\uFF0Cproducer\u624D\u4F1A\u8BA4\u4E3A\u6D88\u606F\u53D1\u9001\u6210\u529F\u3002</p><p>\u6CE8\u610F\uFF0Cack\u7684\u9ED8\u8BA4\u503C\u5C31\u662F1\u3002\u8FD9\u4E2A\u9ED8\u8BA4\u503C\u5176\u5B9E\u5C31\u662F\u541E\u5410\u91CF\u4E0E\u53EF\u9760\u6027\u7684\u4E00\u4E2A\u6298\u4E2D\u65B9\u6848\u3002\u751F\u4EA7\u4E0A\u6211\u4EEC\u53EF\u4EE5\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u8FDB\u884C\u8C03\u6574\uFF0C\u6BD4\u5982\u5982\u679C\u4F60\u8981\u8FFD\u6C42\u9AD8\u541E\u5410\u91CF\uFF0C\u90A3\u4E48\u5C31\u8981\u653E\u5F03\u53EF\u9760\u6027\u3002</p><h3 id="ack-1-\u751F\u4EA7\u4FA7\u548C\u5B58\u50A8\u4FA7\u4E0D\u4F1A\u4E22\u5931\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#ack-1-\u751F\u4EA7\u4FA7\u548C\u5B58\u50A8\u4FA7\u4E0D\u4F1A\u4E22\u5931\u6570\u636E" aria-hidden="true">#</a> ack=-1\uFF1A\u751F\u4EA7\u4FA7\u548C\u5B58\u50A8\u4FA7\u4E0D\u4F1A\u4E22\u5931\u6570\u636E</h3><p>\u7B80\u5355\u6765\u8BF4\u5C31\u662F\uFF0Cproducer\u53EA\u6709\u6536\u5230\u5206\u533A\u5185\u6240\u6709\u526F\u672C\u7684\u6210\u529F\u5199\u5165\u7684\u901A\u77E5\u624D\u8BA4\u4E3A\u63A8\u9001\u6D88\u606F\u6210\u529F\u4E86\u3002</p><h3 id="offset\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#offset\u673A\u5236" aria-hidden="true">#</a> Offset\u673A\u5236</h3><ol><li>kafka\u6D88\u8D39\u8005\u7684\u4E09\u79CD\u6D88\u8D39\u8BED\u4E49</li><li>at-most-once\uFF1A\u6700\u591A\u4E00\u6B21\uFF0C\u53EF\u80FD\u4E22\u6570\u636E</li><li>at-least-once\uFF1A\u6700\u5C11\u4E00\u6B21\uFF0C\u53EF\u80FD\u91CD\u590D\u6D88\u8D39\u6570\u636E</li><li>exact-once message\uFF1A\u7CBE\u786E\u4E00\u6B21</li></ol><h2 id="kafka\u662Fpull-push-\u4EE5\u53CA\u4F18\u52A3\u52BF\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#kafka\u662Fpull-push-\u4EE5\u53CA\u4F18\u52A3\u52BF\u5206\u6790" aria-hidden="true">#</a> Kafka\u662Fpull\uFF1Fpush\uFF1F\u4EE5\u53CA\u4F18\u52A3\u52BF\u5206\u6790</h2><p>Kafka\u6700\u521D\u8003\u8651\u7684\u95EE\u9898\u662F\uFF0Ccustomer\u5E94\u8BE5\u4ECEbrokes\u62C9\u53D6\u6D88\u606F\u8FD8\u662Fbrokers\u5C06\u6D88\u606F\u63A8\u9001\u5230consumer\uFF0C\u4E5F\u5C31\u662Fpull\u8FD8push\u3002</p><p>Kafka\u9075\u5FAA\u4E86\u4E00\u79CD\u5927\u90E8\u5206\u6D88\u606F\u7CFB\u7EDF\u5171\u540C\u7684\u4F20\u7EDF\u7684\u8BBE\u8BA1\uFF1Aproducer\u5C06\u6D88\u606F\u63A8\u9001\u5230broker\uFF0Cconsumer\u4ECEbroker\u62C9\u53D6\u6D88\u606F\u3002</p><p>\u4E00\u4E9B\u6D88\u606F\u7CFB\u7EDF\u6BD4\u5982Scribe\u548CApache Flume\u91C7\u7528\u4E86push\u6A21\u5F0F\uFF0C\u5C06\u6D88\u606F\u63A8\u9001\u5230\u4E0B\u6E38\u7684consumer\u3002</p><p>\u8FD9\u6837\u505A\u6709\u597D\u5904\u4E5F\u6709\u574F\u5904\uFF1A\u7531broker\u51B3\u5B9A\u6D88\u606F\u63A8\u9001\u7684\u901F\u7387\uFF0C\u5BF9\u4E8E\u4E0D\u540C\u6D88\u8D39\u901F\u7387\u7684consumer\u5C31\u4E0D\u592A\u597D\u5904\u7406\u4E86\u3002</p><p>\u6D88\u606F\u7CFB\u7EDF\u90FD\u81F4\u529B\u4E8E\u8BA9consumer\u4EE5\u6700\u5927\u7684\u901F\u7387\u6700\u5FEB\u901F\u7684\u6D88\u8D39\u6D88\u606F\uFF0C\u4F46\u4E0D\u5E78\u7684\u662F\uFF0Cpush\u6A21\u5F0F\u4E0B\uFF0C\u5F53broker\u63A8\u9001\u7684\u901F\u7387\u8FDC\u5927\u4E8Econsumer\u6D88\u8D39\u7684\u901F\u7387\u65F6\uFF0Cconsumer\u6050\u6015\u5C31\u8981\u5D29\u6E83\u4E86\u3002</p><p>\u6700\u7EC8Kafka\u8FD8\u662F\u9009\u53D6\u4E86\u4F20\u7EDF\u7684pull\u6A21\u5F0F\u3002</p><p>Pull\u6A21\u5F0F\u7684\u53E6\u5916\u4E00\u4E2A\u597D\u5904\u662Fconsumer\u53EF\u4EE5\u81EA\u4E3B\u51B3\u5B9A\u662F\u5426\u6279\u91CF\u7684\u4ECEbroker\u62C9\u53D6\u6570\u636E\u3002</p><p>Push\u6A21\u5F0F\u5FC5\u987B\u5728\u4E0D\u77E5\u9053\u4E0B\u6E38consumer\u6D88\u8D39\u80FD\u529B\u548C\u6D88\u8D39\u7B56\u7565\u7684\u60C5\u51B5\u4E0B\u51B3\u5B9A\u662F\u7ACB\u5373\u63A8\u9001\u6BCF\u6761\u6D88\u606F\u8FD8\u662F\u7F13\u5B58\u4E4B\u540E\u6279\u91CF\u63A8\u9001\u3002</p><p>\u5982\u679C\u4E3A\u4E86\u907F\u514Dconsumer\u5D29\u6E83\u800C\u91C7\u7528\u8F83\u4F4E\u7684\u63A8\u9001\u901F\u7387\uFF0C\u5C06\u53EF\u80FD\u5BFC\u81F4\u4E00\u6B21\u53EA\u63A8\u9001\u8F83\u5C11\u7684\u6D88\u606F\u800C\u9020\u6210\u6D6A\u8D39\u3002</p><p>Pull\u6A21\u5F0F\u4E0B\uFF0Cconsumer\u5C31\u53EF\u4EE5\u6839\u636E\u81EA\u5DF1\u7684\u6D88\u8D39\u80FD\u529B\u53BB\u51B3\u5B9A\u8FD9\u4E9B\u7B56\u7565\u3002</p><p>Pull\u6709\u4E2A\u7F3A\u70B9\u662F\uFF0C\u5982\u679Cbroker\u6CA1\u6709\u53EF\u4F9B\u6D88\u8D39\u7684\u6D88\u606F\uFF0C\u5C06\u5BFC\u81F4consumer\u4E0D\u65AD\u5728\u5FAA\u73AF\u4E2D\u8F6E\u8BE2\uFF0C\u76F4\u5230\u65B0\u6D88\u606F\u5230\u8FBE\u3002</p><p>\u4E3A\u4E86\u907F\u514D\u8FD9\u70B9\uFF0CKafka\u6709\u4E2A\u53C2\u6570\u53EF\u4EE5\u8BA9consumer\u963B\u585E\u77E5\u9053\u65B0\u6D88\u606F\u5230\u8FBE(\u5F53\u7136\u4E5F\u53EF\u4EE5\u963B\u585E\u77E5\u9053\u6D88\u606F\u7684\u6570\u91CF\u8FBE\u5230\u67D0\u4E2A\u7279\u5B9A\u7684\u91CF\u8FD9\u6837\u5C31\u53EF\u4EE5\u6279\u91CF\u53D1</p><h2 id="kafka\u4E2Dzk\u7684\u4F5C\u7528\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#kafka\u4E2Dzk\u7684\u4F5C\u7528\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Kafka\u4E2Dzk\u7684\u4F5C\u7528\u662F\u4EC0\u4E48</h2><p>Zookeeper\u662F\u5206\u5E03\u5F0F\u534F\u8C03\uFF0C\u6CE8\u610F\u5B83\u4E0D\u662F\u6570\u636E\u5E93</p><p>kafka\u4E2D\u4F7F\u7528\u4E86zookeeper\u7684\u5206\u5E03\u5F0F\u9501\u548C\u5206\u5E03\u5F0F\u914D\u7F6E\u53CA\u7EDF\u4E00\u547D\u540D\u7684\u5206\u5E03\u5F0F\u534F\u8C03\u89E3\u51B3\u65B9\u6848</p><p>\u5728kafka\u7684broker\u96C6\u7FA4\u4E2D\u7684controller\u7684\u9009\u62E9\uFF0C\u662F\u901A\u8FC7zk\u7684\u4E34\u65F6\u8282\u70B9\u4E89\u62A2\u83B7\u5F97\u7684</p><p>brokerID\u7B49\u5982\u679C\u81EA\u589E\u7684\u8BDD\u4E5F\u662F\u901A\u8FC7zk\u7684\u8282\u70B9version\u5B9E\u73B0\u7684\u5168\u5C40\u552F\u4E00</p><p>kafka\u4E2Dbroker\u4E2D\u7684\u72B6\u6001\u6570\u636E\u4E5F\u662F\u5B58\u50A8\u5728zk\u4E2D\uFF0C\u4E0D\u8FC7\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0Czk\u4E0D\u662F\u6570\u636E\u5E93\uFF0C\u6240\u4EE5\u5B58\u50A8\u7684\u5C5E\u4E8E\u5143\u6570\u636E</p><p>\u800C\uFF0C\u65B0\u65E7\u7248\u672C\u53D8\u5316\u4E2D\uFF0C\u5C31\u628A\u66FE\u7ECF\u7684offset\u4ECEzk\u4E2D\u8FC1\u79FB\u51FA\u4E86zk</p><h2 id="kafka\u4E2D\u9AD8\u6027\u80FD\u5982\u4F55\u4FDD\u969C" tabindex="-1"><a class="header-anchor" href="#kafka\u4E2D\u9AD8\u6027\u80FD\u5982\u4F55\u4FDD\u969C" aria-hidden="true">#</a> Kafka\u4E2D\u9AD8\u6027\u80FD\u5982\u4F55\u4FDD\u969C</h2><p>\u9996\u5148\uFF0C\u6027\u80FD\u7684\u6700\u5927\u74F6\u9888\u4F9D\u7136\u662FIO\uFF0C\u8FD9\u4E2A\u662F\u4E0D\u80FD\u903E\u8D8A\u7684\u9E3F\u6C9F</p><p>\u867D\u7136\uFF0Cbroker\u5728\u6301\u4E45\u5316\u6570\u636E\u7684\u65F6\u5019\u5DF2\u7ECF\u6700\u5927\u52AA\u529B\u7684\u4F7F\u7528\u4E86\u78C1\u76D8\u7684\u987A\u5E8F\u8BFB\u5199</p><p>\u66F4\u8FDB\u4E00\u6B65\u7684\u6027\u80FD\u4F18\u5316\u662F\u96F6\u62F7\u8D1D\u7684\u4F7F\u7528\uFF0C\u4E5F\u5C31\u662F\u4ECE\u78C1\u76D8\u65E5\u5FD7\u5230\u6D88\u8D39\u8005\u5BA2\u6237\u7AEF\u7684\u6570\u636E\u4F20\u9012\uFF0C\u56E0\u4E3Akafka\u662Fmq\uFF0C\u5BF9\u4E8Emsg\u4E0D\u5177\u5907\u52A0\u5DE5\u5904\u7406\uFF0C\u6240\u4EE5\u5F97\u4EE5\u5B9E\u73B0</p><p>\u7136\u540E\u5C31\u662F\u5927\u591A\u6570\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E00\u6837\uFF0C\u603B\u8981\u505Atradeoff\uFF0C\u5728\u901F\u5EA6\u4E0E\u53EF\u7528\u6027/\u53EF\u9760\u6027\u4E2D\u6323\u624E</p><p>ACK\u76840\uFF0C1\uFF0C-1\u7EA7\u522B\u5C31\u662F\u5728\u6027\u80FD\u548C\u53EF\u9760\u4E2D\u6743\u8861</p><h2 id="kafka\u7684rebalance\u673A\u5236\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#kafka\u7684rebalance\u673A\u5236\u662F\u4EC0\u4E48" aria-hidden="true">#</a> kafka\u7684rebalance\u673A\u5236\u662F\u4EC0\u4E48</h2><h3 id="\u6D88\u8D39\u8005\u5206\u533A\u5206\u914D\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u6D88\u8D39\u8005\u5206\u533A\u5206\u914D\u7B56\u7565" aria-hidden="true">#</a> \u6D88\u8D39\u8005\u5206\u533A\u5206\u914D\u7B56\u7565</h3><ol><li>Range \u8303\u56F4\u5206\u533A(\u9ED8\u8BA4\u7684)</li><li>RoundRobin \u8F6E\u8BE2\u5206\u533A</li><li>Sticky\u7B56\u7565</li></ol><h3 id="\u89E6\u53D1-rebalance-\u7684\u65F6\u673A" tabindex="-1"><a class="header-anchor" href="#\u89E6\u53D1-rebalance-\u7684\u65F6\u673A" aria-hidden="true">#</a> \u89E6\u53D1 Rebalance \u7684\u65F6\u673A</h3><p>Rebalance \u7684\u89E6\u53D1\u6761\u4EF6\u67093\u4E2A\u3002</p><ul><li>\u7EC4\u6210\u5458\u4E2A\u6570\u53D1\u751F\u53D8\u5316\u3002\u4F8B\u5982\u6709\u65B0\u7684 consumer \u5B9E\u4F8B\u52A0\u5165\u8BE5\u6D88\u8D39\u7EC4\u6216\u8005\u79BB\u5F00\u7EC4\u3002</li><li>\u8BA2\u9605\u7684 Topic \u4E2A\u6570\u53D1\u751F\u53D8\u5316\u3002</li><li>\u8BA2\u9605 Topic \u7684\u5206\u533A\u6570\u53D1\u751F\u53D8\u5316\u3002</li></ul><h3 id="coordinator\u534F\u8C03\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#coordinator\u534F\u8C03\u8FC7\u7A0B" aria-hidden="true">#</a> Coordinator\u534F\u8C03\u8FC7\u7A0B</h3><p>\u6D88\u8D39\u8005\u5982\u4F55\u53D1\u73B0\u534F\u8C03\u8005</p><p>\u6D88\u8D39\u8005\u5982\u4F55\u786E\u5B9A\u5206\u914D\u7B56\u7565</p><p>\u5982\u679C\u9700\u8981\u518D\u5747\u8861\u5206\u914D\u7B56\u7565\u7684\u5F71\u54CD</p><h2 id="zk\u7684\u6570\u636E\u6A21\u578B\u548C\u8282\u70B9\u7C7B\u578B\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#zk\u7684\u6570\u636E\u6A21\u578B\u548C\u8282\u70B9\u7C7B\u578B\u6709\u54EA\u4E9B" aria-hidden="true">#</a> zk\u7684\u6570\u636E\u6A21\u578B\u548C\u8282\u70B9\u7C7B\u578B\u6709\u54EA\u4E9B</h2><h3 id="zookeeper\u6570\u636E\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#zookeeper\u6570\u636E\u6A21\u578B" aria-hidden="true">#</a> ZooKeeper\u6570\u636E\u6A21\u578B</h3><p>ZooKeeper\u7684\u6570\u636E\u6A21\u578B\uFF0C\u5728\u7ED3\u6784\u4E0A\u548C\u6807\u51C6\u6587\u4EF6\u7CFB\u7EDF\u7684\u975E\u5E38\u76F8\u4F3C\uFF0C\u62E5\u6709\u4E00\u4E2A\u5C42\u6B21\u7684\u547D\u540D\u7A7A\u95F4\uFF0C\u90FD\u662F\u91C7\u7528\u6811\u5F62\u5C42\u6B21\u7ED3\u6784\uFF0CZooKeeper\u6811\u4E2D\u7684\u6BCF\u4E2A\u8282\u70B9\u88AB\u79F0\u4E3A\u2014Znode\u3002</p><p>\u548C\u6587\u4EF6\u7CFB\u7EDF\u7684\u76EE\u5F55\u6811\u4E00\u6837\uFF0CZooKeeper\u6811\u4E2D\u7684\u6BCF\u4E2A\u8282\u70B9\u53EF\u4EE5\u62E5\u6709\u5B50\u8282\u70B9\u3002\u4F46\u4E5F\u6709\u4E0D\u540C\u4E4B\u5904\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>	Znode\u517C\u5177\u6587\u4EF6\u548C\u76EE\u5F55\u4E24\u79CD\u7279\u70B9\u3002\u65E2\u50CF\u6587\u4EF6\u4E00\u6837\u7EF4\u62A4\u7740\u6570\u636E\u3001\u5143\u4FE1\u606F\u3001ACL\u3001\u65F6\u95F4\u6233\u7B49\u6570\u636E\u7ED3\u6784\uFF0C\u53C8\u50CF\u76EE\u5F55\u4E00\u6837\u53EF\u4EE5\u4F5C\u4E3A\u8DEF\u5F84\u6807\u8BC6\u7684\u4E00\u90E8\u5206\uFF0C\u5E76\u53EF\u4EE5\u5177\u6709\u5B50Znode\u3002\u7528\u6237\u5BF9Znode\u5177\u6709\u589E\u3001\u5220\u3001\u6539\u3001\u67E5\u7B49\u64CD\u4F5C\uFF08\u6743\u9650\u5141\u8BB8\u7684\u60C5\u51B5\u4E0B\uFF09
	
	Znode\u5177\u6709\u539F\u5B50\u6027\u64CD\u4F5C\uFF0C\u8BFB\u64CD\u4F5C\u5C06\u83B7\u53D6\u4E0E\u8282\u70B9\u76F8\u5173\u7684\u6240\u6709\u6570\u636E\uFF0C\u5199\u64CD\u4F5C\u4E5F\u5C06\u66FF\u6362\u6389\u8282\u70B9\u7684\u6240\u6709\u6570\u636E\u3002\u53E6\u5916\uFF0C\u6BCF\u4E00\u4E2A\u8282\u70B9\u90FD\u62E5\u6709\u81EA\u5DF1\u7684ACL(\u8BBF\u95EE\u63A7\u5236\u5217\u8868)\uFF0C\u8FD9\u4E2A\u5217\u8868\u89C4\u5B9A\u4E86\u7528\u6237\u7684\u6743\u9650\uFF0C\u5373\u9650\u5B9A\u4E86\u7279\u5B9A\u7528\u6237\u5BF9\u76EE\u6807\u8282\u70B9\u53EF\u4EE5\u6267\u884C\u7684\u64CD\u4F5C
	
	Znode\u5B58\u50A8\u6570\u636E\u5927\u5C0F\u6709\u9650\u5236\u3002ZooKeeper\u867D\u7136\u53EF\u4EE5\u5173\u8054\u4E00\u4E9B\u6570\u636E\uFF0C\u4F46\u5E76\u6CA1\u6709\u88AB\u8BBE\u8BA1\u4E3A\u5E38\u89C4\u7684\u6570\u636E\u5E93\u6216\u8005\u5927\u6570\u636E\u5B58\u50A8\uFF0C\u76F8\u53CD\u7684\u662F\uFF0C\u5B83\u7528\u6765\u7BA1\u7406\u8C03\u5EA6\u6570\u636E\uFF0C\u6BD4\u5982\u5206\u5E03\u5F0F\u5E94\u7528\u4E2D\u7684\u914D\u7F6E\u6587\u4EF6\u4FE1\u606F\u3001\u72B6\u6001\u4FE1\u606F\u3001\u6C47\u96C6\u4F4D\u7F6E\u7B49\u7B49\u3002\u8FD9\u4E9B\u6570\u636E\u7684\u5171\u540C\u7279\u6027\u5C31\u662F\u5B83\u4EEC\u90FD\u662F\u5F88\u5C0F\u7684\u6570\u636E\uFF0C\u901A\u5E38\u4EE5KB\u4E3A\u5927\u5C0F\u5355\u4F4D\u3002ZooKeeper\u7684\u670D\u52A1\u5668\u548C\u5BA2\u6237\u7AEF\u90FD\u88AB\u8BBE\u8BA1\u4E3A\u4E25\u683C\u68C0\u67E5\u5E76\u9650\u5236\u6BCF\u4E2AZnode\u7684\u6570\u636E\u5927\u5C0F\u81F3\u591A1M\uFF0C\u5F53\u65F6\u5E38\u89C4\u4F7F\u7528\u4E2D\u5E94\u8BE5\u8FDC\u5C0F\u4E8E\u6B64\u503C
	
	Znode\u901A\u8FC7\u8DEF\u5F84\u5F15\u7528\uFF0C\u5982\u540CUnix\u4E2D\u7684\u6587\u4EF6\u8DEF\u5F84\u3002\u8DEF\u5F84\u5FC5\u987B\u662F\u7EDD\u5BF9\u7684\uFF0C\u56E0\u6B64\u4ED6\u4EEC\u5FC5\u987B\u7531\u659C\u6760\u5B57\u7B26\u6765\u5F00\u5934\u3002\u9664\u6B64\u4EE5\u5916\uFF0C\u4ED6\u4EEC\u5FC5\u987B\u662F\u552F\u4E00\u7684\uFF0C\u4E5F\u5C31\u662F\u8BF4\u6BCF\u4E00\u4E2A\u8DEF\u5F84\u53EA\u6709\u4E00\u4E2A\u8868\u793A\uFF0C\u56E0\u6B64\u8FD9\u4E9B\u8DEF\u5F84\u4E0D\u80FD\u6539\u53D8\u3002\u5728ZooKeeper\u4E2D\uFF0C\u8DEF\u5F84\u7531Unicode\u5B57\u7B26\u4E32\u7EC4\u6210\uFF0C\u5E76\u4E14\u6709\u4E00\u4E9B\u9650\u5236\u3002\u5B57\u7B26\u4E32&quot;/zookeeper&quot;\u7528\u4EE5\u4FDD\u5B58\u7BA1\u7406\u4FE1\u606F\uFF0C\u6BD4\u5982\u5173\u952E\u914D\u989D\u4FE1\u606F\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u8282\u70B9\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u8282\u70B9\u7C7B\u578B" aria-hidden="true">#</a> \u8282\u70B9\u7C7B\u578B</h3><p>Znode\u6709\u4E24\u79CD\uFF0C\u5206\u522B\u4E3A\u4E34\u65F6\u8282\u70B9\u548C\u6C38\u4E45\u8282\u70B9\u3002 \u8282\u70B9\u7684\u7C7B\u578B\u5728\u521B\u5EFA\u65F6\u5373\u88AB\u786E\u5B9A\uFF0C\u5E76\u4E14\u4E0D\u80FD\u6539\u53D8\u3002 \u4E34\u65F6\u8282\u70B9\uFF1A\u8BE5\u8282\u70B9\u7684\u751F\u547D\u5468\u671F\u4F9D\u8D56\u4E8E\u521B\u5EFA\u5B83\u4EEC\u7684\u4F1A\u8BDD\u3002\u4E00\u65E6\u4F1A\u8BDD\u7ED3\u675F\uFF0C\u4E34\u65F6\u8282\u70B9\u5C06\u88AB\u81EA\u52A8\u5220\u9664\uFF0C\u5F53\u7136\u53EF\u4EE5\u4E5F\u53EF\u4EE5\u624B\u52A8\u5220\u9664\u3002\u4E34\u65F6\u8282\u70B9\u4E0D\u5141\u8BB8\u62E5\u6709\u5B50\u8282\u70B9\u3002</p><p>\u6C38\u4E45\u8282\u70B9\uFF1A\u8BE5\u8282\u70B9\u7684\u751F\u547D\u5468\u671F\u4E0D\u4F9D\u8D56\u4E8E\u4F1A\u8BDD\uFF0C\u5E76\u4E14\u53EA\u6709\u5728\u5BA2\u6237\u7AEF\u663E\u793A\u6267\u884C\u5220\u9664\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u4ED6\u4EEC\u624D\u80FD\u88AB\u5220\u9664\u3002</p><p>Znode\u8FD8\u6709\u4E00\u4E2A\u5E8F\u5217\u5316\u7684\u7279\u6027\uFF0C\u5982\u679C\u521B\u5EFA\u7684\u65F6\u5019\u6307\u5B9A\u7684\u8BDD\uFF0C\u8BE5Znode\u7684\u540D\u5B57\u540E\u9762\u4F1A\u81EA\u52A8\u8FFD\u52A0\u4E00\u4E2A\u4E0D\u65AD\u589E\u52A0\u7684\u5E8F\u5217\u53F7\u3002\u5E8F\u5217\u53F7\u5BF9\u4E8E\u6B64\u8282\u70B9\u7684\u7236\u8282\u70B9\u6765\u8BF4\u662F\u552F\u4E00\u7684\uFF0C\u8FD9\u6837\u4FBF\u4F1A\u8BB0\u5F55\u6BCF\u4E2A\u5B50\u8282\u70B9\u521B\u5EFA\u7684\u5148\u540E\u987A\u5E8F\u3002\u5B83\u7684\u683C\u5F0F\u4E3A\u201C%10d\u201D( 10\u4F4D\u6570\u5B57\uFF0C\u6CA1\u6709\u6570\u503C\u7684\u6570\u4F4D\u75280\u8865\u5145\uFF0C\u4F8B\u5982\u201C0000000001\u201D)</p><p>\u5728ZooKeeper\u4E2D\uFF0C\u6BCF\u4E2A\u6570\u636E\u8282\u70B9\u90FD\u662F\u6709\u751F\u547D\u5468\u671F\u7684\uFF0C\u5176\u751F\u547D\u5468\u671F\u7684\u957F\u77ED\u53D6\u51B3\u4E8E\u6570\u636E\u8282\u70B9\u7684\u8282\u70B9\u7C7B\u578B\u3002</p><p>1\u3001\u6301\u4E45\u8282\u70B9\uFF08PERSISTENT\uFF09</p><p>\u8BE5\u6570\u636E\u8282\u70B9\u522B\u521B\u5EFA\u540E\uFF0C\u5C31\u4F1A\u4E00\u76F4\u5B58\u5728\u4E8EZooKeeper\u670D\u52A1\u5668\u4E0A\uFF0C\u76F4\u5230\u6709\u5220\u9664\u64CD\u4F5C\u6765\u4E3B\u52A8\u5220\u9664\u8BE5\u8282\u70B9\u3002</p><p>2\u3001\u6301\u4E45\u987A\u5E8F\u8282\u70B9\uFF08PERSISTENT_SEQUENTIAL\uFF09</p><p>\u6301\u4E45\u987A\u5E8F\u8282\u70B9\u7684\u57FA\u672C\u7279\u6027\u548C\u6301\u4E45\u8282\u70B9\u662F\u4E00\u81F4\u7684\uFF0C\u989D\u5916\u7684\u7279\u6027\u8868\u73B0\u5728\u987A\u5E8F\u6027\u4E0A\u3002\u5728ZooKeeper\u4E2D\uFF0C\u6BCF\u4E2A\u7236\u8282\u70B9\u90FD\u4F1A\u4E3A\u5B83\u7684\u7B2C\u4E00\u7EA7\u5B50\u8282\u70B9\u7EF4\u62A4\u4E00\u4EFD\u987A\u5E8F\uFF0C\u7528\u4E8E\u8BB0\u5F55\u6BCF\u4E2A\u5B50\u8282\u70B9\u521B\u5EFA\u7684\u5148\u540E\u987A\u5E8F\u3002</p><p>3\u3001\u4E34\u65F6\u8282\u70B9\uFF08EPHEMERAL\uFF09</p><p>\u4E34\u65F6\u8282\u70B9\u7684\u751F\u547D\u5468\u671F\u548C\u5BA2\u6237\u7AEF\u7684\u56DE\u8BDD\u7ED1\u5B9A\u5728\u4E00\u8D77\uFF0C\u5982\u679C\u5BA2\u6237\u7AEF\u4F1A\u8BDD\u5931\u6548\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u8282\u70B9\u5C31\u4F1A\u88AB\u81EA\u52A8\u5730\u6E05\u7406\u6389\u3002</p><p>ZooKeeper\u89C4\u5B9A\u4E86\u4E0D\u80FD\u57FA\u4E8E\u4E34\u65F6\u8282\u70B9\u6765\u521B\u5EFA\u5B50\u8282\u70B9\uFF0C\u5373\u4E34\u65F6\u8282\u70B9\u53EA\u80FD\u4F5C\u4E3A\u53F6\u5B50\u8282\u70B9\u3002</p><p>4\u3001\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\uFF08EPHEMERAL_SEQUENTIAL\uFF09</p><h2 id="zookeeper-watch\u673A\u5236\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#zookeeper-watch\u673A\u5236\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Zookeeper watch\u673A\u5236\u662F\u4EC0\u4E48</h2><p>ZooKeeper\u662F\u7528\u6765\u534F\u8C03\uFF08\u540C\u6B65\uFF09\u5206\u5E03\u5F0F\u8FDB\u7A0B\u7684\u670D\u52A1\uFF0C\u63D0\u4F9B\u4E86\u4E00\u4E2A\u7B80\u5355\u9AD8\u6027\u80FD\u7684\u534F\u8C03\u5185\u6838\uFF0C\u7528\u6237\u53EF\u4EE5\u5728\u6B64\u4E4B\u4E0A\u6784\u5EFA\u66F4\u591A\u590D\u6742\u7684\u5206\u5E03\u5F0F\u534F\u8C03\u529F\u80FD\u3002</p><p>\u591A\u4E2A\u5206\u5E03\u5F0F\u8FDB\u7A0B\u901A\u8FC7ZooKeeper\u63D0\u4F9B\u7684API\u6765\u64CD\u4F5C\u5171\u4EAB\u7684ZooKeeper\u5185\u5B58\u6570\u636E\u5BF9\u8C61ZNode\u6765\u8FBE\u6210\u67D0\u79CD\u4E00\u81F4\u7684\u884C\u4E3A\u6216\u7ED3\u679C\uFF0C\u8FD9\u79CD\u6A21\u5F0F\u672C\u8D28\u4E0A\u662F\u57FA\u4E8E\u72B6\u6001\u5171\u4EAB\u7684\u5E76\u53D1\u6A21\u578B\uFF0C\u4E0EJava\u7684\u591A\u7EBF\u7A0B\u5E76\u53D1\u6A21\u578B\u4E00\u81F4\uFF0C\u4ED6\u4EEC\u7684\u7EBF\u7A0B\u6216\u8FDB\u7A0B\u90FD\u662F\u201D\u5171\u4EAB\u5F0F\u5185\u5B58\u901A\u4FE1\u201C\u3002</p><p>Java\u6CA1\u6709\u76F4\u63A5\u63D0\u4F9B\u67D0\u79CD\u54CD\u5E94\u5F0F\u901A\u77E5\u63A5\u53E3\u6765\u76D1\u63A7\u67D0\u4E2A\u5BF9\u8C61\u72B6\u6001\u7684\u53D8\u5316\uFF0C\u53EA\u80FD\u8981\u4E48\u6D6A\u8D39CPU\u65F6\u95F4\u6BEB\u65E0\u54CD\u5E94\u5F0F\u7684\u8F6E\u8BE2\u91CD\u8BD5\uFF0C\u6216\u57FA\u4E8EJava\u63D0\u4F9B\u7684\u67D0\u79CD\u4E3B\u52A8\u901A\u77E5\uFF08Notif\uFF09\u673A\u5236\uFF08\u5185\u7F6E\u961F\u5217\uFF09\u6765\u54CD\u5E94\u72B6\u6001\u53D8\u5316\uFF0C\u4F46\u8FD9\u79CD\u673A\u5236\u662F\u9700\u8981\u5FAA\u73AF\u963B\u585E\u8C03\u7528\u3002</p><p>\u800CZooKeeper\u5B9E\u73B0\u8FD9\u4E9B\u5206\u5E03\u5F0F\u8FDB\u7A0B\u7684\u72B6\u6001\uFF08ZNode\u7684Data\u3001Children\uFF09\u5171\u4EAB\u65F6\uFF0C\u57FA\u4E8E\u6027\u80FD\u7684\u8003\u8651\u91C7\u7528\u4E86\u7C7B\u4F3C\u7684\u5F02\u6B65\u975E\u963B\u585E\u7684\u4E3B\u52A8\u901A\u77E5\u6A21\u5F0F\u5373Watch\u673A\u5236\uFF0C\u4F7F\u5F97\u5206\u5E03\u5F0F\u8FDB\u7A0B\u4E4B\u95F4\u7684\u201C\u5171\u4EAB\u72B6\u6001\u901A\u4FE1\u201D\u66F4\u52A0\u5B9E\u65F6\u9AD8\u6548\uFF0C\u5176\u5B9E\u8FD9\u4E5F\u662FZooKeeper\u7684\u4E3B\u8981\u4EFB\u52A1\u51B3\u5B9A\u7684\u2014\u534F\u8C03\u3002Consul\u867D\u7136\u4E5F\u5B9E\u73B0\u4E86Watch\u673A\u5236\uFF0C\u4F46\u5B83\u662F\u963B\u585E\u7684\u957F\u8F6E\u8BE2\u3002</p><h3 id="zookeeper\u7684watch\u7279\u6027" tabindex="-1"><a class="header-anchor" href="#zookeeper\u7684watch\u7279\u6027" aria-hidden="true">#</a> ZooKeeper\u7684Watch\u7279\u6027</h3><ol><li>Watch\u662F\u4E00\u6B21\u6027\u7684\uFF0C\u6BCF\u6B21\u90FD\u9700\u8981\u91CD\u65B0\u6CE8\u518C\uFF0C\u5E76\u4E14\u5BA2\u6237\u7AEF\u5728\u4F1A\u8BDD\u5F02\u5E38\u7ED3\u675F\u65F6\u4E0D\u4F1A\u6536\u5230\u4EFB\u4F55\u901A\u77E5\uFF0C\u800C\u5FEB\u901F\u91CD\u8FDE\u63A5\u65F6\u4ECD\u4E0D\u5F71\u54CD\u63A5\u6536\u901A\u77E5\u3002</li><li>Watch\u7684\u56DE\u8C03\u6267\u884C\u90FD\u662F\u987A\u5E8F\u6267\u884C\u7684\uFF0C\u5E76\u4E14\u5BA2\u6237\u7AEF\u5728\u6CA1\u6709\u6536\u5230\u5173\u6CE8\u6570\u636E\u7684\u53D8\u5316\u4E8B\u4EF6\u901A\u77E5\u4E4B\u524D\u662F\u4E0D\u4F1A\u770B\u5230\u6700\u65B0\u7684\u6570\u636E\uFF0C\u53E6\u5916\u9700\u8981\u6CE8\u610F\u4E0D\u8981\u5728Watch\u56DE\u8C03\u903B\u8F91\u4E2D\u963B\u585E\u6574\u4E2A\u5BA2\u6237\u7AEF\u7684Watch\u56DE\u8C03</li><li>Watch\u662F\u8F7B\u91CF\u7EA7\u7684\uFF0CWatchEvent\u662F\u6700\u5C0F\u7684\u901A\u4FE1\u5355\u5143\uFF0C\u7ED3\u6784\u4E0A\u53EA\u5305\u542B\u901A\u77E5\u72B6\u6001\u3001\u4E8B\u4EF6\u7C7B\u578B\u548C\u8282\u70B9\u8DEF\u5F84\u3002ZooKeeper\u670D\u52A1\u7AEF\u53EA\u4F1A\u901A\u77E5\u5BA2\u6237\u7AEF\u53D1\u751F\u4E86\u4EC0\u4E48\uFF0C\u5E76\u4E0D\u4F1A\u544A\u8BC9\u5177\u4F53\u5185\u5BB9\u3002</li></ol><h3 id="zookeeper\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#zookeeper\u72B6\u6001" aria-hidden="true">#</a> Zookeeper\u72B6\u6001</h3><ol><li>Disconnected\uFF1A\u5BA2\u6237\u7AEF\u662F\u65AD\u5F00\u8FDE\u63A5\u7684\u72B6\u6001\uFF0C\u4E0D\u80FD\u8FDE\u63A5\u670D\u52A1\u96C6\u5408\u4E2D\u7684\u4EFB\u610F\u4E00\u4E2A</li><li>SyncConnected\uFF1A\u5BA2\u6237\u7AEF\u662F\u8FDE\u63A5\u72B6\u6001\uFF0C\u8FDE\u63A5\u5176\u4E2D\u7684\u4E00\u4E2A\u670D\u52A1</li><li>AuthFailed\uFF1A\u9274\u6743\u5931\u8D25</li><li>ConnectedReadOnly\uFF1A\u5BA2\u6237\u7AEF\u8FDE\u63A5\u53EA\u8BFB\u7684\u670D\u52A1\u5668</li><li>SaslAuthenticated\uFF1ASASL\u8BA4\u8BC1</li><li>Expired\uFF1A\u670D\u52A1\u5668\u5DF2\u7ECF\u8FC7\u671F\u4E86\u8BE5\u5BA2\u6237\u7AEF\u7684Session</li></ol><h3 id="zookeeper\u4E8B\u4EF6\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#zookeeper\u4E8B\u4EF6\u7C7B\u578B" aria-hidden="true">#</a> Zookeeper\u4E8B\u4EF6\u7C7B\u578B</h3><ol><li>None\uFF1A\u65E0</li><li>NodeCreated\uFF1A\u8282\u70B9\u521B\u5EFA</li><li>NodeDeleted\uFF1A\u8282\u70B9\u5220\u9664</li><li>NodeDataChanged\uFF1A\u8282\u70B9\u6570\u636E\u6539\u53D8</li><li>NodeChildrenChanged\uFF1A\u5B50\u8282\u70B9\u6539\u53D8\uFF08\u6DFB\u52A0/\u5220\u9664\uFF09</li></ol><h3 id="watcher\u4F7F\u7528\u7684\u6CE8\u610F\u4E8B\u9879" tabindex="-1"><a class="header-anchor" href="#watcher\u4F7F\u7528\u7684\u6CE8\u610F\u4E8B\u9879" aria-hidden="true">#</a> Watcher\u4F7F\u7528\u7684\u6CE8\u610F\u4E8B\u9879</h3><p>Watcher\u662F\u4E00\u6B21\u89E6\u53D1\u5668\uFF0C\u5047\u5982\u9700\u8981\u6301\u7EED\u76D1\u542C\u6570\u636E\u53D8\u66F4\uFF0C\u9700\u8981\u5728\u6BCF\u6B21\u83B7\u53D6\u65F6\u8BBE\u7F6EWatcher \u4F1A\u8BDD\u8FC7\u671F\uFF1A\u5F53\u5BA2\u6237\u7AEF\u4F1A\u8BDD\u8FC7\u671F\u65F6\uFF0C\u8BE5\u5BA2\u6237\u7AEF\u6CE8\u518C\u7684Watcher\u4F1A\u5931\u6548 \u4E8B\u4EF6\u4E22\u5931\uFF1A\u5728\u63A5\u6536\u901A\u77E5\u548C\u6CE8\u518C\u76D1\u89C6\u70B9\u4E4B\u95F4\uFF0C\u53EF\u80FD\u4F1A\u4E22\u5931\u4E8B\u4EF6,\u4F46Zookeeper\u7684\u72B6\u6001\u53D8\u66F4\u548C\u6570\u636E\u53D8\u5316\uFF0C\u90FD\u4F1A\u8BB0\u5F55\u5728\u72B6\u6001\u5143\u6570\u636E\u4FE1\u606F\u548CZK\u6570\u636E\u8282\u70B9\u4E0A\uFF0C\u6240\u4EE5\u80FD\u591F\u83B7\u53D6\u6700\u7EC8\u4E00\u81F4\u7684ZK\u4FE1\u606F\u72B6\u6001 \u907F\u514DWatcher\u8FC7\u591A\uFF1A\u670D\u52A1\u5668\u4F1A\u5BF9\u6BCF\u4E00\u4E2A\u6CE8\u518CWatcher\u4E8B\u4EF6\u7684\u5BA2\u6237\u7AEF\u53D1\u9001\u901A\u77E5\uFF0C\u901A\u77E5\u901A\u8FC7Socket\u8FDE\u63A5\u7684\u65B9\u5F0F\u53D1\u9001\uFF0C\u5F53Watcher\u8FC7\u591A\u65F6\uFF0C\u4F1A\u4EA7\u751F\u4E00\u4E2A\u5C16\u5CF0\u7684\u901A\u77E5</p><h2 id="zk\u7684\u547D\u540D\u670D\u52A1\u3001\u914D\u7F6E\u7BA1\u7406\u3001\u96C6\u7FA4\u7BA1\u7406\u5206\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#zk\u7684\u547D\u540D\u670D\u52A1\u3001\u914D\u7F6E\u7BA1\u7406\u3001\u96C6\u7FA4\u7BA1\u7406\u5206\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> zk\u7684\u547D\u540D\u670D\u52A1\u3001\u914D\u7F6E\u7BA1\u7406\u3001\u96C6\u7FA4\u7BA1\u7406\u5206\u522B\u662F\u4EC0\u4E48</h2><h3 id="\u5206\u5E03\u5F0F\u534F\u8C03" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u534F\u8C03" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u534F\u8C03</h3><p>\u5927\u4E8E\u7B49\u4E8E\u4E00\u7684\u60C5\u51B5\u4E0B\uFF0C\u624D\u4F1A\u6709\u534F\u8C03\uFF0C\u5728\u534F\u8C03\u7684\u4E8B\u52A1\u8FDB\u884C\u5206\u7C7B\u5F97\u5230\u4E00\u4E9B\u540D\u8BCD\uFF0C\u8BED\u4E49\u80FD\u591F\u63A5\u53D7\u5C31\u53EF\u4EE5</p><h3 id="\u547D\u540D\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#\u547D\u540D\u670D\u52A1" aria-hidden="true">#</a> \u547D\u540D\u670D\u52A1</h3><p>\u901A\u8FC7\u4F7F\u7528\u6709\u5E8F\u8282\u70B9\u7684\u7279\u6027\u505A\u5230\u534F\u8C03\u547D\u540D\u89C4\u5219</p><p>\u901A\u8FC7zk\u7684\u4E8B\u52A1ID\u9012\u589E\uFF0C\u505A\u5230\u6709\u5E8F\u884C\u547D\u540D\u89C4\u5219</p><p>\u901A\u8FC7\u4F7F\u7528\u81EA\u5DF1\u70B9\u505Amap\u6620\u5C04\uFF0C\u505A\u52301:N\u7684\u547D\u540D\u6620\u5C04\uFF0C\u6BD4\u5982DNS</p><p>\u987A\u5E8F\u5173\u7CFB\u3001\u6620\u5C04\u5173\u7CFB</p><h3 id="\u914D\u7F6E\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u7BA1\u7406" aria-hidden="true">#</a> \u914D\u7F6E\u7BA1\u7406</h3><p>\u914D\u7F6E\u3001\u5143\u6570\u636E\u3001\u72B6\u6001\u7B49\u8BED\u4E49\u53EF\u4EE5\u901A\u8FC7ZK\u7684\u8282\u70B91MB\u5B58\u50A8\uFF0C\u6216\u8005\u901A\u8FC7zk\u7684\u8282\u70B9\u76EE\u5F55\u7ED3\u6784\u7279\u6027\u5B58\u50A8</p><p>\u5E76\u4E14\u901A\u8FC7watch\u673A\u5236\uFF0C\u6EE1\u8DB3\u914D\u7F6E\u53D8\u5316\u7684\u5168\u5C40\u901A\u77E5\u80FD\u529B</p><h3 id="\u96C6\u7FA4\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#\u96C6\u7FA4\u7BA1\u7406" aria-hidden="true">#</a> \u96C6\u7FA4\u7BA1\u7406</h3><p>\u901A\u8FC7zk\u7684\u6392\u4ED6\u6027\uFF0C\u6709\u5E8F\u6027</p><p>\u6EE1\u8DB3\u5206\u5E03\u5F0F\u9501\u3001\u5206\u5E03\u5F0F\u9009\u4E3B\u3001\u961F\u5217\u9501</p><p>\u4E32\u884C\u5316\u56DE\u8C03\u8C03\u5EA6</p><p>\u5206\u5E03\u5F0F\u8C03\u5EA6\u7B49</p>`,171);function Ln(_n,Nn){const o=p("Mermaid"),t=p("ExternalLinkIcon");return l(),i("div",null,[v,a(o,{id:"mermaid-3007bb2e",code:"flowchart%20TB%0A%20%20%20%20subgraph%20SpringApplication.java%0A%20%20%20%20run--%3EprepareContext--%3Eload--%3EBeanDefinitionLoader.load%0A%20%20%20%20run--%3ErefreshContext--%3Erefresh--%3EapplicationContext.refresh%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20BeanDefinitionLoader.java%0A%20%20%20%20load%E6%96%B9%E6%B3%95%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20AbstractApplicationContext.java%0A%20%20%20%20refresh%E6%96%B9%E6%B3%95--%3EinvokeBeanFactoryPostProcessors--%3EPostxx.invokeBeanFactoryPostProcessors%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20PostProcessorRegistrationDelegate.java%0A%20%20%20%20invokeBeanFactoryPostProcessors%E6%96%B9%E6%B3%95--%3Edebug%E5%8F%91%E7%8E%B0%E8%BF%9B%E5%85%A5%E4%BA%86%E9%85%8D%E7%BD%AE%E7%B1%BB%E8%A7%A3%E6%9E%90%E5%99%A8--%3EConfigurationClassParser.parse%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20ConfigurationClassParser.java%0A%20%20%20%20parse%E6%96%B9%E6%B3%95--%3EprocessConfigurationClass--%3EdoProcessConfigurationClass--%3EprocessImports%0A%20%20%20%20parse%E6%96%B9%E6%B3%95--%3Ethis.deferredImportSelectorHandler.process--%3Eprocess--%3Ehandler.processGroupImports--%3EgetImports--%3EgetImportSelector%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20SpringApplication.java--%3EBeanDefinitionLoader.java%0A%20%20%20%20BeanDefinitionLoader.load--%3Eload%E6%96%B9%E6%B3%95%0A%20%20%20%20applicationContext.refresh--%3Erefresh%E6%96%B9%E6%B3%95%0A%20%20%20%20Postxx.invokeBeanFactoryPostProcessors--%3EinvokeBeanFactoryPostProcessors%E6%96%B9%E6%B3%95%0A%20%20%20%20ConfigurationClassParser.parse--%3Eparse%E6%96%B9%E6%B3%95%0A"}),b,n("ol",null,[h,g,f,y,w,C,n("li",null,[x,n("a",S,[P,a(t)])])]),A,n("ol",null,[B,q,E,n("li",null,[R,n("a",M,[D,a(t)])])]),T,n("ol",j,[n("li",null,[I,n("a",O,[L,a(t)])])]),_,n("p",null,[N,n("a",F,[H,a(t)])]),J,U,G,n("ol",V,[n("li",null,[X,n("a",W,[z,a(t)])])]),K,n("p",null,[n("a",Q,[Z,a(t)])]),Y,n("blockquote",null,[$,nn,sn,n("p",null,[n("a",an,[tn,a(t)])]),en]),pn,n("p",null,[n("a",on,[cn,a(t)])]),ln,n("p",null,[un,n("a",rn,[dn,a(t)]),kn]),mn,n("p",null,[vn,n("a",bn,[hn,a(t)]),gn,fn,yn]),wn,n("p",null,[Cn,n("a",xn,[Sn,a(t)]),Pn,n("a",An,[Bn,a(t)]),qn]),En,n("p",null,[Rn,n("a",Mn,[Dn,a(t)]),Tn,jn,In]),On])}var Jn=c(m,[["render",Ln],["__file","interview.html.vue"]]);export{Jn as default};
