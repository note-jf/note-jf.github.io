import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,a as t}from"./app.c37b87a5.js";var e="/assets/true-image-20210913133901438.a902bcd8.png",p="/assets/true-image-20210913134831345.f3723938.png",c="/assets/true-image-20210604132105875.cac41ac7.png",o="/assets/true-image-20210913181008801.c000e07a.png",i="/assets/true-image-20210604132116450.b967e642.png",l="/assets/true-image-20210604132125942.8bebfa80.png",u="/assets/true-image-20210913135023032.e13b9cd8.png",r="/assets/true-image-20210913140426623.9f6d00b2.png",d="/assets/true-image-20210914112220313.015ded10.png",k="/assets/true-image-20210914112316601.d76169a5.png",v="/assets/true-image-20210914111013514.49f95c6c.png",m="/assets/true-image-20210914121035642.2be78af3.png",g="/assets/true-image-20210916165158731.5aea5b4a.png",h="/assets/true-image-20210914143530694.c0ca04a9.png",b="/assets/true-image-20210916170348140.ef8f48f3.png",f="/assets/true-image-20210916165641334.82d56ce6.png",y="/assets/true-image-20210916180627709.e269b54d.png",x="/assets/true-image-20210916171603888.ed8ddad5.png",_="/assets/true-image-20210916180857200.1de9f2d2.png",q="/assets/true-image-20210916173657735.527784f2.png",w="/assets/true-image-20210916173725146.0b5c3c49.png",S="/assets/true-image-20210918141244867.29c604f0.png",C="/assets/true-image-20210918150228793.3929abde.png",L="/assets/true-image-20210918150700034.898da065.png",R="/assets/true-image-20210918151901864.c78f957e.png",J="/assets/true-image-20210918152351597.d2afd539.png";const j={},D=t(`<h1 id="\u7F13\u5B58\u4E00\u81F4\u6027" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u4E00\u81F4\u6027" aria-hidden="true">#</a> \u7F13\u5B58\u4E00\u81F4\u6027</h1><ol><li>\u53CC\u5199\u6A21\u5F0F\uFF1A\u5199\u6570\u636E\u5E93\uFF0C\u5199\u7F13\u5B58</li><li>\u5931\u6548\u6A21\u5F0F\uFF1A\u7F13\u5B58\u5931\u6548\uFF08\u5220\u9664\u7F13\u5B58\uFF09\uFF0C\u5199\u6570\u636E\u5E93</li></ol><blockquote><p>\u8BFB\u53D6\u7F13\u5B58\u6B65\u9AA4\u6570\u636E\u4E00\u81F4\u6027\u4E00\u822C\u6CA1\u6709\u4EC0\u4E48\u95EE\u9898\uFF0C\u4F46\u662F\u4E00\u65E6\u6D89\u53CA\u5230\u6570\u636E\u66F4\u65B0\uFF1A\u6570\u636E\u5E93\u548C\u7F13\u5B58\u66F4\u65B0\uFF0C\u5C31\u5BB9\u6613\u51FA\u73B0<strong>\u7F13\u5B58(Redis)\u548C\u6570\u636E\u5E93\uFF08MySQL\uFF09\u95F4\u7684\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898</strong>\u3002</p><p>\u4E0D\u7BA1\u5148\u4FDD\u5B58\u5230MySQL\uFF0C\u8FD8\u662F\u5148\u4FDD\u5B58\u5230Redis\u90FD\u9762\u4E34\u7740\u4E00\u4E2A\u4FDD\u5B58\u6210\u529F\u800C\u53E6\u5916\u4E00\u4E2A\u4FDD\u5B58\u5931\u8D25\u7684\u60C5\u51B5\u3002</p><p>\u4E0D\u7BA1\u662F\u5148\u5199MySQL\u6570\u636E\u5E93\uFF0C\u518D\u5220\u9664Redis\u7F13\u5B58\uFF1B\u8FD8\u662F\u5148\u5220\u9664\u7F13\u5B58\uFF0C\u518D\u5199\u5E93\uFF0C\u90FD\u6709\u53EF\u80FD\u51FA\u73B0\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u60C5\u51B5\u3002\u4E3E\u4E00\u4E2A\u4F8B\u5B50\uFF1A</p><p>1.\u5982\u679C\u5220\u9664\u4E86\u7F13\u5B58Redis\uFF0C\u8FD8\u6CA1\u6709\u6765\u5F97\u53CA\u5199\u5E93MySQL\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u5C31\u6765\u8BFB\u53D6\uFF0C\u53D1\u73B0\u7F13\u5B58\u4E3A\u7A7A\uFF0C\u5219\u53BB\u6570\u636E\u5E93\u4E2D\u8BFB\u53D6\u6570\u636E\u5199\u5165\u7F13\u5B58\uFF0C\u6B64\u65F6\u7F13\u5B58\u4E2D\u4E3A\u810F\u6570\u636E\u3002</p><p>2.\u5982\u679C\u5148\u5199\u4E86\u5E93\uFF0C\u5728\u5220\u9664\u7F13\u5B58\u524D\uFF0C\u5199\u5E93\u7684\u7EBF\u7A0B\u5B95\u673A\u4E86\uFF0C\u6CA1\u6709\u5220\u9664\u6389\u7F13\u5B58\uFF0C\u5219\u4E5F\u4F1A\u51FA\u73B0\u6570\u636E\u4E0D\u4E00\u81F4\u60C5\u51B5\u3002</p><p>\u56E0\u4E3A\u5199\u548C\u8BFB\u662F\u5E76\u53D1\u7684\uFF0C\u6CA1\u6CD5\u4FDD\u8BC1\u987A\u5E8F,\u5C31\u4F1A\u51FA\u73B0\u7F13\u5B58\u548C\u6570\u636E\u5E93\u7684\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u95EE\u9898\u3002</p></blockquote><h2 id="\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3" aria-hidden="true">#</a> \u89E3\u51B3\uFF1A</h2><h3 id="_1-\u57FA\u4E8Emysql\u7684binlog\u65E5\u5FD7-canal" tabindex="-1"><a class="header-anchor" href="#_1-\u57FA\u4E8Emysql\u7684binlog\u65E5\u5FD7-canal" aria-hidden="true">#</a> 1 \u57FA\u4E8Emysql\u7684binlog\u65E5\u5FD7\uFF08canal\uFF09</h3><h3 id="_2-\u6D88\u606F\u961F\u5217mq" tabindex="-1"><a class="header-anchor" href="#_2-\u6D88\u606F\u961F\u5217mq" aria-hidden="true">#</a> 2 \u6D88\u606F\u961F\u5217MQ</h3><h1 id="_1\u3001\u672C\u5730\u7F13\u5B58-\u5206\u5E03\u5F0F\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u672C\u5730\u7F13\u5B58-\u5206\u5E03\u5F0F\u7F13\u5B58" aria-hidden="true">#</a> 1\u3001\u672C\u5730\u7F13\u5B58&amp;\u5206\u5E03\u5F0F\u7F13\u5B58</h1><h2 id="_1-1-\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_1-1-\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> 1.1 \u4F7F\u7528\u573A\u666F\uFF1A</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u5373\u65F6\u6027\uFF08\u7269\u6D41\u72B6\u6001\u4FE1\u606F\uFF0C\u66F4\u65B0\u6162\uFF09\uFF1B
\u6570\u636E\u4E00\u81F4\u6027\u4E0D\u9AD8\u7684\uFF08\u5BFC\u822A\u83DC\u5355\u6570\u636E\u3001\u6BD4\u8F83\u56FA\u5B9A\u7684\u6570\u636E\uFF09\uFF1B
\u8BBF\u95EE\u91CF\u5927\u4E14\u66F4\u65B0\u9891\u7387\u4E0D\u9AD8\u7684\u6570\u636E\uFF08\u8BFB\u591A\u3001\u5199\u5C11\uFF09\uFF1B

<span class="token comment">#\u4E3E\u4F8B: \u7535\u5546\u7C7B\u5E94\u7528\uFF0C\u5546\u54C1\u5206\u7C7B\uFF0C\u5546\u54C1\u5217\u8868\u7B49\u9002\u5408\u7F13\u5B58\u5E76\u52A0\u4E00\u4E2A\u5931\u6548\u65F6\u95F4(\u6839\u636E\u6570\u636E\u66F4\u65B0\u9891\u7387\u6765\u5B9A)\uFF0C\u540E\u53F0\u5982\u679C\u53D1\u5E03\u4E00\u4E00\u4E2A\u5546\u54C1\uFF0C\u4E70\u5BB6\u9700\u89815\u5206\u949F\u624D\u80FD\u770B\u5230\u65B0\u7684\u5546\u54C1\u822C\u8FD8\u662F\u53EF\u4EE5\u63A5\u53D7\u7684\u3002</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-2-\u4F7F\u7528\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_1-2-\u4F7F\u7528\u6D41\u7A0B" aria-hidden="true">#</a> 1.2 \u4F7F\u7528\u6D41\u7A0B\uFF1A</h2><p><img src="`+e+`" alt=""></p><h2 id="_1-3-\u7B80\u5355\u5B9E\u4F8B\u683C\u5F0F" tabindex="-1"><a class="header-anchor" href="#_1-3-\u7B80\u5355\u5B9E\u4F8B\u683C\u5F0F" aria-hidden="true">#</a> 1.3 \u7B80\u5355\u5B9E\u4F8B\u683C\u5F0F\uFF1A</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>data <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u4ECE\u7F13\u5B58\u52A0\u8F7D\u6570\u636E</span>
<span class="token function">lf</span><span class="token punctuation">(</span>data <span class="token operator">==</span> nul<span class="token punctuation">)</span><span class="token punctuation">{</span>
	data <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u4ECE\u6570\u636E\u5E93\u52A0\u8F7D\u6570\u636E</span>
	cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u4FDD\u5B58\u5230cache\u4E2D\uFF0C\u6DFB\u52A0\u8FC7\u671F\u65F6\u95F4</span>
<span class="token punctuation">}</span>
retum data<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-4-\u672C\u5730\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-4-\u672C\u5730\u7F13\u5B58" aria-hidden="true">#</a> 1.4 \u672C\u5730\u7F13\u5B58</h2><p>Map&lt;String,Object&gt;\uFF1A\u5728\u591A\u5206\u5E03\u5F0F\u90E8\u7F72\u5B9E\u4F8B\u65F6\u4F1A\u5B58\u5728\uFF1A\u5404\u81EA\u4F7F\u7528\u81EA\u5DF1\u7684\u672C\u5730\u7F13\u5B58</p><p><img src="`+p+'" alt=""></p><p>\u200B \u89E3\u51B3\u529E\u6CD5\uFF1A\u5206\u5E03\u5F0F\u7F13\u5B58</p><h2 id="_1-5-\u5206\u5E03\u5F0F\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-5-\u5206\u5E03\u5F0F\u7F13\u5B58" aria-hidden="true">#</a> 1.5 \u5206\u5E03\u5F0F\u7F13\u5B58</h2><h3 id="_1-5-1-\u7F13\u5B58\u7A7F\u900F" tabindex="-1"><a class="header-anchor" href="#_1-5-1-\u7F13\u5B58\u7A7F\u900F" aria-hidden="true">#</a> 1.5.1 \u7F13\u5B58\u7A7F\u900F <a name="\u7F13\u5B58\u7A7F\u900F"></a></h3><p><img src="'+c+'" alt=""></p><p><img src="'+o+'" alt=""></p><blockquote><p>\uFF08[\u7F13\u5B58\u3001DB]\u90FD\u4E0D\u5B58\u5728\u6570\u636E\uFF091000\u4E07\u6761\u5E76\u53D1\u8BF7\u6C42\uFF0C\u7F13\u5B58\u4E3Anull\uFF0C\u5168\u90E8\u8DD1\u5230db\u67E5\u8BE2\uFF0Cdb\u53EF\u80FD\u76F4\u63A5\u5B95\u673A\u3002</p></blockquote><h3 id="_1-5-2-\u7F13\u5B58\u96EA\u5D29" tabindex="-1"><a class="header-anchor" href="#_1-5-2-\u7F13\u5B58\u96EA\u5D29" aria-hidden="true">#</a> 1.5.2 \u7F13\u5B58\u96EA\u5D29 <a name="\u7F13\u5B58\u96EA\u5D29"></a></h3><p><img src="'+i+'" alt=""></p><blockquote><p>\u5B58\u5728\u7684\u6570\u636E\uFF0C\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548)\u5DF2\u7ECF\u6709\u5F88\u591A\u6570\u636E\u5B58\u5728\uFF0C\u4F46\u6709\u4E00\u4E9B\u8BBE\u7F6E\u4E86\u540C\u6837\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5BFC\u81F4\u4E86\u5F88\u591A\u6CA1\u547D\u4E2D\u3002</p></blockquote><h3 id="_1-5-3-\u7F13\u5B58\u51FB\u7A7F" tabindex="-1"><a class="header-anchor" href="#_1-5-3-\u7F13\u5B58\u51FB\u7A7F" aria-hidden="true">#</a> 1.5.3 \u7F13\u5B58\u51FB\u7A7F <a name="\u7F13\u5B58\u51FB\u7A7F"></a></h3><p><img src="'+l+'" alt=""></p><blockquote><p>\uFF08\u5B58\u5728\u7684\u6570\u636E\uFF0C\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548\uFF091000\u4E07\u6761\u5E76\u53D1\uFF0C\uFF0C\u4F1A\u5168\u90E8\u8DD1\u5230db\u67E5\u8BE2\uFF0Cdb\u53EF\u80FD\u76F4\u63A5\u5B95\u673A\u3002</p></blockquote><h3 id="_1-5-4-\u7F13\u5B58\u7A7F\u900F\u3001\u51FB\u7A7F\u3001\u96EA\u5D29\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_1-5-4-\u7F13\u5B58\u7A7F\u900F\u3001\u51FB\u7A7F\u3001\u96EA\u5D29\u7684\u533A\u522B" aria-hidden="true">#</a> 1.5.4 \u7F13\u5B58\u7A7F\u900F\u3001\u51FB\u7A7F\u3001\u96EA\u5D29\u7684\u533A\u522B\uFF1A</h3><h4 id="_1-\u7A7F\u900F\u662F\u7F13\u5B58\u4E0D\u547D\u4E2D-db\u4E5F\u6CA1\u6709\u4E0D\u547D\u4E2D" tabindex="-1"><a class="header-anchor" href="#_1-\u7A7F\u900F\u662F\u7F13\u5B58\u4E0D\u547D\u4E2D-db\u4E5F\u6CA1\u6709\u4E0D\u547D\u4E2D" aria-hidden="true">#</a> 1.\u7A7F\u900F\u662F\u7F13\u5B58\u4E0D\u547D\u4E2D\uFF0CDB\u4E5F\u6CA1\u6709\u4E0D\u547D\u4E2D</h4><h4 id="_2-\u51FB\u7A7F\u662F\u4E00\u4E2A\u70ED\u70B9key\u5931\u6548" tabindex="-1"><a class="header-anchor" href="#_2-\u51FB\u7A7F\u662F\u4E00\u4E2A\u70ED\u70B9key\u5931\u6548" aria-hidden="true">#</a> 2.\u51FB\u7A7F\u662F\u4E00\u4E2A\u70ED\u70B9key\u5931\u6548</h4><h4 id="_3-\u96EA\u5D29\u662F\u5F88\u591Akey\u96C6\u4F53\u5931\u6548" tabindex="-1"><a class="header-anchor" href="#_3-\u96EA\u5D29\u662F\u5F88\u591Akey\u96C6\u4F53\u5931\u6548" aria-hidden="true">#</a> 3.\u96EA\u5D29\u662F\u5F88\u591Akey\u96C6\u4F53\u5931\u6548</h4><h2 id="_1-6-\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#_1-6-\u603B\u7ED3" aria-hidden="true">#</a> 1.6 \u603B\u7ED3</h2><h3 id="_1-6-1\u3001\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F-\u7A7A\u7ED3\u679C\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-6-1\u3001\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F-\u7A7A\u7ED3\u679C\u7F13\u5B58" aria-hidden="true">#</a> 1.6.1\u3001<strong>\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\uFF1A\u7A7A\u7ED3\u679C\u7F13\u5B58</strong></h3><blockquote><p>.set(&quot;cataLogJson&quot;, cataLogJsonDB == null ? &quot;1001&quot; : cataLogJsonDB));</p></blockquote><h3 id="_1-6-2\u3001\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29-\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4-\u52A0\u968F\u673A\u503C-\u3002\u5B58\u5728\u7684\u6570\u636E-\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548" tabindex="-1"><a class="header-anchor" href="#_1-6-2\u3001\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29-\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4-\u52A0\u968F\u673A\u503C-\u3002\u5B58\u5728\u7684\u6570\u636E-\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548" aria-hidden="true">#</a> 1.6.2\u3001<strong>\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29\uFF1A\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4(\u52A0\u968F\u673A\u503C) \u3002\u5B58\u5728\u7684\u6570\u636E\uFF0C\u5927\u9762\u79EF\u6570\u636E\u540C\u65F6\u5931\u6548</strong></h3><blockquote><p>.set(&quot;cataLogJson&quot;, JSON.toJSONString(cataLogJsonFromDB == null ? &quot;1001&quot; : cataLogJsonFromDB), 1, TimeUnit.DAYS);</p></blockquote><h3 id="_1-6-3\u3001\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u3010\u96BE\u70B9\u3011-\u52A0\u9501-\u5B58\u5728\u7684\u6570\u636E-\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548" tabindex="-1"><a class="header-anchor" href="#_1-6-3\u3001\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u3010\u96BE\u70B9\u3011-\u52A0\u9501-\u5B58\u5728\u7684\u6570\u636E-\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548" aria-hidden="true">#</a> 1.6.3\u3001<strong>\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u3010\u96BE\u70B9\u3011\uFF1A\u52A0\u9501\uFF0C\u5B58\u5728\u7684\u6570\u636E\uFF0C\u67D0\u4E00\u4E2A\u6570\u636E\u70ED\u70B9\u5931\u6548</strong></h3><blockquote><p>\u901A\u8FC7redis ...</p></blockquote><p><img src="'+u+'" alt=""></p><h1 id="_2\u3001\u5206\u5E03\u5F0F\u9501-redis-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u5206\u5E03\u5F0F\u9501-redis-\u914D\u7F6E" aria-hidden="true">#</a> 2\u3001\u5206\u5E03\u5F0F\u9501+redis \u914D\u7F6E</h1><p><img src="'+r+`" alt=""></p><p>\u535A\u5BA2\u5730\u5740\uFF1Ahttps://blog.csdn.net/qq_42476834/article/details/125108089</p><h2 id="_2-1-\u4E1A\u52A1\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_2-1-\u4E1A\u52A1\u6D4B\u8BD5" aria-hidden="true">#</a> 2.1 \u4E1A\u52A1\u6D4B\u8BD5</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCataLogJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u83B7\u53D6\u7F13\u5B58\u6570\u636E</span>
    <span class="token class-name">String</span> cataLogJson <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u65E0\u7F13\u5B58</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cataLogJsonFromDB <span class="token operator">=</span> <span class="token function">getCataLogJsonFromDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//json\u5316\u5B58\u50A8</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>cataLogJsonFromDB<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cataLogJsonFromDB<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//\u6709\u7F13\u5B58\uFF0C\u5C06json\u6570\u636E\u8F6C\u5316\u4E3A\u5BF9\u8C61</span>
    <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\uFF1Ahttp://yumall.com/</p><p>\u65E0\u7F13\u5B58--\u65F6\u95F4\uFF1A40</p><p>\u6709\u7F13\u5B58-----\u65F6\u95F4\uFF1A1</p><h2 id="_2-2-\u538B\u529B\u6D4B\u8BD5\u4E0Ebug\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#_2-2-\u538B\u529B\u6D4B\u8BD5\u4E0Ebug\u89E3\u51B3" aria-hidden="true">#</a> 2.2 \u538B\u529B\u6D4B\u8BD5\u4E0Ebug\u89E3\u51B3</h2><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>//TODO\u4EA7\u751F\u5806\u5916\u5185\u5B58\u6EA2\u51FA:
OutOfDirectMemoryError
//1)\u3001springboot2 . e\u4EE5\u540E\u9ED8\u8BA4\u4F7F\u7528lettuce\u4F5C\u4E3A\u64CD\u4F5Credis\u7684\u5BA2\u6237\u7AEF\u3002\u5B83\u4F7F\u7528netty\u8FDB\u884C\u7F51\u7EDC\u901A\u4FE1\u3002
//2)\u3001lettuce\u7684bug\u5BFC\u81F4netty\u5806\u5916\u5185\u5B58\u6EA2\u51FA-Xmx300m; netty\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u5806\u5916\u5185\u5B58\uFF0C\u9ED8\u8BA4\u4F7F\u7528-Xmx300m
//\u53EF\u4EE5\u901A\u8FC7 -Dio. netty . maxDirectMemory\u8FDB\u884C\u8BBE\u7F6E
//\u89E3\u51B3\u65B9\u6848:\u4E0D\u80FD\u4F7F\u7528-Dio. netty. maxDirec tMemory\u53EA\u53BB\u8C03\u5927\u5806\u5916\u5185\u5B58\u3002
//1)\u3001\u5347\u7EA7Lettuce\u5BA2\u6237\u7AEF\u30022) \u3001\u5207\u6362\u4F7F\u7528jedis
//redisTemplate:
//lettuce\u3001jedis\u64CD\u4F5Credis\u7684\u5E95\u5C42\u5BA2\u6237\u7AEF\u3002Spring\u518D\u6B21\u5C01\u88C5redis Template;

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.lettuce<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lettuce-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-3-\u52A0\u9501\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F" tabindex="-1"><a class="header-anchor" href="#_2-3-\u52A0\u9501\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F" aria-hidden="true">#</a> 2.3 \u52A0\u9501\u89E3\u51B3<code>\u7F13\u5B58\u51FB\u7A7F</code></h2><p>\u5355\u4F53\uFF1A\u672C\u5730\u9501\u5728\u5206\u5E03\u5F0F</p><p>//\u53EA\u8981\u662F\u540C\u4E00\u628A\u9501\uFF0C\u5C31\u80FD\u9501\u4F4F\u9700\u8981\u8FD9\u4E2A\u9501\u7684\u6240\u6709\u7EBF\u7A0B //1\u3001synchronized (this): SpringBoot\u6240\u6709\u7684\u7EC4\u4EF6\u5728\u5BB9\u5668\u4E2D\u90FD\u662F\u5355\u4F8B\u7684\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token function">getCataLogJsonFromDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> 
 <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//\u5355\u4F53\u67B6\u6784\u662F\u6CA1\u95EE\u9898\u7684\uFF0C\u5206\u5E03\u5F0F\u5C31\u4E0D\u884C\u4E86</span>
     <span class="token class-name">String</span> cataLogJson <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TypeReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;synchronized---\u67E5\u8BE2\u4E86\u6570\u636E\u5E93&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
     <span class="token comment">//\u4E4B\u524D\u4E1A\u52A1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6A21\u62DF\u5E76\u53D180\uFF1A<em>\u6CA1\u6709\u9501\u4F4F</em></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58
synchronized---\u67E5\u8BE2\u4E86\u6570\u636E\u5E93
synchronized---\u67E5\u8BE2\u4E86\u6570\u636E\u5E93
..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C..........\u65E0\u7F13\u5B58\uFF0C... ...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="`+d+'" alt="image-20210914112220313" style="zoom:80%;"><p>\u89E3\u51B3\uFF1A</p><img src="'+k+`" alt="image-20210914112316601" style="zoom:80%;"><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">return</span> getCataLogJsonFromDB\u4E4B\u524D\u52A0\u5165\u7F13\u5B58\uFF1A
    stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>collect1 <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">&quot;101&quot;</span> <span class="token operator">:</span> collect1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">AUTOSECONDS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> collect1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD580\u7ED3\u679C\uFF1A\u67E5\u8BE2\u6570\u636E\u5E93\u653E\u5165\u7F13\u5B58</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>..........\u65E0\u7F13\u5B58
..........\u65E0\u7F13\u5B58
..........\u65E0\u7F13\u5B58
..........\u65E0\u7F13\u5B58
..........\u65E0\u7F13\u5B58
synchronized---\u67E5\u8BE2\u4E86\u6570\u636E\u5E93
..........\u65E0\u7F13\u5B58
..........\u65E0\u7F13\u5B58
\u6709\u7F13\u5B58........
\u6709\u7F13\u5B58........
\u6709\u7F13\u5B58........
\u6709\u7F13\u5B58........
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-4-\u672C\u5730\u9501\u5728\u5206\u5E03\u5F0F\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_2-4-\u672C\u5730\u9501\u5728\u5206\u5E03\u5F0F\u670D\u52A1" aria-hidden="true">#</a> 2.4 \u672C\u5730\u9501\u5728\u5206\u5E03\u5F0F\u670D\u52A1</h2><p>\u6A21\u62DF\u591A\u53F0\u670D\u52A1\u5668\u7684\u5546\u54C1\u670D\u52A1\uFF0C\u7AEF\u53E3\u4E0D\u4E00: --server.port=8101, 8102, 8103</p><p>\u53D1\u73B0\uFF1A\u672C\u5730\u9501\u5C06\u53EA\u662F\u5BF9\u4E0E\u672C\u5B9E\u4F8B\u8D77\u4F5C\u7528\u3002</p><p>\u89E3\u51B3\uFF1A\u5206\u5E03\u5F0F\u9501</p><h2 id="_2-5-\u5206\u5E03\u5F0F\u9501\u539F\u7406-\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_2-5-\u5206\u5E03\u5F0F\u9501\u539F\u7406-\u4F7F\u7528" aria-hidden="true">#</a> 2.5 \u5206\u5E03\u5F0F\u9501\u539F\u7406&amp;\u4F7F\u7528</h2><p><img src="`+v+'" alt=""></p><p><img src="'+m+`" alt=""></p><h3 id="_2-5-1-redis\u9501" tabindex="-1"><a class="header-anchor" href="#_2-5-1-redis\u9501" aria-hidden="true">#</a> 2.5.1 redis\u9501</h3><p>\u6587\u6863\uFF1Ahttp://redis.cn/commands.html</p><p>SET\u547D\u4EE4 [key value]</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>    EX seconds \u2013 \u8BBE\u7F6E\u6307\u5B9A\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u4EE5\u79D2\u4E3A\u5355\u4F4D
    PX \u6BEB\u79D2 \u2013 \u8BBE\u7F6E\u6307\u5B9A\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u4EE5\u6BEB\u79D2\u4E3A\u5355\u4F4D\u3002 
    NX \u2013\u4EC5\u5728\u5BC6\u94A5\u4E0D\u5B58\u5728\u65F6\u624D\u8BBE\u7F6E\u5BC6\u94A5\u3002 
    XX \u2013 \u4EC5\u8BBE\u7F6E\u5DF2\u5B58\u5728\u7684\u5BC6\u94A5\u3002 
    EX seconds \u2013 \u8BBE\u7F6E\u952Ekey\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5355\u4F4D\u65F6\u79D2
    PX milliseconds \u2013 \u8BBE\u7F6E\u952Ekey\u7684\u8FC7\u671F\u65F6\u95F4\uFF0C\u5355\u4F4D\u65F6\u6BEB\u79D2
    NX \u2013 \u53EA\u6709\u952Ekey\u4E0D\u5B58\u5728\u7684\u65F6\u5019\u624D\u4F1A\u8BBE\u7F6Ekey\u7684\u503C
    XX \u2013 \u53EA\u6709\u952Ekey\u5B58\u5728\u7684\u65F6\u5019\u624D\u4F1A\u8BBE\u7F6Ekey\u7684\u503C
<span class="token builtin class-name">set</span> lock haha NX 
<span class="token builtin class-name">set</span> lock haha XX 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-2-\u7B80\u5355\u7684\u4E1A\u52A1-\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_2-5-2-\u7B80\u5355\u7684\u4E1A\u52A1-\u5206\u6790" aria-hidden="true">#</a> 2.5.2 \u7B80\u5355\u7684\u4E1A\u52A1+\u5206\u6790</h3><h4 id="a\u3001\u6D4B\u8BD5\u95EE\u98981-setnx\u5360\u597D\u4E86\u4F4D-\u4E1A\u52A1\u4EE3\u7801\u5F02\u5E38\u6216\u8005\u7A0B\u5E8F\u5728\u9875\u9762\u8FC7\u7A0B\u4E2D\u5B95\u673A\u3002\u6CA1\u6709\u6267\u884C\u5220\u9664\u9501\u903B\u8F91-\u8FD9\u5C31\u9020\u6210\u4E86\u6B7B\u9501\u3002" tabindex="-1"><a class="header-anchor" href="#a\u3001\u6D4B\u8BD5\u95EE\u98981-setnx\u5360\u597D\u4E86\u4F4D-\u4E1A\u52A1\u4EE3\u7801\u5F02\u5E38\u6216\u8005\u7A0B\u5E8F\u5728\u9875\u9762\u8FC7\u7A0B\u4E2D\u5B95\u673A\u3002\u6CA1\u6709\u6267\u884C\u5220\u9664\u9501\u903B\u8F91-\u8FD9\u5C31\u9020\u6210\u4E86\u6B7B\u9501\u3002" aria-hidden="true">#</a> A\u3001\u6D4B\u8BD5\u95EE\u98981\uFF1Asetnx\u5360\u597D\u4E86\u4F4D\uFF0C\u4E1A\u52A1\u4EE3\u7801\u5F02\u5E38\u6216\u8005\u7A0B\u5E8F\u5728\u9875\u9762\u8FC7\u7A0B\u4E2D\u5B95\u673A\u3002\u6CA1\u6709\u6267\u884C\u5220\u9664\u9501\u903B\u8F91\uFF0C\u8FD9\u5C31\u9020\u6210\u4E86\u6B7B\u9501\u3002</h4><p><img src="`+g+'" alt=""></p><img src="'+h+'" alt="image-20210914143530694" style="zoom:100%;"><h5 id="\u89E3\u51B3-\u8BBE\u7F6E\u9501\u7684\u81EA\u52A8\u8FC7\u671F-\u5373\u4F7F\u6CA1\u6709\u5220\u9664-\u4F1A\u81EA\u52A8\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-\u8BBE\u7F6E\u9501\u7684\u81EA\u52A8\u8FC7\u671F-\u5373\u4F7F\u6CA1\u6709\u5220\u9664-\u4F1A\u81EA\u52A8\u5220\u9664" aria-hidden="true">#</a> - - \u89E3\u51B3: \u8BBE\u7F6E\u9501\u7684\u81EA\u52A8\u8FC7\u671F\uFF0C\u5373\u4F7F\u6CA1\u6709\u5220\u9664\uFF0C\u4F1A\u81EA\u52A8\u5220\u9664</h5><hr><h4 id="b\u3001\u6D4B\u8BD5\u95EE\u98982-setnx\u8BBE\u7F6E\u597D-\u6B63\u8981\u53BB\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4-\u5B95\u673A\u3002\u53C8\u6B7B\u9501\u4E86\u3002" tabindex="-1"><a class="header-anchor" href="#b\u3001\u6D4B\u8BD5\u95EE\u98982-setnx\u8BBE\u7F6E\u597D-\u6B63\u8981\u53BB\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4-\u5B95\u673A\u3002\u53C8\u6B7B\u9501\u4E86\u3002" aria-hidden="true">#</a> B\u3001\u6D4B\u8BD5\u95EE\u98982\uFF1Asetnx\u8BBE\u7F6E\u597D\uFF0C \u6B63\u8981\u53BB\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF0C\u5B95\u673A\u3002\u53C8\u6B7B\u9501\u4E86\u3002</h4><p><img src="'+b+'" alt=""></p><p><img src="'+f+'" alt=""></p><h5 id="\u89E3\u51B3-\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u548C\u5360\u4F4D\u5FC5\u987B\u662F\u539F\u5B50\u7684\u3002redis\u652F\u6301\u4F7F\u7528setnx-ex\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u548C\u5360\u4F4D\u5FC5\u987B\u662F\u539F\u5B50\u7684\u3002redis\u652F\u6301\u4F7F\u7528setnx-ex\u547D\u4EE4" aria-hidden="true">#</a> - - \u89E3\u51B3: \u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u548C\u5360\u4F4D\u5FC5\u987B\u662F\u539F\u5B50\u7684\u3002redis\u652F\u6301\u4F7F\u7528setnx ex\u547D\u4EE4</h5><hr><h4 id="c\u3001\u6D4B\u8BD5\u95EE\u98983-\u52A0\u9501\u539F\u5B50\u578B-\u5220\u9664\u9501\u76F4\u63A5\u5220\u9664-\u5982\u679C\u7531\u4E8E\u4E1A\u52A1\u65F6\u95F4\u5F88\u957F-\u8D85\u65F6-\u9501\u81EA\u5DF1\u8FC7\u671F\u4E86-\u6211\u4EEC\u76F4\u63A5\u5220\u9664-\u6709\u53EF\u80FD\u628A\u522B\u4EBA\u6B63\u5728\u6301\u6709\u7684\u9501\u5220\u9664\u4E86\u3002" tabindex="-1"><a class="header-anchor" href="#c\u3001\u6D4B\u8BD5\u95EE\u98983-\u52A0\u9501\u539F\u5B50\u578B-\u5220\u9664\u9501\u76F4\u63A5\u5220\u9664-\u5982\u679C\u7531\u4E8E\u4E1A\u52A1\u65F6\u95F4\u5F88\u957F-\u8D85\u65F6-\u9501\u81EA\u5DF1\u8FC7\u671F\u4E86-\u6211\u4EEC\u76F4\u63A5\u5220\u9664-\u6709\u53EF\u80FD\u628A\u522B\u4EBA\u6B63\u5728\u6301\u6709\u7684\u9501\u5220\u9664\u4E86\u3002" aria-hidden="true">#</a> C\u3001\u6D4B\u8BD5\u95EE\u98983\uFF08\u52A0\u9501\u539F\u5B50\u578B\uFF09\uFF1A\u5220\u9664\u9501\u76F4\u63A5\u5220\u9664\uFF1F\uFF1F? \u5982\u679C\u7531\u4E8E\u4E1A\u52A1\u65F6\u95F4\u5F88\u957F\uFF08<em>\u8D85\u65F6</em>\uFF09\uFF0C\u9501\u81EA\u5DF1\u8FC7\u671F\u4E86\uFF0C\u6211\u4EEC\u76F4\u63A5\u5220\u9664\uFF0C\u6709\u53EF\u80FD\u628A\u522B\u4EBA\u6B63\u5728\u6301\u6709\u7684\u9501\u5220\u9664\u4E86\u3002</h4><p><img src="'+y+'" alt=""></p><p><img src="'+x+'" alt=""></p><h5 id="\u89E3\u51B3-\u5360\u9501\u7684\u65F6\u5019-\u503C\u6307\u5B9A\u4E3Auuid-\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-\u5360\u9501\u7684\u65F6\u5019-\u503C\u6307\u5B9A\u4E3Auuid-\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002" aria-hidden="true">#</a> - - \u89E3\u51B3: \u5360\u9501\u7684\u65F6\u5019\uFF0C\u503C\u6307\u5B9A\u4E3Auuid,\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002</h5><hr><h4 id="d\u3001-\u6D4B\u8BD5\u95EE\u98984-\u5360\u9501\u65F6\u6307\u5B9A\u4E3Auuid-\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002\u5982\u679C\u6B63\u597D\u5224\u65AD\u662F\u5F53\u524D\u503C-\u6B63\u8981\u5220\u9664\u9501\u7684\u65F6\u5019-\u9501\u5DF2\u7ECF\u8FC7\u671F\u4E86-\u522B\u4EBA\u5DF2\u7ECF\u8BBE\u7F6E\u5230\u4E86\u65B0\u7684\u503C-\u90A3\u4E48\u6211\u4EEC\u5220\u9664\u7684\u5C31\u662F\u522B\u4EBA\u7684\u9501\u4E86" tabindex="-1"><a class="header-anchor" href="#d\u3001-\u6D4B\u8BD5\u95EE\u98984-\u5360\u9501\u65F6\u6307\u5B9A\u4E3Auuid-\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002\u5982\u679C\u6B63\u597D\u5224\u65AD\u662F\u5F53\u524D\u503C-\u6B63\u8981\u5220\u9664\u9501\u7684\u65F6\u5019-\u9501\u5DF2\u7ECF\u8FC7\u671F\u4E86-\u522B\u4EBA\u5DF2\u7ECF\u8BBE\u7F6E\u5230\u4E86\u65B0\u7684\u503C-\u90A3\u4E48\u6211\u4EEC\u5220\u9664\u7684\u5C31\u662F\u522B\u4EBA\u7684\u9501\u4E86" aria-hidden="true">#</a> D\u3001 \u6D4B\u8BD5\u95EE\u98984\uFF1A\u5360\u9501\u65F6\u6307\u5B9A\u4E3Auuid,\u6BCF\u4E2A\u4EBA\u5339\u914D\u662F\u81EA\u5DF1\u7684\u9501\u624D\u5220\u9664\u3002\u5982\u679C\u6B63\u597D\u5224\u65AD\u662F\u5F53\u524D\u503C\uFF0C\u6B63\u8981\u5220\u9664\u9501\u7684\u65F6\u5019\uFF0C\u9501\u5DF2\u7ECF\u8FC7\u671F\u4E86\uFF0C\u522B\u4EBA\u5DF2\u7ECF\u8BBE\u7F6E\u5230\u4E86\u65B0\u7684\u503C\uFF0C\u90A3\u4E48\u6211\u4EEC\u5220\u9664\u7684\u5C31\u662F\u522B\u4EBA\u7684\u9501\u4E86</h4><p><img src="'+_+'" alt=""></p><p><img src="'+q+'" alt=""></p><h5 id="\u89E3\u51B3-lua\u811A\u672C\u89E3\u9501" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3-lua\u811A\u672C\u89E3\u9501" aria-hidden="true">#</a> - - \u89E3\u51B3: lua\u811A\u672C\u89E3\u9501</h5><hr><h4 id="e\u3001-\u6D4B\u8BD5\u95EE\u98985-lua\u811A\u672C\u89E3\u9501-\u6700\u7EC8\u5F62\u6001" tabindex="-1"><a class="header-anchor" href="#e\u3001-\u6D4B\u8BD5\u95EE\u98985-lua\u811A\u672C\u89E3\u9501-\u6700\u7EC8\u5F62\u6001" aria-hidden="true">#</a> E\u3001 \u6D4B\u8BD5\u95EE\u98985\uFF1Alua\u811A\u672C\u89E3\u9501\uFF08\u6700\u7EC8\u5F62\u6001\uFF09</h4><p><img src="'+w+`" alt=""></p><h2 id="_2-6-\u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-6-\u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B" aria-hidden="true">#</a> 2.6 \u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCataLogJson2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u83B7\u53D6\u7F13\u5B58\u6570\u636E</span>
        <span class="token class-name">String</span> cataLogJson <span class="token operator">=</span> <span class="token class-name">RedisUtils<span class="token punctuation">.</span>String2</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u65E0\u7F13\u5B58</span>
            <span class="token keyword">return</span> <span class="token function">getCataLogJsonFromRedisLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCataLogJsonFromRedisLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> uuid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Boolean</span> lock <span class="token operator">=</span> <span class="token class-name">RedisUtils<span class="token punctuation">.</span>String2</span><span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span><span class="token string">&quot;lock&quot;</span><span class="token punctuation">,</span> uuid<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;\u83B7\u53D6\u5206\u5E03\u5F0F\u9501--\u6210\u529F&quot;);</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cataLogJsonFromDB <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u52A0\u9501\u6210\u529F... \u6267\u884C\u4E1A\u52A1</span>
                cataLogJsonFromDB <span class="token operator">=</span> <span class="token function">getCataLogJsonFromDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u83B7\u53D6\u503C\u5BF9\u6BD4+\u5BF9\u6BD4\u6210\u529F\u5220\u9664=\u539F\u5B50\u64CD\u4F5C,lua\u811A\u672C\u89E3\u9501</span>
                <span class="token class-name">String</span> script <span class="token operator">=</span> <span class="token string">&quot;if redis.call(&#39;get&#39;,KEYS[1]) == ARGV[1] then return redis.call(&#39;del&#39;,KEYS[1]) else return 0 end&quot;</span><span class="token punctuation">;</span>
                <span class="token class-name">Long</span> lock1 <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultRedisScript</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>script<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span><span class="token string">&quot;lock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> cataLogJsonFromDB<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u83B7\u53D6\u5206\u5E03\u5F0F\u9501------\u5931\u8D25&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u52A0\u9501\u5931\u8D25,\u4F11\u7720\u4E00\u4E0B6s\uFF0C\u7EE7\u7EED\u8C03\u7528</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">getCataLogJsonFromRedisLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u53D1\u73B0\u52A0\u9501\u4E0E\u89E3\u9501\u91CD\u590D-\u628A\u4ED6\u63D0\u51FA\u6765\u5230\u5DE5\u5177\u7C7B-\u4F46\u5206\u5E03\u5F0F\u6846\u67B6\u6709\u6210\u578B\u4EA7\u54C1\u300Aredisson-\u6574\u5408\u300B" tabindex="-1"><a class="header-anchor" href="#\u53D1\u73B0\u52A0\u9501\u4E0E\u89E3\u9501\u91CD\u590D-\u628A\u4ED6\u63D0\u51FA\u6765\u5230\u5DE5\u5177\u7C7B-\u4F46\u5206\u5E03\u5F0F\u6846\u67B6\u6709\u6210\u578B\u4EA7\u54C1\u300Aredisson-\u6574\u5408\u300B" aria-hidden="true">#</a> <strong>\u53D1\u73B0\u52A0\u9501\u4E0E\u89E3\u9501\u91CD\u590D\uFF0C\u628A\u4ED6\u63D0\u51FA\u6765\u5230\u5DE5\u5177\u7C7B\uFF0C\u4F46\u5206\u5E03\u5F0F\u6846\u67B6\u6709\u6210\u578B\u4EA7\u54C1\u300ARedisSon \u6574\u5408\u300B</strong></h2><h1 id="_3\u3001\u5206\u5E03\u5F0F\u9501-redisson" tabindex="-1"><a class="header-anchor" href="#_3\u3001\u5206\u5E03\u5F0F\u9501-redisson" aria-hidden="true">#</a> 3\u3001\u5206\u5E03\u5F0F\u9501 RedisSon</h1><p>https://redis.io/topics/distlock</p><h2 id="_3-1-redisson-\u6574\u5408" tabindex="-1"><a class="header-anchor" href="#_3-1-redisson-\u6574\u5408" aria-hidden="true">#</a> 3.1. RedisSon \u6574\u5408</h2><h3 id="\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#\u4F9D\u8D56" aria-hidden="true">#</a> - - \u4F9D\u8D56</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E" aria-hidden="true">#</a> - - \u914D\u7F6E</h3><p>\u6587\u6863\uFF1Ahttps://github.com/redisson/redisson/wiki</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * destroyMethod = close/shutdown
 *
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>destroyMethod <span class="token operator">=</span> <span class="token string">&quot;shutdown&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">RedissonClient</span> <span class="token function">redisSon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u9ED8\u8BA4\u8FDE\u63A5\u5730\u5740 127.0.0.1:6379</span>
    <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">&quot;redis://127.0.0.1:6379&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RedissonClient</span> redisson <span class="token operator">=</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> redisson<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5" aria-hidden="true">#</a> - - \u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RedissonClient</span> redissonClient<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>redissonClient<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//org.redisson.Redisson@7037a680</span>
<span class="token punctuation">}</span>


\u5F02\u5E38\uFF1A<span class="token class-name">Redis</span> url should start <span class="token keyword">with</span> <span class="token namespace">redis</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span> or rediss<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token class-name">SSL</span> connection<span class="token punctuation">)</span>
\u89E3\u51B3\uFF1Aconfig<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">&quot;redis://127.0.0.1:6379&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-2-redisson-lock-\u9501\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_3-2-redisson-lock-\u9501\u6D4B\u8BD5" aria-hidden="true">#</a> 3.2. RedisSon-lock \u9501\u6D4B\u8BD5</h2><h3 id="\u7B80\u5355\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u7B80\u5355\u6D4B\u8BD5" aria-hidden="true">#</a> - - \u7B80\u5355\u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">//1\u3001\u83B7\u53D6\u4E00\u628A\u9501\uFF0C\u53EA\u8981\u9501\u7684\u540D\u5B57\u4E00\u6837\uFF0C\u5C31\u662F\u540C\u4E00\u628A\u9501</span>
        <span class="token class-name">RLock</span> lock <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">&quot;my-lock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*
        2\u3001\u52A0\u9501\u3001\u963B\u585E\u5F0F\u7B49\u5F85\uFF0C\u9ED8\u8BA430s
        \u9501\u7684\u81EA\u52A8\u7EED\u671F\uFF0C\u5982\u679C\u4E1A\u52A1\u8D85\u957F\uFF0C\u8FD0\u884C\u671F\u95F4\u81EA\u52A8\u7ED9\u9501\u7EED\u4E0A\u65B0\u768430s\u3002\u4E0D\u7528\u62C5\u5FC3\u4E1A\u52A1\u65F6\u95F4\u957F\uFF0C\u9501\u81EA\u52A8\u8FC7\u671F\u88AB\u5220\u6389\u3002
        2)\u3001\u52A0\u9501\u7684\u4E1A\u52A1\u53EA\u8981\u8FD0\u884C\u5B8C\u6210\uFF0C\u5C31\u4E0D\u4F1A\u7ED9\u5F53\u524D\u9501\u7EED\u671F\uFF0C\u5373\u4F7F\u4E0D\u624B\u52A8\u89E3\u9501\uFF0C\u9501\u9ED8\u8BA4\u572830s\u4EE5\u540E\u81EA\u52A8\u5220\u9664\u3002
        */</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u52A0\u9501\u5B8C\u6210\uFF0C\u4E1A\u52A1\u5904\u7406\u4E2D.......&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u91CA\u653E\u9501...&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="lock\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#lock\u7279\u70B9" aria-hidden="true">#</a> lock\u7279\u70B9\uFF1A</h3><p>\u52A0\u9501\u3001\u963B\u585E\u5F0F\u7B49\u5F85\u3002 \u9501\u7684\u81EA\u52A8\u7EED\u671F\uFF0C\u5982\u679C\u4E1A\u52A1\u8D85\u957F\uFF0C\u8FD0\u884C\u671F\u95F4\u81EA\u52A8\u7ED9\u9501\u7EED\u4E0A\u65B0\u768430s\u3002\u4E0D\u7528\u62C5\u5FC3\u4E1A\u52A1\u65F6\u95F4\u957F\uFF0C\u9501\u81EA\u52A8\u8FC7\u671F\u88AB\u5220\u6389\u3002 \u52A0\u9501\u7684\u4E1A\u52A1\u53EA\u8981\u8FD0\u884C\u5B8C\u6210\uFF0C\u5C31\u4E0D\u4F1A\u7ED9\u5F53\u524D\u9501\u7EED\u671F\uFF0C\u5373\u4F7F\u4E0D\u624B\u52A8\u89E3\u9501\uFF0C\u9501\u9ED8\u8BA4\u572830s\u4EE5\u540E\u81EA\u52A8\u5220\u9664\u3002</p><h2 id="_3-3-redisson-lock-\u770B\u95E8\u72D7\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#_3-3-redisson-lock-\u770B\u95E8\u72D7\u539F\u7406" aria-hidden="true">#</a> 3.3. RedisSon-lock \u770B\u95E8\u72D7\u539F\u7406</h2><h2 id="_3-4-redisson-\u8BFB\u5199\u9501-readwritelock" tabindex="-1"><a class="header-anchor" href="#_3-4-redisson-\u8BFB\u5199\u9501-readwritelock" aria-hidden="true">#</a> 3.4. RedisSon \u8BFB\u5199\u9501 ReadWriteLock</h2><h3 id="\u6D4B\u8BD5-1" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5-1" aria-hidden="true">#</a> - - \u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u4FDD\u8BC1\u4E00\u5B9A\u80FD\u8BFB\u5230\u6700\u65B0\u6570\u636E,\u4FEE\u6539\u671F\u95F4\uFF0C\u5199\u9501\u662F-\u4E2A\u6392\u4ED6\u9501(\u4E92\u65A5\u9501)\u3002\u8BFB\u9501\u662F\u4E00\u4E2A\u5171\u4EAB\u9501<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * \u5199\u9501\u6CA1\u91CA\u653E\u8BFB\u5C31\u5FC5\u987B\u7B49\u5F85
 *
 * <span class="token keyword">@return</span> uuid
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/write&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">writeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">RReadWriteLock</span> lock <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReadWriteLock</span><span class="token punctuation">(</span><span class="token string">&quot;rw-lock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">RLock</span> rLock <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">//1\u3001\u6539\u6570\u636E\u52A0\u5199\u9501\uFF0C\u8BFB\u6570\u636E\u52A0\u8BFB\u9501</span>
        rLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5199\u9501--\u52A0\u9501\u6210\u529F... &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        uuid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisUtils<span class="token punctuation">.</span>String2</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;writeValue&quot;</span><span class="token punctuation">,</span> uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        rLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5199\u9501--\u91CA\u653E&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> uuid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/read&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">readValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">RReadWriteLock</span> lock <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReadWriteLock</span><span class="token punctuation">(</span><span class="token string">&quot;rw-lock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">RLock</span> rLock <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">//1\u3001\u6539\u6570\u636E\u52A0\u5199\u9501\uFF0C\u8BFB\u6570\u636E\u52A0\u8BFB\u9501</span>
        rLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u8BFB\u9501--\u52A0\u9501\u6210\u529F... &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        uuid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisUtils<span class="token punctuation">.</span>String2</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;writeValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        rLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u8BFB\u9501--\u91CA\u653E&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> uuid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7ED3\u8BBA" tabindex="-1"><a class="header-anchor" href="#\u7ED3\u8BBA" aria-hidden="true">#</a> - - \u7ED3\u8BBA</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>* \u4FDD\u8BC1\u4E00\u5B9A\u80FD\u8BFB\u5230\u6700\u65B0\u6570\u636E\uFF0C\u4FEE\u6539\u671F\u95F4\uFF0C\u5199\u9501\u662F\u4E00\u4E2A\u6392\u4ED6\u9501 (\u4E92\u65A5\u9501\u3001\u72EC\u4EAB\u9501)\u3002\u8BFB\u9501\u662F\u4E00\u4E2A\u5171\u4EAB\u9501
* \u5199\u9501\u6CA1\u91CA\u653E\u8BFB\u5C31\u5FC5\u987B\u7B49\u5F85
* \u8BFB+\u8BFB:\u76F8\u5F53\u4E8E\u65E0\u9501\uFF0C\u5E76\u53D1\u8BFB\uFF0C\u53EA\u4F1A\u5728redis\u4E2D\u8BB0\u5F55\u597D\uFF0C \u6240\u6709\u5F53\u524D\u7684\u8BFB\u9501\u3002\u4ED6\u4EEC\u90FD\u4F1A\u540C\u65F6\u52A0\u9501\u6210\u529F
* \u5199+\u8BFB:\u7B49\u5F85\u5199\u9501\u91CA\u653E
* \u5199+\u5199:-\u963B\u585E\u65B9\u5F0F
* \u8BFB+\u5199:\u6709\u8BFB\u9501\u3002\u5199\u4E5F\u9700\u8981\u7B49\u5F85\u3002
* \u53EA\u8981\u6709\u5199\u7684\u5B58\u5728\uFF0C\u90FD\u5FC5\u987B\u7B49\u5F85.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+S+`" alt=""></p><h2 id="_3-5-redisson-\u95ED\u9501countdownlatch-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_3-5-redisson-\u95ED\u9501countdownlatch-\u6D4B\u8BD5" aria-hidden="true">#</a> 3.5. RedisSon \u95ED\u9501CountDownLatch \u6D4B\u8BD5</h2><h3 id="\u653E\u5047-\u9501\u95E8-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u653E\u5047-\u9501\u95E8-\u6D4B\u8BD5" aria-hidden="true">#</a> - - \u653E\u5047\uFF0C\u9501\u95E8 \u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u95ED\u9501CountDownLatch
 *
 * <span class="token keyword">@return</span>
 * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">InterruptedException</span></span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/lockDoor&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">lockDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">RCountDownLatch</span> door <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCountDownLatch</span><span class="token punctuation">(</span><span class="token string">&quot;door&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    door<span class="token punctuation">.</span><span class="token function">trySetCount</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    door<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u7B49\u5F85\u95ED\u9501\u90FD\u5B8C\u6210</span>
    <span class="token keyword">return</span> <span class="token string">&quot;\u653E\u5047\u4E86...&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/gogo/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">gogo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">RCountDownLatch</span> door <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCountDownLatch</span><span class="token punctuation">(</span><span class="token string">&quot;door&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    door<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u8BA1\u6570\u51CF- -;|</span>
    <span class="token keyword">return</span> id <span class="token operator">+</span> <span class="token string">&quot; \u73ED\u7684\u4EBA\u90FD\u8D70\u4E86...&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7ED3\u8BBA-1" tabindex="-1"><a class="header-anchor" href="#\u7ED3\u8BBA-1" aria-hidden="true">#</a> - - \u7ED3\u8BBA</h3><p>\u7B49\u5F85\u67D0\u4E00\u4E8B\u7269\u5904\u7406\u5168\u90E8\u4E1A\u52A1\u5B8C\u6210\u540E\uFF0C\u5728\u6267\u884C\u67D0\u64CD\u4F5C</p><h2 id="_3-6-redisson-\u4FE1\u53F7\u91CFsemaphore-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_3-6-redisson-\u4FE1\u53F7\u91CFsemaphore-\u6D4B\u8BD5" aria-hidden="true">#</a> 3.6. RedisSon \u4FE1\u53F7\u91CFSemaphore \u6D4B\u8BD5</h2><h3 id="\u8F66\u5E93\u505C\u8F66\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u8F66\u5E93\u505C\u8F66\u6D4B\u8BD5" aria-hidden="true">#</a> - - \u8F66\u5E93\u505C\u8F66\u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u8FDB\u8F66\u5E93\u505C\u8F66\uFF1AA\u53E3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * \u8F66\u4F4D\u6570-1\uFF0C\u83B7\u53D61\u4E2A\u4FE1\u53F7\uFF0C\u83B7\u53D61\u4E2A\u503C,\u53601\u4E2A\u8F66\u4F4D.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * \u4FE1\u53F7\u91CF\u4E5F\u53EF\u4EE5\u7528\u4F5C\u5206\u5E03\u5F0F\u9650\u6D41;
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/park&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">RSemaphore</span> park <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSemaphore</span><span class="token punctuation">(</span><span class="token string">&quot;park&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    park<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u83B7\u53D61\u4E2A\u4FE1\u53F7\uFF0C\u83B7\u53D61\u4E2A\u503C,\u53601\u4E2A\u8F66\u4F4D</span>
    <span class="token keyword">boolean</span> b <span class="token operator">=</span> park<span class="token punctuation">.</span><span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u6267\u884C\u4E1A\u52A1</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ok=&gt;&quot;</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u51FA\u8F66\u5E93\uFF1AA\u53E3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * \u91CA\u653E1\u4E2A\u8F66\u4F4D\uFF0C\u8F66\u4F4D\u603B\u91CF+1
 *
 * <span class="token keyword">@return</span>
 * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">InterruptedException</span></span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/go&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token class-name">RSemaphore</span> park <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSemaphore</span><span class="token punctuation">(</span><span class="token string">&quot;park&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    park<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u91CA\u653E- -\u4E2A\u8F66\u4F4D</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-7-redisson-\u7F13\u5B58\u4E00\u81F4\u6027\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#_3-7-redisson-\u7F13\u5B58\u4E00\u81F4\u6027\u89E3\u51B3" aria-hidden="true">#</a> 3.7. RedisSon \u7F13\u5B58\u4E00\u81F4\u6027\u89E3\u51B3</h2><h3 id="\u539F\u7406-\u53CC\u5199\u6A21\u5F0F\u3001\u5931\u6548\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u539F\u7406-\u53CC\u5199\u6A21\u5F0F\u3001\u5931\u6548\u6A21\u5F0F" aria-hidden="true">#</a> - - \u539F\u7406\uFF1A\u53CC\u5199\u6A21\u5F0F\u3001\u5931\u6548\u6A21\u5F0F</h3><p><img src="`+C+'" alt=""></p><p><img src="'+L+`" alt=""></p><h3 id="\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> - - \u89E3\u51B3\u65B9\u6848</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u25CF\u65E0\u8BBA\u662F\u53CC\u5199\u6A21\u5F0F\u8FD8\u662F\u5931\u6548\u6A21\u5F0F\uFF0C\u90FD\u4F1A\u5BFC\u81F4\u7F13\u5B58\u7684\u4E0D\u4E00\u81F4\u95EE\u9898\u3002\u5373\u591A\u4E2A\u5B9E\u4F8B\u540C\u65F6\u66F4\u65B0\u4F1A\u51FA\u4E8B\u3002\u600E\u4E48\u529E?
    \u25CF1\u3001\u5982\u679C\u662F\u7528\u6237\u7EAC\u5EA6\u6570\u636E<span class="token punctuation">(</span>\u8BA2\u5355\u6570\u636E\u3001\u7528\u6237\u6570\u636E<span class="token punctuation">)</span>\uFF0C\u8FD9\u79CD\u5E76\u53D1\u51E0\u7387\u975E\u5E38\u5C0F\uFF0C\u4E0D\u7528\u8003\u8651\u8FD9\u4E2A\u95EE\u9898\uFF0C\u7F13\u5B58\u6570\u636E\u52A0\u4E0A\u8FC7\u671F\u65F6\u95F4\uFF0C\u6BCF\u9694\u4E00\u6BB5\u65F6\u95F4\u89E6\u53D1\u8BFB\u7684\u4E3B\u52A8\u66F4\u65B0\u5373\u53EF
    \u25CF2\u3001\u5982\u679C\u662F\u83DC\u5355\uFF0C\u5546\u54C1\u4ECB\u7ECD\u7B49\u57FA\u7840\u6570\u636E\uFF0C\u4E5F\u53EF\u4EE5\u53BB\u4F7F\u7528 canal \u8BA2\u9605 binlog \u7684\u65B9\u5F0F\u3002
    \u25CF3\u3001\u7F13\u5B58\u6570\u636E+\u8FC7\u671F\u65F6\u95F4\u4E5F\u8DB3\u591F\u89E3\u51B3\u5927\u90E8\u5206\u4E1A\u52A1\u5BF9\u4E8E\u7F13\u5B58\u7684\u8981\u6C42\u3002
    \u25CF4\u3001\u901A\u8FC7\u52A0\u9501\u4FDD\u8BC1\u5E76\u53D1\u8BFB\u5199\uFF0C\u5199\u5199\u7684\u65F6\u5019\u6309\u987A\u5E8F\u6392\u597D\u961F\u3002\u8BFB\u8BFB\u65E0\u6240\u8C13\u3002\u6240\u4EE5\u9002\u5408\u4F7F\u7528\u8BFB\u5199\u9501\u3002 <span class="token punctuation">(</span>\u4E1A\u52A1\u4E0D\u5173\u5FC3\u810F\u6570\u636E\uFF0C\u5141\u8BB8\u4E34\u65F6\u810F\u6570\u636E\u53EF\u5FFD\u7565<span class="token punctuation">)</span>.

\u25CF\u603B\u7ED3:
    \u25CF\u6211\u4EEC\u80FD\u653E\u5165\u7F13\u5B58\u7684\u6570\u636E\u672C\u5C31\u4E0D\u5E94\u8BE5\u662F\u5B9E\u65F6\u6027\u3001-\u81F4\u6027\u8981\u6C42\u8D85\u9AD8\u7684\u3002\u6240\u4EE5\u7F13\u5B58\u6570\u636E\u7684\u65F6\u5019\u52A0\u4E0A\u8FC7\u671F\u65F6\u95F4\uFF0C\u4FDD\u8BC1\u6BCF\u5929\u62FF\u5230\u5F53\u524D\u6700\u65B0\u6570\u636E\u5373\u53EF\u3002
    \u25CF\u6211\u4EEC\u4E0D\u5E94\u8BE5\u8FC7\u5EA6\u8BBE\u8BA1\uFF0C\u589E\u52A0\u7CFB\u7EDF\u7684\u590D\u6742\u6027
    \u25CF\u9047\u5230\u5B9E\u65F6\u6027\u3001\u4E00\u81F4\u6027\u8981\u6C42\u9AD8\u7684\u6570\u636E\uFF0C\u5C31\u5E94\u8BE5\u67E5\u6570\u636E\u5E93\uFF0C\u5373\u4F7F\u6162\u70B9\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="canal" tabindex="-1"><a class="header-anchor" href="#canal" aria-hidden="true">#</a> - - Canal</h3><p><img src="`+R+`" alt=""></p><h3 id="\u4F7F\u7528\u5931\u6548\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u5931\u6548\u6A21\u5F0F" aria-hidden="true">#</a> - - \u4F7F\u7528\u5931\u6548\u6A21\u5F0F</h3><p>\u6211\u4EEC\u7CFB\u7EDF\u7684\u4E00\u81F4\u6027\u89E3\u51B3\u65B9\u6848: 1\u3001 \u7F13\u5B58\u7684\u6240\u6709\u6570\u636E\u90FD\u6709\u8FC7\u671F\u65F6\u95F4\uFF0C\u6570\u636E\u8FC7\u671F\u4E0B\u4E00\u6B21\u67E5\u8BE2\u89E6\u53D1\u4E3B\u52A8\u66F4\u65B0 2\u3001\u8BFB\u5199\u6570\u636E\u7684\u65F6\u5019\uFF0C\u52A0\u4E0A\u5206\u5E03\u5F0F\u7684\u8BFB\u5199\u9501\u3002 \u7ECF\u5E38\u5199\uFF0C\u7ECF\u5E38\u8BFB</p><p>\u4F7F\u7528SpringCache</p><h2 id="redissonlock\u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#redissonlock\u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B" aria-hidden="true">#</a> RedissonLock\u5B8C\u6574\u4E1A\u52A1\u5B9E\u4F8B</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCataLogJson2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u83B7\u53D6\u7F13\u5B58\u6570\u636E</span>
        <span class="token class-name">String</span> cataLogJson <span class="token operator">=</span> <span class="token class-name">RedisUtils<span class="token punctuation">.</span>String2</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;..........\u65E0\u7F13\u5B58&quot;);</span>
            <span class="token comment">//\u65E0\u7F13\u5B58</span>
            <span class="token keyword">return</span> <span class="token function">getCataLogJsonFromRedissonLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//System.out.println(&quot;\u6709\u7F13\u5B58........&quot;);</span>
        <span class="token comment">//\u6709\u7F13\u5B58\uFF0C\u5C06json\u6570\u636E\u8F6C\u5316\u4E3A\u5BF9\u8C61</span>
        <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>cataLogJson<span class="token punctuation">,</span> \u3002<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCataLogJsonFromRedissonLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//        System.out.println(&quot;\u83B7\u53D6\u5206\u5E03\u5F0F\u9501--\u6210\u529F&quot;);</span>
    <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">redisson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">&quot;cataLogJson-lock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Catalog2Vo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cataLogJsonFromDB <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cataLogJsonFromDB <span class="token operator">=</span> <span class="token function">getCataLogJsonFromDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5177\u4F53\u4E1A\u52A1</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cataLogJsonFromDB<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="_4\u3001springcache" tabindex="-1"><a class="header-anchor" href="#_4\u3001springcache" aria-hidden="true">#</a> 4\u3001SpringCache</h1><p><img src="`+J+`" alt=""></p><h2 id="_4-1-\u6574\u5408" tabindex="-1"><a class="header-anchor" href="#_4-1-\u6574\u5408" aria-hidden="true">#</a> 4.1. \u6574\u5408</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">8</span>\u3001\u6574\u5408SpringCache\u7B80\u5316\u7F13\u5B58\u5F00\u53D1
    <span class="token number">1</span><span class="token punctuation">)</span>\u3001\u5F15\u5165\u4F9D\u8D56
    	spring-boot-starter-cache\u3001spring-boot-starter-data-redis
    <span class="token number">2</span><span class="token punctuation">)</span>\u3001\u5199\u914D\u7F6E
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>\u3001\u81EA\u52A8\u914D\u7F6E\u4E86\u54EA\u4E9B
            CacheAuroConfiguration\u4F1A\u5BFC\u5165RedisCacheConfiguration<span class="token punctuation">;</span>
            \u81EA\u52A8\u914D\u597D\u4E86\u7F13\u5B58\u7BA1\u7406\u5668RedisCacheManager
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>\u3001\u914D\u7F6E\u4F7F\u7528redis\u4F5C\u4E3A\u7F13\u5B58
        	spring.cache.type<span class="token operator">=</span>redis <span class="token comment">#spring.cache.cache-names=qq</span>
    <span class="token number">3</span><span class="token punctuation">)</span>\u3001\u6D4B\u8BD5\u4F7F\u7528\u7F13\u5B58
        @Cacheable: Triggers cache population.\u89E6\u53D1\u7F13\u5B58\u586B\u5145
        @CacheEvict: Triggers cache eviction.\u89E6\u53D1\u7F13\u5B58\u9A71\u9010,\u5931\u6548\u6A21\u5F0F\u4F7F\u7528
        @CachePut: Updates the cache without interfering with the method execution.\u5728\u4E0D\u5E72\u6270\u65B9\u6CD5\u6267\u884C\u7684\u60C5\u51B5\u4E0B\u66F4\u65B0\u7F13\u5B58\uFF0C\u53CC\u5199\u6A21\u5F0F\u4F7F\u7528
        @Caching: Regroups multiple cache operations to be applied on a method.\u91CD\u65B0\u7EC4\u5408\u8981\u5E94\u7528\u4E8E\u65B9\u6CD5\u7684\u591A\u4E2A\u7F13\u5B58\u64CD\u4F5C\u3002
        @CacheConfig: Shares some common cache-related settings at class-level.\u5728\u7C7B\u7EA7\u522B\u5171\u4EAB\u4E00\u4E9B\u5E38\u89C1\u7684\u7F13\u5B58\u76F8\u5173\u8BBE\u7F6E\u3002
        
		<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>\u3001\u5F00\u542F\u7F13\u5B58\uFF1A\u542F\u52A8\u7C7B @EnableCaching\u3001\u65B9\u6CD5 @Cacheable<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			Cacheable\u4EE3\u8868\u5F53\u524D\u65B9\u6CD5\u7684\u7ED3\u679C\u9700\u8981\u7F13\u5B58\uFF0C\u5982\u679C\u7F13\u5B58\u4E2D\u6709\uFF0C\u65B9\u6CD5\u4E0D\u7528\u8C03\u7528\u3002\u5982\u679C\u7F13\u5B58\u4E2D\u6CA1\u6709\uFF0C\u4F1A\u8C03\u7528\u65B9\u6CD5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-2-cacheable\u7EC6\u8282\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#_4-2-cacheable\u7EC6\u8282\u8BBE\u7F6E" aria-hidden="true">#</a> 4.2. @Cacheable\u7EC6\u8282\u8BBE\u7F6E</h2><p>@Cacheable(value=&quot;myCache&quot;)\uFF0C\u4EE3\u8868\u5F53\u524D\u65B9\u6CD5\u7684\u7ED3\u679C\u9700\u8981\u7F13\u5B58\uFF0C\u5982\u679C\u7F13\u5B58\u4E2D\u6709\uFF0C\u65B9\u6CD5\u4E0D\u7528\u8C03\u7528\u3002\u5982\u679C\u7F13\u5B58\u4E2D\u6CA1\u6709\uFF0C\u4F1A\u8C03\u7528\u65B9\u6CD5\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>*  -- key \u9ED8\u8BA4\u81EA\u52A8\u751F\u6210\uFF0C\u7F13\u5B58\u540D\u5B57::SimpleKey []
*  --value \u9ED8\u8BA4\u4F7F\u7528jdk\u5E8F\u5217\u5316\u673A\u5236
*  -- -1 \u6570\u636E\u6301\u4E45\u5316\uFF0C
\u6240\u4EE5\uFF1A\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\u8BBE\u7F6E
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-3-\u81EA\u5B9A\u4E49\u7F13\u5B58\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#_4-3-\u81EA\u5B9A\u4E49\u7F13\u5B58\u8BBE\u7F6E" aria-hidden="true">#</a> 4.3. \u81EA\u5B9A\u4E49\u7F13\u5B58\u8BBE\u7F6E</h2><p>\u6307\u5B9A\uFF1Akey\uFF0C\u65F6\u95F4\uFF0Cjson\u5316</p><p>key\uFF0C\u65F6\u95F4:\u914D\u7F6E\u6587\u4EF6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@Cacheable(value = {&quot;category&quot;}, key = &quot;&#39;level1Categorys&#39;&quot;)
@Cacheable(value = {&quot;category&quot;}, key = &quot;#root.method.name&quot;)
#1\u5C0F\u65F6
spring.cache.redis.time-to-live=3600000
#spring.cache.redis.key-prefix=CACHE_
spring.cache.redis.use-key-prefix=true
#\u5B58\u50A8null\u503C\uFF0C\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898
spring.cache.redis.cache-null-values=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>json\u5316+\u914D\u7F6E\u6587\u4EF6\u65F6\u95F4\u5931\u6548</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">CacheProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableCaching</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCacheConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisCacheConfiguration</span> <span class="token function">redisCacheConfiguration</span><span class="token punctuation">(</span><span class="token class-name">CacheProperties</span> cacheProperties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisCacheConfiguration</span> config <span class="token operator">=</span> <span class="token class-name">RedisCacheConfiguration</span><span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">serializeKeysWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//        config = config.entryTtl();</span>
        <span class="token comment">//\u5C06\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u6240\u6709\u914D\u7F6E\u90FD\u751F\u6548</span>
        <span class="token class-name">CacheProperties<span class="token punctuation">.</span>Redis</span> redisProperties <span class="token operator">=</span> cacheProperties<span class="token punctuation">.</span><span class="token function">getRedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>redisProperties<span class="token punctuation">.</span><span class="token function">getTimeToLive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span>redisProperties<span class="token punctuation">.</span><span class="token function">getTimeToLive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>redisProperties<span class="token punctuation">.</span><span class="token function">getKeyPrefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">prefixKeysWith</span><span class="token punctuation">(</span>redisProperties<span class="token punctuation">.</span><span class="token function">getKeyPrefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>redisProperties<span class="token punctuation">.</span><span class="token function">isCacheNullValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">disableCachingNullValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>redisProperties<span class="token punctuation">.</span><span class="token function">isUseKeyPrefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            config <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">disableKeyPrefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-4-cacheevict-caching-\u5931\u6548\u6A21\u5F0F\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_4-4-cacheevict-caching-\u5931\u6548\u6A21\u5F0F\u4F7F\u7528" aria-hidden="true">#</a> 4.4. @CacheEvict+Caching \u5931\u6548\u6A21\u5F0F\u4F7F\u7528</h2><p>@CachEvict \u7684\u4F5C\u7528 \u4E3B\u8981\u9488\u5BF9\u65B9\u6CD5\u914D\u7F6E\uFF0C\u80FD\u591F\u6839\u636E\u4E00\u5B9A\u7684\u6761\u4EF6\u5BF9\u7F13\u5B58\u8FDB\u884C\u6E05\u7A7A\u3002</p><h3 id="_4-4-1-\u5220\u9664\u4E00\u4E2A" tabindex="-1"><a class="header-anchor" href="#_4-4-1-\u5220\u9664\u4E00\u4E2A" aria-hidden="true">#</a> 4.4.1 \u5220\u9664\u4E00\u4E2A</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@CacheEvict(value = {&quot;category&quot;}, key = &quot;&#39;getLevel1Categorys&#39;&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-4-2-\u5220\u9664\u591A\u4E2A" tabindex="-1"><a class="header-anchor" href="#_4-4-2-\u5220\u9664\u591A\u4E2A" aria-hidden="true">#</a> 4.4.2 \u5220\u9664\u591A\u4E2A</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@Caching(evict = {
        @CacheEvict(value = {&quot;category&quot;}, key = &quot;&#39;getLevel1Categorys&#39;&quot;),
        @CacheEvict(value = {&quot;category&quot;}, key = &quot;&#39;getCataLogJson&#39;&quot;),
})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@CacheEvict(value = {&quot;category&quot;}, allEntries = true)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_4-5-cacheput-\u53CC\u5199\u6A21\u5F0F\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_4-5-cacheput-\u53CC\u5199\u6A21\u5F0F\u4F7F\u7528" aria-hidden="true">#</a> 4.5. @CachePut \u53CC\u5199\u6A21\u5F0F\u4F7F\u7528</h2><h2 id="_4-6-\u539F\u7406\u4E0E\u4E0D\u8DB3" tabindex="-1"><a class="header-anchor" href="#_4-6-\u539F\u7406\u4E0E\u4E0D\u8DB3" aria-hidden="true">#</a> 4.6. \u539F\u7406\u4E0E\u4E0D\u8DB3</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Spring-Cache\u7684\u4E0D\u8DB3;
    1)\u3001\u8BFB\u6A21\u5F0F:
    	\u7F13\u5B58\u7A7F\u900F:\u67E5\u8BE2\u4E00\u4E2Anull\u6570\u636E\u3002\u89E3\u51B3:\u7F13\u5B58\u7A7A\u6570\u636E\uFF0Credis.cache-null-values=true
        \u7F13\u5B58\u51FB\u7A7F:\u5927\u91CF\u5E76\u53D1\u8FDB\u6765\u540C\u65F6\u67E5\u8BE2-\u4E2A\u6B63\u597D\u8FC7\u671F\u7684\u6570\u636E\u3002\u89E3\u51B3:\u52A0\u9501; \u9ED8\u8BA4\u662F\u65E0\u9501\u7684\uFF0Csync=true\uFF08\u52A0\u9501\uFF0C\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\uFF09
        \u7F13\u5B58\u96EA\u5D29:\u5927\u91CF\u7684key\u540C\u65F6\u8FC7\u671F\u3002\u89E3\u51B3:\u52A0\u968F\u673A\u65F6\u95F4\u3002\u52A0\u4E0A\u8FC7\u671F\u65F6\u95F4\u3002spring.cache.redis.time-to-live=3600000
    2)\u3001\u5199\u6A21\u5F0F: (\u7F13\u5B58\u4E0E\u6570\u636E\u5E93-\u81F4)
        1)\u3001\u8BFB\u5199\u52A0\u9501\u3002
        2)\u3001\u5F15\u5165Canal,\u611F\u77E5\u5230MySQL\u7684\u66F4\u65B0\u53BB\u66F4\u65B0\u6570\u636E\u5E93
        3)\u3001\u8BFB\u591A\u5199\u591A\uFF0C\u76F4\u63A5\u53BB\u6570\u636E\u5E93\u67E5\u8BE2\u5C31\u884C
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-7-\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#_4-7-\u603B\u7ED3" aria-hidden="true">#</a> 4.7. \u603B\u7ED3</h2><p><strong>\u5E38\u89C4\u6570\u636E</strong>\uFF1A(\u8BFB\u591A\u5199\u5C11\uFF0C\u5373\u65F6\u6027\uFF0C-\u81F4\u6027\u8981\u6C42\u4E0D\u9AD8\u7684\u6570\u636E) ;\u5B8C\u5168\u53EF\u4EE5\u4F7F\u7528Spring-Cache\uFF0C\u5199\u6A21\u5F0F(\u53EA\u8981\u7F13\u5B58\u7684\u6570\u636E\u6709\u8FC7\u671F\u65F6\u95F4\u5C31\u8DB3\u591F\u4E86 <strong>\u7279\u6B8A\u6570\u636E</strong>\uFF1A\u7279\u6B8A\u8BBE\u8BA1</p>`,167),T=[D];function E(U,I){return s(),a("div",null,T)}var F=n(j,[["render",E],["__file","cloud-lock-cache.html.vue"]]);export{F as default};
